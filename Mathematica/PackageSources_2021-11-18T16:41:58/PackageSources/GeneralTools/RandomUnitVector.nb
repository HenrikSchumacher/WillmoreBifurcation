Notebook[{Cell[BoxData[RowBox[{"MeasurePreserving3DSphereParameterization", 
      "=", RowBox[{"CPackageFunction", "[", 
        RowBox[{RowBox[{"{", RowBox[{"{", RowBox[{"X", ",", "_Real", ",", 
                "1"}], "}"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", RowBox[{RowBox[{RowBox[{"Cos", "[", RowBox[
                   {"X", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}], " ", SqrtBox[
                 RowBox[{"1", "-", SuperscriptBox[RowBox[{"X", 
                      "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                    "2"]}]]}], ",", RowBox[{SqrtBox[RowBox[{"1", "-", 
                   SuperscriptBox[RowBox[{"X", "\[LeftDoubleBracket]", "1", 
                      "\[RightDoubleBracket]"}], "2"]}]], " ", 
                RowBox[{"Sin", "[", RowBox[{"X", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}]}], ",", RowBox[{"X", 
                "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "}"}], ",", "\[IndentingNewLine]", RowBox[{"RuntimeAttributes", 
            "\[Rule]", "Listable"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Parallelization", "\[Rule]", "True"}]}], 
        "\[IndentingNewLine]", "]"}]}]], "Input", 
   CellChangeTimes -> {3.658682792604641*^9}], 
  Cell[BoxData[RowBox[{RowBox[{"MeasurePreserving2DSphereParameterization", 
        "=", RowBox[{"CPackageFunction", "[", 
          RowBox[{RowBox[{"{", RowBox[{"{", "X", "}"}], "}"}], ",", 
            "\[IndentingNewLine]", RowBox[{"{", RowBox[{RowBox[{"Cos", "[", 
                  "X", "]"}], ",", RowBox[{"Sin", "[", "X", "]"}]}], "}"}], 
            ",", "\[IndentingNewLine]", RowBox[{"RuntimeAttributes", 
              "\[Rule]", "Listable"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Parallelization", "\[Rule]", "True"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input", 
   CellChangeTimes -> {{3.658682820209536*^9, 3.6586828223653727*^9}}], 
  Cell[BoxData[RowBox[{"RandomUnitVector", "=", 
      RowBox[{"PackageFunction", "[", 
        RowBox[{RowBox[{"{", RowBox[{"n_", ",", "dim_"}], "}"}], ",", 
          "\[IndentingNewLine]", RowBox[{"With", "[", 
            RowBox[{RowBox[{"{", RowBox[{"V", "=", RowBox[{"Switch", "[", 
                    RowBox[{"dim", ",", "\[IndentingNewLine]", "1", ",", 
                      RowBox[{RowBox[{"2.", RowBox[{"RandomInteger", "[", 
                          RowBox[{"1", ",", "n"}], "]"}]}], "-", "1"}], ",", 
                      "\[IndentingNewLine]", "2", ",", RowBox[
                       {"MeasurePreserving2DSphereParameterization", "[", 
                        RowBox[{"RandomReal", "[", RowBox[{RowBox[{"{", 
                          RowBox[{RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], 
                          ",", "n"}], "]"}], "]"}], ",", 
                      "\[IndentingNewLine]", "3", ",", RowBox[
                       {"MeasurePreserving3DSphereParameterization", "[", 
                        "\[IndentingNewLine]", RowBox[{"Transpose", "[", 
                          RowBox[{"{", "\[IndentingNewLine]", RowBox[
                          {RowBox[{"RandomReal", "[", RowBox[{RowBox[{"{", 
                          RowBox[{RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                          "n"}], "]"}], ",", "\[IndentingNewLine]", RowBox[
                          {"RandomReal", "[", RowBox[{RowBox[{"{", RowBox[
                          {RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
                          "n"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
                          "]"}], "\[IndentingNewLine]", "]"}], ",", 
                      "\[IndentingNewLine]", "_", ",", RowBox[{"Message", 
                        "[", RowBox[{RowBox[{"RandomUnitVector", "::", 
                          "dimen"}], ",", "dim"}], "]"}]}], 
                    "\[IndentingNewLine]", "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", RowBox[{"If", "[", RowBox[
                 {RowBox[{"n", "\[Equal]", "1"}], ",", RowBox[{"V", 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                  ",", "V"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
          "\[IndentingNewLine]", RowBox[{"\"Errors\"", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", RowBox[{"\"dimen\"", 
                "\[Rule]", "\"Not implemented for dimension `1`.\""}], 
              "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
        "]"}]}]], "Input", CellChangeTimes -> 
    {{3.658682231607806*^9, 3.658682289933152*^9}, {3.6586823425282593*^9, 
      3.65868236804908*^9}, {3.6586824088659973*^9, 3.658682415322496*^9}, 
     {3.6586824592110147*^9, 3.6586824615714903*^9}, 
     {3.658682561798863*^9, 3.658682562399996*^9}, {3.6586826122804728*^9, 
      3.6586826251788683*^9}, {3.658682665099258*^9, 3.65868268256997*^9}, 
     {3.658682785768227*^9, 3.658682794956867*^9}, {3.658683006046566*^9, 
      3.658683025270712*^9}}]}, WindowSize -> {1115, 852}, 
 WindowMargins -> {{Automatic, 0}, {Automatic, 0}}, 
 FrontEndVersion -> 
  "10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 4, 2014)", 
 StyleDefinitions -> "Default.nb"]
