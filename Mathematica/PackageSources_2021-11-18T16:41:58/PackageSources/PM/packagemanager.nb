(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     54639,       1202]
NotebookOptionsPosition[     51329,       1157]
NotebookOutlinePosition[     51721,       1173]
CellTagsIndexPosition[     51678,       1170]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"VerbatimRegion", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"$PM", "::", "usage"}], "=", 
    "\"\<This is the global PackageManager. Don't mess with it!\>\""}], ";"}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.665495086086028*^9, 3.66549511816611*^9}, 
   3.665495399529447*^9},ExpressionUUID->"1fb5aaa3-87e3-425d-9bc1-\
31aae0377860"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"packagemanager", "=", 
    RowBox[{"Object", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "\"\<Description\>\"", "\[Rule]", 
       "\"\<This is the head used for PackageManager objects.\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<CacheActivated\>\"", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<PersistentCacheActivated\>\"", "\[Rule]", "True"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{"VerbatimRegion", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"Init", "::", "usage"}], "=", 
    "\"\<Initializes objects with heads 'packagemanager'.\>\""}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"packagemanager", "/:", 
    RowBox[{"Init", "[", 
     RowBox[{"packagemanager", ",", "path_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Initialize", "[", 
     RowBox[{"packagemanager", ",", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"\"\<SourcePath\>\"", "\[Rule]", "path"}], ",", 
        RowBox[{"\"\<Version\>\"", "\[Rule]", "\"\<0.9.1\>\""}]}], 
       "\[RightAssociation]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"CreateFormat", "[", 
    RowBox[{"packagemanager", ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<Caption\>\"", "\[Rule]", "\"\<Version: \>\""}], ",", 
         RowBox[{"\"\<Function\>\"", "\[Rule]", "VersionNumber"}]}], 
        "\[RightAssociation]"}], "}"}], "}"}], ",", 
     RowBox[{"{", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.664438991972519*^9, 3.664439026905204*^9}, {
   3.664439782352968*^9, 3.664439791295405*^9}, {3.6644398296080523`*^9, 
   3.664439900828212*^9}, {3.664441214161364*^9, 3.6644412145481*^9}, {
   3.66445875917557*^9, 3.664458832812172*^9}, 3.664459767426354*^9, {
   3.664459800461835*^9, 3.664459801734086*^9}, {3.665327840026353*^9, 
   3.665327860737528*^9}, {3.665330749811331*^9, 3.665330759915777*^9}, {
   3.665334325302908*^9, 3.665334369063648*^9}, {3.665335251670423*^9, 
   3.66533526217976*^9}, {3.665336881096884*^9, 3.665336887601424*^9}, {
   3.665336966259028*^9, 3.665337062659584*^9}, 3.665343384617056*^9, 
   3.669732032157872*^9, 3.683827264642139*^9, {3.6861165403579073`*^9, 
   3.686116557859674*^9}, {3.695027360094851*^9, 3.695027361374655*^9}, {
   3.707567089714114*^9, 3.7075671000314417`*^9}, 3.707567143618013*^9, {
   3.707567219918775*^9, 3.707567254731579*^9}, {3.707567340189814*^9, 
   3.707567374539776*^9}, {3.7075675437783833`*^9, 3.70756754724851*^9}, 
   3.7075678293769627`*^9, {3.7076570106956244`*^9, 3.707657022166273*^9}, {
   3.707977539395133*^9, 3.707977583934601*^9}, {3.7079790171391706`*^9, 
   3.7079790569366703`*^9}, {3.707979134144824*^9, 3.707979138693997*^9}, 
   3.796757858570506*^9},ExpressionUUID->"cca162e8-ff4f-4add-9bc5-\
1a2d201554a7"],

Cell[BoxData[
 RowBox[{"SourcePath", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_packagemanager", ",", 
    RowBox[{
     RowBox[{"M", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "\[LeftDoubleBracket]", "\"\<SourcePath\>\"", 
     "\[RightDoubleBracket]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.664440238852297*^9, 3.664440278294692*^9}, 
   3.665336888711677*^9, {3.695026931488305*^9, 3.695026934537179*^9}, {
   3.7075660070246058`*^9, 3.70756600726495*^9}, 3.756220598627372*^9, {
   3.756220911014052*^9, 3.756220912555056*^9}, {3.7953608480948877`*^9, 
   3.795360851644423*^9}},ExpressionUUID->"20d5e5c9-b999-4384-b3ac-\
6db9f0cd0ed9"],

Cell[BoxData[
 RowBox[{"Packages", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_packagemanager", ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"filedata", "=", 
        RowBox[{"Select", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Complement", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"FileNames", "[", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"SourcePath", "[", "M", "]"}], ",", "\"\<*\>\""}], 
               "}"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"SourcePath", "[", "M", "]"}], ",", 
                "\"\<PackageManager\>\""}], "}"}], "]"}], 
             "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{"x", "\[Function]", 
            RowBox[{"FileExistsQ", "[", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"x", ",", "\"\<MakeFile.m\>\""}], "}"}], "]"}], 
             "]"}]}], ")"}]}], "\[IndentingNewLine]", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Association", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", "=", 
             RowBox[{"Init", "[", 
              RowBox[{"package", ",", "#"}], "]"}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"Name", "[", "a", "]"}], "\[Rule]", "a"}]}], "]"}], "&"}],
         "/@", "filedata"}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.664459769753642*^9, 3.6644598479551783`*^9}, 
   3.6644652014148912`*^9, 3.664466105334309*^9, {3.6644662576142*^9, 
   3.6644662774150267`*^9}, {3.665292178635709*^9, 3.665292198858691*^9}, 
   3.6652924765677967`*^9, 3.665336889717663*^9, {3.6950251086113453`*^9, 
   3.695025139839834*^9}, {3.7075692472018137`*^9, 3.707569248872381*^9}, {
   3.707573788636147*^9, 3.707573790715043*^9}, {3.707578258164098*^9, 
   3.707578258371489*^9}, {3.707578297531774*^9, 3.707578298382189*^9}, {
   3.707929209851759*^9, 3.707929210105304*^9}, {3.756220663384697*^9, 
   3.7562206652380753`*^9}, {3.795360881285125*^9, 3.7953608855804453`*^9}, {
   3.796755034282743*^9, 3.796755078524452*^9}, {3.796755255681796*^9, 
   3.7967552755367537`*^9}, {3.7967905237955017`*^9, 3.796790528079385*^9}, {
   3.7967905839488153`*^9, 3.796790584173531*^9}, 
   3.83947749446782*^9},ExpressionUUID->"7ae0903c-2632-4deb-9c0c-\
aae2a917c549"],

Cell[BoxData[
 RowBox[{"Subpackages", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_packagemanager", ",", 
    RowBox[{"Map", "[", 
     RowBox[{"Subpackages", ",", 
      RowBox[{"Packages", "[", "M", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.664465214547441*^9, 3.664465216506275*^9}, {
   3.665290771162044*^9, 3.665290771781383*^9}, {3.6652911715104427`*^9, 
   3.66529117697366*^9}, {3.665292412749762*^9, 3.66529241777076*^9}, 
   3.665336890526332*^9, {3.6950274361961718`*^9, 3.695027442492228*^9}, {
   3.707926652615959*^9, 3.707926652805711*^9}, {3.795360909531289*^9, 
   3.7953609115290127`*^9}, 3.796755099488636*^9, {3.796789788036847*^9, 
   3.796789789201707*^9}},ExpressionUUID->"09da66d6-ffd4-4226-b359-\
d010370e0b92"],

Cell[BoxData[
 RowBox[{"NewPackages", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_packagemanager", ",", 
    RowBox[{"Complement", "[", 
     RowBox[{
      RowBox[{"Keys", "[", 
       RowBox[{"Packages", "[", "M", "]"}], "]"}], ",", 
      RowBox[{"Keys", "[", 
       RowBox[{"InstalledPackages", "[", "M", "]"}], "]"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.664465172932208*^9, 3.66446518524271*^9}, {
   3.664465222208946*^9, 3.6644652424044657`*^9}, 3.664465272905221*^9, {
   3.665295193505666*^9, 3.665295196714463*^9}, 3.665336893790833*^9, {
   3.6654142565829563`*^9, 3.6654142615309467`*^9}, {3.665414476777985*^9, 
   3.665414477344099*^9}, 3.695025458638647*^9, {3.7953605528078814`*^9, 
   3.7953605562060966`*^9}, {3.796789800192102*^9, 
   3.796789802605311*^9}},ExpressionUUID->"3199b9f8-249c-4423-8d98-\
6024f507e30a"],

Cell[BoxData[
 RowBox[{"ObsoletePackages", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_packagemanager", ",", 
    RowBox[{"KeyDrop", "[", 
     RowBox[{
      RowBox[{"InstalledPackages", "[", "M", "]"}], ",", 
      RowBox[{"Keys", "[", 
       RowBox[{"Packages", "[", "M", "]"}], "]"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.664466311303912*^9, 3.664466325025258*^9}, {
   3.665295201744652*^9, 3.665295205754795*^9}, 3.665336894331353*^9, {
   3.6654138288467703`*^9, 3.665413830193915*^9}, 3.6950254625275106`*^9, {
   3.7953605578394527`*^9, 3.795360559798643*^9}, {3.796789794722423*^9, 
   3.796789798993248*^9}},ExpressionUUID->"b0c57c9c-dd5c-46ee-b3c1-\
83f1d9915170"],

Cell[BoxData[
 RowBox[{"PackageOptions", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_packagemanager", ",", 
    RowBox[{"Map", "[", 
     RowBox[{"PackageOptions", ",", "Packages"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.664465651546032*^9, 3.664465679636262*^9}, 
   3.664466521617745*^9, 3.665336894886849*^9, {3.69502547229318*^9, 
   3.695025475924839*^9}, {3.6950272225216312`*^9, 3.6950272235679913`*^9}, {
   3.69502755981854*^9, 3.695027566674264*^9}, {3.707926663613305*^9, 
   3.707926663789456*^9}, {3.7953605637106733`*^9, 3.7953605660853252`*^9}, {
   3.7967548071711283`*^9, 3.796754811843256*^9}, {3.796789805673242*^9, 
   3.7967898066328707`*^9}},ExpressionUUID->"3ff915d0-079c-464f-854d-\
a87a8ec27deb"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7967550907431793`*^9, 
  3.7967550920162487`*^9}},ExpressionUUID->"dcec6f56-3593-417a-b068-\
d132ee67582a"],

Cell[BoxData[
 RowBox[{"SelfUpdate", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_packagemanager", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "postnames", ",", "newnames", ",", "prenames"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"prenames", "=", 
        RowBox[{"Names", "[", 
         RowBox[{
          RowBox[{"Context", "[", "]"}], "<>", "\"\<*\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ClearCache", "[", "M", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"a", "=", 
        RowBox[{
         RowBox[{"Packages", "[", "M", "]"}], "\[LeftDoubleBracket]", 
         "\"\<PM\>\"", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"repoltempfile", "=", 
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                "a", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "\[LeftDoubleBracket]", "\"\<SourcePath\>\"", 
                "\[RightDoubleBracket]"}], ",", "\"\<LTemplate\>\""}], "}"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"ltempfile", "=", 
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ParentDirectory", "[", 
                RowBox[{"InstallationPath", "[", "a", "]"}], "]"}], ",", 
               "\"\<LTemplate\>\""}], "}"}], "]"}]}]}], "\[IndentingNewLine]",
           "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FileExistsQ", "[", "ltempfile", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"FileDate", "[", "repoltempfile", "]"}], ">", 
               RowBox[{"FileDate", "[", "ltempfile", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"DeleteDirectory", "[", 
                RowBox[{"ltempfile", ",", 
                 RowBox[{"DeleteContents", "\[Rule]", "True"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"CopyDirectory", "[", 
                RowBox[{"repoltempfile", ",", "ltempfile"}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"CopyDirectory", "[", 
              RowBox[{"repoltempfile", ",", "ltempfile"}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"OutdatedQ", "[", "a", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<PM outdated. Updating...\>\"", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"WritePackage", "[", "a", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"CreateCallGraph", "[", 
           RowBox[{"a", ",", 
            RowBox[{"{", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "\"\<PM update complete.\>\"", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Get", "[", "\"\<PM`\>\"", "]"}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LoadCallGraph", "[", "a", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"postnames", "=", 
        RowBox[{"Names", "[", 
         RowBox[{
          RowBox[{"Context", "[", "]"}], "<>", "\"\<*\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newnames", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{"postnames", ",", "prenames"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Unprotect", "/@", "newnames"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Quiet", "[", 
        RowBox[{"Remove", "/@", "newnames"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"postnames", "=", 
        RowBox[{"Names", "[", 
         RowBox[{
          RowBox[{"Context", "[", "]"}], "<>", "\"\<*\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newnames", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{"postnames", ",", "prenames"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "newnames", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<SelfUpdate: SelfUpdate leaked \>\"", ",", 
            RowBox[{"Length", "[", "newnames", "]"}], ",", 
            "\"\< symbols:\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "newnames", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.665386787384774*^9, 3.6653867982875433`*^9}, {
   3.665386847486224*^9, 3.665386876309395*^9}, {3.665386908857263*^9, 
   3.665386944347116*^9}, {3.665401546818362*^9, 3.665401556347926*^9}, {
   3.665401596549008*^9, 3.665401603615076*^9}, {3.665401661556377*^9, 
   3.665401663380328*^9}, {3.665401762389447*^9, 3.6654017808900223`*^9}, {
   3.6654159308982353`*^9, 3.6654159311136637`*^9}, {3.6654779752351933`*^9, 
   3.665477986970336*^9}, {3.665478992070129*^9, 3.665479048835499*^9}, {
   3.6654864109565268`*^9, 3.665486417180479*^9}, 3.665491856053458*^9, {
   3.665494197343478*^9, 3.665494209056282*^9}, {3.683827399129125*^9, 
   3.683827406057494*^9}, {3.683827580916976*^9, 3.683827623128023*^9}, {
   3.6950197797051153`*^9, 3.6950197802894573`*^9}, {3.6950201580869627`*^9, 
   3.695020187207486*^9}, {3.695026972109501*^9, 3.695026986785438*^9}, {
   3.695027017858379*^9, 3.69502702687423*^9}, {3.695041737560631*^9, 
   3.695041790309729*^9}, {3.695041901345899*^9, 3.6950419180296583`*^9}, 
   3.707566025896955*^9, {3.707574191112246*^9, 3.7075741965576563`*^9}, 
   3.707929221218749*^9, {3.729513955833881*^9, 3.729514004776659*^9}, {
   3.729514045120776*^9, 3.7295140569897957`*^9}, {3.729514770464158*^9, 
   3.729514781861252*^9}, {3.729515754476142*^9, 3.7295157567792788`*^9}, {
   3.79536091351584*^9, 3.7953609197946787`*^9}, {3.796736553117116*^9, 
   3.79673656786031*^9}, {3.79673881801433*^9, 3.796738828009753*^9}, 
   3.796885124260564*^9, {3.797419040431158*^9, 3.797419081556718*^9}, {
   3.797419151955462*^9, 3.797419176915399*^9}, {3.7974192333296013`*^9, 
   3.797419235552507*^9}, {3.797419314982205*^9, 3.7974193282862988`*^9}, {
   3.797419498415256*^9, 3.797419498720345*^9}, {3.7974195373016644`*^9, 
   3.79741954118923*^9}},ExpressionUUID->"30a62830-71ca-4099-83ab-\
04a82efc36ba"],

Cell[BoxData[
 RowBox[{"OutdatedSubpackages", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_packagemanager", ",", 
    RowBox[{"Map", "[", 
     RowBox[{"OutdatedSubpackages", ",", 
      RowBox[{"Packages", "[", "M", "]"}]}], "]"}]}], "]"}]}]], "Input",Expres\
sionUUID->"26ea5166-4050-4b2a-ac94-5ceff45eefab"],

Cell[BoxData[
 RowBox[{"OutdatedPackages", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_packagemanager", ",", 
    RowBox[{"Pick", "[", 
     RowBox[{
      RowBox[{"Keys", "[", 
       RowBox[{"Packages", "[", "M", "]"}], "]"}], ",", 
      RowBox[{"Values", "[", 
       RowBox[{"Map", "[", 
        RowBox[{"OutdatedQ", ",", 
         RowBox[{"Packages", "[", "M", "]"}]}], "]"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.664461810840301*^9, 3.6644618153262157`*^9}, {
   3.664461905422283*^9, 3.664461913996653*^9}, {3.664462133758275*^9, 
   3.664462138180686*^9}, {3.664465217255258*^9, 3.6644652198111477`*^9}, {
   3.6644656637126417`*^9, 3.664465668081122*^9}, {3.665290772432856*^9, 
   3.66529077305044*^9}, {3.665295098235886*^9, 3.665295103608985*^9}, {
   3.665296164029845*^9, 3.66529616458836*^9}, {3.665336891126436*^9, 
   3.6653368917634563`*^9}, {3.665389504176759*^9, 3.665389512258004*^9}, {
   3.69502747806392*^9, 3.695027510412055*^9}, 3.695032814231361*^9, {
   3.707926656039855*^9, 3.707926661180766*^9}, {3.795360924617944*^9, 
   3.795360929872299*^9}, {3.796755115512492*^9, 3.7967551231355753`*^9}, {
   3.796755155358718*^9, 3.796755182155491*^9}, {3.7967898201597443`*^9, 
   3.7967898273908377`*^9}},ExpressionUUID->"c2026649-b265-405c-afa5-\
49ced0a4a8e7"],

Cell[BoxData[
 RowBox[{"LoadedPackages", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_packagemanager", ",", "\[IndentingNewLine]", 
    RowBox[{"Intersection", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{"x", "\[Function]", 
         RowBox[{"StringTake", "[", 
          RowBox[{"x", ",", 
           RowBox[{"1", ";;", 
            RowBox[{"-", "2"}]}]}], "]"}]}], ",", "$Packages"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Keys", "[", 
       RowBox[{"Packages", "[", "M", "]"}], "]"}]}], "\[IndentingNewLine]", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.664440684577198*^9, 3.664440711817819*^9}, {
   3.6644609660536633`*^9, 3.664460973975916*^9}, {3.664461098823517*^9, 
   3.664461167395608*^9}, 3.6644612698924837`*^9, 3.664461338970689*^9, 
   3.664465220705246*^9, 3.6652951528959217`*^9, 3.6653368925130777`*^9, 
   3.6950254269034433`*^9, {3.795360933858075*^9, 
   3.79536093608032*^9}},ExpressionUUID->"27ba2a56-a9c9-4feb-bb40-\
5e3697fb6069"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"InstalledPackages", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M_packagemanager", ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "files", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"files", "=", 
         RowBox[{"Select", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Complement", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"FileNames", "[", 
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{
                "$UserBaseDirectory", ",", "\"\<Applications\>\"", ",", 
                 "\"\<*\>\""}], "}"}], "]"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{
                "$UserBaseDirectory", ",", "\"\<Applications\>\"", ",", 
                 "\"\<PackageManager\>\""}], "}"}], "]"}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{"x", "\[Function]", 
             RowBox[{"FileExistsQ", "[", 
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{
                "x", ",", "\"\<aux\>\"", ",", "\"\<MakeFile.aux\>\""}], "}"}],
                "]"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AssociationThread", "[", 
         RowBox[{
          RowBox[{"FileBaseName", "/@", "files"}], ",", "files"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", "]"}]}],
   "*)"}]], "Input",
 CellChangeTimes->{{3.664440720395524*^9, 3.6644407265468407`*^9}, {
   3.664440784495881*^9, 3.6644407866593246`*^9}, {3.664462183832842*^9, 
   3.6644621984615717`*^9}, {3.664463151080229*^9, 3.664463155659485*^9}, 
   3.664465167783205*^9, 3.664465221368024*^9, {3.664466127165873*^9, 
   3.664466208610037*^9}, {3.6644664333033953`*^9, 3.664466437733651*^9}, {
   3.6652951867993507`*^9, 3.665295187095623*^9}, 3.665336893077157*^9, {
   3.665413686513913*^9, 3.665413716857041*^9}, {3.7953605497931128`*^9, 
   3.795360551447093*^9}, {3.7953609609524918`*^9, 3.7953609651594687`*^9}, 
   3.7974398555250597`*^9},ExpressionUUID->"e9c0a50a-cb48-4cdd-a3a1-\
4defb983ae47"],

Cell[BoxData[
 RowBox[{"InstalledPackages", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_packagemanager", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "folderexists", ",", "installedpackages", ",", "corruptedpackges"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"folderexists", "=", 
        RowBox[{"Select", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Packages", "[", "$PM", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"And", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"FileExistsQ", "[", 
              RowBox[{"InstallationPath", "[", "#", "]"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"FileExistsQ", "[", 
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"AuxPath", "[", "#", "]"}], ",", 
                 "\"\<MakeFile.aux\>\""}], "}"}], "]"}], "]"}]}], 
            "\[IndentingNewLine]", "]"}], "&"}]}], "\[IndentingNewLine]", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"installedpackages", "=", 
        RowBox[{"Select", "[", "\[IndentingNewLine]", 
         RowBox[{"folderexists", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"And", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"FileExistsQ", "[", 
              RowBox[{"InstallationFile", "[", "#", "]"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"FileExistsQ", "[", 
              RowBox[{"DynamicLibraryPath", "[", "#", "]"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"FileExistsQ", "[", 
              RowBox[{"GraphFile", "[", "#", "]"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"FileExistsQ", "[", 
              RowBox[{"SourceLookupFile", "[", "#", "]"}], "]"}]}], 
            "\[IndentingNewLine]", "]"}], "&"}]}], "\[IndentingNewLine]", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"corruptedpackges", "=", 
        RowBox[{"Complement", "[", 
         RowBox[{"folderexists", ",", "installedpackages"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "corruptedpackges", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<The following \>\"", ",", 
            RowBox[{"Length", "[", "corruptedpackges", "]"}], ",", 
            "\"\< corrupted packages have been found.\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<  \>\"", ",", 
              RowBox[{"Name", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
           "corruptedpackges"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"InstallationPath", "/@", "installedpackages"}]}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.797439864533225*^9, 3.797439905783554*^9}, {
  3.7974399366816473`*^9, 3.797440037227964*^9}, {3.7974400770201683`*^9, 
  3.797440106993806*^9}, {3.839477474692575*^9, 3.8394774891564503`*^9}, {
  3.839477538174678*^9, 3.8394775702051573`*^9}, {3.8394776064863243`*^9, 
  3.839477635772788*^9}, {3.839481135785303*^9, 3.839481149104106*^9}, {
  3.839481202406802*^9, 3.839481260654307*^9}, {3.8394813068370934`*^9, 
  3.8394813114103107`*^9}},ExpressionUUID->"a3cd64f5-3632-496b-8689-\
f37fa8192266"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.797439862397677*^9, 
  3.7974398859791117`*^9}},ExpressionUUID->"d65ae5e3-f604-432c-8f8b-\
402dbb1fe747"],

Cell[BoxData[
 RowBox[{"VerbatimRegion", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Context2Name", "::", "usage"}], "=", "\"\<\>\""}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"SetAttributes", "[", 
    RowBox[{"Context2Name", ",", "Listable"}], "]"}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Context2Name", "[", "s_String", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{"s", ",", 
         RowBox[{"-", "1"}]}], "]"}], "\[Equal]", "\"\<`\>\""}], ",", 
      RowBox[{"StringTake", "[", 
       RowBox[{"s", ",", 
        RowBox[{"1", ";;", 
         RowBox[{"-", "2"}]}]}], "]"}], ",", "s"}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6644683222205877`*^9, 
  3.664468356525353*^9}},ExpressionUUID->"8b2ffa49-7a2c-481b-b9fe-\
c45740c92897"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"PackageSourceTree", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M_packagemanager", ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"names", "=", 
          RowBox[{"Keys", "[", 
           RowBox[{"Packages", "[", "M", "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"subnames", "=", 
          RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}], "\[Function]", 
             RowBox[{"(", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"x", "\[Rule]", 
                 RowBox[{"FileNameJoin", "[", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "z"}], "}"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"z", ",", "y"}], "}"}]}], "]"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Map", "[", 
             RowBox[{"SubpackageName", ",", 
              RowBox[{"Subpackages", "[", "M", "]"}], ",", 
              RowBox[{"{", "2", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
           "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Graph", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"\"\<PackageSource\>\"", "\[Rule]", "names"}], "]"}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"Catenate", "@", "subnames"}]}], "\[IndentingNewLine]", 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"VertexLabels", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{"\"\<Name\>\"", ",", "Tooltip"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.664460821417582*^9, 3.6644608245751762`*^9}, {
   3.664460863817485*^9, 3.664460917261128*^9}, {3.6644614608065243`*^9, 
   3.664461478107723*^9}, {3.664461515864016*^9, 3.664461519091518*^9}, 
   3.664465212854394*^9, 3.665290770522635*^9, 3.665291165454974*^9, {
   3.665292318785345*^9, 3.665292330904421*^9}, {3.665295494299884*^9, 
   3.6652955052443523`*^9}, {3.6652957749383183`*^9, 3.665295792934387*^9}, {
   3.6652958466337233`*^9, 3.665295847408251*^9}, 3.665336900008061*^9, {
   3.695025483004692*^9, 3.695025484861107*^9}, {3.695025666086506*^9, 
   3.695025669866206*^9}, 3.695025816557796*^9, {3.695025899122332*^9, 
   3.695025909120715*^9}, {3.695026057748502*^9, 3.6950260819755583`*^9}, {
   3.795360569807777*^9, 3.7953605723591623`*^9}, {3.7953606304995413`*^9, 
   3.795360645786388*^9}},ExpressionUUID->"8a35654e-afc9-4cf9-be23-\
e3161701eadb"],

Cell[BoxData[
 RowBox[{"PackageNames", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_packagemanager", ",", 
    RowBox[{"Keys", "[", 
     RowBox[{"Packages", "[", "M", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.8394774758222017`*^9},ExpressionUUID->"abb142e1-90b5-4fdc-b13a-\
0cea96d31942"],

Cell[BoxData[
 RowBox[{"PackageInstallationDates", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_packagemanager", ",", 
    RowBox[{"Map", "[", 
     RowBox[{"InstallationDate", ",", 
      RowBox[{"Packages", "[", "M", "]"}]}], "]"}], ",", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.665396921335882*^9, 3.665396993041881*^9}, 
   3.66539726623596*^9, {3.6655818260900087`*^9, 3.6655818289101686`*^9}, {
   3.69502613712103*^9, 3.695026139007572*^9}, {3.695027277828535*^9, 
   3.695027308510257*^9}, {3.695027610387602*^9, 3.69502764726947*^9}, {
   3.6950323663864737`*^9, 3.69503236657714*^9}, {3.707926665871162*^9, 
   3.707926666045326*^9}, {3.795360650899885*^9, 3.795360674532057*^9}, {
   3.796789759752589*^9, 3.796789766733199*^9}, {3.7967898439530373`*^9, 
   3.796789851895719*^9}},ExpressionUUID->"137db9cf-fd2a-4a8b-8df6-\
abf95d433831"],

Cell[BoxData[
 RowBox[{"PackageLastChangeDates", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_packagemanager", ",", 
    RowBox[{"Map", "[", 
     RowBox[{"LastChangeDate", ",", 
      RowBox[{"Packages", "[", "M", "]"}]}], "]"}], ",", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.665581835092967*^9, 3.665581847584948*^9}, {
  3.695032340925148*^9, 3.69503237769624*^9}, {3.707926667895405*^9, 
  3.707926668067732*^9}, {3.7953606779470654`*^9, 3.795360699325337*^9}, {
  3.79675482535529*^9, 3.79675483173794*^9}, {3.796789854060307*^9, 
  3.796789860058651*^9}},ExpressionUUID->"1280bd2d-7247-45a2-8501-\
d31b3f469ed6"],

Cell[BoxData[
 RowBox[{"LoadedPackageData", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_packagemanager", ",", 
    RowBox[{"Map", "[", 
     RowBox[{"Data", ",", 
      RowBox[{
       RowBox[{"Packages", "[", "M", "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"LoadedPackages", "[", "M", "]"}], "\[RightDoubleBracket]"}]}],
      "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.665408129008436*^9, 3.665408149580256*^9}, {
   3.695026543639635*^9, 3.6950265591490088`*^9}, {3.6950267638695517`*^9, 
   3.6950267648043203`*^9}, {3.707926669997406*^9, 3.707926670165155*^9}, {
   3.795360726442854*^9, 3.795360728456726*^9}, 3.796754986603446*^9, {
   3.796789864839428*^9, 3.796789865829974*^9}, 
   3.839480572781075*^9},ExpressionUUID->"992e123d-9dfb-487c-8ee5-\
55f50c6a9070"],

Cell[BoxData[
 RowBox[{"DeleteObsolete", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_packagemanager", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"packlist", ",", "deletefiles", ",", "deletedirectories"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"packlist", "=", 
        RowBox[{"Packages", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"deletefiles", "=", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Values", "/@", 
          RowBox[{"Values", "[", 
           RowBox[{"Map", "[", 
            RowBox[{"ObsoleteSubpackages", ",", "packlist"}], "]"}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"deletedirectories", "=", 
        RowBox[{"Values", "[", 
         RowBox[{"ObsoletePackages", "[", "M", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DeleteFile", "[", "deletefiles", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DeleteDirectory", "[", 
        RowBox[{"deletedirectories", ",", 
         RowBox[{"DeleteContents", "\[Rule]", "True"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ClearCache", "[", "M", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{"deletefiles", ",", "deletedirectories"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.665413317654434*^9, 3.665413437826124*^9}, {
  3.665413861069338*^9, 3.665413890491914*^9}, {3.6654139247915497`*^9, 
  3.665414013042307*^9}, {3.695026695072832*^9, 3.695026699309372*^9}, {
  3.70792667287816*^9, 3.707926673044251*^9}, {3.795360733210622*^9, 
  3.795360736056652*^9}},ExpressionUUID->"13d93247-6524-41bf-bf54-\
9f61d4854106"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LoadedPackageFunctionList", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M_packagemanager", ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"data", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"DeleteMissing", "[", 
           RowBox[{
            RowBox[{"LoadedPackageData", "[", "M", "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "\"\<PackageFunctions\>\""}], 
            "\[RightDoubleBracket]"}], "]"}], "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"data", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "\"\<FunctionName\>\""}], 
          "\[RightDoubleBracket]"}], ",", "data"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"LoadedCPackageFunctionList", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_packagemanager", ",", "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{"DeleteMissing", "[", 
      RowBox[{
       RowBox[{"LoadedPackageData", "[", "M", "]"}], "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "\"\<CPackageFunctions\>\""}], 
       "\[RightDoubleBracket]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6654751670392036`*^9, 3.665475216296239*^9}, {
  3.665475260396122*^9, 3.665475275525692*^9}, {3.665475338982749*^9, 
  3.6654753660380363`*^9}, {3.6654754173220778`*^9, 3.665475436640459*^9}, {
  3.665478444320632*^9, 3.6654784551158257`*^9}, {3.695026842958948*^9, 
  3.695026844805751*^9}, {3.79536076272794*^9, 3.79536078178168*^9}, {
  3.796789690996817*^9, 
  3.796789691878461*^9}},ExpressionUUID->"8483ad0a-d7e5-41e7-bed9-\
c4674b61eb6a"],

Cell[BoxData[
 RowBox[{"Code", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"s_", ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", "s", "]"}], "===", "packagefunction"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"s", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "\[LeftDoubleBracket]", "\"\<FullCode\>\"", "\[RightDoubleBracket]"}],
        ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"fun", "=", 
          RowBox[{
           RowBox[{"LoadedPackageFunctionList", "[", "$PM", "]"}], "[", 
           RowBox[{"ToString", "[", "s", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "fun", "]"}], "===", "Missing"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"Code", "::", "notfnd"}], ",", "s"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "fun", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", "\"\<FullCode\>\"", 
           "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Errors\>\"", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<notfnd\>\"", "\[Rule]", 
       "\"\<Error: Could not find a PackageFunction `1`.\>\""}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6654757445707817`*^9, 3.6654757685705223`*^9}, 
   3.665475814389957*^9, {3.665476186433813*^9, 3.665476366613309*^9}, {
   3.665476397303957*^9, 3.665476412223858*^9}, {3.6654764660656157`*^9, 
   3.6654764893784103`*^9}, 3.665478458654628*^9, {3.7075660307367067`*^9, 
   3.7075660360811157`*^9}},ExpressionUUID->"d094667a-d3a3-4507-8f77-\
5dbb32f286bb"],

Cell[BoxData[
 RowBox[{"PackageFunctionSources", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_packagemanager", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"allpackages", ",", "indices", ",", "result", ",", "plist"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"allpackages", "=", 
        RowBox[{"Packages", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"plist", "=", 
        RowBox[{"allpackages", "\[LeftDoubleBracket]", 
         RowBox[{"LoadedPackages", "[", "M", "]"}], 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"Merge", "[", 
         RowBox[{
          RowBox[{"Values", "[", 
           RowBox[{"Map", "[", 
            RowBox[{"PackageFunctionSources", ",", "plist"}], "]"}], "]"}], 
          ",", "Catenate"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"allpackages", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"allpackages", ",", "plist"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SetCache", "[", 
        RowBox[{"M", ",", "\"\<Packages\>\"", ",", "allpackages"}], "]"}], 
       ";", "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.683829165139268*^9, 3.6838291796991777`*^9}, {
   3.6838297452254963`*^9, 3.6838297697226763`*^9}, {3.68383009253093*^9, 
   3.6838300929592953`*^9}, {3.694112987597333*^9, 3.694112994853599*^9}, {
   3.694113196450617*^9, 3.694113196927021*^9}, {3.6950269028293743`*^9, 
   3.695026906027506*^9}, 3.6950448864978228`*^9, {3.695044943859282*^9, 
   3.695044957898512*^9}, {3.707926675215169*^9, 3.707926675373013*^9}, {
   3.795360789856676*^9, 3.795360792397992*^9}, {3.7953608392527533`*^9, 
   3.7953608410604267`*^9}, 
   3.7967578230192757`*^9},ExpressionUUID->"27bcac62-eedd-4d2d-9250-\
ae544673ab38"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Source", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M_packagemanager", ",", "fun_"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", "=", 
         RowBox[{"PackageFunctionSources", "[", "M", "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"f", "[", 
        RowBox[{"ToString", "[", 
         RowBox[{"fun", ",", "InputForm"}], "]"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Source", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "fun_", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"f", "=", 
        RowBox[{"PackageFunctionSources", "[", "$PM", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"f", "[", 
       RowBox[{"ToString", "[", 
        RowBox[{"fun", ",", "InputForm"}], "]"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",\

 CellChangeTimes->{
  3.6941132787767267`*^9, {3.795360795136191*^9, 
   3.795360797269524*^9}},ExpressionUUID->"6efe286a-ef20-4be6-898d-\
451ff750226a"],

Cell[BoxData[
 RowBox[{"OpenSource", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M_packagemanager", ",", "fun_"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "source", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"source", "=", 
        RowBox[{"Source", "[", 
         RowBox[{"M", ",", "fun"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "source", "]"}], ">", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"OpenSource", "::", "morethanone"}], ",", "fun"}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Grid", "[", 
           RowBox[{
            RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"s", ",", "i"}], "}"}], "\[Function]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                 "i", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 ",", "\"\<\[Rule]\>\"", ",", 
                 RowBox[{"Button", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{"s", ",", "\"\<Hyperlink\>\"", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "\"\<Courier\>\""}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", "nb", "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"nb", "=", 
                    RowBox[{"NotebookOpen", "[", 
                    RowBox[{
                    "s", "\[LeftDoubleBracket]", "\"\<File\>\"", 
                    "\[RightDoubleBracket]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"SelectionMove", "[", 
                    RowBox[{"nb", ",", "Before", ",", "Notebook"}], "]"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"SelectionMove", "[", 
                    RowBox[{"nb", ",", "Next", ",", "Cell", ",", 
                    RowBox[{
                    "s", "\[LeftDoubleBracket]", "\"\<Cell\>\"", 
                    "\[RightDoubleBracket]"}]}], "]"}]}]}], 
                    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                   
                   RowBox[{"Alignment", "\[Rule]", "Left"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Appearance", "\[Rule]", "None"}]}], 
                  "\[IndentingNewLine]", "]"}]}], "}"}]}], ",", 
              "\[IndentingNewLine]", "source"}], "\[IndentingNewLine]", "]"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"Alignment", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"Right", ",", "Center", ",", "Left"}], "}"}], 
              "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"nb", "=", 
            RowBox[{"NotebookOpen", "[", 
             RowBox[{
              RowBox[{
              "source", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
              "\"\<File\>\"", "\[RightDoubleBracket]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"SelectionMove", "[", 
            RowBox[{"nb", ",", "Before", ",", "Notebook"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"SelectionMove", "[", 
            RowBox[{"nb", ",", "Next", ",", "Cell", ",", 
             RowBox[{"source", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "\"\<Cell\>\""}], "\[RightDoubleBracket]"}]}],
             "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"OpenSource", "[", 
          RowBox[{"M", ",", "fun", ",", "1"}], "]"}]}], "\[IndentingNewLine]",
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{"\"\<Errors\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<morethanone\>\"", "\[Rule]", 
       "\"\<More than one source found. Please specify which one to open by \
calling OpenSource[M,`1`,n].\>\""}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.694112241023273*^9, 3.694112324022481*^9}, {
   3.6941124471387243`*^9, 3.6941124472908783`*^9}, {3.694112490032331*^9, 
   3.694112728197009*^9}, {3.694112764650633*^9, 3.6941127713855553`*^9}, {
   3.694112839614691*^9, 3.694112847106924*^9}, {3.69411296750294*^9, 
   3.694112972191497*^9}, {3.6941130387190657`*^9, 3.694113145757504*^9}, 
   3.694113201693707*^9, 3.707566041169663*^9, {3.7190766010526867`*^9, 
   3.719076601274832*^9}, {3.7589584315474577`*^9, 3.758958486178357*^9}, {
   3.758958543233198*^9, 3.758958548576247*^9}, {3.758960581092733*^9, 
   3.758960589010686*^9}, {3.839482174744101*^9, 
   3.839482189124249*^9}},ExpressionUUID->"e85de76b-a59b-49d3-b83b-\
48374898ed52"],

Cell[BoxData[
 RowBox[{"OpenSource", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M_packagemanager", ",", "fun_", ",", "i_"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"source", ",", "nb"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"source", "=", 
        RowBox[{
         RowBox[{"Source", "[", 
          RowBox[{"M", ",", "fun"}], "]"}], "\[LeftDoubleBracket]", "i", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nb", "=", 
        RowBox[{"NotebookOpen", "[", 
         RowBox[{
         "source", "\[LeftDoubleBracket]", "\"\<File\>\"", 
          "\[RightDoubleBracket]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SelectionMove", "[", 
        RowBox[{"nb", ",", "Before", ",", "Notebook"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SelectionMove", "[", 
        RowBox[{"nb", ",", "Next", ",", "Cell", ",", 
         RowBox[{
         "source", "\[LeftDoubleBracket]", "\"\<Cell\>\"", 
          "\[RightDoubleBracket]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->\
"a6e46f7b-5d6f-4089-ba4d-b17f98692186"],

Cell[BoxData[
 RowBox[{"OpenSource", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "fun_", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"OpenSource", "[", 
     RowBox[{"$PM", ",", "fun"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"faa9ac6f-6321-4022-abf0-ba1f302def7a"],

Cell[BoxData[
 RowBox[{"OpenSource", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fun_", ",", "i_"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"OpenSource", "[", 
     RowBox[{"$PM", ",", "fun", ",", "i"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"1cfbd2f6-7e85-4910-aef1-30cc82e645be"],

Cell[BoxData[
 RowBox[{"VerbatimRegion", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Unprotect", "[", "VersionNumber", "]"}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"VersionNumber", "=", 
    RowBox[{"PackageFunction", "[", 
     RowBox[{"M_packagemanager", ",", 
      RowBox[{
       RowBox[{"M", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "\[LeftDoubleBracket]", "\"\<Version\>\"", "\[RightDoubleBracket]"}]}],
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Protect", "[", "VersionNumber", "]"}], ";"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.70797701117467*^9, 3.70797702583432*^9}, {
  3.795360813637664*^9, 
  3.795360834738351*^9}},ExpressionUUID->"0626c0e1-4f31-4289-ae44-\
8745fb1d55bc"]
},
WindowSize->{1440, 855},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (June 19, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b9b9f27f-6f9a-4046-9542-329f06a9eb6b"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 404, 9, 92, "Input",ExpressionUUID->"1fb5aaa3-87e3-425d-9bc1-31aae0377860"],
Cell[965, 31, 3137, 63, 442, "Input",ExpressionUUID->"cca162e8-ff4f-4add-9bc5-1a2d201554a7"],
Cell[4105, 96, 677, 13, 42, "Input",ExpressionUUID->"20d5e5c9-b999-4384-b3ac-6db9f0cd0ed9"],
Cell[4785, 111, 2904, 62, 367, "Input",ExpressionUUID->"7ae0903c-2632-4deb-9c0c-aae2a917c549"],
Cell[7692, 175, 764, 14, 42, "Input",ExpressionUUID->"09da66d6-ffd4-4226-b359-d010370e0b92"],
Cell[8459, 191, 866, 18, 42, "Input",ExpressionUUID->"3199b9f8-249c-4423-8d98-6024f507e30a"],
Cell[9328, 211, 707, 15, 42, "Input",ExpressionUUID->"b0c57c9c-dd5c-46ee-b3c1-83f1d9915170"],
Cell[10038, 228, 744, 13, 42, "Input",ExpressionUUID->"3ff915d0-079c-464f-854d-a87a8ec27deb"],
Cell[10785, 243, 156, 3, 41, "Input",ExpressionUUID->"dcec6f56-3593-417a-b068-d132ee67582a"],
Cell[10944, 248, 7126, 146, 1017, "Input",ExpressionUUID->"30a62830-71ca-4099-83ab-04a82efc36ba"],
Cell[18073, 396, 320, 7, 42, "Input",ExpressionUUID->"26ea5166-4050-4b2a-ac94-5ceff45eefab"],
Cell[18396, 405, 1347, 25, 92, "Input",ExpressionUUID->"c2026649-b265-405c-afa5-49ced0a4a8e7"],
Cell[19746, 432, 1157, 25, 192, "Input",ExpressionUUID->"27ba2a56-a9c9-4feb-bb40-5e3697fb6069"],
Cell[20906, 459, 2498, 52, 342, "Input",ExpressionUUID->"e9c0a50a-cb48-4cdd-a3a1-4defb983ae47"],
Cell[23407, 513, 3792, 81, 692, "Input",ExpressionUUID->"a3cd64f5-3632-496b-8689-f37fa8192266"],
Cell[27202, 596, 154, 3, 41, "Input",ExpressionUUID->"d65ae5e3-f604-432c-8f8b-402dbb1fe747"],
Cell[27359, 601, 889, 24, 142, "Input",ExpressionUUID->"8b2ffa49-7a2c-481b-b9fe-c45740c92897"],
Cell[28251, 627, 2921, 61, 417, "Input",ExpressionUUID->"8a35654e-afc9-4cf9-be23-e3161701eadb"],
Cell[31175, 690, 316, 8, 42, "Input",ExpressionUUID->"abb142e1-90b5-4fdc-b13a-0cea96d31942"],
Cell[31494, 700, 906, 16, 42, "Input",ExpressionUUID->"137db9cf-fd2a-4a8b-8df6-abf95d433831"],
Cell[32403, 718, 675, 13, 42, "Input",ExpressionUUID->"1280bd2d-7247-45a2-8501-d31b3f469ed6"],
Cell[33081, 733, 793, 16, 42, "Input",ExpressionUUID->"992e123d-9dfb-487c-8ee5-55f50c6a9070"],
Cell[33877, 751, 1838, 39, 317, "Input",ExpressionUUID->"13d93247-6524-41bf-bf54-9f61d4854106"],
Cell[35718, 792, 2005, 44, 242, "Input",ExpressionUUID->"8483ad0a-d7e5-41e7-bed9-c4674b61eb6a"],
Cell[37726, 838, 2162, 50, 392, "Input",ExpressionUUID->"d094667a-d3a3-4507-8f77-5dbb32f286bb"],
Cell[39891, 890, 1985, 40, 267, "Input",ExpressionUUID->"27bcac62-eedd-4d2d-9250-ae544673ab38"],
Cell[41879, 932, 1327, 37, 292, "Input",ExpressionUUID->"6efe286a-ef20-4be6-898d-451ff750226a"],
Cell[43209, 971, 5306, 113, 792, "Input",ExpressionUUID->"e85de76b-a59b-49d3-b83b-48374898ed52"],
Cell[48518, 1086, 1298, 31, 217, "Input",ExpressionUUID->"a6e46f7b-5d6f-4089-ba4d-b17f98692186"],
Cell[49819, 1119, 326, 7, 92, "Input",ExpressionUUID->"faa9ac6f-6321-4022-abf0-ba1f302def7a"],
Cell[50148, 1128, 363, 8, 92, "Input",ExpressionUUID->"1cfbd2f6-7e85-4910-aef1-30cc82e645be"],
Cell[50514, 1138, 811, 17, 192, "Input",ExpressionUUID->"0626c0e1-4f31-4289-ae44-8745fb1d55bc"]
}
]
*)

