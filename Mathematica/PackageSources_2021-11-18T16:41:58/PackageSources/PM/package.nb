(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    109990,       2304]
NotebookOptionsPosition[    105495,       2247]
NotebookOutlinePosition[    105887,       2263]
CellTagsIndexPosition[    105844,       2260]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"package", "=", 
    RowBox[{"Object", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "\"\<Description\>\"", "\[Rule]", 
       "\"\<This is the head used for package objects.\>\""}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<CacheActivated\>\"", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<PersistentCacheActivated\>\"", "\[Rule]", "True"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{"VerbatimRegion", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"Init", "::", "usage"}], "=", 
    "\"\<Initializes objects with heads 'package'.\>\""}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"package", "/:", 
    RowBox[{"Init", "[", 
     RowBox[{"package", ",", "file_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Initialize", "[", 
     RowBox[{"package", ",", "\[IndentingNewLine]", 
      RowBox[{"\[LeftAssociation]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<SourcePath\>\"", "\[Rule]", "file"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<PackageName\>\"", "\[Rule]", 
         RowBox[{"FileBaseName", "[", "file", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<PackageContext\>\"", "\[Rule]", 
         RowBox[{
          RowBox[{"FileBaseName", "[", "file", "]"}], "<>", "\"\<`\>\""}]}]}],
        "\[IndentingNewLine]", "\[RightAssociation]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"CreateFormat", "[", 
    RowBox[{"package", ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"\"\<Caption\>\"", "\[Rule]", "\"\<Name: \>\""}], ",", 
         RowBox[{"\"\<Function\>\"", "\[Rule]", "Name"}]}], 
        "\[RightAssociation]"}], "}"}], "}"}], ",", 
     RowBox[{"{", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.664439992924918*^9, 3.664439994325925*^9}, {
   3.664441208903842*^9, 3.664441229408702*^9}, {3.664441280714192*^9, 
   3.6644413777173033`*^9}, {3.6644415537623177`*^9, 3.664441558462267*^9}, {
   3.664441706212813*^9, 3.664441708433872*^9}, {3.6644429391466293`*^9, 
   3.664442946666461*^9}, {3.664443899204911*^9, 3.664443899796403*^9}, 
   3.665294851709635*^9, {3.665333873138502*^9, 3.665333875705016*^9}, 
   3.6653339634732037`*^9, {3.665334108444235*^9, 3.665334127802652*^9}, {
   3.665334227129072*^9, 3.665334227343318*^9}, {3.665335220516944*^9, 
   3.6653352303026257`*^9}, {3.7076579978662033`*^9, 3.707658010800212*^9}, {
   3.7076581162690496`*^9, 3.7076581169386797`*^9}, {3.707658223536923*^9, 
   3.7076582237748213`*^9}, {3.707658273989738*^9, 3.707658275020358*^9}, {
   3.707977664995365*^9, 3.707977676144833*^9}, 3.707978215458531*^9, {
   3.707979160437214*^9, 
   3.707979167293007*^9}},ExpressionUUID->"879a821f-272a-4f9e-a4a9-\
1c2131334fc0"],

Cell[BoxData[
 RowBox[{"SourcePath", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_package", ",", 
    RowBox[{
     RowBox[{"M", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "\[LeftDoubleBracket]", "\"\<SourcePath\>\"", 
     "\[RightDoubleBracket]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.756220619131444*^9, 3.756220620115284*^9}, {
  3.7583722063428183`*^9, 
  3.758372208309772*^9}},ExpressionUUID->"89d5ae99-e3b5-4a1a-bfdc-\
7eb491090ace"],

Cell[BoxData[
 RowBox[{"SourceLookupFile", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"InstallationPath", "[", "a", "]"}], ",", 
       RowBox[{
        RowBox[{"Name", "[", "a", "]"}], "<>", "\"\<_SourceLookup.mx\>\""}]}],
       "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.839479642535123*^9, 3.839479644383492*^9}, {
  3.8394796962132883`*^9, 
  3.8394797069010878`*^9}},ExpressionUUID->"c437188f-85c1-4829-9b97-\
19c324402052"],

Cell[BoxData[
 RowBox[{"Name", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_package", ",", 
    RowBox[{
     RowBox[{"M", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "\[LeftDoubleBracket]", "\"\<PackageName\>\"", 
     "\[RightDoubleBracket]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.707978245441003*^9, {3.758372204912332*^9, 
   3.758372209998155*^9}},ExpressionUUID->"a69efb82-16b5-45ec-b932-\
e2c3d5c85c19"],

Cell[BoxData[
 RowBox[{"PackageName", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_package", ",", 
    RowBox[{
     RowBox[{"M", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "\[LeftDoubleBracket]", "\"\<PackageName\>\"", 
     "\[RightDoubleBracket]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6644414851599493`*^9, 3.664441507721531*^9}, {
  3.66444171132286*^9, 3.664441718264866*^9}, {3.7075665693326902`*^9, 
  3.707566569547474*^9}, {3.707978233913393*^9, 3.707978237495721*^9}, {
  3.758372204040791*^9, 
  3.758372211789872*^9}},ExpressionUUID->"45229029-0fff-455e-af92-\
0800dfdea2c6"],

Cell[BoxData[
 RowBox[{"PackageContext", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_package", ",", 
    RowBox[{
     RowBox[{"M", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "\[LeftDoubleBracket]", "\"\<PackageContext\>\"", 
     "\[RightDoubleBracket]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.664461036451055*^9, 3.6644610454039593`*^9}, {
  3.707566570668654*^9, 3.707566570915715*^9}, {3.707978248066352*^9, 
  3.707978251056036*^9}, {3.758372203295*^9, 
  3.758372213357772*^9}},ExpressionUUID->"7799dc25-b4ba-4966-afff-\
a80cdce55030"],

Cell[BoxData[
 RowBox[{"InstallationPath", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"$UserBaseDirectory", ",", "\"\<Applications\>\"", ",", 
       RowBox[{"Name", "[", "a", "]"}]}], "}"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.664444876882704*^9, 3.664444893703397*^9}, 
   3.6644449569704123`*^9, {3.664447984234437*^9, 3.664447990908408*^9}, {
   3.758372198807193*^9, 3.75837220057292*^9}, 
   3.8394764016891813`*^9},ExpressionUUID->"a3a4dfc7-e3e8-41a8-8e6a-\
d90fa34ef26e"],

Cell[BoxData[
 RowBox[{"InstallationFile", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"InstallationPath", "[", "a", "]"}], ",", 
       RowBox[{
        RowBox[{"Name", "[", "a", "]"}], "<>", "\"\<.m\>\""}]}], "}"}], "]"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6653362250057907`*^9, 3.6653362401020803`*^9}, {
   3.758372195143684*^9, 3.758372196765092*^9}, 3.839476402554934*^9, {
   3.839481662837995*^9, 3.8394816630296307`*^9}, {3.839485306000991*^9, 
   3.839485320455997*^9}},ExpressionUUID->"72eb8a20-052d-4434-b831-\
74c98a87f695"],

Cell[BoxData[
 RowBox[{"InstallationDate", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"InstalledQ", "[", "a", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"FileDate", "[", 
       RowBox[{"InstallationFile", "[", "a", "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"DateObject", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "12", ",", "25", ",", "0", ",", "0", ",", 
         "1"}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.665394659155422*^9, 3.665394668544806*^9}, {
   3.665394713181885*^9, 3.6653947163504543`*^9}, {3.665394747378292*^9, 
   3.6653947588485317`*^9}, 3.665394927683927*^9, {3.75837221975977*^9, 
   3.758372221389824*^9}},ExpressionUUID->"25391d14-a07a-4b15-9881-\
50567e62653b"],

Cell[BoxData[
 RowBox[{"LastChangeDate", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", ",", "t"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"t", "=", 
         RowBox[{
          RowBox[{"AbsoluteTiming", "[", 
           RowBox[{"r", "=", 
            RowBox[{"Max", "[", 
             RowBox[{"Map", "[", 
              RowBox[{"SourceDate", ",", 
               RowBox[{"Subpackages", "[", "a", "]"}]}], "]"}], "]"}]}], 
           "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"Name", "[", "a", "]"}], "\[Rule]", "t"}], "]"}], ";", 
        "\[IndentingNewLine]", "r"}]}], "\[IndentingNewLine]", "]"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Max", "[", 
     RowBox[{"Map", "[", 
      RowBox[{"SourceDate", ",", 
       RowBox[{"Subpackages", "[", "a", "]"}]}], "]"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.665581364626618*^9, 3.665581395974598*^9}, {
  3.665581617764729*^9, 3.665581685376243*^9}, {3.665581879330731*^9, 
  3.665581881247109*^9}, {3.707926685005445*^9, 3.707926685188602*^9}, {
  3.758372224838855*^9, 3.758372227221716*^9}, {3.7967929762169027`*^9, 
  3.796792980991156*^9}, {3.796793304548671*^9, 3.796793304761053*^9}, {
  3.796793350303131*^9, 3.79679339576768*^9}, {3.796793866136167*^9, 
  3.7967938683736258`*^9}, {3.796793952698812*^9, 3.796793954853571*^9}, {
  3.7967941020147533`*^9, 3.79679410685326*^9}, {3.7968869187936707`*^9, 
  3.796886922176157*^9}},ExpressionUUID->"2a9bbc03-c2e7-4483-99c2-\
21e45693573a"],

Cell[BoxData[
 RowBox[{"InstalledQ", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"FileExistsQ", "[", 
     RowBox[{"InstallationPath", "[", "a", "]"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6644449296042423`*^9, 3.664444993956931*^9}, 
   3.664447999778562*^9, {3.758372229478257*^9, 
   3.758372232246008*^9}},ExpressionUUID->"b778a04f-03e8-4401-aa7f-\
10dcbfd86316"],

Cell[BoxData[
 RowBox[{"DynamicLibraryPath", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"InstallationPath", "[", "a", "]"}], ",", 
       "\"\<LibraryResources\>\"", ",", "$SystemID"}], "}"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.665303231987698*^9, 3.665303247643955*^9}, 
   3.6653032816994658`*^9, {3.665324648197547*^9, 3.6653246528941717`*^9}, {
   3.7583722338622227`*^9, 3.7583722353651*^9}, {3.839475792871394*^9, 
   3.839475808920332*^9}},ExpressionUUID->"ce708bc3-018e-4cf4-9d8e-\
de9d97ba847d"],

Cell[BoxData[
 RowBox[{"AuxPath", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"InstallationPath", "[", "a", "]"}], ",", 
       "\"\<Auxiliaries\>\""}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6653032588205843`*^9, 3.665303282890299*^9}, {
  3.758372237405892*^9, 3.758372238693037*^9}, {3.840078907724656*^9, 
  3.8400789286904707`*^9}},ExpressionUUID->"0c0e12af-647d-4627-bbfe-\
621230e55f87"],

Cell[BoxData[
 RowBox[{"Subpackages", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"path", "=", 
         RowBox[{"InstallationPath", "[", "a", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"subfiles", "=", 
         RowBox[{"Complement", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"FileNames", "[", 
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"SourcePath", "[", "a", "]"}], ",", "\"\<*.nb\>\""}], 
              "}"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"SourcePath", "[", "a", "]"}], ",", 
                "\"\<.DS_Store\>\""}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"SourcePath", "[", "a", "]"}], ",", 
                "\"\<MakeFile.nb\>\""}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"SourcePath", "[", "a", "]"}], ",", 
                "\"\<MakePackageManager.nb\>\""}], "}"}], "]"}]}], 
            "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Name", "[", "#", "]"}], "\[Rule]", "#"}], "&"}], "[", 
          RowBox[{"Init", "[", 
           RowBox[{"subpackage", ",", "file", ",", "path"}], "]"}], "]"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"file", ",", "subfiles"}], "}"}]}], "]"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.664442466176157*^9, 3.664442492754229*^9}, {
   3.6644425277369003`*^9, 3.664442565286446*^9}, {3.664442607969907*^9, 
   3.6644426084284487`*^9}, {3.664444766965774*^9, 3.6644447705521803`*^9}, {
   3.6644496904782343`*^9, 3.664449692743041*^9}, {3.664450983525736*^9, 
   3.664450988611516*^9}, {3.665290703846146*^9, 3.665290707068379*^9}, 
   3.665291136729621*^9, {3.665291990437213*^9, 3.665291995097373*^9}, {
   3.6652920904490423`*^9, 3.665292092983302*^9}, {3.665292711937406*^9, 
   3.665292746340934*^9}, {3.6653393887625*^9, 3.665339396665841*^9}, {
   3.6950277534625063`*^9, 3.695027777443429*^9}, {3.695028208764039*^9, 
   3.695028214963544*^9}, {3.695028847365388*^9, 3.6950288531084414`*^9}, 
   3.69503643480132*^9, {3.707570731091445*^9, 3.7075707323286047`*^9}, 
   3.7079292377456512`*^9, {3.756220876686905*^9, 3.7562208780705137`*^9}, {
   3.758372246951662*^9, 3.758372268295412*^9}, {3.796793022021347*^9, 
   3.796793057164179*^9}, {3.7967930874432373`*^9, 
   3.796793098502935*^9}},ExpressionUUID->"48364ccb-cbdc-4d3d-84bd-\
9db6f7a60011"],

Cell[BoxData[
 RowBox[{"InstalledSubpackages", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"InstalledQ", "[", "a", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Association", "@", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"FileBaseName", "[", "file", "]"}], "\[Rule]", "file"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"file", ",", 
           RowBox[{"FileNames", "[", 
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"AuxPath", "[", "a", "]"}], ",", "\"\<*.aux\>\""}], 
              "}"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\[LeftAssociation]", "\[RightAssociation]"}]}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"InstalledQ", "[", "a", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"subfiles", "=", 
           RowBox[{"Complement", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"FileNames", "[", 
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"InstallationPath", "[", "a", "]"}], ",", 
                 "\"\<aux\>\"", ",", "\"\<*.aux\>\""}], "}"}], "]"}], "]"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"FileNameJoin", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"InstallationPath", "[", "a", "]"}], ",", 
                  "\"\<aux\>\"", ",", "\"\<MakeFile.aux\>\""}], "}"}], "]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"FileNameJoin", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"InstallationPath", "[", "a", "]"}], ",", 
                  "\"\<aux\>\"", ",", "\"\<Makefile.aux\>\""}], "}"}], 
                "]"}]}], "\[IndentingNewLine]", "}"}]}], 
            "\[IndentingNewLine]", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Association", "@", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"FileBaseName", "[", "file", "]"}], "\[Rule]", "file"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"file", ",", "subfiles"}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", "\[RightAssociation]"}]}], 
      "\[IndentingNewLine]", "]"}], "*)"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.664442466176157*^9, 3.664442492754229*^9}, {
   3.6644425277369003`*^9, 3.664442565286446*^9}, {3.664442607969907*^9, 
   3.6644426084284487`*^9}, {3.664444766965774*^9, 3.6644447705521803`*^9}, {
   3.664444805961296*^9, 3.664444808153597*^9}, 3.664445039109661*^9, {
   3.66444518698289*^9, 3.66444524374047*^9}, 3.664449347056219*^9, {
   3.664449664434099*^9, 3.664449683143078*^9}, {3.66444977294628*^9, 
   3.6644498066726847`*^9}, {3.66445111572921*^9, 3.664451117129393*^9}, 
   3.665290717134659*^9, {3.6652944455350857`*^9, 3.665294445837346*^9}, {
   3.665294493304632*^9, 3.665294494399466*^9}, {3.665412899492442*^9, 
   3.665412908131975*^9}, {3.66541302161246*^9, 3.6654130501862392`*^9}, {
   3.7079792045678453`*^9, 3.70797920488722*^9}, {3.758372273704365*^9, 
   3.7583722757566767`*^9}, {3.796754112716072*^9, 3.796754148713437*^9}, {
   3.796783991598078*^9, 3.796783998388936*^9}, {3.839475898454726*^9, 
   3.839475899324759*^9}, 
   3.8400788947664337`*^9},ExpressionUUID->"4c83f749-5b99-44b1-b80e-\
07998815e0a3"],

Cell[BoxData[
 RowBox[{"ObsoleteSubpackages", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"KeyDrop", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"InstalledSubpackages", "[", "a", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Keys", "[", 
       RowBox[{"Subpackages", "[", "a", "]"}], "]"}]}], "\[IndentingNewLine]",
      "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.66444984768946*^9, 3.664449860732038*^9}, 
   3.664459268837358*^9, {3.665290723037826*^9, 3.665290730832652*^9}, 
   3.665291143651752*^9, 3.665293966236805*^9, {3.665413191880301*^9, 
   3.6654131981338882`*^9}, {3.695027803164563*^9, 3.6950278044110107`*^9}, {
   3.758372277924354*^9, 
   3.758372279411531*^9}},ExpressionUUID->"2954e1c9-d8d5-4091-b736-\
09a1be9bcbac"],

Cell[BoxData[
 RowBox[{"NewSubpackages", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"Complement", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Keys", "[", 
       RowBox[{"Subpackages", "[", "a", "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Keys", "[", 
       RowBox[{"InstalledSubpackages", "[", "a", "]"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.66444988152526*^9, 3.664449887056654*^9}, 
   3.66445926668261*^9, {3.665290737127931*^9, 3.665290741024762*^9}, 
   3.665291148275894*^9, 3.665293969230638*^9, {3.6950278129708433`*^9, 
   3.695027814019156*^9}, {3.758372281804092*^9, 
   3.758372283235538*^9}},ExpressionUUID->"5af18006-8dca-46ce-aea7-\
0041d39dae37"],

Cell[BoxData[
 RowBox[{"MakeFile", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"SourcePath", "[", "a", "]"}], ",", "\"\<MakeFile.m\>\""}], 
      "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.664465327048337*^9, 3.664465336305538*^9}, {
   3.664465536469647*^9, 3.66446553929401*^9}, 3.756220867464467*^9, {
   3.75837228442045*^9, 3.7583722857153482`*^9}, 
   3.7967906124502077`*^9},ExpressionUUID->"089bf6c6-98ba-4845-a512-\
27691d166626"],

Cell[BoxData[
 RowBox[{"MakeFileDate", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"FileDate", "[", 
     RowBox[{"MakeFile", "[", "a", "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.66558145139981*^9, 3.665581464488817*^9}, {
  3.665581572432166*^9, 3.6655815729633617`*^9}, {3.758372286987789*^9, 
  3.758372288283217*^9}},ExpressionUUID->"d7a0ee3e-23b3-4ee9-bbe1-\
8999fdac4c0f"],

Cell[BoxData[
 RowBox[{"PackageOptions", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"Association", "@@", 
     RowBox[{"Get", "[", 
      RowBox[{"MakeFile", "[", "a", "]"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"makedata", "=", 
          RowBox[{"Import", "[", 
           RowBox[{"MakeFile", "[", "a", "]"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"pos", "=", 
            RowBox[{"Position", "[", 
             RowBox[{"makedata", ",", "BoxData"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Association", "@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"ToExpression", "/@", 
               RowBox[{"Extract", "[", 
                RowBox[{"makedata", ",", 
                 RowBox[{"Most", "/@", "pos"}]}], "]"}]}], ",", "Null"}], 
             "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ","}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.664465543839096*^9, 3.664465549566248*^9}, 
   3.664465618117441*^9, {3.6653358151013308`*^9, 3.665335841202351*^9}, {
   3.758372290452055*^9, 3.758372291835533*^9}, {3.796790703117776*^9, 
   3.796790711216015*^9}, {3.796790887459428*^9, 3.796790890103904*^9}, {
   3.79679186645676*^9, 3.7967918676320333`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"cb1f2bfa-2f6c-4928-a091-9b7b8b773219"],

Cell[BoxData[
 RowBox[{"MakefileOutdatedQ", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"file", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"AuxPath", "[", "a", "]"}], ",", "\"\<MakeFile.aux\>\""}], 
          "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"FileExistsQ", "[", "file", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MakeFileDate", "[", "a", "]"}], ">", 
         RowBox[{"FileDate", "[", "file", "]"}]}], ",", "\[IndentingNewLine]",
         "True"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6653899027093897`*^9, 3.6653899078959913`*^9}, {
   3.66539010688733*^9, 3.66539011973359*^9}, {3.6655815601879587`*^9, 
   3.665581567276504*^9}, {3.758372293876231*^9, 3.7583722959393797`*^9}, 
   3.795360424515766*^9},ExpressionUUID->"b52b54d6-0588-484a-bfa8-\
64827cf6a255"],

Cell[BoxData[
 RowBox[{"OutdatedSubpackages", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"list", ",", "bools"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"list", "=", 
        RowBox[{"Subpackages", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MakefileOutdatedQ", "[", "a", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{"x", "\[Function]", 
             RowBox[{"SetCache", "[", 
              RowBox[{"x", ",", "\"\<OutdatedQ\>\"", ",", "True"}], "]"}]}], 
            ",", "list"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"SetCache", "[", 
             RowBox[{"a", ",", "\"\<Subpackages\>\"", ",", "list"}], "]"}], 
            ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Keys", "[", "list", "]"}]}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"bools", "=", 
           RowBox[{"Map", "[", 
            RowBox[{"OutdatedQ", ",", "list"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"SetCache", "[", 
             RowBox[{"a", ",", "\"\<Subpackages\>\"", ",", "list"}], "]"}], 
            ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Pick", "[", 
           RowBox[{
            RowBox[{"Keys", "[", "list", "]"}], ",", 
            RowBox[{"Values", "[", "bools", "]"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6644508681421432`*^9, 3.664450877332221*^9}, {
   3.664454855632958*^9, 3.6644548557978992`*^9}, 3.6644550309861183`*^9, 
   3.664455693536367*^9, 3.664459263948873*^9, {3.6652907465510597`*^9, 
   3.6652907608650093`*^9}, 3.665291153725664*^9, 3.665294763349938*^9, {
   3.665389574936304*^9, 3.6653895857491093`*^9}, {3.665389705354714*^9, 
   3.6653897677573223`*^9}, {3.665389849872972*^9, 3.665389882380352*^9}, {
   3.695027908875833*^9, 3.695027924138056*^9}, 3.695030103381344*^9, {
   3.7079266910364523`*^9, 3.707926699724495*^9}, 3.729358639269517*^9, {
   3.758372298364689*^9, 3.758372300043788*^9}, 
   3.796793656853833*^9},ExpressionUUID->"1f551080-56dc-45f5-8542-\
888ca9f01d76"],

Cell[BoxData[
 RowBox[{"OutdatedQ", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"OutdatedSubpackages", "[", "a", "]"}], "]"}], ">", "0"}], 
      ")"}], "||", 
     RowBox[{"MakefileOutdatedQ", "[", "a", "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.6644619397328587`*^9, {3.664461990747923*^9, 3.66446203250422*^9}, 
   3.665290759694388*^9, {3.6653896217977667`*^9, 3.665389641052745*^9}, {
   3.665389678243018*^9, 3.665389680081038*^9}, {3.665390218780643*^9, 
   3.665390246728362*^9}, {3.758372302371414*^9, 3.7583723037307787`*^9}, {
   3.796738586616906*^9, 
   3.796738590579838*^9}},ExpressionUUID->"96a44d24-505b-4cc2-b9e3-\
f253b34530ea"],

Cell[BoxData[
 RowBox[{"Parse", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"list", ",", "alist"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"\"\<Parsing package \>\"", ",", " ", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"Name", "[", "a", "]"}], ",", "Bold"}], "]"}], ",", 
         "\"\< ...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"CreateInstallationPaths", "[", "a", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"SetOptions", "[", 
        RowBox[{"CreateCPackageFunction", ",", 
         RowBox[{"\"\<DynamicLibraryPath\>\"", "\[Rule]", 
          RowBox[{"DynamicLibraryPath", "[", "a", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Internal`WithLocalSettings", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"BeginPackage", "[", 
           RowBox[{
            RowBox[{"PackageContext", "[", "a", "]"}], "<>", 
            "\"\<Private`\>\""}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"Context", "[", "]"}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{",", "\[IndentingNewLine]", 
         RowBox[{"Map", "[", 
          RowBox[{"Data", ",", 
           RowBox[{"Subpackages", "[", "a", "]"}]}], "]"}], 
         "\[IndentingNewLine]", ","}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"EndPackage", "[", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.665303305801395*^9, 3.6653033304518557`*^9}, {
   3.665303420598837*^9, 3.665303421428821*^9}, {3.6653035049518948`*^9, 
   3.665303508448742*^9}, {3.665303724931288*^9, 3.665303731174844*^9}, {
   3.665304070043738*^9, 3.6653040743074827`*^9}, {3.665324690081964*^9, 
   3.665324698866221*^9}, {3.665387642045033*^9, 3.6653876427134247`*^9}, {
   3.665387732251585*^9, 3.665387733827429*^9}, {3.665398731070216*^9, 
   3.665398754996067*^9}, {3.665410111878582*^9, 3.6654101146882257`*^9}, 
   3.665489820977427*^9, {3.665492214163186*^9, 3.6654922154912167`*^9}, {
   3.665502579729961*^9, 3.665502641473214*^9}, {3.665502684042946*^9, 
   3.665502692577632*^9}, {3.665502725632444*^9, 3.665502727746345*^9}, {
   3.665502946594819*^9, 3.665502948962232*^9}, {3.665503075810254*^9, 
   3.665503112190978*^9}, {3.665503345640623*^9, 3.665503350654149*^9}, 
   3.695028187879236*^9, {3.7079266931732388`*^9, 3.707926693340581*^9}, {
   3.729358628667574*^9, 3.72935863696511*^9}, {3.758372306220584*^9, 
   3.758372308994993*^9}, {3.796738652482122*^9, 3.796738675920928*^9}, {
   3.7967563842559566`*^9, 3.796756393063231*^9}, {3.7967564674429493`*^9, 
   3.796756469236133*^9}, {3.796756515674944*^9, 3.796756537367928*^9}, {
   3.796756575905157*^9, 3.796756577384096*^9}, 3.796756700412013*^9, {
   3.7967568343366127`*^9, 3.796756834567202*^9}, {3.7974127094035387`*^9, 
   3.79741271568522*^9}, {3.797412977254634*^9, 3.797412979276787*^9}, 
   3.797413027699273*^9, 3.8394764040632353`*^9, 3.839479432944057*^9, 
   3.839480201139247*^9},ExpressionUUID->"ddfea897-d09b-4e74-a784-\
355a4e372df4"],

Cell[BoxData[
 RowBox[{"Data", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"Parse", "[", "a", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6653084881022177`*^9, 3.665308505907464*^9}, {
   3.75837231080324*^9, 3.758372313393938*^9}, {3.797411459203856*^9, 
   3.797411499153468*^9}, {3.7974116929946537`*^9, 3.7974116967941713`*^9}, {
   3.797412536154057*^9, 3.797412542233582*^9}, 3.797412719628591*^9, 
   3.839479406621098*^9, 
   3.839480206082733*^9},ExpressionUUID->"4fc4ba65-d5bb-42be-96e8-\
32c489d0f559"],

Cell[BoxData[
 RowBox[{"VerbatimRegion", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"str", "::", "usage"}], "=", "\"\<\>\""}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"SetAttributes", "[", 
    RowBox[{"str", ",", "HoldAll"}], "]"}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"str", "[", "x_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", 
        RowBox[{"Unevaluated", "[", "x", "]"}], "]"}], "===", "String"}], ",", 
      RowBox[{"x", "<>", "\"\<\\n\\n\>\""}], ",", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"Unevaluated", "[", "x", "]"}], ",", "InputForm"}], "]"}], 
       "<>", "\"\<;\\n\\n\>\""}]}], "]"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ListToPackageString", "::", "usage"}], "=", "\"\<\>\""}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"ListToPackageString", "=", 
    RowBox[{"datalist", "\[Function]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{"List", "[", "datalist", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"a", "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}], 
         "=", "HoldComplete"}], ";", "\[IndentingNewLine]", 
        RowBox[{"b", "=", 
         RowBox[{"a", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Hold", "[", "x_", "]"}], "\[RuleDelayed]", "x"}], 
           "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"ReleaseHold", "[", 
          RowBox[{"Map", "[", 
           RowBox[{"str", ",", "b", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.665310441855908*^9, 3.66531044806575*^9}, {
  3.695028840574729*^9, 
  3.695028840578493*^9}},ExpressionUUID->"eef5e05f-7ddc-4fb5-b723-\
73360d6adf11"],

Cell[BoxData[
 RowBox[{"PackageFunctionList", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Values", "[", 
      RowBox[{"DeleteMissing", "/@", 
       RowBox[{
        RowBox[{"Data", "[", "a", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "\"\<PackageFunctions\>\""}], 
        "\[RightDoubleBracket]"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.665324985173176*^9, 3.665324985842277*^9}, 
   3.6950286816470346`*^9, {3.695029282279887*^9, 3.695029285389139*^9}, {
   3.7583723182663097`*^9, 3.7583723206580963`*^9}, 
   3.839479407717267*^9},ExpressionUUID->"0383124d-1839-439a-828b-\
4f462a1cde13"],

Cell[BoxData[
 RowBox[{"PackageFunctionCodes", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"data", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Values", "[", 
          RowBox[{"DeleteMissing", "/@", 
           RowBox[{
            RowBox[{"Data", "[", "a", "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "\"\<PackageFunctions\>\""}], 
            "\[RightDoubleBracket]"}]}], "]"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Values", "[", 
        RowBox[{
         RowBox[{"data", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Errors\>\"", ",", "\"\<Warnings\>\"", ",", 
            "\"\<FullCode\>\""}], "}"}]}], "\[RightDoubleBracket]"}], "]"}], 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.665477116020053*^9, 3.665477130771896*^9}, {
   3.665477163174592*^9, 3.66547723678329*^9}, {3.6654772996038647`*^9, 
   3.665477338132436*^9}, {3.665477493835103*^9, 3.6654775222458057`*^9}, {
   3.66547755605412*^9, 3.665477583310514*^9}, {3.6654776369596252`*^9, 
   3.665477638035966*^9}, {3.695029538713047*^9, 3.695029541880034*^9}, 
   3.707573005448654*^9, {3.758372327635528*^9, 3.758372329283217*^9}, 
   3.839479408735354*^9},ExpressionUUID->"9a9cd930-c708-4800-a22f-\
a8eeaeeb3bd1"],

Cell[BoxData[
 RowBox[{"PackageString", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "s", ",", "Dependencies", ",", "PM`Private`mess", ",", 
        "CreateUsageMessageString", ",", "LoadList", ",", "UsageListString"}],
        "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Dependencies", "=", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Name", "[", "a", "]"}], "\[NotEqual]", "\"\<PM\>\""}], 
            ",", 
            RowBox[{"{", "\"\<PM`\>\"", "}"}], ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Libraries", "[", "a", "]"}], "]"}], ">", "0"}], ",", 
            RowBox[{"{", "\"\<LTemplate`\>\"", "}"}], ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"DeleteMissing", "[", 
           RowBox[{
            RowBox[{"PackageOptions", "[", "a", "]"}], 
            "\[LeftDoubleBracket]", "\"\<LoadList\>\"", 
            "\[RightDoubleBracket]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"DeleteMissing", "[", 
           RowBox[{
            RowBox[{"PackageOptions", "[", "a", "]"}], 
            "\[LeftDoubleBracket]", "\"\<NeedList\>\"", 
            "\[RightDoubleBracket]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"DeleteMissing", "[", 
           RowBox[{
            RowBox[{"PackageOptions", "[", "a", "]"}], 
            "\[LeftDoubleBracket]", "\"\<DependencyList\>\"", 
            "\[RightDoubleBracket]"}], "]"}]}], "\[IndentingNewLine]", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"LoadList", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"UsageListString", "=", 
        RowBox[{"ToPackageString", "[", 
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"Values", "[", 
              RowBox[{"DeleteMissing", "/@", 
               RowBox[{
                RowBox[{"Data", "[", "a", "]"}], "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "\"\<Objects\>\""}], 
                "\[RightDoubleBracket]"}]}], "]"}], "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "\"\<PublicDescription\>\""}], 
            "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Thread", "[", 
            RowBox[{"Rule", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"HoldToString", "/@", 
               RowBox[{
                RowBox[{
                 RowBox[{"PackageFunctionList", "[", "a", "]"}], 
                 "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
                "\[LeftDoubleBracket]", 
                RowBox[{
                "All", ",", "\"\<Usage\>\"", ",", "All", ",", "1", ",", "1"}],
                 "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"ReleaseHold", "@", 
               RowBox[{
                RowBox[{
                 RowBox[{"PackageFunctionList", "[", "a", "]"}], 
                 "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
                "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "\"\<Usage\>\"", ",", "All", ",", "2"}], 
                "\[RightDoubleBracket]"}]}]}], "\[IndentingNewLine]", "]"}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"Values", "[", 
              RowBox[{"DeleteMissing", "/@", 
               RowBox[{
                RowBox[{"Data", "[", "a", "]"}], "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "\"\<CPackageFunctions\>\""}], 
                "\[RightDoubleBracket]"}]}], "]"}], "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "\"\<PublicDescription\>\""}], 
            "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
            RowBox[{"DeleteMissing", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"Values", "[", 
                RowBox[{"DeleteMissing", "/@", 
                 RowBox[{
                  RowBox[{"Data", "[", "a", "]"}], "\[LeftDoubleBracket]", 
                  RowBox[{"All", ",", "\"\<VerbatimRegions\>\""}], 
                  "\[RightDoubleBracket]"}]}], "]"}], "]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "\"\<PublicDescription\>\""}], 
              "\[RightDoubleBracket]"}], "\[IndentingNewLine]", "]"}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "CreateUsageMessageString", "=", 
          "\"\<CreateUsageMessage[name_String, message_String] := \
Module[{context, cname, str}, Quiet[context = Context[Evaluate[name]]]; \
If[Head[context] === String, cname = StringJoin[context, name], cname = \
name]; With[{musage = ToExpression[StringJoin[\\\"MessageName[\\\", cname, \\\
\",\\\\\\\"usage\\\\\\\"]\\\"]]}, If[Head[musage] === MessageName, str = \
StringJoin[cname, \\\"::usage = \\\", ToString[message, InputForm], \
\\\";\\\"]; ToExpression[str]; , If[StringPosition[musage, message] == {}, \
str = StringJoin[cname, \\\"::usage = \\\", ToString[StringJoin[musage, \
\\\"\\\\n\\\\n\\\", message], InputForm], \\\";\\\"]; ToExpression[str]]]]; \
];\>\""}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
       "CreateUsageMessageString", "=", 
        "\"\<CreateUsageMessage[name_String, \
message_String]:=With[{symbol=Symbol[name]},\[IndentingNewLine]If[MemberQ[\
Messages[symbol][[All,1,1,2]],\\\"usage\\\"],\[IndentingNewLine]With[{s=\
MessageName[symbol,\\\"usage\\\"]},\[IndentingNewLine]If[StringQ[s]&&!\
StringContainsQ[s, message],\[IndentingNewLine]MessageName[symbol,\\\"usage\\\
\"]=StringJoin[s,\\\"\\n\\n\\\",message];\[IndentingNewLine]]\
\[IndentingNewLine]];\[IndentingNewLine],\[IndentingNewLine]MessageName[\
symbol,\\\"usage\\\"]=message;\[IndentingNewLine]]\[IndentingNewLine]];\>\""}]\
, ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Begin", "[", "\"\<Scratch`\>\"", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"beginstring", "=", 
            RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
             RowBox[{"\"\<BeginPackage[\\\"\>\"", ",", 
              RowBox[{"Name", "[", "a", "]"}], ",", "\"\<`\\\"\>\"", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"Dependencies", "\[Equal]", 
                 RowBox[{"{", "}"}]}], "\[IndentingNewLine]", ",", 
                "\[IndentingNewLine]", "\"\<\>\"", "\[IndentingNewLine]", ",",
                 "\[IndentingNewLine]", 
                RowBox[{"StringJoin", "[", 
                 RowBox[{"\"\<, {\>\"", ",", 
                  RowBox[{"Riffle", "[", 
                   RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{"x", "\[Function]", 
                    RowBox[{
                    "\"\<\\\"\>\"", "<>", "x", "<>", "\"\<\\\"\>\""}]}], ",", 
                    
                    RowBox[{"Flatten", "[", 
                    RowBox[{"List", "[", "Dependencies", "]"}], "]"}]}], 
                    "]"}], ",", "\"\<, \>\""}], "]"}], ",", "\"\<}\>\""}], 
                 "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              "\"\<];\\n\\n\>\"", ",", "\[IndentingNewLine]", 
              "\"\<EndPackage[];\\n\\n\>\"", ",", "\[IndentingNewLine]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"\"\<LoadPackage[\>\"", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"s", ",", "InputForm"}], "]"}], "<>", 
                 "\"\<];\\n\>\""}], ",", 
                RowBox[{"{", 
                 RowBox[{"s", ",", "LoadList"}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", "\"\<\\n\\n\>\"", ",", 
              "\[IndentingNewLine]", "\"\<Begin[\\\"\>\"", ",", 
              RowBox[{"Name", "[", "a", "]"}], ",", 
              "\"\<`Private`\\\"];\\n\\n\>\"", ",", "\[IndentingNewLine]", 
              "\"\<(** PackageInfo **)\\n\\n\>\"", ",", "\[IndentingNewLine]",
               "\[IndentingNewLine]", "\"\<$PackageUsageInfo = \>\"", ",", 
              "UsageListString", ",", "\"\<;\\n\\n\>\"", ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              "CreateUsageMessageString", ",", "\"\<\\n\\n\>\"", ",", 
              "\[IndentingNewLine]", "\"\<End[];\\n\\n\>\""}], 
             "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"endstring", "=", 
            RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Name", "[", "a", "]"}], "\[Equal]", "\"\<PM\>\""}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
                 RowBox[{"\"\<$PM = Init[packagemanager, \>\"", ",", 
                  RowBox[{"ToString", "[", 
                   RowBox[{
                    RowBox[{"ParentDirectory", "[", 
                    RowBox[{"SourcePath", "[", "a", "]"}], "]"}], ",", 
                    "InputForm"}], "]"}], ",", "\"\<];\>\"", ",", 
                  "\"\<\\n\>\"", ",", "\"\<PM`Private`$Runtime = True;\>\"", 
                  ",", "\"\<\\n\>\"", ",", "\[IndentingNewLine]", 
                  "\"\<PM`Private`$Compiletime = True;\>\"", ",", 
                  "\"\<\\n\>\"", ",", "\[IndentingNewLine]", 
                  "\"\<SelfUpdate[$PM];\>\""}], "\[IndentingNewLine]", "]"}], 
                ",", "\"\<\>\""}], "]"}], ",", "\[IndentingNewLine]", 
              "\"\<\>\""}], "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"s", "=", 
          RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<(* ::Package:: *)\>\"", ",", "\"\<\\n\\n\>\"", ",", 
            "\[IndentingNewLine]", "beginstring", ",", "\[IndentingNewLine]", 
            "\"\<\\n\\n\>\"", ",", "\[IndentingNewLine]", 
            "\"\<Begin[\\\"\>\"", ",", 
            RowBox[{"Name", "[", "a", "]"}], ",", "\"\<`\\\"];\\n\\n\>\"", 
            ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\"\<(** Public Declarations **)\\n\\n\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"TrueQ", "[", "PM`Private`$DiagnosticQ", "]"}], ",", 
              "\"\<Module[{time},\\nPrint[\\\"  Creating usage \
messages...\\\" ];\\ntime=AbsoluteTiming[\>\"", ",", "\"\<\>\""}], "]"}], ",",
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"Name", "[", "a", "]"}], ",", 
            "\"\<`Private`CreateUsageMessage@@@\>\"", ",", 
            RowBox[{"Name", "[", "a", "]"}], ",", 
            "\"\<`Private`$PackageUsageInfo;\>\"", ",", "\[IndentingNewLine]",
             "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"TrueQ", "[", "PM`Private`$DiagnosticQ", "]"}], ",", 
              "\"\<\\n}];\\n\\tPrint[\\\"  Time elapsed = \\\",time];\\n];\\n\
\\n\>\"", ",", "\"\<\>\""}], "]"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\"\<\\n\\n\>\"", ",", 
            "\[IndentingNewLine]", 
            "\"\<$packageDirectory  = \
DirectoryName[$InputFileName];\\n\\n\>\"", ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Force", " ", "LTemplate", " ", "to", " ", "create", " ", "my", 
              " ", "classes", " ", "in", " ", "the", " ", 
              RowBox[{"package", "'"}], "s", " ", 
              RowBox[{"context", "."}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"Libraries", "[", "a", "]"}], "]"}], ">", "0"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"StringJoin", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Map", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"StringJoin", "[", 
                    RowBox[{
                    "\"\<LTemplate`Private`symName[\\\"\>\"", ",", "#", ",", 
                    "\"\<\\\"]=\\\"\>\"", ",", 
                    RowBox[{"Name", "[", "a", "]"}], ",", "\"\<`\>\"", ",", 
                    "#", ",", "\"\<\\\";\\n\>\""}], "]"}], "&"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"Union", "@@", 
                   RowBox[{"Values", "[", 
                    RowBox[{
                    RowBox[{"Keys", "@*", "LibraryClasses"}], "/@", 
                    RowBox[{"Libraries", "[", "a", "]"}]}], "]"}]}]}], 
                 "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                "\"\<\n$libraryDirectory  = FileNameJoin[{$packageDirectory, \
\\\"LibraryResources\\\", $SystemID}];\n\
If[!FileExists[$libraryDirectory],CreateDirectory[$libraryDirectory]];\n\
$sourceDirectory   = FileNameJoin[{$packageDirectory, \
\\\"LibraryResources\\\", \\\"Source\\\"}];\n\
If[!FileExists[$sourceDirectory],CreateDirectory[$sourceDirectory]];\n\n(* \
Add $libraryDirectory to $LibraryPath in case the package is not installed in \
$UserBaseDirectory/Applications. *)\nIf[Not@MemberQ[$LibraryPath, \
$libraryDirectory],AppendTo[$LibraryPath, $libraryDirectory]];\n\nWith[\n\t{\n\
\t\tctxt = LClassContext[], \n\t\tsymbol = LTemplate`Private`$messageSymbol, \
\n\t\tlazyQ = LTemplate`Private`$lazyLoading\n\t},\n\t\
Internal`WithLocalSettings[\n\t\t(*Unprotect[LClassContext];*)\n\t\t\
(*LClassContext[] =\\\"\>\"", "<>", 
                 RowBox[{"Name", "[", "a", "]"}], "<>", 
                 "\"\<`\\\";*)\n\t\tSetDirectory[$sourceDirectory];\n\t\t\
(*ConfigureLTemplate[\n\t\t\t\\\"MessageSymbol\\\" -> \>\"", "<>", 
                 RowBox[{"Name", "[", "a", "]"}], "<>", 
                 "\"\<, \n\t\t\t\\\"LazyLoading\\\" -> True\n\t\t];*)\n\t,\n\t\
\tScan[\n\t\t\tname\[Function]Module[{template,buildsettings,lib,src,time},\n\
\t\t\t\ttemplate = Get[FileNameJoin[{$sourceDirectory,name<> \\\"_LTemplate.m\
\\\"}]];\n\t\t\t\tbuildsettings = Get[FileNameJoin[{$sourceDirectory,name<> \
\\\"_BuildSettings.m\\\"}]];\n\t\t\t\tsrc = \
FileNameJoin[{$sourceDirectory,name<>\\\".h\\\"}];\n\t\t\t\tlib = \
FileNameJoin[{$libraryDirectory,name<>CCompilerDriver`CCompilerDriverBase`$\
PlatformDLLExtension}];\n\t\t\t\t\
If[!FileExistsQ[lib]||(FileDate[src]>FileDate[lib]),\n\t\t\t\t\ttime = \
AbsoluteTiming[\n\t\t\t\t\t\tCompileTemplate[\n\t\t\t\t\t\t\ttemplate,\n\t\t\t\
\t\t\t\tSequence@@buildsettings, \n\t\t\t\t\t\t\t\\\"TargetDirectory\\\" -> \
$libraryDirectory\n\t\t\t\t\t\t]\n\t\t\t\t\t][[1]];\n\t\t\t\t\t\
Print[\\\"Compilation done. Time elapsed = \\\",time];\n\t\t\t\t];\n\t\t\t\t\
LoadTemplate[template]\t\t\n\t\t\t]\n\t\t\t,\n\t\t\t\>\"", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{"Name", "/@", 
                    RowBox[{"Values", "[", 
                    RowBox[{"Libraries", "[", "a", "]"}], "]"}]}], ",", 
                   "InputForm"}], "]"}], "<>", 
                 "\"\<\n\t\t]\n\t,\n\t\tResetDirectory[];\n\t\t\
(*LClassContext[] = ctxt;*)\n\t\t(*Protect[LClassContext];*)\n\t\t\
(*ConfigureLTemplate[\n\t\t\t\\\"MessageSymbol\\\" -> symbol, \n\t\t\t\
\\\"LazyLoading\\\" -> lazyQ\n\t\t];*)\n\t]\n];\n\>\""}]}], "]"}], 
              "\[IndentingNewLine]", ",", "\[IndentingNewLine]", "\"\<\>\""}],
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            "\"\<\\n\\n\>\"", ",", "\[IndentingNewLine]", 
            "\"\<End[];\\n\\n\>\"", ",", "\[IndentingNewLine]", 
            "\"\<Begin[\\\"\>\"", ",", 
            RowBox[{"Name", "[", "a", "]"}], ",", 
            "\"\<`Private`\\\"];\\n\\n\>\"", ",", "\[IndentingNewLine]", 
            "\"\<(** Objects **)\\n\\n\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"TrueQ", "[", "PM`Private`$DiagnosticQ", "]"}], ",", 
              "\"\<Module[{time},\\nPrint[\\\"  Loading \
objects...\\\"];\\ntime=First@AbsoluteTiming[{\\n\\n\>\"", ",", "\"\<\>\""}], 
             "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"ListToPackageString", "[", "\[IndentingNewLine]", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Values", "[", 
               RowBox[{"DeleteMissing", "/@", 
                RowBox[{
                 RowBox[{"Data", "[", "a", "]"}], "\[LeftDoubleBracket]", 
                 RowBox[{
                 "All", ",", "\"\<Objects\>\"", ",", "All", ",", 
                  "\"\<Private\>\""}], "\[RightDoubleBracket]"}]}], "]"}], 
              "]"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]",
             "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"TrueQ", "[", "PM`Private`$DiagnosticQ", "]"}], ",", 
              "\"\<\\n}];\\n\\tPrint[\\\"  Time elapsed = \\\",time];\\n];\\n\
\\n\>\"", ",", "\"\<\>\""}], "]"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\"\<(** Verbatims **)\\n\\n\>\"", ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"TrueQ", "[", "PM`Private`$DiagnosticQ", "]"}], ",", 
              "\"\<Module[{time},\\nPrint[\\\"  Loading \
verbatims...\\\"];\\ntime=First@AbsoluteTiming[{\\n\\n\>\"", ",", 
              "\"\<\>\""}], "]"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"ListToPackageString", "[", "\[IndentingNewLine]", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Values", "[", 
               RowBox[{"DeleteMissing", "/@", 
                RowBox[{
                 RowBox[{"Data", "[", "a", "]"}], "\[LeftDoubleBracket]", 
                 RowBox[{
                 "All", ",", "\"\<VerbatimRegions\>\"", ",", "All", ",", 
                  "\"\<Private\>\""}], "\[RightDoubleBracket]"}]}], "]"}], 
              "]"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]",
             "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"TrueQ", "[", "PM`Private`$DiagnosticQ", "]"}], ",", 
              "\"\<\\n}];\\n\\tPrint[\\\"  Time elapsed = \\\",time];\\n];\\n\
\\n\>\"", ",", "\"\<\>\""}], "]"}], "\[IndentingNewLine]", ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\"\<(** CompiledFunctions **)\\n\\n\>\"", ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"TrueQ", "[", "PM`Private`$DiagnosticQ", "]"}], ",", 
              "\"\<Module[{time},\\nPrint[\\\"  Loading \
CompiledFunctions...\\\"];\\ntime=First@AbsoluteTiming[{\\n\\n\>\"", ",", 
              "\"\<\>\""}], "]"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"ListToPackageString", "[", "\[IndentingNewLine]", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Values", "[", 
               RowBox[{"DeleteMissing", "/@", 
                RowBox[{
                 RowBox[{"Data", "[", "a", "]"}], "\[LeftDoubleBracket]", 
                 RowBox[{
                 "All", ",", "\"\<CPackageFunctions\>\"", ",", "All", ",", 
                  "\"\<Private\>\""}], "\[RightDoubleBracket]"}]}], "]"}], 
              "]"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]",
             "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"TrueQ", "[", "PM`Private`$DiagnosticQ", "]"}], ",", 
              "\"\<\\n}];\\n\\tPrint[\\\"  Time elapsed = \\\",time];\\n];\\n\
\\n\>\"", ",", "\"\<\>\""}], "]"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\"\<(** PackageFunctions **)\\n\\n\>\"", ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"TrueQ", "[", "PM`Private`$DiagnosticQ", "]"}], ",", 
              "\"\<Module[{time},\\nPrint[\\\"  Loading PackageFunctions...\\\
\"];\\ntime=First@AbsoluteTiming[{\\n\\n\>\"", ",", "\"\<\>\""}], "]"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"ListToPackageString", "[", 
             RowBox[{"PackageFunctionCodes", "[", "a", "]"}], "]"}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"TrueQ", "[", "PM`Private`$DiagnosticQ", "]"}], ",", 
              "\"\<\\n}];\\n\\tPrint[\\\"  Time elapsed = \\\",time];\\n];\\n\
\\n\>\"", ",", "\"\<\>\""}], "]"}], ",", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\"\<\\n\\n\>\"", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "\"\<DumpSave[FileNameJoin[{$packageDirectory,\\\"\>\"", ",", 
              RowBox[{"Name", "[", "a", "]"}], ",", 
              "\"\<_Buffer.mx\\\"}],\\\"\>\"", ",", 
              RowBox[{"PackageContext", "[", "a", "]"}], ",", "\"\<\\\"]\>\"",
               ",", "\[IndentingNewLine]", "\"\<\\n\\n\>\"", ","}], "*)"}], 
            "\[IndentingNewLine]", "\"\<End[];\\n\\n\>\"", ",", 
            "\[IndentingNewLine]", "endstring"}], "\[IndentingNewLine]", 
           "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"End", "[", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
       "s"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.665308239256591*^9, 3.665308273509638*^9}, {
   3.6653083120369263`*^9, 3.665308318651143*^9}, {3.6653083923570967`*^9, 
   3.665308428022388*^9}, {3.665308687249041*^9, 3.665308688056344*^9}, {
   3.665308818766118*^9, 3.665308887443696*^9}, {3.665308999203257*^9, 
   3.665309022853586*^9}, {3.665309055618088*^9, 3.665309084175452*^9}, {
   3.6653091318974867`*^9, 3.665309138112878*^9}, {3.665309394205275*^9, 
   3.6653093987201147`*^9}, {3.665309821813087*^9, 3.665309860364358*^9}, {
   3.665309975169353*^9, 3.665309982280498*^9}, {3.665310120335638*^9, 
   3.66531012489342*^9}, {3.6653102204846783`*^9, 3.6653102358583603`*^9}, {
   3.665310332863923*^9, 3.665310355657083*^9}, {3.665336027643464*^9, 
   3.6653360299638977`*^9}, {3.66534060713297*^9, 3.665340617275878*^9}, {
   3.665340649507826*^9, 3.66534071745002*^9}, {3.665342871918714*^9, 
   3.6653428727004337`*^9}, {3.665343339452227*^9, 3.66534334205834*^9}, {
   3.6653436923959303`*^9, 3.6653436982587357`*^9}, {3.6653842579814997`*^9, 
   3.665384259289414*^9}, {3.6653879441380167`*^9, 3.6653879481081753`*^9}, {
   3.6653880515215883`*^9, 3.6653880885350523`*^9}, {3.665400923667109*^9, 
   3.665400950801076*^9}, {3.6654010899538183`*^9, 3.665401134013143*^9}, {
   3.665401248645027*^9, 3.665401280837432*^9}, {3.6950288405344667`*^9, 
   3.6950288405634747`*^9}, 3.695029141709632*^9, {3.695029490438119*^9, 
   3.6950295049159727`*^9}, 3.695031238424766*^9, 3.707572693176806*^9, {
   3.7075727706320477`*^9, 3.707572775150198*^9}, {3.707572834982965*^9, 
   3.707572854251069*^9}, {3.707572913479412*^9, 3.707572917183208*^9}, {
   3.7075730365857286`*^9, 3.707573039344308*^9}, {3.707575797813075*^9, 
   3.707575815971651*^9}, {3.707575850329183*^9, 3.707575852559177*^9}, {
   3.707576178250017*^9, 3.707576185472343*^9}, {3.707657831596239*^9, 
   3.707657831812799*^9}, 3.756220887758217*^9, {3.758372333721456*^9, 
   3.758372341101864*^9}, {3.796711850586054*^9, 3.7967119175019197`*^9}, {
   3.7967119574875717`*^9, 3.796711959726796*^9}, 3.796712038994275*^9, {
   3.796712149727261*^9, 3.796712194751285*^9}, 3.796712251188048*^9, {
   3.796712410099432*^9, 3.796712411173427*^9}, {3.7967132922695436`*^9, 
   3.796713324834517*^9}, {3.796713409248502*^9, 3.7967134247273827`*^9}, {
   3.796714379304818*^9, 3.7967143820147943`*^9}, {3.796735736384856*^9, 
   3.79673577381203*^9}, {3.7967435889504013`*^9, 3.796743605399596*^9}, {
   3.7967437136206903`*^9, 3.79674372540484*^9}, {3.796743977403015*^9, 
   3.7967439787693357`*^9}, {3.796744048179428*^9, 3.7967440524389277`*^9}, {
   3.796747313009053*^9, 3.796747313603759*^9}, {3.796786012161972*^9, 
   3.796786101574333*^9}, {3.796786155007031*^9, 3.7967861698448963`*^9}, {
   3.796786208556163*^9, 3.796786210722213*^9}, {3.7967862897272*^9, 
   3.796786302588923*^9}, {3.7967863422856417`*^9, 3.796786346645083*^9}, {
   3.796786420716806*^9, 3.7967864249625072`*^9}, 3.796788326334208*^9, {
   3.796876608005341*^9, 3.796876708375621*^9}, {3.796876739902224*^9, 
   3.796876760421232*^9}, {3.796876890994828*^9, 3.796876936770059*^9}, 
   3.796877017709478*^9, {3.796877050561192*^9, 3.7968770532417393`*^9}, {
   3.7968794269706593`*^9, 3.7968794325862617`*^9}, {3.7968802601646*^9, 
   3.7968802671957893`*^9}, {3.796880971585034*^9, 3.796880971809664*^9}, {
   3.79688370395578*^9, 3.796883733745326*^9}, {3.7968837872881613`*^9, 
   3.796884169024425*^9}, {3.7968842298725863`*^9, 3.796884304899481*^9}, {
   3.7968844102748537`*^9, 3.7968844378721867`*^9}, {3.796884957752174*^9, 
   3.7968849766920357`*^9}, {3.7968907473282757`*^9, 
   3.7968907984352207`*^9}, {3.79734009227057*^9, 3.797340093512374*^9}, {
   3.7973403628461514`*^9, 3.797340374148766*^9}, {3.7973404825616293`*^9, 
   3.797340496455158*^9}, {3.7973407763853416`*^9, 3.797340809725082*^9}, {
   3.797411635850243*^9, 3.797411640488063*^9}, {3.839476412775251*^9, 
   3.839476424373528*^9}, {3.839479401947023*^9, 3.839479413029917*^9}, {
   3.839481856836946*^9, 3.839481917721407*^9}, {3.839485598000718*^9, 
   3.839485655176056*^9}, {3.839486429680049*^9, 3.839486471467239*^9}, {
   3.8394904677988567`*^9, 3.83949048814988*^9}, {3.839490594882433*^9, 
   3.839490653080792*^9}, {3.8394907040059147`*^9, 3.8394907054224977`*^9}, {
   3.83949076289264*^9, 3.8394907699878387`*^9}, {3.8394908568407583`*^9, 
   3.839491013260894*^9}, {3.8394911643336143`*^9, 3.839491186467148*^9}, {
   3.839491593911008*^9, 3.839491657164935*^9}, {3.839494489011075*^9, 
   3.839494533258017*^9}, {3.839494879366254*^9, 3.839495143628714*^9}, {
   3.839495198655128*^9, 3.839495233282749*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"8934faf7-7f0a-4b5d-b459-8bc00b3dfe6d"],

Cell[BoxData[
 RowBox[{"CreateInstallationPaths", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "[", 
         RowBox[{"InstallationPath", "[", "a", "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PrintTemporary", "[", 
         RowBox[{"\"\<Creating installation tree for \>\"", ",", " ", 
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Name", "[", "a", "]"}], ",", "Bold"}], "]"}], ",", 
          "\"\< ...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"CreateDirectory", "[", 
         RowBox[{"InstallationPath", "[", "a", "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CreateDirectory", "[", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"InstallationPath", "[", "a", "]"}], ",", 
            "\"\<Kernel\>\""}], "}"}], "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CreateDirectory", "[", 
         RowBox[{"AuxPath", "[", "a", "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CreateDirectory", "[", 
         RowBox[{"DynamicLibraryPath", "[", "a", "]"}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"FileExistsQ", "[", 
            RowBox[{"AuxPath", "[", "a", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"PrintTemporary", "[", 
            RowBox[{"\"\<Creating aux folder for \>\"", ",", " ", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Name", "[", "a", "]"}], ",", "Bold"}], "]"}], ",", 
             "\"\< ...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"CreateDirectory", "[", 
            RowBox[{"AuxPath", "[", "a", "]"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"FileExistsQ", "[", 
            RowBox[{"DynamicLibraryPath", "[", "a", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"PrintTemporary", "[", 
            RowBox[{"\"\<Creating lib folder for \>\"", ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Name", "[", "a", "]"}], ",", "Bold"}], "]"}], ",", 
             "\"\< ...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"CreateDirectory", "[", 
            RowBox[{"DynamicLibraryPath", "[", "a", "]"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"FileExistsQ", "[", 
            RowBox[{"FileNameJoin", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"InstallationPath", "[", "a", "]"}], ",", 
               "\"\<Kernel\>\""}], "}"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"CreateDirectory", "[", 
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"InstallationPath", "[", "a", "]"}], ",", 
              "\"\<Kernel\>\""}], "}"}], "]"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"AuxPath", "[", "a", "]"}], ",", "\"\<MakeFile.aux\>\""}], 
         "}"}], "]"}], ",", "\"\<\>\"", ",", "\"\<Text\>\""}], "]"}], ";"}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.665387590765501*^9, 3.665387591925077*^9}, {
   3.6653876489393377`*^9, 3.665387677601716*^9}, {3.665392673597282*^9, 
   3.6653927240239983`*^9}, {3.665409968070633*^9, 3.66540996983501*^9}, {
   3.665410039947679*^9, 3.665410068116654*^9}, {3.665491827459964*^9, 
   3.665491829342497*^9}, {3.665497136417656*^9, 3.665497137208486*^9}, 
   3.729585971726782*^9, {3.758372342546548*^9, 3.7583723457063437`*^9}, 
   3.7953604309401407`*^9, {3.796753648597925*^9, 3.796753655357481*^9}, {
   3.796786492779849*^9, 3.796786563778418*^9}, 3.796786780626174*^9, {
   3.839476425347467*^9, 3.839476426277154*^9}, 3.840085327406097*^9, 
   3.840085776324527*^9},ExpressionUUID->"fb7c1c96-5242-4fbe-b2de-\
58a5500c6a1d"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8394795891632013`*^9, 
  3.8394796236824093`*^9}},ExpressionUUID->"108b6df4-3069-49ab-beb3-\
9ceee10f85fe"],

Cell[BoxData[
 RowBox[{"WritePackage", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pflist", ",", "sourcedata"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"CreateInstallationPaths", "[", "a", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<WritePackage\>\"", "\[Rule]", "\"\<Creating libraries\>\""}], 
          "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ExportLibrary", "/@", " ", 
        RowBox[{"Libraries", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<WritePackage\>\"", "\[Rule]", "\"\<PackageFunctionList\>\""}], 
          "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pflist", "=", 
        RowBox[{"PackageFunctionList", "[", "a", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<WritePackage\>\"", "\[Rule]", "\"\<sourcedata\>\""}], 
          "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"sourcedata", "=", 
        RowBox[{"GroupBy", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"pflist", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "\"\<FunctionName\>\""}], 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{"pflist", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "\"\<Source\>\""}], 
              "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"First", "\[Rule]", "Last"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<WritePackage\>\"", "\[Rule]", "\"\<Write sourcedata\>\""}], 
          "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"SourceLookupFile", "[", "a", "]"}], ",", "sourcedata"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<WritePackage\>\"", "\[Rule]", "\"\<PackageString\>\""}], "]"}],
          ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<WritePackage\>\"", "\[Rule]", "\"\<Export\>\""}], 
          "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"InstallationFile", "[", "a", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"StringReplace", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ImportString", "[", 
            RowBox[{
             RowBox[{"PackageString", "[", "a", "]"}], ",", "\"\<Text\>\""}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "\"\<\[LeftArrow]\>\"", "\[Rule]", "\"\<\\\\[LeftArrow]\>\""}], 
             ",", 
             RowBox[{
             "\"\<\[Function]\>\"", "\[Rule]", "\"\<\\\\[Function]\>\""}], 
             ",", 
             RowBox[{"\"\<\[Rule]\>\"", "\[Rule]", "\"\<\\\\[Rule]\>\""}]}], 
            "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", "\"\<String\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"InstallationPath", "[", "a", "]"}], ",", 
            "\"\<Kernel\>\"", ",", "\"\<init.m\>\""}], "}"}], "]"}], ",", 
         RowBox[{"\"\<Get[\\\"\>\"", "<>", 
          RowBox[{"Name", "[", "a", "]"}], "<>", "\"\<`\>\"", "<>", 
          RowBox[{"Name", "[", "a", "]"}], "<>", "\"\<`\\\"];\>\""}], ",", 
         "\"\<Text\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.665308239256591*^9, 3.665308273509638*^9}, {
   3.6653083120369263`*^9, 3.665308318651143*^9}, {3.6653083923570967`*^9, 
   3.665308428022388*^9}, {3.665308687249041*^9, 3.665308688056344*^9}, {
   3.665308818766118*^9, 3.665308887443696*^9}, {3.665308999203257*^9, 
   3.665309022853586*^9}, {3.665309055618088*^9, 3.665309084175452*^9}, {
   3.6653091318974867`*^9, 3.665309138112878*^9}, {3.665309394205275*^9, 
   3.6653093987201147`*^9}, {3.665309821813087*^9, 3.665309860364358*^9}, {
   3.665309975169353*^9, 3.665309982280498*^9}, {3.665310120335638*^9, 
   3.66531012489342*^9}, {3.6653102204846783`*^9, 3.6653102358583603`*^9}, {
   3.665310332863923*^9, 3.665310355657083*^9}, {3.665336027643464*^9, 
   3.6653360299638977`*^9}, {3.6653361500224648`*^9, 3.665336170522459*^9}, {
   3.665336610802953*^9, 3.6653366154316187`*^9}, {3.665336654466672*^9, 
   3.665336656544298*^9}, {3.6653862566135483`*^9, 3.665386263226823*^9}, {
   3.66538633892969*^9, 3.665386340558277*^9}, {3.665386691524866*^9, 
   3.665386694476613*^9}, {3.665387682648889*^9, 3.665387688505596*^9}, {
   3.6838290383156652`*^9, 3.6838290843551493`*^9}, {3.6838304245372143`*^9, 
   3.6838304313975067`*^9}, {3.683830645799152*^9, 3.683830649594685*^9}, {
   3.6861256007806664`*^9, 3.686125606073676*^9}, 3.695028840569219*^9, 
   3.707572472891427*^9, {3.7293582770717297`*^9, 3.7293582932529383`*^9}, {
   3.729358541159079*^9, 3.7293585446791162`*^9}, {3.7562200086626453`*^9, 
   3.756220097433386*^9}, {3.7562225207665567`*^9, 3.756222533149033*^9}, {
   3.758372347051252*^9, 3.7583723505865307`*^9}, {3.796728136101654*^9, 
   3.7967281434234667`*^9}, {3.796728519040676*^9, 3.796728528295578*^9}, {
   3.796730694582963*^9, 3.7967306953032627`*^9}, {3.79673868498505*^9, 
   3.796738686241488*^9}, {3.796739253446576*^9, 3.796739282003446*^9}, {
   3.7967535858155737`*^9, 3.7967535862409973`*^9}, {3.796756041732993*^9, 
   3.7967560493627253`*^9}, {3.79678402314081*^9, 3.796784028115835*^9}, {
   3.796784529677899*^9, 3.7967845331460733`*^9}, {3.796785948479007*^9, 
   3.796786000470302*^9}, {3.796786784376019*^9, 3.79678694269169*^9}, {
   3.796786983579617*^9, 3.7967869841950397`*^9}, {3.796787142533296*^9, 
   3.796787149795631*^9}, {3.7967876930575*^9, 3.7967877164730883`*^9}, {
   3.7967877988751163`*^9, 3.796787802349308*^9}, {3.796788095786582*^9, 
   3.796788166399798*^9}, {3.7967882634184837`*^9, 3.7967882984604683`*^9}, {
   3.796876233918046*^9, 3.7968762352618093`*^9}, {3.797181746990641*^9, 
   3.797181792308305*^9}, {3.797213481992663*^9, 3.797213491094686*^9}, {
   3.839476426787071*^9, 3.839476427279513*^9}, {3.8394764692578897`*^9, 
   3.839476471503973*^9}, 3.83947687271449*^9, {3.839478069802984*^9, 
   3.8394780953234997`*^9}, {3.839479619163816*^9, 3.839479619729314*^9}, 
   3.839479734182996*^9, {3.839480048195196*^9, 3.839480058202592*^9}, {
   3.839480250226469*^9, 3.839480257866212*^9}, {3.840085328574999*^9, 
   3.84008532904282*^9}, {3.840085777279653*^9, 3.840085777531255*^9}, {
   3.840092657921492*^9, 3.840092701559744*^9}, {3.840095252758621*^9, 
   3.840095315187982*^9}, {3.840099439838283*^9, 
   3.840099450102191*^9}},ExpressionUUID->"43a735d4-d1a7-4e9e-aa40-\
aaae7d1e66de"],

Cell[BoxData[
 RowBox[{"DeletePackage", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"InstalledQ", "[", "a", "]"}], ",", 
      RowBox[{"DeleteDirectory", "[", 
       RowBox[{
        RowBox[{"InstallationPath", "[", "a", "]"}], ",", 
        RowBox[{"DeleteContents", "\[Rule]", "True"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.665386506587143*^9, 3.665386579337185*^9}, 
   3.66538774774958*^9, {3.758372352161254*^9, 
   3.758372353800929*^9}},ExpressionUUID->"1a1fc883-237b-48fe-908b-\
8ce9c0a488c6"],

Cell[BoxData[
 RowBox[{"PackageLoadDependencies", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Name", "[", "a", "]"}], "\[NotEqual]", "\"\<PM\>\""}], ",", 
        
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Name", "[", "a", "]"}], "\[Rule]", "\"\<PM\>\""}], "}"}], 
        ",", 
        RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{"Rule", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Name", "[", "a", "]"}], ",", 
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Context2Name", "/@", 
            RowBox[{"DeleteMissing", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"List", "[", 
               RowBox[{
                RowBox[{"PackageOptions", "[", "a", "]"}], 
                "\[LeftDoubleBracket]", "\"\<DependencyList\>\"", 
                "\[RightDoubleBracket]"}], "]"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Context2Name", "/@", 
            RowBox[{"DeleteMissing", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"List", "[", 
               RowBox[{
                RowBox[{"PackageOptions", "[", "a", "]"}], 
                "\[LeftDoubleBracket]", "\"\<LoadList\>\"", 
                "\[RightDoubleBracket]"}], "]"}], "]"}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
       "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.665388718263989*^9, 3.665388726607251*^9}, {
  3.669730582520505*^9, 3.669730595623954*^9}, {3.669730646010468*^9, 
  3.669730646362362*^9}, {3.669731245311057*^9, 3.669731246140152*^9}, {
  3.669731349000939*^9, 3.669731349471846*^9}, {3.758372355154132*^9, 
  3.758372356809453*^9}, {3.839476427882804*^9, 
  3.839476428963222*^9}},ExpressionUUID->"5b2bf263-9265-4387-bac0-\
7bd160656512"],

Cell[BoxData[
 RowBox[{"PackageUpdateDependencies", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Name", "[", "a", "]"}], "\[NotEqual]", "\"\<PM\>\""}], ",", 
        
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Name", "[", "a", "]"}], "\[Rule]", "\"\<PM\>\""}], "}"}], 
        ",", 
        RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{"Rule", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Name", "[", "a", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Context2Name", "/@", 
          RowBox[{"DeleteMissing", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"List", "[", 
             RowBox[{
              RowBox[{"PackageOptions", "[", "a", "]"}], 
              "\[LeftDoubleBracket]", "\"\<DependencyList\>\"", 
              "\[RightDoubleBracket]"}], "]"}], "]"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.669731249493332*^9, 3.6697312631247997`*^9}, {
  3.75837235936195*^9, 3.758372360945222*^9}, {3.8394764295039988`*^9, 
  3.839476430504019*^9}},ExpressionUUID->"b9141180-0f01-457f-9eeb-\
fd790f16288e"],

Cell[BoxData[
 RowBox[{"PackageNeeds", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Name", "[", "a", "]"}], "\[NotEqual]", "\"\<PM\>\""}], ",", 
        
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Name", "[", "a", "]"}], "\[Rule]", "\"\<PM\>\""}], "}"}], 
        ",", 
        RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Thread", "[", 
       RowBox[{"Rule", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Name", "[", "a", "]"}], ",", 
         RowBox[{"Context2Name", "/@", 
          RowBox[{"DeleteMissing", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"List", "[", 
             RowBox[{
              RowBox[{"PackageOptions", "[", "a", "]"}], 
              "\[LeftDoubleBracket]", "\"\<NeedList\>\"", 
              "\[RightDoubleBracket]"}], "]"}], "]"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6697302096358843`*^9, 3.669730216524781*^9}, {
  3.758372362857708*^9, 3.758372364999773*^9}, {3.839476431014245*^9, 
  3.8394764319438887`*^9}},ExpressionUUID->"c898c5f3-8a04-4d54-b6be-\
f9ec1c36b53f"],

Cell[BoxData[
 RowBox[{"EnforceCompilation", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "list", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Enforcing compilation for: \>\"", ",", "a"}], "]"}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"list", "=", 
        RowBox[{"Subpackages", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"SetCache", "[", 
        RowBox[{"a", ",", "\"\<Data\>\"", ",", 
         RowBox[{"Missing", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Scan", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x", "\[Function]", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"SetCache", "[", 
             RowBox[{"x", ",", "\"\<EnforcedCompilationQ\>\"", ",", "True"}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"ClearCache", "[", 
             RowBox[{"x", ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<CallGraph\>\"", ",", "\"\<Data\>\"", ",", 
                "\"\<OutdatedFromDependencies\>\""}], "}"}]}], "]"}], ";"}], 
           ")"}]}], ",", "\[IndentingNewLine]", "list"}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"SetCache", "[", 
        RowBox[{"a", ",", "\"\<Subpackages\>\"", ",", "list"}], "]"}], ";", 
       "\[IndentingNewLine]", "a"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.665393731587153*^9, 3.665393739947709*^9}, {
   3.665393790605988*^9, 3.6653938373387938`*^9}, {3.665397800909186*^9, 
   3.665397864752055*^9}, {3.665478896999853*^9, 3.665478907546071*^9}, {
   3.665479555416251*^9, 3.665479565414678*^9}, {3.665479807400586*^9, 
   3.665479826348755*^9}, {3.6654798742625017`*^9, 3.665479910712479*^9}, {
   3.665479974075426*^9, 3.6654799875941153`*^9}, {3.6654800301356363`*^9, 
   3.665480042099553*^9}, {3.665480072389028*^9, 3.665480072597254*^9}, {
   3.665480118263444*^9, 3.66548011829755*^9}, {3.665481082344316*^9, 
   3.6654810841329*^9}, {3.6654907381183767`*^9, 3.665490744353285*^9}, {
   3.6654913328463793`*^9, 3.665491338133966*^9}, {3.683823088802931*^9, 
   3.683823113297674*^9}, {3.683823336315687*^9, 3.6838233398064632`*^9}, {
   3.695033335813534*^9, 3.6950333536492443`*^9}, 3.695040065376623*^9, 
   3.7075703789999313`*^9, {3.70790191732176*^9, 3.707901918990848*^9}, {
   3.707902317200555*^9, 3.707902317448802*^9}, {3.707926702475711*^9, 
   3.70792672154484*^9}, {3.758372368066208*^9, 3.758372370705271*^9}, {
   3.8394793862366743`*^9, 3.839479390198144*^9}, {3.839479447358979*^9, 
   3.839479487821557*^9}},ExpressionUUID->"ee191e13-da8b-45f9-b08a-\
82461e5ec873"],

Cell[BoxData[
 RowBox[{"GraphFile", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"InstallationPath", "[", "a", "]"}], ",", 
       RowBox[{
        RowBox[{"Name", "[", "a", "]"}], "<>", "\"\<_Graph.mx\>\""}]}], "}"}],
      "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.83947952636546*^9, 3.8394795385493317`*^9}, 
   3.8394813190814133`*^9},ExpressionUUID->"967b6da4-6f7c-4ea8-b82c-\
42f6de00409e"],

Cell[BoxData[
 RowBox[{"CallGraph", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"Missing", "[", 
     RowBox[{"\"\<CallGraph\>\"", ",", "\"\<Not initialized\>\""}], "]"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"0eeaf696-9ce4-4046-b458-77f080ddf36e"],

Cell[BoxData[
 RowBox[{"WriteCallGraph", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"GraphFile", "[", "a", "]"}], ",", 
      RowBox[{"CallGraph", "[", "a", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.839479524179607*^9, 3.839479545578883*^9}, 
   3.8394813524723387`*^9},ExpressionUUID->"fce7da71-d139-4599-bc66-\
494f0ff365ef"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\n", 
  RowBox[{"LoadCallGraph", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"a_package", ",", "\[IndentingNewLine]", 
     RowBox[{"SetCache", "[", 
      RowBox[{"a", ",", "\"\<CallGraph\>\"", ",", 
       RowBox[{"Import", "[", 
        RowBox[{"GraphFile", "[", "a", "]"}], "]"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.683825994976103*^9, 3.683826065544745*^9}, {
   3.6838261660333776`*^9, 3.683826166231246*^9}, {3.758372373097286*^9, 
   3.758372379544221*^9}, {3.7953604487550497`*^9, 3.79536045160105*^9}, {
   3.796753700835104*^9, 3.7967537468679047`*^9}, {3.796784039163733*^9, 
   3.7967840553450537`*^9}, {3.796784085658819*^9, 3.796784107768277*^9}, {
   3.796784314067533*^9, 3.796784325390225*^9}, {3.796784472838099*^9, 
   3.796784479419569*^9}, {3.796784936760392*^9, 3.796784937205809*^9}, {
   3.839476432426895*^9, 3.8394764328898897`*^9}, {3.839479514559208*^9, 
   3.839479521990749*^9}, 3.83947955587704*^9, 
   3.839481357647976*^9},ExpressionUUID->"f54ef416-b3c6-42a4-8b75-\
41f8551b344b"],

Cell[BoxData[
 RowBox[{"CreateCallGraph", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a_package", ",", "plist0_"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "graphlist", ",", "expfunnames", ",", "expfunlist", ",", "pfuns", ",", 
        "pfunnames", ",", "cpfunnames", ",", "pfun", ",", "pfunlist", ",", 
        "cpfunlist", ",", "funnames", ",", "funlist", ",", "codelist", ",", 
        "check", ",", "c", ",", "calls", ",", "cachecolorfun", ",", "plist", 
        ",", "g"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"\"\<Building call graph for \>\"", ",", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"Name", "[", "a", "]"}], ",", "Bold"}], "]"}], ",", 
         "\"\<...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"plist", "=", 
        RowBox[{"Values", "[", "plist0", "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"graphlist", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"CallGraph", ",", "plist"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"expfunnames", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Map", "[", 
          RowBox[{"VertexList", ",", "graphlist"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"expfunlist", "=", 
        RowBox[{
         RowBox[{"MakeExpression", "[", "expfunnames", "]"}], "/.", 
         RowBox[{"HoldComplete", "\[Rule]", "Hold"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pfuns", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"PackageFunctionList", "[", "a", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pfunnames", "=", 
        RowBox[{
         RowBox[{"pfuns", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "\"\<FunctionName\>\""}], 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cpfunnames", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Values", "[", 
          RowBox[{"DeleteMissing", "/@", 
           RowBox[{
            RowBox[{"Data", "[", "a", "]"}], "\[LeftDoubleBracket]", 
            RowBox[{
            "All", ",", "\"\<CPackageFunctions\>\"", ",", "All", ",", 
             "\"\<Name\>\""}], "\[RightDoubleBracket]"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"pfunlist", "=", 
        RowBox[{
         RowBox[{"pfuns", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "\"\<FunctionExpression\>\""}], 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cpfunlist", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"x", "\[Function]", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{
             RowBox[{"MakeExpression", "[", "x", "]"}], ",", 
             RowBox[{"0", "\[Rule]", "Hold"}]}], "]"}]}], ",", "cpfunnames"}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"funnames", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"pfunnames", ",", "cpfunnames"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"funlist", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"pfunlist", ",", "cpfunlist", ",", "expfunlist"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"codelist", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"x", "\[Function]", 
           RowBox[{"MapAll", "[", 
            RowBox[{"Hold", ",", "x", ",", 
             RowBox[{"Heads", "\[Rule]", "True"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"pfuns", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "\"\<Code\>\""}], "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"check", "=", 
        RowBox[{"x", "\[Function]", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"funlist", ",", "x"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"calls", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"c", "++"}], ";", "\[IndentingNewLine]", 
              RowBox[{"DeleteDuplicates", "[", "\[IndentingNewLine]", 
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{
                 "pfunnames", "\[LeftDoubleBracket]", "c", 
                  "\[RightDoubleBracket]"}], "\[DirectedEdge]", 
                 RowBox[{"HoldToString", "/@", 
                  RowBox[{"Extract", "[", 
                   RowBox[{"cc", ",", 
                    RowBox[{"Position", "[", 
                    RowBox[{"cc", ",", 
                    RowBox[{"_", "?", "check"}]}], "]"}]}], "]"}]}]}], "]"}], 
               "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"cc", ",", "codelist"}], "}"}]}], "]"}], "]"}]}], ";"}],
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cachecolorfun", "[", "False", "]"}], ":=", 
        RowBox[{"Lighter", "@", 
         RowBox[{"Lighter", "@", "Blue"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cachecolorfun", "[", "True", "]"}], ":=", 
        RowBox[{"Darker", "@", 
         RowBox[{"Darker", "@", "Green"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cachecolorfun", "[", "Access", "]"}], ":=", "Black"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cachecolorfun", "[", "\"\<Access\>\"", "]"}], ":=", 
        "Black"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cachecolorfun", "[", "Persistent", "]"}], ":=", 
        RowBox[{"Lighter", "@", "Purple"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cachecolorfun", "[", "\"\<Persistent\>\"", "]"}], ":=", 
        RowBox[{"Lighter", "@", "Purple"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cachecolorfun", "[", "Settings", "]"}], ":=", "Yellow"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cachecolorfun", "[", "\"\<Settings\>\"", "]"}], ":=", 
        "Yellow"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cachecolorfun", "[", "_", "]"}], ":=", "Gray"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"g", "=", 
        RowBox[{"Graph", "[", "\[IndentingNewLine]", 
         RowBox[{"funnames", ",", "calls", ",", "\[IndentingNewLine]", 
          RowBox[{"VertexLabels", "\[Rule]", 
           RowBox[{"Placed", "[", 
            RowBox[{"\"\<Name\>\"", ",", "Tooltip"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"VertexStyle", "\[Rule]", 
           RowBox[{"Join", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"cpfunnames", "\[Rule]", 
               RowBox[{"Darker", "@", "Red"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Thread", "[", 
              RowBox[{"pfunnames", "\[Rule]", 
               RowBox[{"cachecolorfun", "/@", 
                RowBox[{
                 RowBox[{"pfuns", "\[LeftDoubleBracket]", 
                  RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
                 "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", "\"\<Caching\>\""}], 
                 "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Thread", "[", 
              RowBox[{
               RowBox[{"pfunnames", "\[LeftDoubleBracket]", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Position", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"pfuns", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "\"\<InputType\>\""}], 
                    "\[RightDoubleBracket]"}], ",", "None"}], "]"}], "]"}], 
                "\[RightDoubleBracket]"}], "\[Rule]", "White"}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"SetCache", "[", 
        RowBox[{"a", ",", "\"\<CallGraph\>\"", ",", "g"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"\"\<Writing call graph for \>\"", ",", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"Name", "[", "a", "]"}], ",", "Bold"}], "]"}], ",", 
         "\"\<...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"WriteCallGraph", "[", "a", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{
  3.695029864156516*^9, {3.695039197463908*^9, 3.695039202126343*^9}, {
   3.695039461161134*^9, 3.695039465253668*^9}, {3.70757319572029*^9, 
   3.707573221934688*^9}, {3.7079266968130198`*^9, 3.707926696998973*^9}, {
   3.728283463318513*^9, 3.728283477158266*^9}, {3.728283510442667*^9, 
   3.728283517231308*^9}, 3.7282837592983303`*^9, {3.72828398694738*^9, 
   3.728284001628871*^9}, {3.7282845293490353`*^9, 3.728284531905264*^9}, {
   3.728285389813609*^9, 3.728285437175542*^9}, {3.7295141374330378`*^9, 
   3.7295141597263412`*^9}, {3.7295157877451344`*^9, 3.729515796666463*^9}, {
   3.758372145932393*^9, 3.758372173304235*^9}, {3.839476433384015*^9, 
   3.839476433843598*^9}, 
   3.839479391621622*^9},ExpressionUUID->"59ab1e2b-aa51-4bee-a4e6-\
95a7ca0e0c80"],

Cell[BoxData[
 RowBox[{"PackageFunctionSources", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_package", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pflist", ",", "sourcedata", ",", "file"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"file", "=", 
        RowBox[{"SourceLookupFile", "[", "a", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"FileExistsQ", "[", "file", "]"}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"(*", "Then", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"sourcedata", "=", 
          RowBox[{"Import", "[", "file", "]"}]}], "\[IndentingNewLine]", ",", 
         
         RowBox[{"(*", "Else", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"pflist", "=", 
           RowBox[{
            RowBox[{"PackageFunctionList", "[", "a", "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"sourcedata", "=", 
           RowBox[{"GroupBy", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"pflist", "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", "\"\<FunctionName\>\""}], 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"pflist", "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", "\"\<Source\>\""}], 
                 "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"First", "\[Rule]", "Last"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Export", "[", 
           RowBox[{"file", ",", "sourcedata"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "sourcedata"}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.683828565869116*^9, 3.683828600023498*^9}, {
   3.683828657070586*^9, 3.6838287078860903`*^9}, {3.683828759348195*^9, 
   3.683828818268553*^9}, {3.683828849858515*^9, 3.683828948456232*^9}, {
   3.683829133227665*^9, 3.683829138785454*^9}, {3.683829237632841*^9, 
   3.683829240859696*^9}, {3.683829524817286*^9, 3.683829526642014*^9}, {
   3.758372175214839*^9, 3.758372180334375*^9}, {3.7967560917148237`*^9, 
   3.796756103146636*^9}, {3.796756137962214*^9, 3.796756138161666*^9}, 
   3.796757332282918*^9, {3.79678411742651*^9, 3.7967841258310013`*^9}, {
   3.796784546817685*^9, 3.796784586378086*^9}, {3.796784946028804*^9, 
   3.79678495873067*^9}, {3.796789027344685*^9, 3.79678903473695*^9}, 
   3.796789179747901*^9, 3.839476434272838*^9, {3.8394797479424057`*^9, 
   3.8394797581395617`*^9}},ExpressionUUID->"807f385e-1ae1-4140-bb3e-\
bfa0e0d5f493"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Libraries", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"p_package", ",", "\[IndentingNewLine]", 
     RowBox[{"Association", "[", "\[IndentingNewLine]", 
      RowBox[{"Map", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"dir", "=", 
             RowBox[{"DirectoryName", "[", "#", "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"FileBaseName", "[", "dir", "]"}], "\[Rule]", 
            RowBox[{"Init", "[", 
             RowBox[{"library", ",", "dir", ",", 
              RowBox[{"InstallationPath", "[", "p", "]"}], ",", 
              RowBox[{"Get", "[", "#", "]"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], "&"}], ",", "\[IndentingNewLine]", 
        RowBox[{"FileNames", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<*\>\"", ",", "\"\<MakeFile.m\>\""}], "}"}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"SourcePath", "[", "p", "]"}], ",", 
             "\"\<LibrarySources\>\""}], "}"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Caching", "\[Rule]", "Persistent"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.796730587349148*^9, 3.796730595700068*^9}, {
  3.839480305162476*^9, 3.839480307918948*^9}, {3.8394803706051817`*^9, 
  3.839480394484211*^9}},ExpressionUUID->"dffead86-0aaf-4fc7-8c37-\
53fdc8a3016f"]
},
WindowSize->{1440, 855},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (June 19, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4df6e708-434c-4b45-b277-d2c99c37d35a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3053, 64, 542, "Input",ExpressionUUID->"879a821f-272a-4f9e-a4a9-1c2131334fc0"],
Cell[3614, 86, 477, 11, 42, "Input",ExpressionUUID->"89d5ae99-e3b5-4a1a-bfdc-7eb491090ace"],
Cell[4094, 99, 601, 14, 92, "Input",ExpressionUUID->"c437188f-85c1-4829-9b97-19c324402052"],
Cell[4698, 115, 447, 11, 42, "Input",ExpressionUUID->"a69efb82-16b5-45ec-b932-e2c3d5c85c19"],
Cell[5148, 128, 624, 13, 42, "Input",ExpressionUUID->"45229029-0fff-455e-af92-0800dfdea2c6"],
Cell[5775, 143, 577, 12, 42, "Input",ExpressionUUID->"7799dc25-b4ba-4966-afff-a80cdce55030"],
Cell[6355, 157, 716, 15, 117, "Input",ExpressionUUID->"a3a4dfc7-e3e8-41a8-8e6a-d90fa34ef26e"],
Cell[7074, 174, 784, 17, 117, "Input",ExpressionUUID->"72eb8a20-052d-4434-b831-74c98a87f695"],
Cell[7861, 193, 1010, 22, 192, "Input",ExpressionUUID->"25391d14-a07a-4b15-9881-50567e62653b"],
Cell[8874, 217, 1880, 41, 242, "Input",ExpressionUUID->"2a9bbc03-c2e7-4483-99c2-21e45693573a"],
Cell[10757, 260, 469, 10, 92, "Input",ExpressionUUID->"b778a04f-03e8-4401-aa7f-10dcbfd86316"],
Cell[11229, 272, 758, 16, 117, "Input",ExpressionUUID->"ce708bc3-018e-4cf4-9d8e-de9d97ba847d"],
Cell[11990, 290, 645, 14, 117, "Input",ExpressionUUID->"0c0e12af-647d-4627-bbfe-621230e55f87"],
Cell[12638, 306, 3409, 71, 467, "Input",ExpressionUUID->"48364ccb-cbdc-4d3d-84bd-9db6f7a60011"],
Cell[16050, 379, 4094, 85, 617, "Input",ExpressionUUID->"4c83f749-5b99-44b1-b80e-07998815e0a3"],
Cell[20147, 466, 933, 19, 192, "Input",ExpressionUUID->"2954e1c9-d8d5-4091-b736-09a1be9bcbac"],
Cell[21083, 487, 914, 19, 192, "Input",ExpressionUUID->"5af18006-8dca-46ce-aea7-0041d39dae37"],
Cell[22000, 508, 686, 15, 117, "Input",ExpressionUUID->"089bf6c6-98ba-4845-a512-27691d166626"],
Cell[22689, 525, 554, 11, 117, "Input",ExpressionUUID->"d7a0ee3e-23b3-4ee9-bbe1-8999fdac4c0f"],
Cell[23246, 538, 1762, 41, 217, "Input",ExpressionUUID->"cb1f2bfa-2f6c-4928-a091-9b7b8b773219"],
Cell[25011, 581, 1253, 27, 267, "Input",ExpressionUUID->"b52b54d6-0588-484a-bfa8-64827cf6a255"],
Cell[26267, 610, 2635, 58, 392, "Input",ExpressionUUID->"1f551080-56dc-45f5-8542-888ca9f01d76"],
Cell[28905, 670, 907, 21, 117, "Input",ExpressionUUID->"96a44d24-505b-4cc2-b9e3-f253b34530ea"],
Cell[29815, 693, 3566, 69, 442, "Input",ExpressionUUID->"ddfea897-d09b-4e74-a784-355a4e372df4"],
Cell[33384, 764, 681, 13, 117, "Input",ExpressionUUID->"4fc4ba65-d5bb-42be-96e8-32c489d0f559"],
Cell[34068, 779, 2157, 54, 392, "Input",ExpressionUUID->"eef5e05f-7ddc-4fb5-b723-73360d6adf11"],
Cell[36228, 835, 752, 16, 92, "Input",ExpressionUUID->"0383124d-1839-439a-828b-4f462a1cde13"],
Cell[36983, 853, 1641, 36, 142, "Input",ExpressionUUID->"9a9cd930-c708-4800-a22f-a8eeaeeb3bd1"],
Cell[38627, 891, 27792, 499, 5617, "Input",ExpressionUUID->"8934faf7-7f0a-4b5d-b459-8bc00b3dfe6d"],
Cell[66422, 1392, 4638, 103, 567, "Input",ExpressionUUID->"fb7c1c96-5242-4fbe-b2de-58a5500c6a1d"],
Cell[71063, 1497, 156, 3, 41, "Input",ExpressionUUID->"108b6df4-3069-49ab-beb3-9ceee10f85fe"],
Cell[71222, 1502, 7809, 155, 667, "Input",ExpressionUUID->"43a735d4-d1a7-4e9e-aa40-aaae7d1e66de"],
Cell[79034, 1659, 655, 15, 92, "Input",ExpressionUUID->"1a1fc883-237b-48fe-908b-8ce9c0a488c6"],
Cell[79692, 1676, 2215, 49, 317, "Input",ExpressionUUID->"5b2bf263-9265-4387-bac0-7bd160656512"],
Cell[81910, 1727, 1513, 35, 267, "Input",ExpressionUUID->"b9141180-0f01-457f-9eeb-fd790f16288e"],
Cell[83426, 1764, 1472, 35, 242, "Input",ExpressionUUID->"c898c5f3-8a04-4d54-b6be-f9ec1c36b53f"],
Cell[84901, 1801, 2940, 56, 392, "Input",ExpressionUUID->"ee191e13-da8b-45f9-b08a-82461e5ec873"],
Cell[87844, 1859, 559, 13, 92, "Input",ExpressionUUID->"967b6da4-6f7c-4ea8-b82c-42f6de00409e"],
Cell[88406, 1874, 414, 8, 117, "Input",ExpressionUUID->"0eeaf696-9ce4-4046-b458-77f080ddf36e"],
Cell[88823, 1884, 478, 11, 92, "Input",ExpressionUUID->"fce7da71-d139-4599-bc66-494f0ff365ef"],
Cell[89304, 1897, 1118, 20, 142, "Input",ExpressionUUID->"f54ef416-b3c6-42a4-8b75-41f8551b344b"],
Cell[90425, 1919, 10178, 219, 1292, "Input",ExpressionUUID->"59ab1e2b-aa51-4bee-a4e6-95a7ca0e0c80"],
Cell[100606, 2140, 3089, 63, 492, "Input",ExpressionUUID->"807f385e-1ae1-4140-bb3e-bfa0e0d5f493"],
Cell[103698, 2205, 1793, 40, 367, "Input",ExpressionUUID->"dffead86-0aaf-4fc7-8c37-53fdc8a3016f"]
}
]
*)

