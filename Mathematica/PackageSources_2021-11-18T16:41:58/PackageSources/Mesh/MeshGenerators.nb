(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    285152,       6733]
NotebookOptionsPosition[    279021,       6661]
NotebookOutlinePosition[    279357,       6676]
CellTagsIndexPosition[    279314,       6673]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"DiskMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"n0_Integer", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "inst", ",", "outInst", ",", "r", ",", "s", ",", "n", ",", "m", ",", 
        "e", ",", "digits"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"3", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"2.", 
         RowBox[{"Pi", " ", "/", "n"}], " ", 
         RowBox[{"OptionValue", "[", "\"\<SubdivisionFactor\>\"", "]"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", "e"}], "}"}], "=", 
        RowBox[{"MantissaExponent", "[", 
         RowBox[{
          RowBox[{"r", "^", "2"}], "/", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"digits", "=", 
          RowBox[{"StringTake", "[", 
           RowBox[{
            RowBox[{"Internal`DoubleToString", "[", 
             RowBox[{"m", ",", "False"}], "]"}], ",", 
            RowBox[{"3", ";;"}]}], "]"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"digits", "=", 
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"DecimalForm", "[", "m", "]"}], "]"}], ",", 
          RowBox[{"3", ";;"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"s", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"e", "\[LessEqual]", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<0\>\"", ",", "\"\<.\>\"", ",", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"\"\<0\>\"", ",", 
              RowBox[{"-", "e"}]}], "]"}], ",", "digits"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"e", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
            "digits", ",", "\[IndentingNewLine]", 
            RowBox[{"StringInsert", "[", 
             RowBox[{"digits", ",", "\"\<.\>\"", ",", 
              RowBox[{"e", "+", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"inst", "=", 
        RowBox[{"TriangleCreate", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"TriangleSetPoints", "[", 
        RowBox[{"inst", ",", 
         RowBox[{"CirclePoints", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"N", "[", 
              RowBox[{"OptionValue", "[", "\"\<Radius\>\"", "]"}], "]"}], ",",
              "0."}], "}"}], ",", "n"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"TriangleSetSegments", "[", 
        RowBox[{"inst", ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", "n", "]"}], ",", 
            RowBox[{"RotateLeft", "[", 
             RowBox[{"Range", "[", "n", "]"}], "]"}]}], "}"}], "]"}]}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"outInst", "=", 
        RowBox[{"TriangleTriangulate", "[", " ", 
         RowBox[{"inst", ",", " ", 
          RowBox[{"\"\<pqa\>\"", "<>", "s", "<>", "\"\<Y\>\""}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Init", "[", 
        RowBox[{"mesh", ",", 
         RowBox[{"TriangleGetPoints", "[", "outInst", "]"}], ",", 
         RowBox[{"TriangleGetElements", "[", "outInst", "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
    "Description", "\[Rule]", 
     "\"\<DiskMesh[n] generates a meshed regular n-gon in R^2.\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Radius\>\"", "\[Rule]", "1."}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<SubdivisionFactor\>\"", "\[Rule]", "1."}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.716716471093336*^9, 3.716716471971047*^9}, {
   3.7188869319121513`*^9, 3.7188869402549677`*^9}, {3.718887808562551*^9, 
   3.718887810559785*^9}, {3.720539809364481*^9, 3.720539820069208*^9}, 
   3.72054752216337*^9, 3.720547581054596*^9, {3.720547615167338*^9, 
   3.72054761537539*^9}, {3.748367630401971*^9, 3.748367672104512*^9}, {
   3.7483683138308067`*^9, 3.7483683333254757`*^9}, {3.777803550902905*^9, 
   3.7778035804200373`*^9}, {3.777803638662468*^9, 3.777803641915741*^9}, {
   3.7778041814564257`*^9, 3.7778042619642477`*^9}, {3.777804325066874*^9, 
   3.777804350206625*^9}, {3.777804489283967*^9, 3.777804490905757*^9}, 
   3.788440115683146*^9, {3.788441081877952*^9, 3.7884411015793123`*^9}, {
   3.795246998651052*^9, 3.795247049838134*^9}, {3.829723045263288*^9, 
   3.829723056165823*^9}},ExpressionUUID->"9f11f0c0-71f6-4743-a08e-\
24a05fcacd4e"],

Cell[BoxData[
 RowBox[{"RegularDiskMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"n_Integer", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Q", ",", "m", ",", "\[Alpha]", ",", "r"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m", "=", 
        RowBox[{"OptionValue", "[", "\"\<BndSubdivisions\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Alpha]", "=", 
        RowBox[{"OptionValue", "[", "\"\<RotationAngle\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"OptionValue", "[", "\"\<Radius\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Q", "=", 
        RowBox[{"Init", "[", 
         RowBox[{"mesh", ",", "\[IndentingNewLine]", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0.", ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "3"}], "}"}]}], "]"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"CirclePoints", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"r", ",", "\[Alpha]"}], "}"}], ",", "m"}], "]"}], 
              ",", 
              RowBox[{"Transpose", "[", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"0.", ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "m"}], "}"}]}], "]"}], "]"}], ",", "2"}], 
             "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"i", "+", "1"}], ",", 
                RowBox[{"i", "+", "2"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"m", "-", "1"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"m", "+", "1"}], ",", "2"}], "}"}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SetPersistentCache", "[", 
        RowBox[{
        "Q", ",", "\"\<BoundaryLinkData\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Alpha]", "=", "\[Alpha]"}], ",", 
             RowBox[{"r", "=", "r"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\[LeftAssociation]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\"\<Curve\>\"", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"t", "\[Function]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"r", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"t", "+", "\[Alpha]"}], "]"}]}], ",", 
                   RowBox[{"r", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"t", "+", "\[Alpha]"}], "]"}]}], ",", "0."}], 
                  "}"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<SamplingPoints\>\"", "\[Rule]", 
               RowBox[{"Most", "[", 
                RowBox[{"Subdivide", "[", 
                 RowBox[{"0.", ",", 
                  RowBox[{"2.", "Pi"}], ",", "6"}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<FirstPoint\>\"", "\[Rule]", 
               RowBox[{
                RowBox[{"VertexCoordinates", "[", "Q", "]"}], 
                "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"\"\<SecondPoint\>\"", "\[Rule]", 
               RowBox[{
                RowBox[{"VertexCoordinates", "[", "Q", "]"}], 
                "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], 
             "\[IndentingNewLine]", "\[RightAssociation]"}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"Q", "=", 
          RowBox[{"Subdivide", "[", 
           RowBox[{"Q", ",", 
            RowBox[{"Method", "\[Rule]", "\"\<Loop\>\""}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "Q"}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Description", "\[Rule]", 
     "\"\<RegularDiskMesh[n] generates a meshed unit disk in R^2.\>\""}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<BndSubdivisions\>\"", "\[Rule]", "6"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<RotationAngle\>\"", "\[Rule]", "0."}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Radius\>\"", "\[Rule]", "1."}]}], "\[IndentingNewLine]", 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6518411569467173`*^9, 3.65184127515847*^9}, {
   3.651841638772361*^9, 3.651841665028029*^9}, {3.667231148894786*^9, 
   3.667231195585771*^9}, {3.698293747168542*^9, 3.698293766861635*^9}, {
   3.707968569542665*^9, 3.707968572288806*^9}, {3.715570221402636*^9, 
   3.715570229265058*^9}, {3.720547845054443*^9, 3.720547856813196*^9}, 
   3.758462823167994*^9, {3.758463198782332*^9, 3.7584632560821133`*^9}, {
   3.7584632940734*^9, 3.7584633227442207`*^9}},
 CellLabel->
  "In[1432]:=",ExpressionUUID->"1a3b6193-0cc2-47ff-b3cd-bc27ad48455a"],

Cell[BoxData[
 RowBox[{"CollarDiskMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"n_Integer", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Q", ",", "m", ",", "InnerDisk", ",", "Collar", ",", "\[Theta]"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Q", "=", 
        RowBox[{"DiskMesh", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"InnerDisk", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"x", "\[Function]", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "^", 
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}]}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", "^", 
                RowBox[{"(", 
                 RowBox[{"n", "-", "1"}], ")"}]}], "+", "1"}], ")"}]}], " ", 
            "x"}]}], ",", "Q"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"m", "=", 
        RowBox[{"3", " ", 
         RowBox[{"2", "^", "n"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Theta]", "=", 
        RowBox[{
         RowBox[{"-", "Pi"}], "/", "m"}]}], " ", ";", "\[IndentingNewLine]", 
       RowBox[{"Collar", "=", 
        RowBox[{"Init", "[", 
         RowBox[{"mesh", ",", "\[IndentingNewLine]", 
          RowBox[{"Join", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Most", "@", 
             RowBox[{
              RowBox[{"BoundaryVertexCoordinates", "[", "InnerDisk", "]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Most", "@", 
              RowBox[{
               RowBox[{"BoundaryVertexCoordinates", "[", "Q", "]"}], 
               "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ".", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
                 RowBox[{"-", 
                  RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", "0"}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", 
                 RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", "0"}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Join", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"i", "+", "m"}], ",", 
                RowBox[{"i", "+", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"m", "-", "1"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"m", ",", 
               RowBox[{"2", "m"}], ",", "1"}], "}"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "+", "m"}], ",", 
                RowBox[{"i", "+", "m", "+", "1"}], ",", 
                RowBox[{"i", "+", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"m", "-", "1"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"2", "m"}], ",", 
               RowBox[{"m", "+", "1"}], ",", "1"}], "}"}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Q", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"InnerDisk", ",", "Collar"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Q", "=", 
        RowBox[{"ToleranceGlue", "[", 
         RowBox[{"Q", ",", "0.00000001"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "Q"}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Description", "\[Rule]", 
     "\"\<CollarDiskMesh[n] generates a meshed unit disk in R^2 with a nice \
collar for Neumann boundary conditions.\>\""}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{
  3.645368124909067*^9, {3.645368486648538*^9, 3.645368546165885*^9}, {
   3.645369247547142*^9, 3.6453693332055683`*^9}, {3.645371160841813*^9, 
   3.645371188396131*^9}, {3.6453712467439537`*^9, 3.645371285526783*^9}, {
   3.7079685628421507`*^9, 3.707968603465673*^9}, {3.715570232777516*^9, 
   3.7155702395770493`*^9}, {3.720106231780263*^9, 
   3.720106241058371*^9}},ExpressionUUID->"de83b2e9-3338-4c7b-91d6-\
fdf9c5717d4d"],

Cell[BoxData[
 RowBox[{"MoebiusStrip", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"mm_Integer", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "R", ",", "v", ",", "Cyl", ",", "\[Phi]", ",", "R0", ",", "R1", ",", 
        "R2", ",", "kk", ",", "nn", ",", "\[Alpha]", ",", "p0", ",", "p", ",",
         "fflist", ",", "\[Sigma]", ",", "q0", ",", "gglist", ",", "h", ",", 
        "F", ",", "Q0", ",", "P0", ",", "SOL", ",", "f", ",", "c", ",", "Q1", 
        ",", "P1", ",", "Q2", ",", "P2", ",", "Q3", ",", "P3", ",", "PP", ",",
         "fflist1", ",", "fflist2", ",", "fflist3", ",", "gglist1", ",", 
        "gglist2", ",", "gglist3", ",", "v2", ",", "v3", ",", "ffflist", ",", 
        "mean", ",", "M"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"R", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"v", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"R0", "=", 
        RowBox[{"RotationMatrix", "[", 
         RowBox[{
          RowBox[{"Pi", "/", "2."}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"R1", "=", 
        RowBox[{"RotationMatrix", "[", 
         RowBox[{
          RowBox[{"Pi", "/", "2."}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"R2", "=", 
        RowBox[{"RotationMatrix", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], 
           RowBox[{"Pi", "/", "3."}]}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"kk", "=", "2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"nn", "=", 
        RowBox[{"kk", " ", "mm"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Alpha]", "=", "0."}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"p0", "=", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"s", "=", 
            RowBox[{"1.", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"nn", "-", "1"}], ")"}], 
               RowBox[{
                RowBox[{"RotationMatrix", "[", 
                 RowBox[{"Pi", "/", "6."}], "]"}], "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
              ")"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Join", "@@", 
           RowBox[{"Outer", "[", "\[IndentingNewLine]", 
            RowBox[{"Plus", ",", "\[IndentingNewLine]", 
             RowBox[{"KroneckerProduct", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"0.", ",", "mm"}], "]"}], ",", 
               RowBox[{"s", " ", 
                RowBox[{"{", 
                 RowBox[{"0.", ",", "1."}], "}"}]}]}], "  ", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"KroneckerProduct", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"0.", ",", 
                 RowBox[{"nn", "-", "1"}]}], "]"}], ",", 
               RowBox[{"s", " ", 
                RowBox[{
                 RowBox[{"RotationMatrix", "[", 
                  RowBox[{"Pi", "/", "6."}], "]"}], "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", "1"}], "\[IndentingNewLine]",
             "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Pi", "+", 
             RowBox[{"2", "\[Alpha]"}]}], ")"}], "p0"}], "-", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Alpha]", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Length", "[", "p0", "]"}], "}"}]}], "]"}]}], ")"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{"p", "+", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"First", "[", "p", "]"}], "-", 
                 RowBox[{"Last", "[", "p", "]"}]}], ")"}], 
               "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "/", 
              "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "p", "]"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fflist", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"1", "+", "i", "+", 
                   RowBox[{"nn", " ", "j"}]}], ",", 
                  RowBox[{"2", "+", "i", "+", 
                   RowBox[{"nn", " ", "j"}]}], ",", 
                  RowBox[{"nn", "+", "1", "+", "i", "+", 
                   RowBox[{"nn", " ", "j"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"2", "+", "i", "+", 
                   RowBox[{"nn", " ", "j"}]}], ",", 
                  RowBox[{"nn", "+", "2", "+", "i", "+", 
                   RowBox[{"nn", " ", "j"}]}], ",", 
                  RowBox[{"nn", "+", "1", "+", "i", "+", 
                   RowBox[{"nn", " ", "j"}]}]}], "}"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", 
                RowBox[{"nn", "-", "2"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "0", ",", 
              RowBox[{"mm", "-", "1"}]}], "}"}]}], "]"}], ",", "2"}], "]"}]}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"\[Sigma]", "=", 
        RowBox[{"j", "\[Function]", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"Sum", "[", " ", 
           RowBox[{
            RowBox[{"nn", "-", "k"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "0", ",", "j"}], "}"}]}], "]"}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"s", ",", "u", ",", "w"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"s", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nn", "-", "1"}], ")"}], 
            RowBox[{
             RowBox[{"RotationMatrix", "[", 
              RowBox[{
               RowBox[{"-", "Pi"}], "/", "6."}], "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"u", "=", 
           RowBox[{
            RowBox[{"UnitVector", "[", 
             RowBox[{"2", ",", "1", ",", 
              RowBox[{"WorkingPrecision", "\[Rule]", "MachinePrecision"}]}], 
             "]"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Pi", "+", 
               RowBox[{"2", "\[Alpha]"}]}], ")"}], "/", "s"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"w", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"RotationMatrix", "[", 
              RowBox[{
               RowBox[{"-", "Pi"}], "/", "6."}], "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Pi", "+", 
               RowBox[{"2", "\[Alpha]"}]}], ")"}], "/", "s"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"q0", "=", 
           RowBox[{"Join", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", " ", "u"}], "+", 
               RowBox[{"i", " ", "w"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0.", ",", "mm"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "0.", ",", 
                RowBox[{"nn", "-", "1", "-", "i"}], ",", "1"}], "}"}]}], 
             "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"gglist", "=", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Sigma]j", ",", "\[Sigma]jm1"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Reverse", "/@", 
           RowBox[{"Join", "@@", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Sigma]j", "=", 
                RowBox[{"\[Sigma]", "[", "j", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"\[Sigma]jm1", "=", 
                RowBox[{"\[Sigma]", "[", 
                 RowBox[{"j", "-", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Append", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i", "+", "\[Sigma]jm1"}], ",", 
                    RowBox[{"1", "+", "i", "+", "\[Sigma]jm1"}], ",", 
                    RowBox[{"i", "+", "\[Sigma]j"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "+", "i", "+", "\[Sigma]jm1"}], ",", 
                    RowBox[{"\[Sigma]j", "+", "1", "+", "i"}], ",", 
                    RowBox[{"\[Sigma]j", "+", "i"}]}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"nn", "-", "2", "-", "j"}]}], "}"}]}], "]"}], ",",
                    "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Sigma]j", "-", "1"}], ",", "\[Sigma]j", ",", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"j", "+", "1"}], "]"}]}], "}"}], "}"}]}], "]"}], 
                 ",", "\[IndentingNewLine]", "1"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"j", ",", "0", ",", 
                RowBox[{"mm", "-", "1"}]}], "}"}]}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"f", "=", 
        RowBox[{"t", "\[Function]", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"c", "[", "i", "]"}], " ", 
            RowBox[{"t", "^", "i"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SOL", "=", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"f", "[", 
               RowBox[{"mm", "/", "2"}], "]"}], "==", "0"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"f", "'"}], "[", 
               RowBox[{"mm", "/", "2"}], "]"}], "==", "0"}], ",", 
             RowBox[{
              RowBox[{"f", "[", 
               RowBox[{"nn", "-", 
                RowBox[{"mm", "/", "2"}], "-", "1"}], "]"}], "==", 
              RowBox[{"2", "R"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"f", "'"}], "[", 
               RowBox[{"nn", "-", 
                RowBox[{"mm", "/", "2"}], "-", "1"}], "]"}], "==", "0"}]}], 
            "}"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"c", "[", "i", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], "]"}]}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"h", "=", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", "t", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Function", "@@", 
           RowBox[{"{", 
            RowBox[{"t", ",", 
             RowBox[{"Piecewise", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", 
                  RowBox[{"0", "<=", "t", "<=", 
                   RowBox[{"mm", "/", "2"}]}]}], " ", "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"f", "[", "t", "]"}], "/.", "SOL"}], ")"}], ",", 
                  RowBox[{
                   RowBox[{"mm", "/", "2"}], "<=", "t", "<=", 
                   RowBox[{"nn", "-", "1", "-", 
                    RowBox[{"mm", "/", "2"}]}]}]}], "}"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"2", "R"}], ",", 
                  RowBox[{
                   RowBox[{"nn", "-", 
                    RowBox[{"mm", "/", "2"}], "-", "1"}], "<=", "t", "<=", 
                   RowBox[{"nn", "-", "1"}]}]}], " ", "}"}]}], 
               "\[IndentingNewLine]", "}"}], "]"}]}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"F", "=", 
        RowBox[{"X", "\[Function]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "X", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "X", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
           RowBox[{"h", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "X", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{"\[Pi]", "+", 
                    RowBox[{"2", "\[Alpha]"}]}], ")"}]}], ")"}], "/", 
                RowBox[{"Sqrt", "[", "3", "]"}]}], ")"}]}], " ", 
             RowBox[{"(", 
              RowBox[{"nn", "-", "1"}], ")"}]}], " ", "]"}]}], "}"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Q0", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"F", "/@", "q0"}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ReflectionMatrix", "[", 
            RowBox[{"{", 
             RowBox[{"0.", ",", "1.", ",", "0."}], "}"}], "]"}], ".", 
           RowBox[{"RotationMatrix", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "Pi"}], "/", "6."}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ")"}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"P0", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"v", " ", "#2"}], ",", 
               RowBox[{"R", " ", 
                RowBox[{"Cos", "[", "#1", "]"}]}], ",", 
               RowBox[{"R", " ", 
                RowBox[{"Sin", "[", "#1", "]"}]}]}], "}"}], "]"}], "&"}], "@@", 
           RowBox[{"Transpose", "[", "p", "]"}]}], ")"}], ".", 
         RowBox[{"Transpose", "[", 
          RowBox[{"R1", ".", "R0"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Q1", "=", "Q0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"P1", "=", 
        RowBox[{"P0", "+", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Last", "[", "Q0", "]"}], "-", 
            RowBox[{"First", "[", "P0", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"Length", "[", "P0", "]"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"gglist1", "=", "gglist"}], ";", "\[IndentingNewLine]", 
       RowBox[{"fflist1", "=", 
        RowBox[{"fflist", "+", 
         RowBox[{"Length", "[", "Q0", "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"v2", "=", 
        RowBox[{
         RowBox[{"P1", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"Length", "[", "P1", "]"}], "-", 
           RowBox[{"nn", " ", "mm"}]}], "\[RightDoubleBracket]"}], "-", 
         RowBox[{"First", "[", "Q1", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"v3", "=", 
        RowBox[{
         RowBox[{"v2", ".", "R2"}], "+", "v2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Q2", "=", 
        RowBox[{
         RowBox[{"Q1", ".", "R2"}], "+", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"v2", ",", 
           RowBox[{"Length", "[", "Q1", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"P2", "=", 
        RowBox[{
         RowBox[{"P1", ".", "R2"}], "+", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"v2", ",", 
           RowBox[{"Length", "[", "P1", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"gglist2", "=", 
        RowBox[{
         RowBox[{"Reverse", "/@", "gglist"}], "+", 
         RowBox[{"Length", "[", "Q0", "]"}], "+", 
         RowBox[{"Length", "[", "P0", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fflist2", "=", 
        RowBox[{
         RowBox[{"Reverse", "/@", "fflist"}], "+", 
         RowBox[{"2", 
          RowBox[{"Length", "[", "Q0", "]"}]}], "+", 
         RowBox[{"Length", "[", "P0", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Q3", "=", 
        RowBox[{
         RowBox[{"Q1", ".", 
          RowBox[{"(", 
           RowBox[{"R2", ".", "R2"}], ")"}]}], "+", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"v3", ",", 
           RowBox[{"Length", "[", "Q1", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"P3", "=", 
        RowBox[{
         RowBox[{"P1", ".", 
          RowBox[{"(", 
           RowBox[{"R2", ".", "R2"}], ")"}]}], "+", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"v3", ",", 
           RowBox[{"Length", "[", "P1", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"gglist3", "=", 
        RowBox[{"gglist", "+", 
         RowBox[{"2", 
          RowBox[{"Length", "[", "Q0", "]"}]}], "+", 
         RowBox[{"2", 
          RowBox[{"Length", "[", "P0", "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fflist3", "=", 
        RowBox[{"fflist", "+", 
         RowBox[{"3", 
          RowBox[{"Length", "[", "Q0", "]"}]}], "+", 
         RowBox[{"2", 
          RowBox[{"Length", "[", "P0", "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PP", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
         "Q1", ",", "P1", ",", "Q2", ",", "P2", ",", "Q3", ",", "P3"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mean", "=", 
        RowBox[{"Mean", "[", "PP", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"PP", "=", 
        RowBox[{"PP", "-", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"mean", ",", 
           RowBox[{"Length", "[", "PP", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ffflist", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
         "gglist1", ",", "fflist1", ",", "gglist2", ",", "fflist2", ",", 
          "gglist3", ",", "fflist3"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ToleranceGlue", "[", 
        RowBox[{
         RowBox[{"Init", "[", 
          RowBox[{"mesh", ",", "PP", ",", "ffflist"}], "]"}], ",", 
         "0.000001"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Description", "\[Rule]", 
     "\"\<MoebiusStrip[n] generates a meshed Moebius strip in R^3.\>\""}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Public\>\"", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"\"\<Width\>\"", "\[Rule]", "1."}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.630792232415444*^9, 3.63079241300308*^9}, {
   3.630792468483878*^9, 3.630792719495352*^9}, {3.630793169176141*^9, 
   3.6307931807989683`*^9}, {3.630928374651874*^9, 3.6309283752124557`*^9}, {
   3.630933184070017*^9, 3.63093318488971*^9}, {3.6320621819896307`*^9, 
   3.632062284383649*^9}, {3.632062321785874*^9, 3.632062337886148*^9}, {
   3.63206246570779*^9, 3.632062477990923*^9}, {3.632062631360539*^9, 
   3.632062641937737*^9}, {3.632217071047448*^9, 3.632217103587668*^9}, {
   3.632217210737775*^9, 3.632217239551093*^9}, 3.632217284261664*^9, {
   3.632217323950507*^9, 3.6322173387730217`*^9}, {3.632731905881394*^9, 
   3.632732016008236*^9}, {3.632732214252681*^9, 3.632732214277192*^9}, 
   3.6327420803767633`*^9, {3.632770420553384*^9, 3.6327704277435617`*^9}, {
   3.635790357007154*^9, 3.6357903580920143`*^9}, {3.638844407164033*^9, 
   3.638844500899663*^9}, 3.645691964771452*^9, {3.6663395697729177`*^9, 
   3.666339649060936*^9}, {3.66634058537709*^9, 3.666340615062484*^9}, {
   3.707968622684045*^9, 3.707968622881748*^9}, {3.715569654319577*^9, 
   3.715569662605959*^9}, {3.823573661609799*^9, 3.823573667400926*^9}, {
   3.823578374352737*^9, 3.823578493782522*^9}, {3.823578535997781*^9, 
   3.823578551267168*^9}, {3.841062227316373*^9, 
   3.841062227452468*^9}},ExpressionUUID->"36efd3cd-b2c6-4d69-8868-\
2412c8a7b8f3"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"getGridTriangles", "=", 
   RowBox[{"CPackageFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", "_Integer"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "_Integer"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"a1", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"m", "+", "1"}], ")"}], 
               RowBox[{"(", 
                RowBox[{"j", "-", "1"}], ")"}]}], "+", "i"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"a2", "=", 
             RowBox[{"a1", "+", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"a3", "=", 
             RowBox[{"a1", "+", "m", "+", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"a4", "=", 
             RowBox[{"a3", "+", "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a1", ",", "a2", ",", "a4"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"a1", ",", "a4", ",", "a3"}], "}"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "m"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "2"}], 
        "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{3.675685659140189*^9, 
  3.7200975573189373`*^9},ExpressionUUID->"5aba9bbf-4e2e-40bf-84e8-\
896e9a9389fe"],

Cell[BoxData[
 RowBox[{"getRectangleTriangles", "=", 
  RowBox[{"CPackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "_Integer"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "_Integer"}], "}"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"a1", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "+", "1"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}]}], "+", "i"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"a2", "=", 
            RowBox[{"a1", "+", "1"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"a3", "=", 
            RowBox[{"a1", "+", "m", "+", "1"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"a4", "=", 
            RowBox[{"a3", "+", "1"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"a1", ",", "a2", ",", "a4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"a1", ",", "a4", ",", "a3"}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "m"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", "2"}], 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.675680714254348*^9, 3.675680792148694*^9}, {
   3.6756808643302937`*^9, 3.675680903859877*^9}, {3.675680954233671*^9, 
   3.6756810319675007`*^9}, {3.675681133979508*^9, 3.675681141868232*^9}, 
   3.675681239905162*^9, {3.675681300652028*^9, 3.675681302084401*^9}, {
   3.675685566459478*^9, 3.675685572746726*^9}, {3.675685628894113*^9, 
   3.6756856532552147`*^9}, {3.67569097077871*^9, 3.6756909807865257`*^9}, {
   3.67569103407931*^9, 3.675691042894505*^9}, 
   3.720097558370216*^9},ExpressionUUID->"facbe6de-5352-4d5b-b5c3-\
c81d66cd4883"],

Cell[BoxData[
 RowBox[{"RectangleMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"r_", ",", "s_"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mm", ",", "nn"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mm", ",", "nn"}], "}"}], "=", 
        RowBox[{"OptionValue", "[", "\"\<Mesh\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Init", "[", 
        RowBox[{"mesh", ",", "\[IndentingNewLine]", 
         RowBox[{"getGridPoints", "[", 
          RowBox[{
          "0.", ",", "r", ",", "0.", ",", "s", ",", "mm", ",", "nn", ",", 
           "False", ",", "False"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"getGridTriangles", "[", 
          RowBox[{"mm", ",", "nn", ",", "False", ",", "False"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<InputType\>\"", "\[Rule]", "None"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Caching\>\"", "\[Rule]", "False"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
    "\"\<Description\>\"", "\[Rule]", 
     "\"\<RectangleMesh[r,s] generates a meshed rectangle in R^3 with edge \
lengths r and s. You can specify the subdivisions of the grid by using the \
Mesh option.\>\""}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Public\>\"", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Options\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Mesh\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"5", ",", "5"}], "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.635790454520939*^9, 3.635790465589239*^9}, {
   3.6357905038812933`*^9, 3.635790545428344*^9}, {3.635790599511429*^9, 
   3.635790613789729*^9}, 3.635791190432603*^9, {3.635791795613212*^9, 
   3.6357918409880238`*^9}, {3.635792692862647*^9, 3.63579272053351*^9}, {
   3.63579275829245*^9, 3.635792766012616*^9}, 3.636106757986404*^9, 
   3.645691965582129*^9, {3.675690650478999*^9, 3.6756906659912043`*^9}, {
   3.6756908654544687`*^9, 3.675690867692384*^9}, {3.675690960155653*^9, 
   3.675690962843771*^9}, {3.675690998862073*^9, 3.67569100146765*^9}, {
   3.6756911404852333`*^9, 3.6756911425176153`*^9}, {3.675692548175165*^9, 
   3.675692552583078*^9}, {3.6756930370138483`*^9, 3.675693051146309*^9}, 
   3.6757060864410887`*^9, {3.699779520356493*^9, 3.699779534283577*^9}, 
   3.720097560905045*^9},ExpressionUUID->"002a69a4-b0ae-4b1c-8a9b-\
a662b09b3569"],

Cell[BoxData[
 RowBox[{"SquareMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"mm", ",", "nn", ",", "r", ",", "c"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c", "=", 
        RowBox[{"OptionValue", "[", "\"\<Center\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"OptionValue", "[", "\"\<EdgeLength\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"mm", ",", "nn"}], "}"}], "=", 
        RowBox[{"OptionValue", "[", "\"\<Mesh\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Init", "[", 
        RowBox[{"mesh", ",", "\[IndentingNewLine]", 
         RowBox[{"getGridPoints", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
            
            RowBox[{"0.5", " ", "r"}]}], ",", 
           RowBox[{
            RowBox[{
            "c", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
            
            RowBox[{"0.5", " ", "r"}]}], ",", 
           RowBox[{
            RowBox[{
            "c", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "-", 
            
            RowBox[{"0.5", " ", "r"}]}], ",", 
           RowBox[{
            RowBox[{
            "c", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "+", 
            
            RowBox[{"0.5", "r"}]}], ",", "mm", ",", "nn", ",", "False", ",", 
           "False"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"getGridTriangles", "[", 
          RowBox[{"mm", ",", "nn", ",", "False", ",", "False"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
    "\"\<Description\>\"", "\[Rule]", 
     "\"\<SquareMesh[n,r] generates a meshed rectangle in R^3 with edge \
length r. You can specify the subdivisions of the grid by using the Mesh \
option.\>\""}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Mesh\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"5", ",", "5"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<EdgeLength\>\"", "\[Rule]", "1."}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Center\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0.", ",", "0.", ",", "0."}], "}"}]}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.635790371142777*^9, 3.635790450811467*^9}, {
   3.635790663238574*^9, 3.6357906646183863`*^9}, {3.6357907144221573`*^9, 
   3.6357907238915157`*^9}, {3.6357907542323923`*^9, 3.635790755700457*^9}, 
   3.635790790160245*^9, {3.662655831123774*^9, 3.662655834084752*^9}, {
   3.699779539258223*^9, 3.699779559601438*^9}, {3.706522974532576*^9, 
   3.70652300911973*^9}, 3.706523052136683*^9, 3.720097561969329*^9, {
   3.752251611010488*^9, 3.752251733637154*^9}, {3.7522517918810577`*^9, 
   3.752251794744391*^9}, 3.752251825270946*^9, {3.7522518846689997`*^9, 
   3.75225188528973*^9}},
 CellLabel->
  "In[983]:=",ExpressionUUID->"cd650940-2af8-4e48-8baa-61f00e437cdf"],

Cell[BoxData[
 RowBox[{"TorusMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"R0_", ",", "r0_"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Q", ",", "m", ",", "n", ",", "pts", ",", "faces", ",", 
        "\[CapitalPhi]", ",", "M"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}], "=", 
        RowBox[{"OptionValue", "[", "\"\<Mesh\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalPhi]", "=", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"R", "=", "R0"}], ",", 
            RowBox[{"r", "=", "r0"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"X", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"X", ",", "1"}], "]"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"R", "+", 
                 RowBox[{"r", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"X", ",", "2"}], "]"}], "]"}]}]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"X", ",", "1"}], "]"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"R", "+", 
                 RowBox[{"r", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"X", ",", "2"}], "]"}], "]"}]}]}], ")"}]}], ",", 
              RowBox[{"r", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"X", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Parallelization", "\[Rule]", "True"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"pts", "=", 
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"getGridPoints", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"2", "Pi"}], ",", "0.", ",", 
           RowBox[{"2", "Pi"}], ",", "m", ",", "n", ",", "True", ",", 
           "True"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"faces", "=", 
        RowBox[{"getGridTriangles", "[", 
         RowBox[{"m", ",", "n", ",", "True", ",", "True"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"Init", "[", 
         RowBox[{"mesh", ",", "pts", ",", "faces"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<Texture\>\"", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Q", "=", 
           RowBox[{"Init", "[", 
            RowBox[{"mesh", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"getGridPoints", "[", 
               RowBox[{
               "0.", ",", "1.", ",", "0.", ",", "1.", ",", "m", ",", "n", ",",
                 "False", ",", "False"}], "]"}], "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", 
               RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"getGridTriangles", "[", 
              RowBox[{"m", ",", "n", ",", "False", ",", "False"}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"SetTextureMesh", "[", 
           RowBox[{"M", ",", "Q"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"SetTexture", "[", 
           RowBox[{"M", ",", 
            RowBox[{"GridTexture", "[", 
             RowBox[{
              RowBox[{"Mesh", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"5", ",", "5"}], "}"}]}], ",", 
              RowBox[{"Thickness", "\[Rule]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], "0.0005"}]}]}], "]"}]}], 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "M"}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Description", "\[Rule]", 
     "\"\<TorusMesh[r1,r2] computes a meshed Torus with radii r1 and r2. You \
can specify the subdivisions of the grid by using the Mesh option.\>\""}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Mesh\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"30", ",", "18"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<Texture\>\"", "\[Rule]", "False"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6357932035772543`*^9, 3.635793242760022*^9}, {
   3.64265279714878*^9, 3.6426528249321613`*^9}, {3.666339627938909*^9, 
   3.6663396323526373`*^9}, {3.67570613069315*^9, 3.675706204920302*^9}, {
   3.699779527252644*^9, 3.6997795302911797`*^9}, {3.718287838494611*^9, 
   3.7182879288075666`*^9}, {3.7182879608634033`*^9, 3.718287982067876*^9}, 
   3.72009756296054*^9, {3.758282342366214*^9, 3.758282432751528*^9}, {
   3.758282514703899*^9, 3.758282514911767*^9}, 3.758282919601919*^9, {
   3.758786575691263*^9, 3.75878657747375*^9}, {3.776708118157836*^9, 
   3.776708142523546*^9}, {3.788672995688308*^9, 3.78867299903239*^9}, {
   3.792042701816806*^9, 3.7920427259590683`*^9}, {3.7927455349330873`*^9, 
   3.792745578626545*^9}, {3.792745626618466*^9, 3.792745629121129*^9}, {
   3.7927467050162783`*^9, 3.792746705550233*^9}, {3.829385411812667*^9, 
   3.8293854132333403`*^9}, {3.843564089950632*^9, 3.8435641002770348`*^9}, {
   3.843564135908683*^9, 3.843564178178463*^9}, {3.8435642840131474`*^9, 
   3.843564290390272*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"69d44c90-6300-4dbf-892b-2343f0088fa9"],

Cell[BoxData[
 RowBox[{"CliffordTorusMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"TorusMesh", "[", 
     RowBox[{
      RowBox[{"1.", "+", 
       RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "1.", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Mesh\>\"", "\[Rule]", 
       RowBox[{"OptionValue", "[", "\"\<Mesh\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Texture\>\"", "\[Rule]", 
       RowBox[{"OptionValue", "[", "\"\<Texture\>\"", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Mesh\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"30", ",", "18"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<Texture\>\"", "\[Rule]", "False"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[56]:=",ExpressionUUID->"8a0c47c0-ce47-40d6-947f-bddd39c2db7c"],

Cell[BoxData[
 RowBox[{"IrregularTorusMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"R0_", ",", "r0_"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "m", ",", "n", ",", "\[CapitalPhi]", ",", "xscale", ",", "inst", ",", 
        "bndr", ",", "s", ",", "outInst", ",", "M", ",", "Q"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}], "=", 
        RowBox[{"OptionValue", "[", "\"\<Mesh\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"xscale", "=", 
        RowBox[{"N", "[", 
         RowBox[{"R0", "/", "r0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bndr", "=", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Most", "[", 
           RowBox[{"Subdivide", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.", ",", "0."}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"xscale", " ", ",", "0."}], "}"}], ",", "m"}], "]"}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Most", "[", 
           RowBox[{"Subdivide", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"xscale", ",", "0."}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"xscale", ",", "1."}], "}"}], ",", "n"}], "]"}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Most", "[", 
           RowBox[{"Subdivide", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"xscale", ",", "1."}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.", ",", "1."}], "}"}], ",", "m"}], "]"}], "]"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"Most", "[", 
           RowBox[{"Subdivide", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.", ",", "1."}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0.", ",", "0."}], "}"}], ",", "n"}], "]"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalPhi]", "=", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"R", "=", "R0"}], ",", 
            RowBox[{"r", "=", "r0"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"X", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"X", ",", "1"}], "]"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"R", "+", 
                 RowBox[{"r", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"X", ",", "2"}], "]"}], "]"}]}]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"X", ",", "1"}], "]"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"R", "+", 
                 RowBox[{"r", " ", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"X", ",", "2"}], "]"}], "]"}]}]}], ")"}]}], ",", 
              RowBox[{"r", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"Compile`GetElement", "[", 
                 RowBox[{"X", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Parallelization", "\[Rule]", "True"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"inst", "=", 
        RowBox[{"TriangleCreate", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"TriangleSetPoints", "[", 
        RowBox[{"inst", ",", "bndr"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"TriangleSetSegments", "[", 
        RowBox[{"inst", ",", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "bndr", "]"}], "]"}], ",", "2", ",", "1", 
           ",", "1"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"s", "=", 
        RowBox[{"ToString", "[", 
         RowBox[{"DecimalForm", "[", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"xscale", "/", "m"}], "/", "n"}], "/", "2"}], "]"}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"outInst", "=", 
        RowBox[{"TriangleTriangulate", "[", " ", 
         RowBox[{"inst", ",", " ", 
          RowBox[{"\"\<pqa\>\"", "<>", "s", "<>", "\"\<YY\>\""}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Q", "=", 
        RowBox[{"Init", "[", 
         RowBox[{"mesh", ",", "\[IndentingNewLine]", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{"x", "\[Function]", 
             RowBox[{
              RowBox[{"x", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1.", "/", "xscale"}], ",", "1"}], "}"}]}], "+", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "/", "2"}], ",", 
                RowBox[{
                 RowBox[{"-", "1"}], "/", "4"}]}], "}"}]}]}], ",", 
            RowBox[{"TriangleGetPoints", "[", "outInst", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TriangleGetElements", "[", "outInst", "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"Init", "[", 
         RowBox[{"mesh", ",", 
          RowBox[{"\[CapitalPhi]", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2.", "Pi"}], ")"}], " ", 
            RowBox[{"VertexCoordinates", "[", "Q", "]"}]}], "]"}], ",", 
          RowBox[{"Triangles", "[", "Q", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"ToleranceGlue", "[", 
         RowBox[{"M", ",", 
          RowBox[{"0.25", " ", 
           RowBox[{"Min", "[", 
            RowBox[{"EdgeLengths", "[", "M", "]"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<Texture\>\"", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"SetTextureMesh", "[", 
           RowBox[{"M", ",", "Q"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"SetTexture", "[", 
           RowBox[{"M", ",", 
            RowBox[{"GridTexture", "[", 
             RowBox[{
              RowBox[{"Mesh", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"5", ",", "5"}], "}"}]}], ",", 
              RowBox[{"Thickness", "\[Rule]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], "0.0005"}]}]}], "]"}]}], 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "M"}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Description", "\[Rule]", 
     "\"\<IrregularTorusMesh[r1,r2] computes a meshed Torus with radii r1 and \
r2. You can specify the subdivisions of the grid by using the Mesh \
option.\>\""}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Mesh\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"36", ",", "18"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<Texture\>\"", "\[Rule]", "False"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.8293854189263973`*^9, {3.829722802314369*^9, 3.82972280889924*^9}, {
   3.829722845697013*^9, 3.829722847647421*^9}, {3.8297230117463703`*^9, 
   3.829723012800935*^9}, {3.829723146805468*^9, 3.82972316889878*^9}, {
   3.829723208197118*^9, 3.829723219848757*^9}, {3.829730013942923*^9, 
   3.8297300175333*^9}},ExpressionUUID->"4ebe46f9-e1b0-4242-8f4d-\
77b0bfa10946"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ImplicitTorusMesh", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"R_", ",", "r_", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"ToMesh", "@", 
        RowBox[{"BoundaryDiscretizeRegion", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ImplicitRegion", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Sqrt", "[", 
                  RowBox[{
                   RowBox[{"x", "^", "2"}], "+", 
                   RowBox[{"y", "^", "2"}]}], "]"}], "-", "R"}], ")"}], "^", 
               "2"}], "+", 
              RowBox[{"z", "^", "2"}]}], "\[LessEqual]", 
             RowBox[{"r", "^", "2"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{
                 RowBox[{"-", "1.1"}], 
                 RowBox[{"(", 
                  RowBox[{"R", "+", "r"}], ")"}]}], ",", 
                RowBox[{"1.1", 
                 RowBox[{"(", 
                  RowBox[{"R", "+", "r"}], ")"}]}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{
                 RowBox[{"-", "1.1"}], 
                 RowBox[{"(", 
                  RowBox[{"R", "+", "r"}], ")"}]}], ",", 
                RowBox[{"1.1", 
                 RowBox[{"(", 
                  RowBox[{"R", "+", "r"}], ")"}]}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"z", ",", 
                RowBox[{
                 RowBox[{"-", "1.1"}], 
                 RowBox[{"(", "r", ")"}]}], ",", 
                RowBox[{"1.1", 
                 RowBox[{"(", "r", ")"}]}]}], "}"}]}], "\[IndentingNewLine]", 
             "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
          "\[IndentingNewLine]", "opts"}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellLabel->"In[84]:=",ExpressionUUID->"8f9e4210-b039-4432-8ce7-d35e72132988"],

Cell[BoxData[
 RowBox[{"HoledCubeMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "a", ",", "r", ",", "h", ",", "m", ",", "n", ",", "p", ",", "inst", 
        ",", "outInst", ",", "p1", ",", "p2", ",", "edges", ",", "triangles", 
        ",", "pts"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", "=", 
        RowBox[{"OptionValue", "[", "\"\<BoxEdgeLength\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<InnerRadius\>\"", "]"}], ",", 
          "a"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"h", "=", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<MaxEdgeLength\>\"", "]"}], ",", 
          RowBox[{"a", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"Ceiling", "[", 
         RowBox[{"2.", "/", "h"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"m", "=", 
        RowBox[{"Ceiling", "[", 
         RowBox[{"2", "Pi", " ", 
          RowBox[{"r", "/", "h"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{"Most", "[", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ConstantArray", "[", 
             RowBox[{"1.", ",", 
              RowBox[{"n", "+", "1"}]}], "]"}], ",", 
            RowBox[{"Subdivide", "[", 
             RowBox[{
              RowBox[{"-", "1."}], ",", "1.", ",", "n"}], "]"}]}], "}"}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"p", ",", 
          RowBox[{"p", ".", 
           RowBox[{"RotationMatrix", "[", 
            RowBox[{
             RowBox[{"-", "Pi"}], "/", "2"}], "]"}]}], ",", 
          RowBox[{"p", ".", 
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"-", "Pi"}], "]"}]}], ",", 
          RowBox[{"p", ".", 
           RowBox[{"RotationMatrix", "[", 
            RowBox[{
             RowBox[{"-", "3"}], " ", 
             RowBox[{"Pi", "/", "2"}]}], "]"}]}], ",", 
          RowBox[{"CirclePoints", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0."}], "}"}], ",", "m"}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"edges", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", 
              RowBox[{"4", "n"}]}], "]"}], ",", "2", ",", "1", ",", "1"}], 
           "]"}], ",", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"4", "n"}], "+", "1"}], ",", 
              RowBox[{
               RowBox[{"4", "n"}], "+", "m"}]}], "]"}], ",", "2", ",", "1", 
            ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"inst", "=", 
        RowBox[{"TriangleCreate", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"TriangleSetPoints", "[", 
        RowBox[{"inst", ",", "p"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"TriangleSetSegments", "[", 
        RowBox[{"inst", ",", "edges"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"TriangleSetHoles", "[", 
        RowBox[{"inst", ",", " ", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"0.", ",", "0."}], "}"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"outInst", "=", 
        RowBox[{"TriangleTriangulate", "[", " ", 
         RowBox[{"inst", ",", " ", 
          RowBox[{"\"\<pqa\>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"h", "^", "2"}], "]"}], "<>", "\"\<Y\>\""}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p1", ",", "p2"}], "}"}], "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"TriangleGetPoints", "[", "outInst", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pts", "=", 
        RowBox[{"Join", "@@", 
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ConstantArray", "[", 
                RowBox[{"1.", ",", 
                 RowBox[{"{", 
                  RowBox[{"Length", "[", "p1", "]"}], "}"}]}], "]"}], ",", 
               "p1", ",", "p2"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"p1", ",", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"1.", ",", 
                 RowBox[{"{", 
                  RowBox[{"Length", "[", "p1", "]"}], "}"}]}], "]"}], ",", 
               "p2"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"p1", ",", "p2", ",", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{"1.", ",", 
                 RowBox[{"{", 
                  RowBox[{"Length", "[", "p1", "]"}], "}"}]}], "]"}]}], "}"}],
              ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"ConstantArray", "[", 
                RowBox[{
                 RowBox[{"-", "1."}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Length", "[", "p1", "]"}], "}"}]}], "]"}], ",", 
               "p1", ",", "p2"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"p1", ",", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{
                 RowBox[{"-", "1."}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Length", "[", "p1", "]"}], "}"}]}], "]"}], ",", 
               "p2"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"p1", ",", "p2", ",", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{
                 RowBox[{"-", "1."}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Length", "[", "p1", "]"}], "}"}]}], "]"}]}], 
              "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ToleranceGlue", "[", 
        RowBox[{
         RowBox[{"Init", "[", 
          RowBox[{"mesh", ",", "pts", ",", 
           RowBox[{"Join", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"TriangleGetElements", "[", "outInst", "]"}], "+", 
               RowBox[{"i", " ", 
                RowBox[{"Length", "[", "p1", "]"}]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}]}]}], "]"}], 
         ",", 
         RowBox[{"h", "/", "100."}]}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<MaxEdgeLength\>\"", "\[Rule]", "0.05"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<InnerRadius\>\"", "\[Rule]", "0.5"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<BoxEdgeLength\>\"", "\[Rule]", "2."}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.795247555791772*^9, 3.7952475699232607`*^9}, {
  3.7954365407710953`*^9, 3.7954365437782383`*^9}},
 CellLabel->
  "In[805]:=",ExpressionUUID->"a8d0ff82-2863-42cf-9ed7-cf144efec20a"],

Cell[BoxData[
 RowBox[{"SimonMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"subd0_:", "2"}], ",", 
      RowBox[{"subd_:", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "k", ",", "m", ",", "n", ",", "S", ",", "\[Gamma]", ",", "X", ",", 
        "XX", ",", "\[CapitalPhi]", ",", "\[CapitalPsi]1", ",", 
        "\[CapitalPsi]2", ",", "r", ",", "cut", ",", "t"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"k", "=", "3"}], ";", "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"2", "/", "3"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"XX", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Indexed", "[", 
           RowBox[{"X", ",", "1"}], "]"}], ",", 
          RowBox[{"Indexed", "[", 
           RowBox[{"X", ",", "2"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]", "=", 
        RowBox[{"t", "\[Function]", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cos", "[", "t", "]"}], ",", 
             RowBox[{"Sin", "[", "t", "]"}]}], "}"}], "+", 
           RowBox[{"r", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"k", " ", "t"}], "]"}], ",", 
              RowBox[{"Sin", "[", 
               RowBox[{"k", " ", "t"}], "]"}]}], "}"}]}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cut", "=", 
        RowBox[{"t", "/.", 
         RowBox[{
          RowBox[{"NSolve", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]", "[", "t", "]"}], "\[LeftDoubleBracket]",
                   "2", "\[RightDoubleBracket]"}], ",", "t"}], "]"}], 
               "\[Equal]", "0"}], ",", 
              RowBox[{"0", "\[LessEqual]", "t", "\[LessEqual]", "Pi"}]}], 
             "}"}], ",", "t"}], "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"{", 
           RowBox[{"1", ",", "3"}], "}"}], "\[RightDoubleBracket]"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"\[CapitalPhi]", "=", 
        RowBox[{"X", "\[Function]", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Gamma]", "[", 
              RowBox[{
              "XX", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Gamma]", "[", 
               RowBox[{
               "XX", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}], "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
              "XX", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Gamma]", "[", 
               RowBox[{
               "XX", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}], "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             
             RowBox[{"Sin", "[", 
              RowBox[{
              "XX", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "]"}]}]}], "\[IndentingNewLine]", "}"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalPsi]1", "=", 
        RowBox[{"X", "\[Function]", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Gamma]", "[", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"XX", ".", "XX"}], "]"}], "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Gamma]", "[", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"XX", ".", "XX"}], "]"}], "]"}], 
              "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"ArcTan", "@@", "XX"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Gamma]", "[", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"XX", ".", "XX"}], "]"}], "]"}], 
              "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             RowBox[{"Sin", "[", 
              RowBox[{"ArcTan", "@@", "XX"}], "]"}]}]}], 
           "\[IndentingNewLine]", "}"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalPsi]2", "=", 
        RowBox[{"X", "\[Function]", 
         RowBox[{"Evaluate", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Gamma]", "[", 
              RowBox[{"Pi", "-", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"XX", ".", "XX"}], "]"}]}], "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Gamma]", "[", 
               RowBox[{"Pi", "-", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{"XX", ".", "XX"}], "]"}]}], "]"}], 
              "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"ArcTan", "@@", "XX"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Gamma]", "[", 
               RowBox[{"Pi", "-", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{"XX", ".", "XX"}], "]"}]}], "]"}], 
              "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             RowBox[{"Sin", "[", 
              RowBox[{"ArcTan", "@@", "XX"}], "]"}]}]}], 
           "\[IndentingNewLine]", "}"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}], "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", "6"}], "}"}], " ", 
          RowBox[{"2", "^", 
           RowBox[{"(", 
            RowBox[{"1", "+", "subd0"}], ")"}]}]}], "+", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"S", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"x", "\[Function]", 
           RowBox[{
            RowBox[{
            "cut", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            RowBox[{"x", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}]}]}], ",", 
          RowBox[{"RegularDiskMesh", "[", 
           RowBox[{"1", "+", "subd0"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"36", ",", "72"}], "}"}], "2"}], "+", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"S", "=", 
          RowBox[{"DiskMesh", "[", 
           RowBox[{
            RowBox[{"n", "-", "1"}], ",", 
            RowBox[{"\"\<Radius\>\"", "\[Rule]", 
             RowBox[{
             "cut", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ",", 
            RowBox[{"\"\<SubdivisionFactor\>\"", "\[Rule]", "0.8"}]}], 
           "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Subdivide", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ToleranceGlue", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Join", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{"\[CapitalPsi]1", ",", "S"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Init", "[", 
              RowBox[{"mesh", ",", 
               RowBox[{"Map", "[", 
                RowBox[{"\[CapitalPsi]2", ",", 
                 RowBox[{"VertexCoordinates", "[", "S", "]"}]}], "]"}], ",", 
               RowBox[{"Reverse", "/@", 
                RowBox[{"Triangles", "[", "S", "]"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Init", "[", 
              RowBox[{"mesh", ",", "\[IndentingNewLine]", 
               RowBox[{"Map", "[", "\[IndentingNewLine]", 
                RowBox[{"\[CapitalPhi]", ",", "\[IndentingNewLine]", 
                 RowBox[{"getGridPoints", "[", 
                  RowBox[{
                   RowBox[{
                   "cut", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{
                   "cut", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"-", "Pi"}], ",", 
                   RowBox[{"N", "[", "Pi", "]"}], ",", "m", ",", "n", ",", 
                   "False", ",", "True"}], "]"}]}], "\[IndentingNewLine]", 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"getGridTriangles", "[", 
                RowBox[{"m", ",", "n", ",", "False", ",", "True"}], "]"}]}], 
              "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
           ",", "\[IndentingNewLine]", "0.00000001"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<Subdivisions\>\"", "\[Rule]", "subd"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.748369441216416*^9, 3.7483694413712273`*^9}, {
  3.748369883875523*^9, 3.748369885799952*^9}, {3.758458182779723*^9, 
  3.7584582208925667`*^9}, {3.758458253443343*^9, 3.758458259698311*^9}, {
  3.75845830193753*^9, 3.7584583454966927`*^9}, {3.7584634880881643`*^9, 
  3.758463604433566*^9}, {3.758463735530951*^9, 3.75846376584811*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"6601e01d-6081-4493-91cd-900ba08dab75"],

Cell[BoxData[
 RowBox[{"SphereMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"s_Integer", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"R", ",", "P", ",", "fflist", ",", "M", ",", "r"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "=", 
        RowBox[{"OptionValue", "[", "\"\<Radius\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"R", "=", 
        RowBox[{"RegionBoundary", "[", 
         RowBox[{"PolyhedronData", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "\"\<Polyhedron\>\"", "]"}], ",", 
           "\"\<MeshRegion\>\""}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"P", "=", 
        RowBox[{"cNormalize3", "[", 
         RowBox[{"MeshCoordinates", "[", "R", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fflist", "=", 
        RowBox[{"ToPack", "[", 
         RowBox[{
          RowBox[{"MeshCells", "[", 
           RowBox[{"R", ",", "2"}], "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"Init", "[", 
         RowBox[{"mesh", ",", "P", ",", "fflist"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"M", "=", 
           RowBox[{"Subdivide", "[", 
            RowBox[{"M", ",", 
             RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", 
              RowBox[{"OptionValue", "[", "\"\<MultiGrid\>\"", "]"}]}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"SetVertexCoordinates", "[", 
           RowBox[{"M", ",", 
            RowBox[{"r", " ", 
             RowBox[{"cNormalize3", "[", 
              RowBox[{"VertexCoordinates", "[", "M", "]"}], "]"}]}]}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "s", "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "M"}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Description", "\[Rule]", 
     "\"\<SphereMesh[s] computes the s-fold Buckminster subdivision of the \
icosahedron. Approximates the unit sphere for s\[Rule]\[Infinity]\>\""}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<Radius\>\"", "\[Rule]", "1."}], ",", 
       RowBox[{"\"\<Polyhedron\>\"", "\[Rule]", "\"\<Icosahedron\>\""}], ",", 
       
       RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", "False"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.63223263844561*^9, 3.632232696417294*^9}, {
   3.632732023021899*^9, 3.6327320403138237`*^9}, 3.6327322142851753`*^9, {
   3.6357932638785467`*^9, 3.6357932933281727`*^9}, {3.64569193681532*^9, 
   3.6456919661162024`*^9}, {3.692871695805414*^9, 3.6928717882146482`*^9}, {
   3.6928720984595013`*^9, 3.692872098626597*^9}, {3.695618256645948*^9, 
   3.695618269828205*^9}, {3.707968642589265*^9, 3.7079686482932262`*^9}, {
   3.71556967595428*^9, 3.71556969246593*^9}, {3.715569778038022*^9, 
   3.715569812780778*^9}, {3.71556988610325*^9, 3.715569992443719*^9}, {
   3.715570143807979*^9, 3.715570171407803*^9}, {3.718685444326571*^9, 
   3.718685444756013*^9}, 3.719479032425473*^9, {3.719479109226905*^9, 
   3.7194791119851093`*^9}, 3.7200974881730127`*^9, {3.724951584416164*^9, 
   3.724951609732753*^9}, {3.724958101102375*^9, 3.7249581044423723`*^9}, 
   3.7302158408424587`*^9, {3.77767525297373*^9, 
   3.777675253244172*^9}},ExpressionUUID->"8c6a9d9e-e0bb-4207-98f3-\
486487b51e6e"],

Cell[BoxData[
 RowBox[{"FigureEightMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"n_", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pts", ",", "M", ",", "spline"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"pts", "=", 
         RowBox[{"VertexCoordinates", "[", 
          RowBox[{"KnotDataPolygon", "[", "\"\<FigureEight\>\"", "]"}], 
          "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"pts", "=", 
         RowBox[{"Mean", "/@", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"KnotData", "[", 
              RowBox[{"\"\<FigureEight\>\"", ",", "\"\<Image\>\""}], "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1", ",", "1", ",", "1"}], 
             "\[RightDoubleBracket]"}], ",", "12"}], "]"}]}]}], ";"}], "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"M", "=", 
         RowBox[{"SpanSurface", "[", 
          RowBox[{"Most", "@", "pts"}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pts", "=", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"data", "=", 
            RowBox[{
            "DataPaclets`KnotDataDump`RawKnotData", "[", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"KnotData", "[", 
               RowBox[{
               "\"\<FigureEight\>\"", ",", "\"\<AlexanderBriggsList\>\""}], 
               "]"}], ",", "\"\<GraphicsData\>\""}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "data", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ".", 
           RowBox[{"DiagonalMatrix", "[", 
            RowBox[{
            "data", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"spline", "=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"data", "=", 
            RowBox[{"List", "@@", 
             RowBox[{"BSplineFunction", "[", "\[IndentingNewLine]", 
              RowBox[{"pts", ",", "\[IndentingNewLine]", 
               RowBox[{"SplineClosed", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"SplineDegree", "\[Rule]", "3"}]}], 
              "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "data", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "*=", 
            RowBox[{"2.", "Pi"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "data", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}], "*=", 
            RowBox[{"2.", "Pi"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"BSplineFunction", "@@", "data"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"SpanSurface", "[", 
         RowBox[{"spline", ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<BoundarySubdivisions\>\"", "\[Rule]", 
           RowBox[{
           "OptionValue", "[", "\"\<BoundarySubdivisions\>\"", "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"Orient", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Subdivide", "[", 
        RowBox[{"M", ",", 
         RowBox[{"\"\<Subdivisions\>\"", "\[Rule]", "n"}], ",", 
         RowBox[{"Method", "\[Rule]", "\"\<Loop\>\""}], ",", 
         RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", 
          RowBox[{"OptionValue", "[", "\"\<MultiGrid\>\"", "]"}]}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", "False"}], ",", 
       RowBox[{"\"\<BoundarySubdivisions\>\"", "\[Rule]", "2"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{
  3.632232650182094*^9, 3.637240414168754*^9, 3.6372404552560387`*^9, {
   3.695618249861116*^9, 3.6956182531478443`*^9}, {3.7176487758644257`*^9, 
   3.717648778214951*^9}, {3.718990334042119*^9, 3.7189903431199827`*^9}, {
   3.718992174232943*^9, 3.718992175824046*^9}, {3.724958108306748*^9, 
   3.724958133506068*^9}, {3.729166036073422*^9, 3.729166071937264*^9}, {
   3.729595145480356*^9, 3.7295951467937927`*^9}, {3.7295952247754087`*^9, 
   3.729595234775508*^9}, {3.729595343099739*^9, 3.729595365656311*^9}, {
   3.730105712283679*^9, 3.730105725172331*^9}, {3.7301058080311832`*^9, 
   3.7301058362768717`*^9}, {3.730105889241869*^9, 3.7301058894387627`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"1c9fae79-ad2a-4707-aba8-915170a3fe4e"],

Cell[BoxData[
 RowBox[{"CylinderMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"radius_", ",", "height_"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M", ",", "m", ",", "n", ",", "circumference", ",", "R"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"circumference", "=", 
        RowBox[{"2", "Pi", " ", "radius"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<Mesh\>\"", "]"}], "===", 
          "Automatic"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"grid", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Floor", "[", 
                RowBox[{"2", "Pi", " ", 
                 RowBox[{"radius", "/", "height"}]}], "]"}], " ", "11"}], ",",
               "10"}], "}"}]}], ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"height", ">", "circumference"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"m", ",", "n"}], "}"}], "=", 
             RowBox[{"{", 
              RowBox[{"17", ",", 
               RowBox[{
                RowBox[{"16", 
                 RowBox[{"Ceiling", "[", 
                  RowBox[{"height", "/", "circumference"}], "]"}]}], " ", "+",
                 "1"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"m", ",", "n"}], "}"}], "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Floor", "[", 
                  RowBox[{"circumference", "/", "height"}], "]"}], " ", 
                 "16"}], "+", "1"}], ",", "17"}], "}"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], "=", 
          RowBox[{
           RowBox[{"OptionValue", "[", "\"\<Mesh\>\"", "]"}], "+", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}]}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"Init", "[", 
         RowBox[{"mesh", ",", "\[IndentingNewLine]", 
          RowBox[{"Map", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"X", "\[Function]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"radius", " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{
                 "X", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "]"}]}], ",", 
               RowBox[{"radius", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{
                 "X", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "]"}]}], ",", " ", 
               RowBox[{
                RowBox[{
                "X", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                "-", 
                RowBox[{"height", "/", "2"}]}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"getGridPoints", "[", 
             RowBox[{"0.", ",", 
              RowBox[{"N", "[", 
               RowBox[{"2", "Pi"}], "]"}], ",", "0.", ",", 
              RowBox[{"N", "[", "height", "]"}], ",", "m", ",", "n", ",", 
              "True", ",", "False"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"getGridTriangles", "[", 
           RowBox[{"m", ",", "n", ",", "True", ",", "False"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<Textured\>\"", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"R", "=", 
           RowBox[{"Init", "[", 
            RowBox[{"mesh", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"getGridPoints", "[", 
               RowBox[{
               "0.", ",", "1.", ",", "0.", ",", "1.", ",", "m", ",", "n", ",",
                 "False", ",", "False"}], "]"}], "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", 
               RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"getGridTriangles", "[", 
              RowBox[{"m", ",", "n", ",", "False", ",", "False"}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"M", "=", 
           RowBox[{"SmoothBoundaryLink", "[", "M", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"SetTextureMesh", "[", 
           RowBox[{"M", ",", "R"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"SetTexture", "[", 
           RowBox[{"M", ",", 
            RowBox[{"GridTexture", "[", 
             RowBox[{
              RowBox[{"Mesh", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"5", ",", "5"}], "}"}]}], ",", 
              RowBox[{"Thickness", "\[Rule]", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], "0.0005"}]}]}], "]"}]}], 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "M"}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Options\>\"", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Mesh\>\"", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Textured\>\"", "\[Rule]", "True"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.675706294237335*^9, 3.675706391318884*^9}, {
   3.6997795744347258`*^9, 3.6997795777134953`*^9}, {3.707968716465892*^9, 
   3.707968719431072*^9}, 3.72009756415757*^9, {3.75828077186241*^9, 
   3.7582807837949944`*^9}, {3.758280816546826*^9, 3.758280816960392*^9}, {
   3.7582825265281563`*^9, 3.758282526760323*^9}, {3.758282901443935*^9, 
   3.758282906983974*^9}, {3.758786570086644*^9, 3.758786571818305*^9}, 
   3.788673006675107*^9, {3.812344877287464*^9, 3.812344899646202*^9}},
 CellLabel->
  "In[516]:=",ExpressionUUID->"5e7d80f6-ab1f-4420-9c68-de7ad86ad4bd"],

Cell[BoxData[
 RowBox[{"HandleMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"r1_", ",", "r2_", ",", "angle_"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M", ",", "m", ",", "n", ",", 
        RowBox[{"circumference", "=", 
         RowBox[{"2", "Pi", " ", "r1"}]}], ",", "pts", ",", "faces"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<Mesh\>\"", "]"}], "===", 
          "Automatic"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"grid", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Floor", "[", 
                RowBox[{"2", "Pi", " ", 
                 RowBox[{"radius", "/", "height"}]}], "]"}], " ", "11"}], ",",
               "10"}], "}"}]}], ","}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"angle", "<", "circumference"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"m", ",", "n"}], "}"}], "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"16", 
                 RowBox[{"Ceiling", "[", 
                  RowBox[{"angle", "/", "circumference"}], "]"}]}], " ", "+", 
                "1"}], ",", "17"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"m", ",", "n"}], "}"}], "=", 
             RowBox[{"{", 
              RowBox[{"17", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Floor", "[", 
                  RowBox[{"circumference", "/", "angle"}], "]"}], " ", "16"}],
                 "+", "1"}]}], "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], "=", 
          RowBox[{
           RowBox[{"OptionValue", "[", "\"\<Mesh\>\"", "]"}], "+", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}]}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"pts", "=", 
        RowBox[{"Map", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"X", "\[Function]", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{
               "X", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}], 
              RowBox[{"(", 
               RowBox[{"r1", "+", 
                RowBox[{"r2", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                  "X", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   "]"}]}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"Sin", "[", 
               RowBox[{
               "X", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "]"}], 
              RowBox[{"(", 
               RowBox[{"r1", "+", 
                RowBox[{"r2", " ", 
                 RowBox[{"Cos", "[", 
                  RowBox[{
                  "X", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                   "]"}]}]}], ")"}]}], ",", 
             RowBox[{"r2", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
               "X", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "]"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"getGridPoints", "[", 
           RowBox[{"0.", ",", "angle", ",", "0.", ",", 
            RowBox[{"2.", "Pi"}], ",", "m", ",", "n", ",", "False", ",", 
            "True"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"faces", "=", 
        RowBox[{"getGridTriangles", "[", 
         RowBox[{"m", ",", "n", ",", "False", ",", "True"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"Init", "[", 
         RowBox[{"mesh", ",", "pts", ",", "faces"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"SmoothBoundaryLink", "[", "M", "]"}]}], ";", 
       "\[IndentingNewLine]", "M"}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Options\>\"", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"\"\<Mesh\>\"", "\[Rule]", "Automatic"}], "\[IndentingNewLine]",
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6997795920269327`*^9, 3.69977959496061*^9}, {
   3.707968725393486*^9, 3.7079687270636053`*^9}, 
   3.7200975650625563`*^9},ExpressionUUID->"cd6dd171-fc38-4f5a-a023-\
e37b84f80b25"],

Cell[BoxData[
 RowBox[{"CubeWireMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "n_", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Q", ",", "qflist", ",", "eqlist", ",", "R", ",", "r", ",", "P", ",", 
        "fflist"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Q", ",", "qflist"}], "}"}], "=", 
        RowBox[{"Extract", "[", 
         RowBox[{
          RowBox[{"PolyhedronData", "[", "\"\<Cube\>\"", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"eqlist", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"x", "\[Function]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{
               "x", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "x", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{
               "x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{"x", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "4", "]"}], "]"}], ",", 
               RowBox[{
               "x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
              "}"}]}], "}"}]}], ",", "qflist"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"R", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Mean", "/@", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Q", "[", 
             RowBox[{"[", 
              RowBox[{"Flatten", "[", "eqlist", "]"}], "]"}], "]"}], ",", 
            "2"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"r", "=", "0.2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"P", "=", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"r", ",", "r", ",", "0."}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "r"}], ",", "r", ",", "0."}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "r"}], ",", 
               RowBox[{"-", "r"}], ",", "0."}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"r", ",", 
               RowBox[{"-", "r"}], ",", "0."}], "}"}]}], "}"}], ",", "Q", ",",
            "R"}], "]"}], "//", "N"}]}], ";", 
       RowBox[{"fflist", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "4"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "3", ",", "4"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"1", ",", "11", ",", "20"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "20", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "20", ",", "7"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"2", ",", "7", ",", "22"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "22", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "22", ",", "5"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"3", ",", "5", ",", "24"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "24", ",", "4"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "24", ",", "9"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"4", ",", "9", ",", "18"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "18", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "18", ",", "11"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"1", ",", "12", ",", "16"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "16", ",", "4"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "16", ",", "10"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"4", ",", "10", ",", "15"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "15", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "15", ",", "6"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"3", ",", "6", ",", "14"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "14", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "14", ",", "8"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"2", ",", "8", ",", "13"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "13", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "13", ",", "12"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"1", ",", "11", ",", "19"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "19", ",", "12"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"4", ",", "9", ",", "17"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "17", ",", "10"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"3", ",", "5", ",", "23"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "23", ",", "6"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"2", ",", "7", ",", "21"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "21", ",", "8"}], "}"}]}], "\[IndentingNewLine]",
          "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Subdivide", "[", 
        RowBox[{
         RowBox[{"Init", "[", 
          RowBox[{"mesh", ",", "P", ",", "fflist"}], "]"}], ",", 
         RowBox[{"\"\<Subdivisions\>\"", "\[Rule]", "n"}], ",", 
         RowBox[{"Method", "\[Rule]", "\"\<Planar\>\""}], ",", 
         RowBox[{"\"\<AverageBoundaryPoints\>\"", "\[Rule]", "False"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", 
          RowBox[{"OptionValue", "[", "\"\<MultiGrid\>\"", "]"}]}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", "False"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.636375393146772*^9, 3.636375449809099*^9}, {
   3.636376138453596*^9, 3.636376138752577*^9}, 3.636376281714244*^9, {
   3.637944774546377*^9, 3.637944807194682*^9}, 3.6379449739306726`*^9, {
   3.647694463790289*^9, 3.6476944799566383`*^9}, {3.6476950791895847`*^9, 
   3.6476950886738033`*^9}, {3.647695500238689*^9, 3.647695606603611*^9}, {
   3.647695664097773*^9, 3.6476956646564827`*^9}, {3.666339627961549*^9, 
   3.6663396369987717`*^9}, {3.707968733233451*^9, 3.707968734689328*^9}, {
   3.7249581560512667`*^9, 3.7249581896897497`*^9}, 3.7249582263260307`*^9, {
   3.726845070180686*^9, 
   3.7268450928625402`*^9}},ExpressionUUID->"e01780d3-fe8e-4471-ab31-\
7b6f14dd854a"],

Cell[BoxData[
 RowBox[{"TetrahedronWireMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"n_", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "M", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"M", "=", 
        RowBox[{"Init", "[", 
         RowBox[{"mesh", ",", "\[IndentingNewLine]", 
          RowBox[{"N", "[", 
           RowBox[{"2", 
            RowBox[{"Prepend", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"PolyhedronData", "[", "\"\<Tetrahedron\>\"", "]"}], 
               "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", 
                RowBox[{"-", "0.5"}]}], "}"}]}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3", ",", "4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "4", ",", "5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "5", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "4"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3", ",", "5"}], "}"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Quiet", "[", 
        RowBox[{"Subdivide", "[", 
         RowBox[{"M", ",", 
          RowBox[{"\"\<Subdivisions\>\"", "\[Rule]", "n"}], ",", 
          RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<MultiGrid\>\"", "]"}]}]}], "]"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", "False"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.647709901768729*^9, 3.647710029007187*^9}, {
   3.647710106941544*^9, 3.647710114347513*^9}, 3.647710198802771*^9, 
   3.6707310748913593`*^9, {3.707968737136668*^9, 3.707968737326432*^9}, {
   3.724958208526512*^9, 
   3.724958215136303*^9}},ExpressionUUID->"a8a016b1-862d-471e-a11e-\
a7f51f52abbe"],

Cell[BoxData[
 RowBox[{"TetrahedronMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"n_", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"g", ",", "gc", ",", "P", ",", "fflist"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "=", 
        RowBox[{"PolyhedronData", "[", "\"\<Tetrahedron\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"gc", "=", 
        RowBox[{"Extract", "[", 
         RowBox[{"g", ",", 
          RowBox[{"Position", "[", 
           RowBox[{"g", ",", 
            RowBox[{"GraphicsComplex", "[", "__", "]"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"P", "=", 
        RowBox[{"cNormalize", "/@", 
         RowBox[{"N", "[", 
          RowBox[{"Join", "@@", 
           RowBox[{"gc", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"fflist", "=", 
        RowBox[{"Join", "@@", 
         RowBox[{
          RowBox[{"Extract", "[", 
           RowBox[{"gc", ",", 
            RowBox[{"Position", "[", 
             RowBox[{"gc", ",", 
              RowBox[{"Polygon", "[", "__", "]"}]}], "]"}]}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Subdivide", "[", 
        RowBox[{
         RowBox[{"Init", "[", 
          RowBox[{"mesh", ",", "P", ",", "fflist"}], "]"}], ",", 
         RowBox[{"Method", "\[Rule]", "\"\<Planar\>\""}], ",", 
         RowBox[{"Subdivisions", "\[Rule]", "n"}], ",", 
         RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", 
          RowBox[{"OptionValue", "[", "\"\<MultiGrid\>\"", "]"}]}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", "False"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.724958251540001*^9, 
  3.724958271498595*^9}},ExpressionUUID->"3b15fedd-e675-4ad3-b34c-\
26a79543056e"],

Cell[BoxData[
 RowBox[{"getTrianglePoints", "=", 
  RowBox[{"CPackageFunction", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"nn", ",", "_Integer"}], "}"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nn", "+", "1"}], ")"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"nn", "+", "2"}], ")"}], "/", "2"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"c", "=", "0"}]}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"c", "++"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "p", " ", "\[LeftDoubleBracket]", "c", "\[RightDoubleBracket]"}],
              "=", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}], "/", "nn"}], "+", 
                RowBox[{"0.5", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"j", "-", "1"}], ")"}], "/", "nn"}]}]}], ",", 
               RowBox[{
                RowBox[{"Sqrt", "[", "3", "]"}], "0.5", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"j", "-", "1"}], ")"}], "/", "nn"}]}], " ", ",", 
               "0."}], "}"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"nn", "-", "j", "+", "2"}]}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"nn", "+", "1"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "p"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6518583285823317`*^9, 3.651858333676221*^9}, {
   3.651858366068413*^9, 3.651858531564835*^9}, {3.6518585720877542`*^9, 
   3.651858759406423*^9}, {3.651858806901599*^9, 3.65185882943042*^9}, {
   3.6518589019782057`*^9, 3.6518589359672403`*^9}, {3.651858966071212*^9, 
   3.651858978207699*^9}, {3.6518591616277533`*^9, 3.6518591643012753`*^9}, 
   3.651859322183947*^9, {3.6518593580894327`*^9, 3.651859392585525*^9}, {
   3.6518594751215487`*^9, 3.65185950908918*^9}, {3.65185955993211*^9, 
   3.6518595898248167`*^9}, {3.651859648433179*^9, 3.6518596844967737`*^9}, {
   3.651859718083619*^9, 3.6518597391216908`*^9}, {3.651897924037807*^9, 
   3.6518979242189693`*^9}, {3.674971899052247*^9, 
   3.6749719043514547`*^9}},ExpressionUUID->"1f220d05-8f21-4e39-9cd7-\
8b8c959fac43"],

Cell[BoxData[
 RowBox[{"getTriangleTriangles", "=", 
  RowBox[{"CPackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"nn", ",", "_Integer"}], "}"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"faces", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{
              RowBox[{"nn", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"nn", "+", "1"}], ")"}], "/", "2"}]}], "+", 
              RowBox[{"nn", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"nn", "-", "1"}], ")"}], "/", "2"}]}]}]}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"c", "=", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"f", "=", "0"}]}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"f", "++"}], ";", "\[IndentingNewLine]", 
             RowBox[{"c", "++"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "faces", "\[LeftDoubleBracket]", "f", "\[RightDoubleBracket]"}],
               "=", 
              RowBox[{"{", 
               RowBox[{"c", ",", 
                RowBox[{"c", "+", "1"}], ",", 
                RowBox[{"c", "+", "nn", "-", "j", "+", "2"}]}], "}"}]}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"nn", "-", "j", "+", "1"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"c", "++"}]}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"nn", "+", "1"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"nn", ">", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"c", "=", "1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Do", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"f", "++"}], ";", "\[IndentingNewLine]", 
                RowBox[{"c", "++"}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                 "faces", "\[LeftDoubleBracket]", "f", 
                  "\[RightDoubleBracket]"}], "=", 
                 RowBox[{"{", 
                  RowBox[{"c", ",", 
                   RowBox[{"c", "+", "nn", "-", "j", "+", "2"}], ",", 
                   RowBox[{"c", "+", "nn", "-", "j", "+", "1"}]}], "}"}]}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"i", ",", "2", ",", 
                 RowBox[{"nn", "-", "j", "+", "1"}]}], "}"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"c", "+=", "2"}], ";"}], "\[IndentingNewLine]", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "nn"}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "faces"}]}],
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{
  3.6518597774829082`*^9, {3.651897997819213*^9, 3.651898033859755*^9}, {
   3.651898071442971*^9, 3.651898081239892*^9}, 
   3.720097566567528*^9},ExpressionUUID->"3b80d4d5-a4b3-4fc2-b264-\
586664fcd614"],

Cell[BoxData[
 RowBox[{"TriangleMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"n_", ",", "\[IndentingNewLine]", 
    RowBox[{"Init", "[", 
     RowBox[{"mesh", ",", " ", 
      RowBox[{"getTrianglePoints", "[", "n", "]"}], ",", " ", 
      RowBox[{"getTriangleTriangles", "[", "n", "]"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Description", "\[Rule]", 
     "\"\<TriangleMesh[n] generates a meshed equilateral triangle in R^3 with \
edge length 1. Each edge is divided into n edges.\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.651980465488452*^9, 3.651980574807714*^9}, 
   3.720097568089244*^9, {3.724958287634955*^9, 3.724958307143684*^9}, {
   3.829379408810351*^9, 
   3.829379409049966*^9}},ExpressionUUID->"090e1dff-5f54-42f4-881a-\
4c2e946662bc"],

Cell[BoxData[
 RowBox[{"LshapedDomain", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"a_", ",", "\[IndentingNewLine]", 
    RowBox[{"Quiet", "[", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "M", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"M", "=", 
         RowBox[{"SquareMesh", "[", 
          RowBox[{"a", ",", 
           RowBox[{"Mesh", "\[Rule]", 
            RowBox[{"OptionValue", "[", "\"\<Mesh\>\"", "]"}]}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"ToleranceGlue", "[", 
         RowBox[{
          RowBox[{"Join", "[", "\[IndentingNewLine]", 
           RowBox[{"M", ",", "\[IndentingNewLine]", 
            RowBox[{"Displace", "[", 
             RowBox[{"M", ",", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "a"}], ",", 
                  RowBox[{"-", "a"}], ",", "0."}], "}"}], ",", 
                RowBox[{"VertexCount", "[", "M", "]"}]}], "]"}]}], "]"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"Displace", "[", 
             RowBox[{"M", ",", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0.", ",", 
                  RowBox[{"-", "a"}], ",", "0."}], "}"}], ",", 
                RowBox[{"VertexCount", "[", "M", "]"}]}], "]"}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}], ",", "0.00000001"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Mesh\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"5", ",", "5"}], "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6626558460688353`*^9, 3.66265587270255*^9}, {
  3.6626573463288603`*^9, 3.6626573854886503`*^9}, {3.7200975173025417`*^9, 
  3.720097522289166*^9}, {3.724958316970253*^9, 3.7249583171682777`*^9}, {
  3.8293794147289543`*^9, 
  3.829379421489884*^9}},ExpressionUUID->"cbd08fde-8c85-4842-928a-\
81b8eda9afd5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"getStandardSimplexPoints", "=", 
   RowBox[{"CPackageFunction", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"nn", ",", "_Integer"}], "}"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"p", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0.", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"nn", "+", "1"}], ")"}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"nn", "+", "2"}], ")"}], "/", "2"}]}]}], "}"}], ",", 
            
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"c", "=", "0"}]}], "\[IndentingNewLine]", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"c", "++"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "p", " ", "\[LeftDoubleBracket]", "c", 
               "\[RightDoubleBracket]"}], "=", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}], "/", "nn"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"j", "-", "1"}], ")"}], "/", "nn"}], " ", ",", 
                RowBox[{"1.", "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"i", "+", "j", "-", "2"}], ")"}], "/", "nn"}]}]}], 
               "}"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"nn", "-", "j", "+", "2"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"nn", "+", "1"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "p"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"StandardSimplexMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"n_", ",", "\[IndentingNewLine]", 
    RowBox[{"Init", "[", 
     RowBox[{"mesh", ",", " ", 
      RowBox[{"getStandardSimplexPoints", "[", "n", "]"}], ",", " ", 
      RowBox[{"getTriangleTriangles", "[", "n", "]"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
    "\"\<Description\>\"", "\[Rule]", 
     "\"\<StandardSimplexMesh[n] generates a meshed equilateral triangle in \
R^3 with edge length Sqrt[2]. Each edge is divided into n edges.\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.674972030235099*^9, 3.674972055305985*^9}, 
   3.720097584673468*^9, {3.829379427210137*^9, 
   3.8293794309213877`*^9}},ExpressionUUID->"691e540e-bd19-411f-864c-\
c76cb46396df"],

Cell[BoxData[
 RowBox[{"BorromeanRingsMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "n_", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "A", ",", "pts", ",", "P", ",", "dividespts", ",", "splinepts", ",", 
        "\[Gamma]list", ",", "m", ",", "tlist", ",", "oldbndpts", ",", 
        "bndpts", ",", "pts1", ",", "pts2", ",", "blink", ",", "fflist", ",", 
        "pplist", ",", "\[Sigma]", ",", "M000", ",", "M00"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", "=", 
        RowBox[{"RotationTransform", "[", 
         RowBox[{"1.0172219678978514`", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pts", "=", 
        RowBox[{"A", "/@", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"PolyhedronData", "[", "\"\<Icosahedron\>\"", "]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"pts", "=", "pts"}], 
       RowBox[{"(*", 
        RowBox[{"+", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.02", ",", 
             RowBox[{"-", "0.04"}], ",", "0."}], "}"}], ",", 
           RowBox[{"Length", "[", "pts", "]"}]}], "]"}]}], "*)"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"P", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"x", "\[Function]", 
           RowBox[{"Part", "[", 
            RowBox[{"pts", ",", "x"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "3", ",", "2", ",", "4", ",", "1"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"5", ",", "6", ",", "8", ",", "7", ",", "5"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"9", ",", "11", ",", "12", ",", "10", ",", "9"}], 
             "}"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dividespts", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"x", "\[Function]", 
           RowBox[{"MovingAverage", "[", 
            RowBox[{"x", ",", "2"}], "]"}]}], ",", "P"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"splinepts", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Riffle", "[", 
           RowBox[{
            RowBox[{
            "P", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
            
            RowBox[{
            "dividespts", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "P", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]list", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"pp", "\[Function]", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"(", 
             RowBox[{"t", "\[Function]", 
              RowBox[{
               RowBox[{"BSplineFunction", "[", 
                RowBox[{
                 RowBox[{"Most", "[", "pp", "]"}], ",", 
                 RowBox[{"SplineClosed", "\[Rule]", "True"}]}], "]"}], "[", 
               RowBox[{
                RowBox[{"t", "/", "2"}], "/", "Pi"}], "]"}]}], ")"}], "]"}]}],
           ",", "splinepts"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"m", "=", "8"}], ";", "\[IndentingNewLine]", 
       RowBox[{"tlist", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"ToPack", "[", 
           RowBox[{"N", "[", 
            RowBox[{"Table", "[", 
             RowBox[{"t", ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "0", ",", 
                RowBox[{"2", "Pi"}], ",", 
                RowBox[{"2", 
                 RowBox[{"Pi", "/", "m"}]}]}], "}"}]}], "]"}], "]"}], "]"}], 
          ",", 
          RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"oldbndpts", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "\[Gamma]list", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], "/@", 
           RowBox[{
           "tlist", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "tlist", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bndpts", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"x", "\[Function]", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", "\[LeftDoubleBracket]", 
               RowBox[{"-", "2"}], "\[RightDoubleBracket]"}], "}"}], ",", 
             RowBox[{"x", "[", 
              RowBox[{"[", 
               RowBox[{"1", ";;", 
                RowBox[{"-", "3"}]}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", "\[LeftDoubleBracket]", 
               RowBox[{"-", "2"}], "\[RightDoubleBracket]"}], "}"}]}], 
            "]"}]}], ",", "oldbndpts"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"pts1", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "bndpts", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", "5", ",", "7", ",", "1"}], "}"}], 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "bndpts", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pts2", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "bndpts", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"{", 
            RowBox[{"2", ",", "4", ",", "6", ",", "8"}], "}"}], 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "bndpts", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pts", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Riffle", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "pts1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                "\[LeftDoubleBracket]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}], 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
               RowBox[{
               "pts1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                "\[LeftDoubleBracket]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
               RowBox[{
               "pts1", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
                "\[LeftDoubleBracket]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "4", ",", "2", ",", "3"}], "}"}], 
               "\[RightDoubleBracket]"}]}], "]"}], "\[IndentingNewLine]", ",", 
            RowBox[{"Join", "@@", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{"x", "\[Function]", 
                RowBox[{"MovingAverage", "[", 
                 RowBox[{"x", ",", "2"}], "]"}]}], ",", "P"}], "]"}]}]}], 
           "]"}], ",", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"1", "/", "3"}], 
            RowBox[{
             RowBox[{"PolyhedronData", "[", "\"\<Cube\>\"", "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"blink", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"x", "\[Function]", "\[IndentingNewLine]", 
           RowBox[{"Association", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\"\<Curve\>\"", "\[Rule]", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<SamplingPoints\>\"", "\[Rule]", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<FirstPoint\>\"", "\[Rule]", 
              RowBox[{
               RowBox[{
               "x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "[", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<SecondPoint\>\"", "\[Rule]", 
              RowBox[{
               RowBox[{
               "x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "[", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "]"}]}]}],
             "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]list", ",", 
             RowBox[{"Most", "/@", "tlist"}], ",", 
             RowBox[{"bndpts", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"bndpts", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fflist", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"4", ",", "14", ",", "13"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "15", ",", "14"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"12", ",", "19", ",", "22"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"12", ",", "22", ",", "23"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"8", ",", "9", ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"8", ",", "10", ",", "11"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"16", ",", "18", ",", "17"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"16", ",", "21", ",", "18"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"20", ",", "3", ",", "6"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "6", ",", "7"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"24", ",", "1", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"24", ",", "2", ",", "5"}], "}"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"4", ",", "32", ",", "26"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "3", ",", "32"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"20", ",", "32", ",", "29"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "32", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "7", ",", "29"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"29", ",", "7", ",", "8"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"29", ",", "8", ",", "27"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"27", ",", "8", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"27", ",", "1", ",", "24"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"27", ",", "24", ",", "26"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"26", ",", "24", ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"26", ",", "5", ",", "4"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"4", ",", "13", ",", "26"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"26", ",", "13", ",", "16"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"26", ",", "29", ",", "16"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"29", ",", "16", ",", "9"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"29", ",", "9", ",", "8"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"8", ",", "11", ",", "27"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"27", ",", "11", ",", "12"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"27", ",", "12", ",", "32"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"32", ",", "12", ",", "15"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"32", ",", "15", ",", "4"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"12", ",", "27", ",", "19"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"27", ",", "24", ",", "19"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"32", ",", "27", ",", "26"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"26", ",", "17", ",", "24"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"26", ",", "16", ",", "17"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"16", ",", "29", ",", "21"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"29", ",", "21", ",", "20"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"32", ",", "12", ",", "20"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"12", ",", "23", ",", "20"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"26", ",", "29", ",", "32"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"26", ",", "27", ",", "29"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"27", ",", "29", ",", "32"}], "}"}]}], 
         "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pplist", "=", 
        RowBox[{"Union", "@@", "fflist"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Sigma]", "=", 
        RowBox[{"Association", "[", 
         RowBox[{"Thread", "[", 
          RowBox[{"pplist", "\[Rule]", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "pplist", "]"}], "]"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"M000", "=", 
        RowBox[{"Init", "[", 
         RowBox[{"mesh", ",", 
          RowBox[{"pts", "[", 
           RowBox[{"[", "pplist", "]"}], "]"}], ",", 
          RowBox[{"Map", "[", 
           RowBox[{"\[Sigma]", ",", "fflist", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", "blink"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M00", "=", 
        RowBox[{"DeleteFacets", "[", 
         RowBox[{"M000", ",", 
          RowBox[{"{", 
           RowBox[{
           "7", ",", "8", ",", "9", ",", "10", ",", "11", ",", "12", ",", 
            "13", ",", "14", ",", "15", ",", "16"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Subdivide", "[", 
        RowBox[{"M00", ",", 
         RowBox[{"\"\<Subdivisions\>\"", "\[Rule]", "n"}], ",", 
         RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", 
          RowBox[{"OptionValue", "[", "\"\<MultiGrid\>\"", "]"}]}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", "False"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.670730489319309*^9, 3.6707306193804493`*^9}, {
   3.670731048704138*^9, 3.6707311686766367`*^9}, {3.7079687535123777`*^9, 
   3.70796875496054*^9}, {3.724958353979535*^9, 3.724958375503664*^9}, 
   3.724958558619815*^9, {3.759988750090197*^9, 3.759988753441077*^9}},
 CellLabel->
  "In[203]:=",ExpressionUUID->"9352ed5c-a9fb-454d-85bf-4cb6c5242847"],

Cell[BoxData[
 RowBox[{"Die120", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "M", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"M", "=", 
        RowBox[{"SphereMesh", "[", "0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"LetL", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"newpts", "=", 
            RowBox[{"Join", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"VertexCoordinates", "[", "M", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"0.9281013227811312`", " ", 
               RowBox[{"cNormalize3", "[", 
                RowBox[{"EdgeMidpoints", "[", "M", "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"0.9580086660762787`", " ", 
               RowBox[{"cNormalize3", "[", 
                RowBox[{"TriangleMidpoints", "[", "M", "]"}], "]"}]}]}], 
             "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"newfaces", "=", 
            RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "getBarycentricSubdividedTriangles", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Triangles", "[", "M", "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"TrianglesNeighEdges", "[", "M", "]"}], "+", 
                 RowBox[{"VertexCount", "[", "M", "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Range", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"VertexCount", "[", "M", "]"}], "+", 
                   RowBox[{"EdgeCount", "[", "M", "]"}], "+", "1"}], ",", 
                  RowBox[{
                   RowBox[{"VertexCount", "[", "M", "]"}], "+", 
                   RowBox[{"EdgeCount", "[", "M", "]"}], "+", 
                   RowBox[{"TriangleCount", "[", "M", "]"}]}]}], "]"}]}], 
               "\[IndentingNewLine]", "]"}], ",", "1"}], "]"}]}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Init6", "[", 
          RowBox[{"mesh", ",", "newpts", ",", "newfaces"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.671472282874219*^9, 3.6714722925276117`*^9}, {
  3.671472338391861*^9, 3.671472385710169*^9}, {3.707968757950593*^9, 
  3.707968760022664*^9}, {3.72009748213272*^9, 3.720097540344212*^9}, {
  3.720097588965352*^9, 
  3.7200975966857853`*^9}},ExpressionUUID->"09929b03-9058-4e83-85fd-\
68fa689b4c0a"],

Cell[BoxData[
 RowBox[{"PerforatedSphereMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M0", ",", "M00", ",", "Q", ",", "r", ",", "V"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"M0", "=", 
        RowBox[{"SphereMesh", "[", 
         RowBox[{"OptionValue", "[", "\"\<PreSubdivisions\>\"", "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"M00", "=", 
        RowBox[{"SphereMesh", "[", "0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", 
           RowBox[{"OptionValue", "[", "\"\<CutPoints\>\"", "]"}], "]"}], "===",
           "String"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Q", "=", 
           RowBox[{"cNormalize3", "[", 
            RowBox[{"PolyhedronData", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "\"\<CutPoints\>\"", "]"}], ",", 
              "\"\<VertexCoordinates\>\""}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"V", "=", "Q"}], ";"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Q", "=", 
           RowBox[{"OptionValue", "[", "\"\<CutPoints\>\"", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"V", "=", 
           RowBox[{"cNormalize3", "[", "Q", "]"}]}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<Radius\>\"", "]"}], ",", 
          RowBox[{"Length", "[", "Q", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M0", "=", 
        RowBox[{"CutHole", "[", 
         RowBox[{"M0", ",", "Q", ",", "r", ",", "V"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M0", "=", 
        RowBox[{"SmoothBoundaryLink", "[", "M0", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Subdivide", "[", 
        RowBox[{"M0", ",", 
         RowBox[{"\"\<Subdivisions\>\"", "\[Rule]", 
          RowBox[{"OptionValue", "[", "\"\<PostSubdivisions\>\"", "]"}]}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
    "\"\<Description\>\"", "\[Rule]", "\[IndentingNewLine]", 
     "\"\<Radius\[Rule]0.225 yields sigularities; Radius\[Rule]0.25 allows \
for minimizers.\>\""}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Radius\>\"", "\[Rule]", "0.25"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<PreSubdivisions\>\"", "\[Rule]", "4"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<PostSubdivisions\>\"", "\[Rule]", "2"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<CutPoints\>\"", "\[Rule]", "\"\<Icosahedron\>\""}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.674451439916954*^9, 3.674451644307757*^9}, {
   3.674451682060856*^9, 3.6744516822685623`*^9}, {3.674451746440752*^9, 
   3.674451796522045*^9}, {3.674451833187681*^9, 3.674451836994227*^9}, 
   3.674451876420535*^9, {3.6744519880960093`*^9, 3.674451994768641*^9}, {
   3.674452050955205*^9, 3.674452114740457*^9}, {3.674452172063395*^9, 
   3.6744522326425037`*^9}, {3.7079687692738123`*^9, 
   3.7079687748708057`*^9}, {3.720097678245769*^9, 
   3.7200976812676773`*^9}},ExpressionUUID->"ba600486-1738-483e-b610-\
6555c15b6caa"],

Cell[BoxData[
 RowBox[{"SpotSurface", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "n_", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M", ",", 
        RowBox[{"path", "=", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"SourcePath", "[", 
             RowBox[{
              RowBox[{"Packages", "[", "$PM", "]"}], "[", "\"\<Mesh\>\"", 
              "]"}], "]"}], ",", "\"\<Geometries\>\"", ",", "\"\<Spot\>\""}], 
           "}"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", "path", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"ImportFromOBJ2", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"path", ",", "\"\<spot_triangulated.obj\>\""}], "}"}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"path", ",", 
             RowBox[{"OptionValue", "[", "\"\<Texture\>\"", "]"}]}], "}"}], 
           "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"TexturedSubdivide", "[", 
         RowBox[{"M", ",", 
          RowBox[{"Subdivisions", "\[Rule]", "n"}], ",", 
          RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<MultiGrid\>\"", "]"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SetPOVrayFinish", "[", 
        RowBox[{"M", ",", "\"\<Dull\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Centralize", "[", "M", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "\"\<Texture\>\"", "\[Rule]", "\"\<spot_texture_highres.png\>\""}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", "False"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.679718825511833*^9, 3.67971890903971*^9}, {
   3.6797190620702877`*^9, 3.679719087342362*^9}, {3.679719613401019*^9, 
   3.6797196138749647`*^9}, {3.679720499480112*^9, 3.6797205748730173`*^9}, {
   3.679720754859021*^9, 3.6797207622913427`*^9}, {3.679721608045045*^9, 
   3.6797217308535633`*^9}, {3.681624475063531*^9, 3.681624493438922*^9}, {
   3.6816249057592707`*^9, 3.6816249765639668`*^9}, {3.681625080855722*^9, 
   3.6816250821608353`*^9}, 3.695055613063924*^9, {3.707968780862335*^9, 
   3.707968783205873*^9}, {3.72009769557865*^9, 3.720097698122568*^9}, {
   3.724958403333208*^9, 3.724958410856147*^9}, 3.7249585718902607`*^9, 
   3.7442929723163033`*^9, {3.744293964424799*^9, 3.744293965462408*^9}, 
   3.756307687654702*^9},
 CellLabel->
  "In[159]:=",ExpressionUUID->"a86d3402-9242-4d44-bb9d-03e61fa348af"],

Cell[BoxData[
 RowBox[{"BobSurface", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "n_", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M", ",", 
        RowBox[{"path", "=", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"SourcePath", "[", 
             RowBox[{
              RowBox[{"Packages", "[", "$PM", "]"}], "[", "\"\<Mesh\>\"", 
              "]"}], "]"}], ",", "\"\<Geometries\>\"", ",", "\"\<Bob\>\""}], 
           "}"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", "path", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"ImportFromOBJ2", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"path", ",", "\"\<bob_tri.obj\>\""}], "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"path", ",", 
             RowBox[{"OptionValue", "[", "\"\<Texture\>\"", "]"}]}], "}"}], 
           "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"TexturedSubdivide", "[", 
         RowBox[{"M", ",", 
          RowBox[{"Subdivisions", "\[Rule]", "n"}], ",", 
          RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<MultiGrid\>\"", "]"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SetPOVrayFinish", "[", 
        RowBox[{"M", ",", "\"\<Dull\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Centralize", "[", "M", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Texture\>\"", "\[Rule]", "\"\<bob_diffuse.png\>\""}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", "False"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.681040182193705*^9, 3.681040187468439*^9}, {
   3.6810402205100803`*^9, 3.681040240357369*^9}, {3.681044710584326*^9, 
   3.681044710920577*^9}, {3.68162499554016*^9, 3.681625010027658*^9}, {
   3.681625073713036*^9, 3.681625075984682*^9}, {3.681731735341962*^9, 
   3.681731756547024*^9}, {3.682883717791885*^9, 3.6828837213007507`*^9}, {
   3.695055816648046*^9, 3.695055818044928*^9}, {3.707968786839196*^9, 
   3.707968788790193*^9}, {3.72009768634921*^9, 3.720097688472693*^9}, {
   3.724958415092862*^9, 3.724958417151847*^9}, 3.7249585761455917`*^9, {
   3.744293970022887*^9, 3.744293970271104*^9}, 
   3.756307688226012*^9},ExpressionUUID->"32a3bd61-9e43-474b-9ef2-\
f28f540b0056"],

Cell[BoxData[
 RowBox[{"BlubSurface", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "n_", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"path", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"SourcePath", "[", 
            RowBox[{
             RowBox[{"Packages", "[", "$PM", "]"}], "[", "\"\<Mesh\>\"", 
             "]"}], "]"}], ",", "\"\<Geometries\>\"", ",", "\"\<Blub\>\""}], 
          "}"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", "path", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"M", ",", "v"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"M", "=", 
           RowBox[{"ImportFromOBJ2", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"path", ",", "\"\<blub_triangulated.obj\>\""}], "}"}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FileNameJoin", "[", 
              RowBox[{"{", 
               RowBox[{"path", ",", "\"\<blub_texture.png\>\""}], "}"}], 
              "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"M", "=", 
           RowBox[{"TexturedSubdivide", "[", 
            RowBox[{"M", ",", 
             RowBox[{"Subdivisions", "\[Rule]", "n"}], ",", 
             RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", 
              RowBox[{"OptionValue", "[", "\"\<MultiGrid\>\"", "]"}]}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"SetPOVrayFinish", "[", 
           RowBox[{"M", ",", "\"\<Dull\>\""}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Centralize", "[", "M", "]"}]}]}], "\[IndentingNewLine]", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", "False"}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.681040249952064*^9, 3.681040255136622*^9}, 
   3.6810402894658527`*^9, 3.6810403255786057`*^9, {3.681044670029447*^9, 
   3.681044721989609*^9}, 3.681044947956843*^9, {3.681625018334886*^9, 
   3.681625059990484*^9}, {3.6950558230773697`*^9, 3.695055824941432*^9}, {
   3.70796879158451*^9, 3.707968793342557*^9}, {3.720097691005135*^9, 
   3.720097692986774*^9}, {3.724958435022915*^9, 3.724958437444059*^9}, 
   3.724958578600277*^9, {3.744293973109844*^9, 3.744293973374693*^9}, 
   3.756307688807448*^9},ExpressionUUID->"a67509fd-d1e8-4553-bac7-\
31843a3962a6"],

Cell[BoxData[
 RowBox[{"BumpyTorusMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M", ",", "file", ",", "path"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"file", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "\"\<Resolution\>\"", "]"}], 
           "\[Equal]", "\"\<High\>\""}], ",", "\"\<84_bumpy_torus.off\>\"", 
          ",", "\"\<84.off\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"path", "=", "\[IndentingNewLine]", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"SourcePath", "[", 
            RowBox[{
             RowBox[{"Packages", "[", "$PM", "]"}], "[", "\"\<Mesh\>\"", 
             "]"}], "]"}], ",", "\"\<Geometries\>\"", ",", 
           "\"\<BumpyTorus\>\"", ",", "file"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "path", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"ToMesh", "[", 
         RowBox[{"Import", "[", "path", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Centralize", "[", "M", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Resolution\>\"", "\[Rule]", "\"\<High\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", "False"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6812944970050907`*^9, 3.681294498265519*^9}, {
   3.6812945306541452`*^9, 3.681294670969041*^9}, {3.695055832446224*^9, 
   3.695055840361019*^9}, {3.695055889669901*^9, 3.695055891598905*^9}, {
   3.707968795864133*^9, 3.7079687962146072`*^9}, {3.720097707332529*^9, 
   3.7200977075218287`*^9}, {3.724958444341202*^9, 3.724958447115456*^9}, 
   3.756307689508151*^9},ExpressionUUID->"619cd504-4ca9-467e-babd-\
2d7f293a79a8"],

Cell[BoxData[
 RowBox[{"TriceratopsMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "n_", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"gc", ",", "polygons", ",", "f", ",", "faces", ",", "M"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gc", "=", 
        RowBox[{
         RowBox[{"Extract", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ExampleData", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<Geometry3D\>\"", ",", "\"\<Triceratops\>\""}], 
             "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Most", "/@", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"ExampleData", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<Geometry3D\>\"", ",", "\"\<Triceratops\>\""}], 
                "}"}], "]"}], ",", "GraphicsComplex"}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"polygons", "=", 
        RowBox[{
         RowBox[{"Extract", "[", 
          RowBox[{"gc", ",", 
           RowBox[{"Most", "/@", 
            RowBox[{"Position", "[", 
             RowBox[{"gc", ",", "Polygon"}], "]"}]}]}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"f", "=", 
        RowBox[{"x", "\[Function]", 
         RowBox[{"Join", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"x", "\[LeftDoubleBracket]", 
               RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{"x", "\[LeftDoubleBracket]", 
               RowBox[{"i", "+", "2"}], "\[RightDoubleBracket]"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{
               RowBox[{"Length", "[", "x", "]"}], "-", "2"}]}], "}"}]}], 
           "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"faces", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{"f", ",", "polygons", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"Init", "[", 
         RowBox[{"mesh", ",", 
          RowBox[{
          "gc", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          "faces"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"Subdivide", "[", 
         RowBox[{"M", ",", 
          RowBox[{"Subdivisions", "\[Rule]", "n"}], ",", 
          RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<MultiGrid\>\"", "]"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Centralize", "[", "M", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", "False"}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.681546675366683*^9, 3.681546682861081*^9}, {
   3.707968799896226*^9, 3.707968801542925*^9}, {3.719076321184243*^9, 
   3.719076325575307*^9}, {3.7249584561715403`*^9, 3.7249584584277267`*^9}, 
   3.7249585845458803`*^9},ExpressionUUID->"2dcb4107-ea4e-47be-bdf9-\
4ce528acb4f4"],

Cell[BoxData[
 RowBox[{"CastingMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M", ",", "path"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"path", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"SourcePath", "[", 
            RowBox[{
             RowBox[{"Packages", "[", "$PM", "]"}], "[", "\"\<Mesh\>\"", 
             "]"}], "]"}], ",", "\"\<Geometries\>\"", ",", "\"\<Casting\>\"", 
           ",", "\"\<16_casting.off\>\""}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "path", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"ToMesh", "[", 
         RowBox[{"Import", "[", "path", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Centralize", "[", "M", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.681565638075815*^9, 3.68156569647785*^9}, {
   3.695055873687965*^9, 3.695055880493314*^9}, {3.707968804397847*^9, 
   3.707968804589014*^9}, 3.719076329984456*^9, {3.7199095702597933`*^9, 
   3.719909572048938*^9}, 
   3.7563076901375093`*^9},ExpressionUUID->"ede8aed5-4a84-4375-adb0-\
54fdcd619d2c"],

Cell[BoxData[
 RowBox[{"HorseMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"n_", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "g", ",", "gc", ",", "polygons", ",", "pts", ",", "faces", ",", 
        "\[Sigma]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "=", 
        RowBox[{"ExampleData", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<Geometry3D\>\"", ",", "\"\<Horse\>\""}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"gc", "=", 
        RowBox[{
         RowBox[{"Extract", "[", 
          RowBox[{"g", ",", 
           RowBox[{"Most", "/@", 
            RowBox[{"Position", "[", 
             RowBox[{"g", ",", "GraphicsComplex"}], "]"}]}]}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"polygons", "=", 
        RowBox[{"Union", "@@", 
         RowBox[{
          RowBox[{"Extract", "[", "\[IndentingNewLine]", 
           RowBox[{"gc", ",", "\[IndentingNewLine]", 
            RowBox[{"Most", "/@", 
             RowBox[{"Position", "[", 
              RowBox[{"gc", ",", "Polygon"}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"polygons", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{"polygons", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "9618", "}"}], ",", 
            RowBox[{"{", "9634", "}"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pts", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{
          RowBox[{
          "gc", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", "4837", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Sigma]", "=", 
        RowBox[{"Association", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"Range", "[", "4836", "]"}], "\[Rule]", 
             RowBox[{"Range", "[", "4836", "]"}]}], "]"}], ",", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"4838", ",", "4850"}], "]"}], "\[Rule]", 
             RowBox[{"Range", "[", 
              RowBox[{"4837", ",", "4849"}], "]"}]}], "]"}]}], "]"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"faces", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"\[Sigma]", ",", "polygons", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"Init", "[", 
         RowBox[{"mesh", ",", "pts", ",", "faces"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"Subdivide", "[", 
         RowBox[{"M", ",", 
          RowBox[{"\"\<Subdivisions\>\"", "\[Rule]", "n"}], ",", 
          RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<MultiGrid\>\"", "]"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Centralize", "[", "M", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", "False"}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.682256811630927*^9, 3.682256875086359*^9}, {
   3.682256939006501*^9, 3.682256941316991*^9}, {3.6822570163585997`*^9, 
   3.682257017363854*^9}, {3.6822570958412247`*^9, 3.682257125224451*^9}, {
   3.6822572045410833`*^9, 3.682257208135721*^9}, {3.682257263442934*^9, 
   3.682257330727862*^9}, {3.682257806046562*^9, 3.6822578291727133`*^9}, {
   3.6822578755450172`*^9, 3.6822579736548767`*^9}, 3.682258022815094*^9, {
   3.7079688073988237`*^9, 3.7079688268898773`*^9}, {3.719076338904766*^9, 
   3.719076342414166*^9}, 3.724958465477827*^9, 
   3.7249585883612556`*^9},ExpressionUUID->"856a0a47-a2c8-4a40-a13c-\
d843eaa356df"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Graphics3D2Mesh", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"g_Graphics3D", ",", 
     RowBox[{"ToMesh", "[", "g", "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics3DToMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"g_Graphics3D", ",", 
    RowBox[{"ToMesh", "[", "g", "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.691919106517943*^9, 3.691919109099683*^9}, {
  3.691919161310897*^9, 3.6919191630187883`*^9}, {3.7190763539444923`*^9, 
  3.719076369736635*^9}},ExpressionUUID->"bab950e1-3430-4e99-bf71-\
1efd84da4fb8"],

Cell[BoxData[
 RowBox[{"ToMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"g_Graphics3D", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"gc", ",", "polygons", ",", "f", ",", "faces", ",", "M"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gc", "=", 
        RowBox[{
         RowBox[{"Extract", "[", 
          RowBox[{"g", ",", 
           RowBox[{"Most", "/@", 
            RowBox[{"Position", "[", 
             RowBox[{"g", ",", "GraphicsComplex"}], "]"}]}]}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"polygons", "=", 
        RowBox[{
         RowBox[{"Extract", "[", "\[IndentingNewLine]", 
          RowBox[{"gc", ",", "\[IndentingNewLine]", 
           RowBox[{"Most", "/@", 
            RowBox[{"Position", "[", 
             RowBox[{"gc", ",", "Polygon"}], "]"}]}]}], "\[IndentingNewLine]",
           "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"f", "=", 
        RowBox[{"x", "\[Function]", 
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"x", "\[LeftDoubleBracket]", 
               RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{"x", "\[LeftDoubleBracket]", 
               RowBox[{"i", "+", "2"}], "\[RightDoubleBracket]"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{
               RowBox[{"Length", "[", "x", "]"}], "-", "2"}]}], "}"}]}], 
           "]"}], "\[IndentingNewLine]", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"faces", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{"f", ",", "polygons", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"Init", "[", 
         RowBox[{"mesh", ",", 
          RowBox[{
          "gc", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          "faces"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Centralize", "[", "M", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.682256155600584*^9, 3.682256211239951*^9}, 
   3.682256768990046*^9, {3.6822579982327538`*^9, 3.682258013577448*^9}, {
   3.691919090488215*^9, 3.691919114813335*^9}, {3.6919191511176043`*^9, 
   3.6919191541889877`*^9}, {3.707968830002233*^9, 
   3.707968830170678*^9}},ExpressionUUID->"3bf373eb-fc3d-4f9b-a00d-\
aed806dc4f3f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"DoubleTorusMesh", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r2_", ",", "r1_"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "X", ",", "f", ",", "M", ",", "M1", ",", "\[Sigma]", ",", "x", ",", 
         "y", ",", "z", ",", "flist", ",", "faces", ",", "plist", ",", 
         "qlist", ",", "pts", ",", "n", ",", "s"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"s", "=", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"OptionValue", "[", "\"\<Overlap\>\"", "]"}]}], ")"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"f", "=", 
         RowBox[{"X", "\[Function]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
               "X", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "^", "2"}], "+", 
              RowBox[{
               RowBox[{
               "X", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "^", "2"}], "+", 
              RowBox[{
               RowBox[{
               "X", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
               "^", "2"}], "+", 
              RowBox[{"r2", "^", "2"}], "-", 
              RowBox[{"r1", "^", "2"}]}], ")"}], "^", "2"}], "-", 
           RowBox[{"4", " ", 
            RowBox[{"r2", "^", "2"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
               "X", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "^", "2"}], "+", 
              RowBox[{
               RowBox[{
               "X", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "^", "2"}]}], ")"}]}]}]}]}], ";", 
        RowBox[{"M", "\[LeftArrow]", 
         RowBox[{"ToMesh", "[", 
          RowBox[{"BoundaryMesh", "[", 
           RowBox[{"DiscretizeRegion", "[", 
            RowBox[{"ImplicitRegion", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"f", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"x", "+", "r2", "+", 
                    RowBox[{"r1", " ", "s"}]}], ",", "y", ",", "z"}], "}"}], 
                 "]"}], "\[LessEqual]", "0"}], "&&", 
               RowBox[{"x", "\[LessEqual]", "0"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", 
                  RowBox[{
                   RowBox[{"-", "1.1"}], " ", "3", " ", 
                   RowBox[{"(", 
                    RowBox[{"r1", "+", "r2"}], ")"}]}], ",", 
                  RowBox[{"1.1", 
                   RowBox[{"(", 
                    RowBox[{"r1", "+", "r2"}], ")"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"y", ",", 
                  RowBox[{
                   RowBox[{"-", "1.1"}], 
                   RowBox[{"(", 
                    RowBox[{"r1", "+", "r2"}], ")"}]}], ",", 
                  RowBox[{"1.1", 
                   RowBox[{"(", 
                    RowBox[{"r1", "+", "r2"}], ")"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"z", ",", 
                  RowBox[{
                   RowBox[{"-", "1.1"}], " ", "r1"}], ",", 
                  RowBox[{"1.1", " ", "r1"}]}], "}"}]}], "}"}]}], "]"}], 
            "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"flist", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"TriangleMidpoints", "[", "M", "]"}], 
                "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], 
              "<", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "8"}], ")"}]}]}], "]"}], ",", "False"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"faces", "=", 
         RowBox[{"Triangles", "[", 
          RowBox[{"M", ",", "flist"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"plist", "=", 
         RowBox[{"Union", "@@", "faces"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Sigma]", "=", 
         RowBox[{"AssociationThread", "[", 
          RowBox[{"plist", ",", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "plist", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"M1", "\[LeftArrow]", 
         RowBox[{"Init", "[", 
          RowBox[{"mesh", ",", 
           RowBox[{"VertexCoordinates", "[", 
            RowBox[{"M", ",", "plist"}], "]"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{"\[Sigma]", ",", "faces", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"plist", "=", 
         RowBox[{"BoundaryVertices", "[", "M1", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"n", "=", 
         RowBox[{"VertexCount", "[", "M1", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"qlist", "=", 
         RowBox[{"n", "+", "plist"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Sigma]", "=", 
         RowBox[{"AssociationThread", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"qlist", ",", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{"n", "+", "1"}], ",", 
                 RowBox[{"2", "n"}]}], "]"}], ",", "qlist"}], "]"}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Join", "[", 
            RowBox[{"plist", ",", 
             RowBox[{"Range", "[", 
              RowBox[{
               RowBox[{"n", "+", "1"}], ",", 
               RowBox[{
                RowBox[{"2", "n"}], "-", 
                RowBox[{"Length", "[", "plist", "]"}]}]}], "]"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"pts", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"VertexCoordinates", "[", "M1", "]"}], ",", 
           RowBox[{
            RowBox[{"VertexCoordinates", "[", 
             RowBox[{"M1", ",", 
              RowBox[{"Complement", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"VertexCount", "[", "M1", "]"}], "]"}], ",", 
                "plist"}], "]"}]}], "]"}], ".", 
            RowBox[{"DiagonalMatrix", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1."}], ",", "1.", ",", "1."}], "}"}], "]"}]}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"faces", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Triangles", "[", "M1", "]"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"VertexCount", "[", "M1", "]"}], "+", 
              RowBox[{"Triangles", "[", "M1", "]"}]}], "/.", "\[Sigma]"}], 
            ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Init", "[", 
         RowBox[{"mesh", ",", "pts", ",", "faces"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Options", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Overlap\>\"", "\[Rule]", "0.5"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6882922328588*^9, 3.6882922768838053`*^9}, 
   3.68829317603784*^9, {3.688293271725054*^9, 3.688293442947007*^9}, {
   3.688293477952877*^9, 3.6882935658923187`*^9}, {3.6882936310785837`*^9, 
   3.6882936616371117`*^9}, 3.691935426879006*^9, {3.720097482851757*^9, 
   3.7200975515455008`*^9}, 3.72009765968223*^9, 
   3.829723058301646*^9},ExpressionUUID->"ac48b6ca-6c8f-4994-8203-\
31337bcd47e2"],

Cell[BoxData[
 RowBox[{"Joint", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p_", ",", "R_", ",", "directions_"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "vlist", ",", "numtubes", ",", "mlist", ",", "q", ",", "qlist", ",", 
        "rlist", ",", "M", ",", "outerplist", ",", "plist", ",", "blist", ",",
         "S", ",", "A", ",", "delflist", ",", "slist", ",", "\[Alpha]", ",", 
        "rmax", ",", "subdiv"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vlist", "=", 
        RowBox[{"cNormalize", "[", "directions", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"numtubes", "=", 
        RowBox[{"Length", "[", "vlist", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mlist", "=", 
        RowBox[{"OptionValue", "[", "\"\<TubeSegments\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"mlist", "===", "Automatic"}], ",", "\[IndentingNewLine]", 
         RowBox[{"mlist", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"6", ",", "numtubes"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "mlist", "]"}], "===", "Integer"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"mlist", "=", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"mlist", ",", "numtubes"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", "mlist", "]"}], "===", "List"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "mlist", "]"}], "\[NotEqual]", 
                 "numtubes"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Message", "[", 
                  RowBox[{"Joint", "::", "wrongseg"}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"mlist", "=", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{"6", ",", "numtubes"}], "]"}]}]}]}], 
               "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Message", "[", 
                RowBox[{"Joint", "::", "nolistseg"}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"mlist", "=", 
                RowBox[{"ConstantArray", "[", 
                 RowBox[{"6", ",", "numtubes"}], "]"}]}]}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Alpha]", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"VectorAngle", "[", 
             RowBox[{
              RowBox[{
              "vlist", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
               ",", 
              RowBox[{
              "vlist", "\[LeftDoubleBracket]", "j", 
               "\[RightDoubleBracket]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "numtubes"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"i", "+", "1"}], ",", "numtubes"}], "}"}]}], "]"}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rmax", "=", 
        RowBox[{"R", " ", 
         RowBox[{"Min", "[", 
          RowBox[{"0.5", ",", 
           RowBox[{"Sin", "[", 
            RowBox[{"0.4", " ", "\[Alpha]"}], "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"rlist", "=", 
        RowBox[{"OptionValue", "[", "\"\<TubeRadii\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"rlist", "===", "Automatic"}], ",", "\[IndentingNewLine]", 
         RowBox[{"rlist", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"rmax", ",", "numtubes"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"NumericQ", "[", "rlist", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"rlist", "=", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"rlist", ",", "numtubes"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", "rlist", "]"}], "===", "List"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "rlist", "]"}], "\[NotEqual]", 
                 "numtubes"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Message", "[", 
                  RowBox[{"Joint", "::", "wrongr"}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"rlist", "=", 
                  RowBox[{"ConstantArray", "[", 
                   RowBox[{"rmax", ",", "numtubes"}], "]"}]}]}]}], 
               "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Message", "[", 
                RowBox[{"Joint", "::", "nolistr"}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"rlist", "=", 
                RowBox[{"ConstantArray", "[", 
                 RowBox[{"rmax", ",", "numtubes"}], "]"}]}]}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{"R", "-", "rlist"}], "]"}], "\[LessEqual]", "0."}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"Joint", "::", "nonposr"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"rlist", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"rmax", ",", "numtubes"}], "]"}]}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"subdiv", "=", 
        RowBox[{"OptionValue", "[", "\"\<Subdivisions\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"subdiv", "===", "Automatic"}], ",", "\[IndentingNewLine]", 
         RowBox[{"subdiv", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"0", ",", 
            RowBox[{"Ceiling", "[", 
             RowBox[{"-", 
              RowBox[{"Log2", "[", 
               RowBox[{"Min", "[", "rlist", "]"}], "]"}]}], "]"}]}], 
           "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"S", "=", 
        RowBox[{"SphereMesh", "[", 
         RowBox[{"subdiv", ",", 
          RowBox[{"\"\<Radius\>\"", "\[Rule]", "R"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"slist", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"R", "^", "2"}], "-", 
            RowBox[{
             RowBox[{
             "rlist", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "^", "2"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "numtubes"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q", "[", "m_", "]"}], ":=", 
        RowBox[{
         RowBox[{"q", "[", "m", "]"}], "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1.", " ", 
              RowBox[{"Cos", "[", "t", "]"}]}], ",", 
             RowBox[{"1.", " ", 
              RowBox[{"Sin", "[", "t", "]"}]}], ",", "0."}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0.", ",", 
             RowBox[{"2.", "Pi", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"1", "/", "m"}]}], ")"}]}], ",", 
             RowBox[{"2.", 
              RowBox[{"Pi", "/", "m"}]}]}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"qlist", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Dot", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "rlist", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
               " ", 
              RowBox[{"q", "[", 
               RowBox[{
               "mlist", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "]"}]}], "+", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0.", ",", "0.", ",", 
                 RowBox[{
                 "slist", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], "}"}], ",", 
               RowBox[{
               "mlist", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"RotationMatrix", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "vlist", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.", ",", "0.", ",", "1."}], "}"}]}], "}"}], "]"}]}],
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "numtubes"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"outerplist", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Total", "/@", 
            RowBox[{"UnitStep", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"VertexCoordinates", "[", "S", "]"}], ".", 
               RowBox[{"vlist", "\[Transpose]"}]}], "-", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"slist", ",", 
                RowBox[{"VertexCount", "[", "S", "]"}]}], "]"}]}], "]"}]}], 
           ",", "0"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"plist", "=", 
        RowBox[{"Complement", "[", "\[IndentingNewLine]", 
         RowBox[{"outerplist", ",", "\[IndentingNewLine]", 
          RowBox[{"Union", "@@", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"And", "@@@", 
                 RowBox[{"(", 
                  RowBox[{"Thread", "/@", 
                   RowBox[{"Thread", "[", 
                    RowBox[{
                    RowBox[{"DistanceMatrix", "[", 
                    RowBox[{
                    RowBox[{"VertexCoordinates", "[", "S", "]"}], ",", 
                    RowBox[{
                    "qlist", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "]"}], ">", 
                    RowBox[{"0.3", 
                    RowBox[{
                    "rlist", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}], "]"}]}], ")"}]}], ",", 
                "False"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "numtubes"}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"M", "=", 
          RowBox[{"ConvexHullSurface", "[", 
           RowBox[{"Union", "[", 
            RowBox[{
             RowBox[{"VertexCoordinates", "[", 
              RowBox[{"S", ",", "plist"}], "]"}], ",", 
             RowBox[{"Sequence", "@@", "qlist"}]}], "]"}], "]"}]}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"ConvexHullSurface", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"VertexCoordinates", "[", 
            RowBox[{"S", ",", "plist"}], "]"}], ",", 
           RowBox[{"Join", "@@", "qlist"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"blist", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"And", "@@@", 
              RowBox[{"(", 
               RowBox[{"Thread", "/@", 
                RowBox[{"Thread", "[", 
                 RowBox[{
                  RowBox[{"DistanceMatrix", "[", 
                   RowBox[{
                    RowBox[{"VertexCoordinates", "[", "M", "]"}], ",", 
                    RowBox[{
                    "qlist", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "]"}], ">", 
                  RowBox[{"0.3", 
                   RowBox[{
                   "rlist", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}], "]"}]}], ")"}]}], ",", 
             "False"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "numtubes"}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"A", "=", 
        RowBox[{"AdjacencyMatrix", "[", 
         RowBox[{"M", ",", "Vertices", ",", "Triangles"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"delflist", "=", 
        RowBox[{"Union", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"Total", "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"A", "\[LeftDoubleBracket]", 
                 RowBox[{
                 "blist", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], 
                "\[Transpose]"}], ")"}]}], ",", "3"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "numtubes"}], "}"}]}], "]"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"Init", "[", 
         RowBox[{"mesh", ",", 
          RowBox[{"VertexCoordinates", "[", "M", "]"}], ",", 
          RowBox[{"Delete", "[", 
           RowBox[{
            RowBox[{"Triangles", "[", "M", "]"}], ",", "delflist"}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Translate", "[", 
        RowBox[{"M", ",", "p"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<TubeRadii\>\"", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<TubeSegments\>\"", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Subdivisions\>\"", "\[Rule]", "Automatic"}]}], 
      "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Warnings\>\"", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "\"\<wrongseg\>\"", "\[Rule]", 
        "\"\<Option value of \\\"TubeSegments\\\" not consistent. Default \
value 6 is used instead.\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{
       "\"\<nolistseg\>\"", "\[Rule]", 
        "\"\<Option value of \\\"TubeSegments\\\" is neither a List, an \
Integer nor equal to Automatic. Default value 6 is used instead.\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
       "\"\<wrongr\>\"", "\[Rule]", 
        "\"\<Option value of \\\"TubeRadii\\\" not consistent. Default value \
is used instead.\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{
       "\"\<nolistr\>\"", "\[Rule]", 
        "\"\<Option value of \\\"TubeRadii\\\" is neither a List, a positive \
number nor equal to Automatic. Default value is used instead.\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
       "\"\<nonposr\>\"", "\[Rule]", 
        "\"\<Option value of \\\"TubeRadii\\\" contains too large or negative \
numbers. Default value is used instead.\>\""}]}], "\[IndentingNewLine]", 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.692869858998783*^9, 3.692869966621189*^9}, {
   3.692870000926002*^9, 3.692870378650983*^9}, {3.692870410528101*^9, 
   3.692870603960494*^9}, {3.6928706396766453`*^9, 3.692870935770419*^9}, {
   3.6928710736915703`*^9, 3.692871202240057*^9}, {3.692871548750142*^9, 
   3.692871578070846*^9}, {3.6928716262504168`*^9, 3.692871666704204*^9}, {
   3.692871810243362*^9, 3.692871846348793*^9}, {3.692871950248907*^9, 
   3.692872037263753*^9}, {3.692872138832197*^9, 3.6928721949568787`*^9}, {
   3.692872321579711*^9, 3.692872349875889*^9}, {3.6928723855874033`*^9, 
   3.692872390066606*^9}, {3.6929040722949133`*^9, 3.692904074884665*^9}, {
   3.707968893292818*^9, 3.707968900090858*^9}, {3.71462284751265*^9, 
   3.71462284931085*^9}, {3.720097484221313*^9, 3.7200975219576263`*^9}, 
   3.720097553200466*^9, {3.720097724029542*^9, 3.7200977248921824`*^9}, 
   3.758622140925914*^9, {3.758622229373827*^9, 3.7586222303425417`*^9}, {
   3.758628146831724*^9, 3.758628148467873*^9}, {3.759119638563305*^9, 
   3.759119649923334*^9}, {3.759121455076291*^9, 3.759121455841659*^9}, {
   3.759121536263508*^9, 3.759121541566153*^9}, {3.759124439411894*^9, 
   3.7591244440107203`*^9}, {3.836116278390965*^9, 
   3.8361162825884733`*^9}},ExpressionUUID->"0e63f571-5ccb-4001-a773-\
3533ab442636"],

Cell[BoxData[
 RowBox[{"StegosaurusMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "n_", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M", ",", "file"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"file", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"SourcePath", "[", 
            RowBox[{
             RowBox[{"Packages", "[", "$PM", "]"}], "[", "\"\<Mesh\>\"", 
             "]"}], "]"}], ",", "\"\<Geometries\>\"", ",", 
           "\"\<Stegosaurus\>\"", ",", "\"\<STEGOSRS.obj\>\""}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"ToMesh", "[", 
         RowBox[{"RepairMesh", "[", 
          RowBox[{"Import", "[", "file", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"Subdivide", "[", 
         RowBox[{"M", ",", 
          RowBox[{"Subdivisions", "\[Rule]", "n"}], ",", 
          RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<MultiGrid\>\"", "]"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Centralize", "[", "M", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", "False"}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.697823791053651*^9, 3.697823794253446*^9}, {
   3.697824333383383*^9, 3.6978243613073606`*^9}, {3.697825660679111*^9, 
   3.697825705955822*^9}, {3.7079689046477957`*^9, 3.707968905711855*^9}, 
   3.7249584842193613`*^9, 3.724958592008925*^9, 
   3.756307690733509*^9},ExpressionUUID->"9415a0e9-5c11-4497-bf26-\
f7806ab07e48"],

Cell[BoxData[
 RowBox[{"BrachiosaurusMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "n_", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "M", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"M", "=", 
        RowBox[{"ToMesh", "[", 
         RowBox[{"Import", "[", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"SourcePath", "[", 
              RowBox[{
               RowBox[{"Packages", "[", "$PM", "]"}], "[", "\"\<Mesh\>\"", 
               "]"}], "]"}], ",", "\"\<Geometries\>\"", ",", 
             "\"\<Brachiosaurus\>\"", ",", "\"\<Brac.obj\>\""}], "}"}], "]"}],
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"Subdivide", "[", 
         RowBox[{"M", ",", 
          RowBox[{"Subdivisions", "\[Rule]", "n"}], ",", 
          RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<MultiGrid\>\"", "]"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Centralize", "[", "M", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", "False"}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6978248731615343`*^9, 3.697824887300229*^9}, {
   3.707968907758922*^9, 3.707968913543009*^9}, 3.7249584806833773`*^9, {
   3.724958595992567*^9, 3.724958597743286*^9}, 
   3.756307691243783*^9},ExpressionUUID->"5a3090f7-72e0-4fb3-b970-\
a425e5a158be"],

Cell[BoxData[
 RowBox[{"ClosedPlanarCurveFillMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"b_", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "n", ",", "Inst", ",", "s", ",", "r", ",", "outInst", ",", "m", ",", 
        "e", ",", "digits"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "b", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Inst", "=", 
        RowBox[{"TriangleCreate", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"TriangleSetPoints", "[", 
        RowBox[{"Inst", ",", "b"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"TriangleSetSegments", "[", 
        RowBox[{"Inst", ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", "n", "]"}], ",", 
            RowBox[{"RotateLeft", "@", 
             RowBox[{"Range", "[", "n", "]"}]}]}], "}"}], "]"}]}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"Mean", "[", 
         RowBox[{"cNorm3", "[", 
          RowBox[{"Differences", "[", "b", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", "e"}], "}"}], "=", 
        RowBox[{"MantissaExponent", "[", 
         RowBox[{
          RowBox[{"r", "^", "2"}], "/", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"digits", "=", 
          RowBox[{"StringTake", "[", 
           RowBox[{
            RowBox[{"Internal`DoubleToString", "[", 
             RowBox[{"m", ",", "False"}], "]"}], ",", 
            RowBox[{"3", ";;"}]}], "]"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"digits", "=", 
        RowBox[{"StringTake", "[", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"DecimalForm", "[", "m", "]"}], "]"}], ",", 
          RowBox[{"3", ";;"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"s", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"e", "\[LessEqual]", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<0\>\"", ",", "\"\<.\>\"", ",", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"\"\<0\>\"", ",", 
              RowBox[{"-", "e"}]}], "]"}], ",", "digits"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"e", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
            "digits", ",", "\[IndentingNewLine]", 
            RowBox[{"StringInsert", "[", 
             RowBox[{"digits", ",", "\"\<.\>\"", ",", 
              RowBox[{"e", "+", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"outInst", "=", 
        RowBox[{"TriangleTriangulate", "[", " ", 
         RowBox[{"Inst", ",", " ", 
          RowBox[{"\"\<pqa\>\"", "<>", "s", "<>", "\"\<Y\>\""}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Init", "[", 
        RowBox[{"mesh", ",", 
         RowBox[{"TriangleGetPoints", "[", "outInst", "]"}], ",", 
         RowBox[{"TriangleGetElements", "[", "outInst", "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.69841758739401*^9, 3.698417651580113*^9}, {
  3.698417850290753*^9, 3.69841786227472*^9}, {3.7884411116589117`*^9, 
  3.788441117280179*^9}, {3.829723064505416*^9, 
  3.8297230742292233`*^9}},ExpressionUUID->"36cfdfc2-e40a-4e50-b501-\
132720553cfa"],

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"X", ",", "z", ",", "f", ",", "g"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"f", "=", 
      RowBox[{"z", "\[Function]", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{"z", "\[Function]", "z"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"code", "=", 
         RowBox[{"N", "@", 
          RowBox[{"ComplexExpand", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Re", "[", 
               RowBox[{"Integrate", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"f", "[", "z", "]"}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"g", "[", "z", "]"}], "^", "2"}]}], ")"}], "/", 
                   "2"}]}], ",", "z"}], "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Re", "[", 
               RowBox[{"Integrate", "[", 
                RowBox[{
                 RowBox[{"I", " ", 
                  RowBox[{"f", "[", "z", "]"}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{"g", "[", "z", "]"}], "^", "2"}]}], ")"}], "/", 
                   "2"}]}], ",", "z"}], "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Re", "[", 
               RowBox[{"Integrate", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"f", "[", "z", "]"}], 
                  RowBox[{"g", "[", "z", "]"}]}], ",", "z"}], "]"}], "]"}]}], 
             "\[IndentingNewLine]", "}"}], "/.", 
            RowBox[{"{", 
             RowBox[{"z", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "X", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "+", " ", 
                RowBox[{"I", " ", 
                 RowBox[{
                 "X", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}]}], ")"}]}], "}"}]}], "]"}]}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"cEnnerperSurface", "=", 
        RowBox[{"CPackageFunction", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"X", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
          "\[IndentingNewLine]", "code", ",", "\[IndentingNewLine]", 
          RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"RuntimeAttributes", "\[Rule]", 
           RowBox[{"{", "Listable", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Parallelization", "\[Rule]", "True"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}], "]"}]], "Input",
 CellChangeTimes->{
  3.7154171463580112`*^9, {3.7154172129214077`*^9, 3.715417268748629*^9}, 
   3.790750326629343*^9},ExpressionUUID->"6e4b8f59-5c00-430d-ab0c-\
57cd19c0ca99"],

Cell[BoxData[
 RowBox[{"EnneperSurface", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"n_", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", ",", "M0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "=", 
        RowBox[{"OptionValue", "[", "\"\<Radius\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M0", "=", 
        RowBox[{"DiskMesh", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Init", "[", 
        RowBox[{"mesh", ",", 
         RowBox[{"cEnnerperSurface", "[", 
          RowBox[{"r", " ", 
           RowBox[{"VertexCoordinates", "[", "M0", "]"}]}], "]"}], ",", 
         RowBox[{"Triangles", "[", "M0", "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Radius\>\"", "\[Rule]", "1."}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7200974869334707`*^9, 3.720097498338822*^9}, 
   3.790750328644374*^9},ExpressionUUID->"ac44e100-4d8c-4ed5-b350-\
06ecd2ce6e9a"],

Cell[BoxData[
 RowBox[{"Quiet", "[", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "h", ",", "s", ",", "\[CapitalPhi]", ",", "\[CapitalPsi]", ",", "f", ",",
       "X"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"h", "=", 
      RowBox[{"Z", "\[Function]", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"Simplify", "@", 
         RowBox[{"ComplexExpand", "@", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"w", "=", 
              RowBox[{
               RowBox[{
               "Z", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "+", 
               RowBox[{"I", " ", 
                RowBox[{
                "Z", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}]}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Re", "[", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"I", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"w", "^", "3"}], "-", "w"}], ")"}]}], ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"w", "^", "3"}], "+", "w"}], ")"}], ",", 
                RowBox[{
                 RowBox[{"I", "/", "2"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"w", "^", "4"}], "+", "1"}], ")"}]}]}], 
               "\[IndentingNewLine]", "}"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"w", "^", "4"}], "+", 
                RowBox[{"2", 
                 RowBox[{"Sqrt", "[", "3", "]"}], 
                 RowBox[{"w", "^", "2"}]}], "-", "1"}], ")"}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"s", "=", 
      RowBox[{"35", "/", "100"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[CapitalPhi]", "=", 
      RowBox[{"X", "\[Function]", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"r2", "=", 
            RowBox[{
             RowBox[{
              RowBox[{
              "X", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "^", "2"}], "+", 
             RowBox[{
              RowBox[{
              "X", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "^", "2"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "X", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                "-", "s"}], ")"}], "^", "2"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
             "X", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "/",
              "r2"}], ",", 
            RowBox[{
             RowBox[{
             "X", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "/",
              "r2"}], ",", 
            RowBox[{"s", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "X", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                "-", "s"}], ")"}], "/", "r2"}]}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"\[CapitalPsi]", "=", 
      RowBox[{"X", "\[Function]", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "X", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "X", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "}"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{
           "X", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
          ")"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"f", "=", 
      RowBox[{"X", "\[Function]", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"Together", "[", 
           RowBox[{"\[CapitalPhi]", "[", 
            RowBox[{"h", "[", 
             RowBox[{"\[CapitalPsi]", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "X", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "X", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "X", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
                "}"}], "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
             "X", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "^",
              "2"}], "+", 
            RowBox[{
             RowBox[{
             "X", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "^",
              "2"}], "+", 
            RowBox[{
             RowBox[{
             "X", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], "^",
              "2"}]}], "\[Equal]", "1"}]}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"cMorinSurface", "=", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"code", "=", 
          RowBox[{"N", "[", 
           RowBox[{"f", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "X", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "X", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "X", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
             "}"}], "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"CPackageFunction", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"X", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
          "\[IndentingNewLine]", "code", ",", "\[IndentingNewLine]", 
          RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"RuntimeAttributes", "\[Rule]", 
           RowBox[{"{", "Listable", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Parallelization", "\[Rule]", "True"}]}], 
         "\[IndentingNewLine]", "]"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.715566363340547*^9, 3.7155664889362707`*^9}, {
   3.71556667055158*^9, 3.7155667700450077`*^9}, {3.715566808155346*^9, 
   3.71556680937921*^9}, {3.715566855042493*^9, 3.7155669613577623`*^9}, {
   3.7155676308553057`*^9, 3.71556763320391*^9}, {3.71556793468801*^9, 
   3.715567976493272*^9}, {3.715568052930809*^9, 3.715568054376915*^9}, 
   3.7155681638994703`*^9, 3.715568224302863*^9, {3.715568460642997*^9, 
   3.715568461826928*^9}, {3.715568556867731*^9, 3.715568559073786*^9}, 
   3.715568963064814*^9, {3.715569312737686*^9, 3.71556937348108*^9}, {
   3.7155719607828617`*^9, 3.715572018201496*^9}, 
   3.7907503360697002`*^9},ExpressionUUID->"c625680b-f1a2-4a9b-8e0f-\
ecff9d241886"],

Cell[BoxData[
 RowBox[{"MorinSurface", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"n_", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"S", ",", "M"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"S", "=", 
        RowBox[{"SphereMesh", "[", 
         RowBox[{"n", ",", 
          RowBox[{"\"\<Polyhedron\>\"", "\[Rule]", "\"\<Octahedron\>\""}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"Init", "[", 
         RowBox[{"mesh", ",", 
          RowBox[{"cMorinSurface", "[", 
           RowBox[{"VertexCoordinates", "[", "S", "]"}], "]"}], ",", 
          RowBox[{"Triangles", "[", "S", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SetGraphicsDirectives", "[", 
        RowBox[{"M", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"EdgeForm", "[", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"FaceForm", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"uniblau", ",", 
               RowBox[{"Specularity", "[", 
                RowBox[{"White", ",", "30"}], "]"}], ",", 
               RowBox[{"Opacity", "[", "1", "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "@", "Orange"}], ",", 
               RowBox[{"Specularity", "[", 
                RowBox[{"White", ",", "30"}], "]"}], ",", 
               RowBox[{"Opacity", "[", "1", "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "M"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.715572027027461*^9, 3.715572092189921*^9}, {
   3.7200974873195677`*^9, 3.720097498832992*^9}, 
   3.790750339659655*^9},ExpressionUUID->"16a6ff06-c818-4e00-9969-\
a2cdc72af537"],

Cell[BoxData[
 RowBox[{"CostaSurface", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"n_", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tlist", ",", "blink", ",", "p1", ",", "p2", ",", "p3", ",", "p0", ",",
         "faces", ",", "Q", ",", "m"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tlist", "=", 
        RowBox[{"Most", "@", 
         RowBox[{"Table", "[", 
          RowBox[{"t", ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0.", ",", 
             RowBox[{"2.", "Pi"}], ",", 
             RowBox[{"2.", 
              RowBox[{"Pi", "/", "8"}]}]}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"blink", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Association", "@", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\"\<Curve\>\"", "\[Rule]", "\[Gamma]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<SamplingPoints\>\"", "\[Rule]", "tlist"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<FirstPoint\>\"", "\[Rule]", 
              RowBox[{"\[Gamma]", "@", 
               RowBox[{
               "tlist", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<SecondPoint\>\"", "\[Rule]", 
              RowBox[{"\[Gamma]", "@", 
               RowBox[{
               "tlist", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}]}]}]}], "\[IndentingNewLine]", 
            "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]", ",", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"t", "\[Function]", 
               RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                 "OptionValue", "[", "\"\<TopTransformation\>\"", "]"}], "[", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"OptionValue", "[", "\"\<TopRadius\>\"", "]"}], 
                    " ", 
                    RowBox[{"Cos", "[", "t", "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"OptionValue", "[", "\"\<TopRadius\>\"", "]"}], 
                    " ", 
                    RowBox[{"Sin", "[", "t", "]"}]}], ",", 
                   RowBox[{"OptionValue", "[", "\"\<TopHeight\>\"", "]"}]}], 
                  "}"}], "\[IndentingNewLine]", "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"t", "\[Function]", 
               RowBox[{"Evaluate", "@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"OptionValue", "[", "\"\<CenterRadius\>\"", "]"}], 
                   " ", 
                   RowBox[{"Cos", "[", "t", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"OptionValue", "[", "\"\<CenterRadius\>\"", "]"}], 
                   " ", 
                   RowBox[{"Sin", "[", "t", "]"}]}], ",", "0"}], "}"}]}]}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"t", "\[Function]", 
               RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                 "OptionValue", "[", "\"\<BottomTransformation\>\"", "]"}], 
                 "[", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"OptionValue", "[", "\"\<BottomRadius\>\"", "]"}],
                     " ", 
                    RowBox[{"Cos", "[", "t", "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"OptionValue", "[", "\"\<BottomRadius\>\"", "]"}],
                     " ", 
                    RowBox[{"Sin", "[", "t", "]"}]}], ",", 
                   RowBox[{"-", 
                    RowBox[{
                    "OptionValue", "[", "\"\<BottomHeight\>\"", "]"}]}]}], 
                  "}"}], "\[IndentingNewLine]", "]"}], "]"}]}]}], 
             "\[IndentingNewLine]", "}"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p1", "=", 
        RowBox[{
         RowBox[{"blink", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "\"\<Curve\>\""}], "\[RightDoubleBracket]"}], "/@", 
         RowBox[{"blink", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "\"\<SamplingPoints\>\""}], 
          "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p2", "=", 
        RowBox[{
         RowBox[{"blink", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "\"\<Curve\>\""}], "\[RightDoubleBracket]"}], "/@", 
         RowBox[{"blink", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "\"\<SamplingPoints\>\""}], 
          "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p0", "=", 
        RowBox[{"Most", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"OptionValue", "[", "\"\<InnerRadius\>\"", "]"}], " ", 
              RowBox[{"Cos", "[", "t", "]"}]}], ",", 
             RowBox[{
              RowBox[{"OptionValue", "[", "\"\<InnerRadius\>\"", "]"}], " ", 
              RowBox[{"Sin", "[", "t", "]"}]}], ",", "0."}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0.", ",", 
             RowBox[{"2.", "Pi"}], ",", 
             RowBox[{"Pi", "/", "2."}]}], "}"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p3", "=", 
        RowBox[{
         RowBox[{"blink", "\[LeftDoubleBracket]", 
          RowBox[{"3", ",", "\"\<Curve\>\""}], "\[RightDoubleBracket]"}], "/@", 
         RowBox[{"blink", "\[LeftDoubleBracket]", 
          RowBox[{"3", ",", "\"\<SamplingPoints\>\""}], 
          "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"faces", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "9", ",", "17"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "18", ",", "11"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "11", ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "10", ",", "9"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "10", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "10", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"13", ",", "19", ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "15", ",", "7"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"19", ",", "18", ",", "4"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "4", ",", "18"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "5", ",", "19"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"14", ",", "13", ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "6", ",", "14"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", "7", ",", "14"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"15", ",", "14", ",", "7"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"8", ",", "20", ",", "7"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"8", ",", "17", ",", "20"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"8", ",", "1", ",", "17"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"21", ",", "17", ",", "18"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"21", ",", "18", ",", "19"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"21", ",", "19", ",", "20"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"21", ",", "20", ",", "17"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"9", ",", "22", ",", "17"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"11", ",", "18", ",", "24"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"9", ",", "16", ",", "22"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"22", ",", "16", ",", "29"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"16", ",", "28", ",", "29"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"15", ",", "28", ",", "16"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "28", ",", "15"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"27", ",", "28", ",", "20"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"19", ",", "27", ",", "20"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"27", ",", "19", ",", "26"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"23", ",", "17", ",", "22"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"23", ",", "18", ",", "17"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"23", ",", "24", ",", "18"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"13", ",", "12", ",", "26"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"26", ",", "12", ",", "25"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"26", ",", "19", ",", "13"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"12", ",", "24", ",", "25"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"12", ",", "11", ",", "24"}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Q", "=", 
        RowBox[{"Init", "[", 
         RowBox[{"mesh", ",", 
          RowBox[{"Join", "[", 
           RowBox[{"p1", ",", "p2", ",", "p0", ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"0.", ",", "0.", ",", "0."}], "}"}], "}"}], ",", "p3"}],
            "]"}], ",", "faces", ",", "blink"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m", "=", 
        RowBox[{"OptionValue", "[", "\"\<RotationSymmetries\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"m", ">", "2"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tlist", "=", 
           RowBox[{"Most", "[", 
            RowBox[{"Table", "[", 
             RowBox[{"t", ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "0.", ",", 
                RowBox[{"2.", "Pi"}], ",", 
                RowBox[{"2", 
                 RowBox[{
                  RowBox[{"Pi", "/", "4"}], "/", "m"}]}]}], "}"}]}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"blink", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", "a", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"a", "=", "b"}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                 "a", "\[LeftDoubleBracket]", "\"\<SamplingPoints\>\"", 
                  "\[RightDoubleBracket]"}], "=", "tlist"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                 "a", "\[LeftDoubleBracket]", "\"\<FirstPoint\>\"", 
                  "\[RightDoubleBracket]"}], "=", 
                 RowBox[{
                  RowBox[{
                  "a", "\[LeftDoubleBracket]", "\"\<Curve\>\"", 
                   "\[RightDoubleBracket]"}], "[", 
                  RowBox[{
                  "tlist", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                 "a", "\[LeftDoubleBracket]", "\"\<SecondPoint\>\"", 
                  "\[RightDoubleBracket]"}], "=", 
                 RowBox[{
                  RowBox[{
                  "a", "\[LeftDoubleBracket]", "\"\<Curve\>\"", 
                   "\[RightDoubleBracket]"}], "[", 
                  RowBox[{
                  "tlist", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", "a"}]}], "\[IndentingNewLine]", "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"b", ",", "blink"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Quiet", "[", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "x", ",", "xx", ",", "f", ",", "Qlist", ",", "R", ",", "t"}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"f", "=", 
               RowBox[{"t", "\[Function]", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{"Evaluate", "/@", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "t", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "^", "2"}], "+", 
                    RowBox[{
                    RowBox[{
                    "t", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "^", "2"}]}], "<", 
                    RowBox[{"10", "^", 
                    RowBox[{"-", "14"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "t", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "t", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "t", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Append", "[", 
                    RowBox[{
                    RowBox[{"FromPolarCoordinates", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"2", "/", "m"}]}], "}"}], 
                    RowBox[{"ToPolarCoordinates", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "t", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "t", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}], "]"}]}], "]"}], ",", 
                    RowBox[{
                    "t", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], 
                   "\[IndentingNewLine]", "]"}]}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Q", "=", 
               RowBox[{"MeshPart", "[", 
                RowBox[{"Q", ",", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"VertexCoordinates", "[", 
                    RowBox[{"Q", ",", "All", ",", "1"}], "]"}], ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{"x", "\[Function]", 
                    RowBox[{"x", "\[GreaterEqual]", 
                    RowBox[{"-", 
                    RowBox[{"10", "^", 
                    RowBox[{"(", 
                    RowBox[{"-", "6"}], ")"}]}]}]}]}], ")"}]}], ",", "1"}], 
                   "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Q", "=", 
               RowBox[{"Init", "[", 
                RowBox[{"mesh", ",", 
                 RowBox[{"Map", "[", 
                  RowBox[{"f", ",", 
                   RowBox[{"VertexCoordinates", "[", "Q", "]"}]}], "]"}], ",", 
                 RowBox[{"Delete", "[", 
                  RowBox[{
                   RowBox[{"Triangles", "[", "Q", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "7", "}"}], ",", 
                    RowBox[{"{", "14", "}"}]}], "}"}]}], "]"}]}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"Q", "=", 
               RowBox[{"ToleranceGlue", "[", 
                RowBox[{
                 RowBox[{"Join", "@@", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "\[Function]", 
                    RowBox[{
                    RowBox[{"RotationMatrix", "[", 
                    RowBox[{
                    RowBox[{"2.", 
                    RowBox[{"Pi", "/", "m"}], " ", "i"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.", ",", "0.", ",", "1."}], "}"}]}], "]"}], ".",
                     "x"}]}], ")"}], ",", "Q"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "0", ",", 
                    RowBox[{"m", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
                 "0.00001"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"SetPersistentCache", "[", 
               RowBox[{"Q", ",", "\"\<BoundaryLinkData\>\"", ",", "blink"}], 
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Subdivide", "[", 
        RowBox[{"Q", ",", 
         RowBox[{"\"\<Subdivisions\>\"", "\[Rule]", "n"}], ",", 
         RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", 
          RowBox[{"OptionValue", "[", "\"\<MultiGrid\>\"", "]"}]}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<TopRadius\>\"", "\[Rule]", "6."}], ",", 
       RowBox[{"\"\<TopHeight\>\"", "\[Rule]", "5."}], ",", 
       RowBox[{"\"\<TopTransformation\>\"", "\[Rule]", "Identity"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<BottomRadius\>\"", "\[Rule]", "6."}], ",", 
       RowBox[{"\"\<BottomHeight\>\"", "\[Rule]", "5."}], ",", 
       RowBox[{"\"\<BottomTransformation\>\"", "\[Rule]", "Identity"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<CenterRadius\>\"", "\[Rule]", "10."}], ",", 
       RowBox[{"\"\<InnerRadius\>\"", "\[Rule]", "5."}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<RotationSymmetries\>\"", "\[Rule]", "2"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", "False"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.717855280761348*^9, 3.717855330959684*^9}, {
   3.71785603952571*^9, 3.717856100180582*^9}, {3.717856174182604*^9, 
   3.717856175842785*^9}, {3.7178563374413652`*^9, 3.717856340945664*^9}, {
   3.717857871851288*^9, 3.7178578723705673`*^9}, {3.717857930171496*^9, 
   3.717857964855485*^9}, {3.717857999190959*^9, 3.717858106066202*^9}, {
   3.7178581362296677`*^9, 3.7178584209431467`*^9}, {3.717858485410223*^9, 
   3.717858525063816*^9}, {3.717858571320079*^9, 3.7178586130455503`*^9}, {
   3.717861578789357*^9, 3.717861697199121*^9}, {3.717861752420257*^9, 
   3.717861851769245*^9}, {3.717861927167013*^9, 3.717861946245298*^9}, {
   3.7178619801309853`*^9, 3.7178620511330547`*^9}, {3.717862105678236*^9, 
   3.717862383355215*^9}, {3.717862416517192*^9, 3.71786243296511*^9}, {
   3.7178624878115788`*^9, 3.717862489443368*^9}, {3.7178625231394043`*^9, 
   3.717862566143948*^9}, {3.717862617524068*^9, 3.717862622593074*^9}, {
   3.717862766448348*^9, 3.717862882072455*^9}, {3.71786293514036*^9, 
   3.717862946316145*^9}, {3.7178629794088*^9, 3.7178629806072073`*^9}, {
   3.717863032563202*^9, 3.7178630632815847`*^9}, 3.7178630973425903`*^9, {
   3.71786313024716*^9, 3.7178631489566717`*^9}, {3.717863301506345*^9, 
   3.717863375237822*^9}, {3.717863416928838*^9, 3.717863463674638*^9}, 
   3.717863612686906*^9, {3.717863643141902*^9, 3.717863723612957*^9}, {
   3.717863755812785*^9, 3.717863764826785*^9}, {3.717863827296677*^9, 
   3.717863838100337*^9}, {3.717863919386672*^9, 3.71786392055409*^9}, {
   3.7178669656451607`*^9, 3.717867014940337*^9}, 3.717867060604917*^9, {
   3.717867125942871*^9, 3.71786715303056*^9}, 3.7178675024902973`*^9, {
   3.7178678229195557`*^9, 3.717867830602091*^9}, {3.7200974876126633`*^9, 
   3.7200974993700533`*^9}, {3.724958504534151*^9, 3.7249585091562157`*^9}, 
   3.724958603403184*^9},ExpressionUUID->"51ba84d1-2325-4628-a056-\
1dc8c01034a8"],

Cell[BoxData[
 RowBox[{"GaussMap", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_mesh", ",", "\[IndentingNewLine]", 
    RowBox[{"Init", "[", 
     RowBox[{"mesh", ",", 
      RowBox[{"Normals", "[", "M", "]"}], ",", 
      RowBox[{"Triangles", "[", "M", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"92ab2337-fe43-4d8e-98d4-0f041d115770"],

Cell[BoxData[
 RowBox[{"KleinBottle", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"b0_:", "2"}], ",", 
      RowBox[{"h0_:", "6"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "m", ",", "n", ",", "\[CapitalPhi]", ",", "pts", ",", "faces", ",", 
        "M", ",", "R"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}], "=", 
        RowBox[{"OptionValue", "[", "\"\<Mesh\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"n", "+", 
         RowBox[{"Mod", "[", 
          RowBox[{"n", ",", "2", ",", "1"}], "]"}], "-", "1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalPhi]", "=", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"b", "=", 
             RowBox[{"N", "[", "b0", "]"}]}], ",", 
            RowBox[{"h", "=", 
             RowBox[{"N", "[", "h0", "]"}]}], ",", 
            RowBox[{"part", "=", "Compile`GetElement"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"X", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"b", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"part", "[", 
                    RowBox[{"X", ",", "1"}], "]"}], "]"}]}], ")"}], 
                RowBox[{"Cos", "[", 
                 RowBox[{"part", "[", 
                  RowBox[{"X", ",", "1"}], "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"2", "-", 
                  RowBox[{"Cos", "[", 
                   RowBox[{"part", "[", 
                    RowBox[{"X", ",", "1"}], "]"}], "]"}]}], ")"}], " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"part", "[", 
                  RowBox[{"X", ",", "2"}], "]"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"part", "[", 
                    RowBox[{"X", ",", "1"}], "]"}], "/", "2"}], "-", "Pi"}], 
                    ")"}], "^", "2"}]}], "]"}]}], "-", "1"}], ")"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", "-", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"part", "[", 
                   RowBox[{"X", ",", "1"}], "]"}], "]"}]}], ")"}], 
               RowBox[{"Sin", "[", 
                RowBox[{"part", "[", 
                 RowBox[{"X", ",", "2"}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"h", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"part", "[", 
                  RowBox[{"X", ",", "1"}], "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"2", "-", 
                   RowBox[{"Cos", "[", 
                    RowBox[{"part", "[", 
                    RowBox[{"X", ",", "1"}], "]"}], "]"}]}], ")"}], "/", 
                 "2"}], 
                RowBox[{"Sin", "[", 
                 RowBox[{"part", "[", 
                  RowBox[{"X", ",", "1"}], "]"}], "]"}], 
                RowBox[{"Cos", "[", 
                 RowBox[{"part", "[", 
                  RowBox[{"X", ",", "2"}], "]"}], "]"}], 
                RowBox[{"Exp", "[", 
                 RowBox[{"-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"part", "[", 
                    RowBox[{"X", ",", "1"}], "]"}], "-", 
                    RowBox[{"3", 
                    RowBox[{"Pi", "/", "2"}]}]}], ")"}], "^", "2"}]}], 
                 "]"}]}]}]}], "\[IndentingNewLine]", "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Parallelization", "\[Rule]", "True"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"pts", "=", 
        RowBox[{"\[CapitalPhi]", "[", 
         RowBox[{"getGridPoints", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"2", "Pi"}], ",", "0.", ",", 
           RowBox[{"2", "Pi"}], ",", "m", ",", "n", ",", "False", ",", 
           "True"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pts", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", ";;", "m"}], "\[RightDoubleBracket]"}], "=", 
        RowBox[{"RotateLeft", "[", 
         RowBox[{
          RowBox[{"Reverse", "@", 
           RowBox[{"pts", "\[LeftDoubleBracket]", 
            RowBox[{"m", ";;", ";;", "m"}], "\[RightDoubleBracket]"}]}], ",", 
          
          RowBox[{
           RowBox[{"Quotient", "[", 
            RowBox[{"n", ",", "2"}], "]"}], "-", "1"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"faces", "=", 
        RowBox[{"getGridTriangles", "[", 
         RowBox[{"m", ",", "n", ",", "False", ",", "True"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"ToleranceGlue", "[", 
         RowBox[{
          RowBox[{"Init", "[", 
           RowBox[{"mesh", ",", "pts", ",", "faces"}], "]"}], ",", 
          "0.000000001"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"R", "=", 
        RowBox[{"Init", "[", 
         RowBox[{"mesh", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"getGridPoints", "[", 
            RowBox[{
            "0.", ",", "1.", ",", "0.", ",", "1.", ",", "m", ",", "n", ",", 
             "False", ",", "False"}], "]"}], "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", 
            RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"getGridTriangles", "[", 
           RowBox[{"m", ",", "n", ",", "False", ",", "False"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SetTextureMesh", "[", 
        RowBox[{"M", ",", "R"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"SetTexture", "[", 
        RowBox[{"M", ",", 
         RowBox[{"GridTexture", "[", 
          RowBox[{
           RowBox[{"Mesh", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"5", ",", "5"}], "}"}]}], ",", 
           RowBox[{"Thickness", "\[Rule]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], "0.0005"}]}]}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", "M"}]}], "\[IndentingNewLine]", "]"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Mesh", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"36", " ", "3"}], ",", "36"}], "}"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.75828254395224*^9, 3.758282559667883*^9}, 
   3.758282930698864*^9, 3.758786560789967*^9, 
   3.7886730122920313`*^9},ExpressionUUID->"6062a169-9361-4014-9458-\
4e48dd5952c5"],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"z", ",", "Z", ",", "g1", ",", "g2", ",", "g3"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z", "=", 
     RowBox[{
      RowBox[{"Compile`GetElement", "[", 
       RowBox[{"Z", ",", "1"}], "]"}], "+", 
      RowBox[{"I", " ", 
       RowBox[{"Compile`GetElement", "[", 
        RowBox[{"Z", ",", "2"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"g1", "=", 
     RowBox[{"Simplify", "@", 
      RowBox[{"ComplexExpand", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], "/", "2"}], 
        RowBox[{"Im", "[", 
         RowBox[{"z", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"z", "^", "4"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"z", "^", "6"}], "+", 
             RowBox[{
              RowBox[{"Sqrt", "[", "5", "]"}], " ", 
              RowBox[{"z", "^", "3"}]}], "-", "1"}], ")"}]}]}], "]"}]}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"g2", "=", 
     RowBox[{"Simplify", "@", 
      RowBox[{"ComplexExpand", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], "/", "2"}], 
        RowBox[{"Re", "[", 
         RowBox[{"z", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"z", "^", "4"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"z", "^", "6"}], "+", 
             RowBox[{
              RowBox[{"Sqrt", "[", "5", "]"}], " ", 
              RowBox[{"z", "^", "3"}]}], "-", "1"}], ")"}]}]}], "]"}]}], 
       "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"g3", "=", 
     RowBox[{"Simplify", "@", 
      RowBox[{"ComplexExpand", "[", 
       RowBox[{
        RowBox[{"Im", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"z", "^", "6"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"z", "^", "6"}], "+", 
            RowBox[{
             RowBox[{"Sqrt", "[", "5", "]"}], " ", 
             RowBox[{"z", "^", "3"}]}], "-", "1"}], ")"}]}], "]"}], "-", 
        RowBox[{"1", "/", "2"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"code", "=", 
        RowBox[{"N", "@", 
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"g1", "^", "2"}], "+", 
              RowBox[{"g2", "^", "2"}], "+", 
              RowBox[{"g3", "^", "2"}]}], ")"}]}], 
           RowBox[{"{", 
            RowBox[{"g1", ",", "g2", ",", "g3"}], "}"}]}], "]"}]}]}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"cKusnerBriantParameterization", "=", 
       RowBox[{"CPackageFunction", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"Z", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
         "\[IndentingNewLine]", "code", ",", "\[IndentingNewLine]", 
         RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"RuntimeAttributes", "\[Rule]", 
          RowBox[{"{", "Listable", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.757696338845943*^9, 3.75769633952488*^9}, 
   3.790750358581658*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"b75420ed-739d-449c-8953-fd748270132d"],

Cell[BoxData[
 RowBox[{"KusnerBriantMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"n_Integer", "?", "Positive"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "M0", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"M0", "=", 
        RowBox[{"DiskMesh", "[", 
         RowBox[{"Round", "[", 
          RowBox[{"n", ",", "6"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ToleranceGlue", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Init", "[", 
          RowBox[{"mesh", ",", 
           RowBox[{"cKusnerBriantParameterization", "[", 
            RowBox[{"VertexCoordinates", "[", "M0", "]"}], "]"}], ",", 
           RowBox[{"Triangles", "[", "M0", "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "0.000001"}], "\[IndentingNewLine]", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.757696508785202*^9, 3.7576965127414923`*^9}, 
   3.7576965813425293`*^9, 3.790750363349205*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"be21ba18-4f5f-4986-b8be-638b62f54c2c"],

Cell[BoxData[
 RowBox[{"getKochSnowFlakeTriangles", "=", 
  RowBox[{"CPackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ff", ",", "_Integer", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ee", ",", "_Integer", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p", ",", "_Integer"}], "}"}]}], "}"}], ",", "\n", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ff", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"ee", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{
        "ee", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ff", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"ee", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{
        "ee", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ff", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"ee", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{
        "ee", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ee", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"ee", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", "p"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ee", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"ee", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", "p"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ee", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"ee", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
        ",", "p"}], "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"RuntimeAttributes", "\[Rule]", 
     RowBox[{"{", "Listable", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Parallelization", "\[Rule]", "True"}]}], "\n", "]"}]}]], "Input",\

 CellChangeTimes->{{3.6822628524262943`*^9, 3.682262911483995*^9}, 
   3.682263133725606*^9, {3.682263229305624*^9, 3.682263229511897*^9}, {
   3.682307721991321*^9, 3.682307724060742*^9}, 
   3.7201026077960167`*^9},ExpressionUUID->"6947f183-6c97-46ac-a7ca-\
f3596fe508f7"],

Cell[BoxData[
 RowBox[{"KochSnowFlakeTriangles", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_mesh", ",", "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"getKochSnowFlakeTriangles", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Triangles", "[", "M", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"TrianglesNeighEdges", "[", "M", "]"}], "+", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"VertexCount", "[", "M", "]"}], ",", 
           RowBox[{"Dimensions", "[", 
            RowBox[{"TrianglesNeighEdges", "[", "M", "]"}], "]"}]}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"VertexCount", "[", "M", "]"}], "+", 
           RowBox[{"EdgeCount", "[", "M", "]"}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"VertexCount", "[", "M", "]"}], "+", 
           RowBox[{"EdgeCount", "[", "M", "]"}], "+", 
           RowBox[{"TriangleCount", "[", "M", "]"}]}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "1"}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "False"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.682262948586007*^9, 3.682263014833695*^9}, 
   3.6822630935317793`*^9, {3.68226313051096*^9, 3.68226313124163*^9}, 
   3.682307729711063*^9, {3.720102563009512*^9, 3.720102611968793*^9}, {
   3.720102669027589*^9, 3.7201026704196453`*^9}, 3.7231028075229063`*^9, {
   3.79075553284028*^9, 
   3.790755534790182*^9}},ExpressionUUID->"868663b3-eec2-4fa6-9f51-\
911c790a00c0"],

Cell[BoxData[
 RowBox[{"KochSnowFlakeIteration", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M0_mesh", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Sigma]", ",", "M", ",", "newpts", ",", "newfaces"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"M", "\[LeftArrow]", "M0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Sigma]", "=", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<SpikeFactor\>\"", "]"}], " ", 
         "0.25", " ", 
         RowBox[{
          RowBox[{"Sqrt", "[", "3.", "]"}], "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"0.25", 
            RowBox[{"Sqrt", "[", "3.", "]"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"newpts", "=", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"VertexCoordinates", "[", "M", "]"}], ",", 
             RowBox[{"EdgeMidpoints", "[", "M", "]"}], ",", 
             RowBox[{
              RowBox[{"TriangleMidpoints", "[", "M", "]"}], "+", 
              RowBox[{"\[Sigma]", " ", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"Areas", "[", "M", "]"}], "]"}], 
               RowBox[{"TriangleNormals", "[", "M", "]"}]}]}]}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"newfaces", "=", 
           RowBox[{"KochSnowFlakeTriangles", "[", "M", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"M", "=", 
           RowBox[{"Init", "[", 
            RowBox[{"mesh", ",", "newpts", ",", "newfaces"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"OptionValue", "[", "\"\<Iterations\>\"", "]"}]}], "}"}]}],
         "]"}], ";", "\[IndentingNewLine]", "M"}]}], "\[IndentingNewLine]", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Options\>\"", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<SpikeFactor\>\"", "\[Rule]", "1."}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Iterations\>\"", "\[Rule]", "1"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.720102604943173*^9, 3.720102621783537*^9}, {
   3.720102674707467*^9, 3.720102677914412*^9}, 3.723102801931604*^9, {
   3.790755528312625*^9, 
   3.790755530046666*^9}},ExpressionUUID->"cd11e5f0-68eb-4bff-9a20-\
c9a42ce8f791"],

Cell[BoxData[
 RowBox[{"KochSnowFlakeMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m_", ",", "n_"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Sigma]", ",", "M", ",", "newpts", ",", "newfaces"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"M", "=", 
        RowBox[{"ToMesh", "@", 
         RowBox[{"PolyhedronData", "[", "\"\<Tetrahedron\>\"", "]"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"Orient", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"KochSnowFlakeIteration", "[", 
         RowBox[{"M", ",", 
          RowBox[{"\"\<Iterations\>\"", "\[Rule]", "m"}], ",", 
          RowBox[{"\"\<SpikeFactor\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<SpikeFactor\>\"", "]"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Subdivide", "[", 
        RowBox[{"M", ",", 
         RowBox[{"\"\<Subdivisions\>\"", "\[Rule]", "n"}], ",", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"OptionValue", "[", "\"\<SubdivisionMethod\>\"", "]"}]}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Options\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<SubdivisionMethod\>\"", "\[Rule]", "\"\<Loop\>\""}], ",", 
       
       RowBox[{"\"\<SpikeFactor\>\"", "\[Rule]", "1."}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.72010263790914*^9, 
  3.7201026534027767`*^9}},ExpressionUUID->"d9389a64-3545-44df-bd4c-\
0de09d3f5a4e"],

Cell[BoxData[
 RowBox[{"GeckoMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ImportObject", "[", "\[IndentingNewLine]", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"SourcePath", "[", 
         RowBox[{
          RowBox[{"Packages", "[", "$PM", "]"}], "[", "\"\<Mesh\>\"", "]"}], 
         "]"}], ",", "\"\<Geometries\>\"", ",", "\"\<Gecko\>\"", ",", 
        "\"\<gecko.wdx\>\""}], "}"}], "]"}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[576]:=",ExpressionUUID->"2fb6e13f-a0d6-412f-accb-ce991d4facc8"],

Cell[BoxData[
 RowBox[{"TriangleSoup", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n_", ",", 
      RowBox[{"R0_:", "Automatic"}], ",", 
      RowBox[{"r_:", "1."}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"R", ",", "M0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"M0", "=", 
        RowBox[{"StandardSimplexMesh", "[", "1", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"R", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"R0", "===", "Automatic"}], ",", " ", 
          RowBox[{"2", " ", 
           RowBox[{"Surd", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"N", "[", "n", "]"}], "r"}], ",", "3"}], "]"}]}], ",", 
          "R0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"Init", "[", 
         RowBox[{"mesh", ",", "\[IndentingNewLine]", 
          RowBox[{"Join", "@@", 
           RowBox[{"Plus", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"RandomVariate", "[", 
                 RowBox[{
                  RowBox[{"CircularRealMatrixDistribution", "[", "3", "]"}], 
                  ",", "n"}], "]"}], ".", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"r", " ", 
                  RowBox[{
                   RowBox[{"TriangleData", "[", "M0", "]"}], 
                   "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"ConstantArray", "[", 
                RowBox[{"#", ",", "3"}], "]"}], "&"}], "/@", 
              RowBox[{"RandomPoint", "[", 
               RowBox[{
                RowBox[{"Ball", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "R"}], 
                 "]"}], ",", "n"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", 
              RowBox[{"n", " ", "3"}]}], "]"}], ",", "3"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{
  3.80725710524275*^9, 3.807257221494321*^9, {3.80742231676073*^9, 
   3.8074223289116497`*^9}, 3.807422359838575*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"88a02ca0-860f-4604-8f4b-d25f92c859e3"],

Cell[BoxData[
 RowBox[{"SphereCapMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"n_", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", ",", "\[Phi]", ",", "f", ",", "X"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Indexed", "[", 
            RowBox[{"X", ",", "1"}], "]"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"Indexed", "[", 
            RowBox[{"X", ",", "2"}], "]"}], "^", "2"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Phi]", "=", 
        RowBox[{"ArcTan", "[", 
         RowBox[{
          RowBox[{"Indexed", "[", 
           RowBox[{"X", ",", "1"}], "]"}], ",", 
          RowBox[{"Indexed", "[", 
           RowBox[{"X", ",", "2"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"f", "=", 
        RowBox[{"Function", "@@", 
         RowBox[{"{", 
          RowBox[{"X", ",", 
           RowBox[{
            RowBox[{"OptionValue", "[", "\"\<Radius\>\"", "]"}], 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{"Pi", "/", "2"}], "r"}], "]"}], 
               RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
              RowBox[{
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{"Pi", "/", "2"}], "r"}], "]"}], 
               RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"Pi", "/", "2"}], "r"}], "]"}]}], "}"}]}]}], 
          "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{"f", ",", 
         RowBox[{"DiskMesh", "[", "n", "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Radius\>\"", "\[Rule]", "1"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->"98133a02-2db7-\
4d7d-86b0-fa102efe83e0"],

Cell[BoxData[
 RowBox[{"FigureEightTunnelMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "n_", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M", ",", 
        RowBox[{"path", "=", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"SourcePath", "[", 
             RowBox[{
              RowBox[{"Packages", "[", "$PM", "]"}], "[", "\"\<Mesh\>\"", 
              "]"}], "]"}], ",", "\"\<Geometries\>\"", ",", 
            "\"\<Figure8Tunnel5k\>\""}], "}"}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", "path", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"ImportFromOBJ", "[", "\[IndentingNewLine]", 
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{"path", ",", "\"\<Figure8Tunnel5k.obj\>\""}], "}"}], "]"}],
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"Subdivide", "[", 
         RowBox[{"M", ",", 
          RowBox[{"Subdivisions", "\[Rule]", "n"}], ",", 
          RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<MultiGrid\>\"", "]"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"SetPOVrayFinish", "[", 
        RowBox[{"M", ",", "\"\<Dull\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Centralize", "[", "M", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "\"\<Texture\>\"", "\[Rule]", "\"\<spot_texture_highres.png\>\""}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<MultiGrid\>\"", "\[Rule]", "False"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->"In[17]:=",ExpressionUUID->"c29c4102-9506-4652-ab5a-2ddaf594518b"]
},
WindowSize->{1440, 851},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5141, 116, 692, "Input",ExpressionUUID->"9f11f0c0-71f6-4743-a08e-24a05fcacd4e"],
Cell[5702, 138, 5755, 130, 742, "Input",ExpressionUUID->"1a3b6193-0cc2-47ff-b3cd-bc27ad48455a"],
Cell[11460, 270, 5141, 123, 667, "Input",ExpressionUUID->"de83b2e9-3338-4c7b-91d6-fdf9c5717d4d"],
Cell[16604, 395, 22294, 532, 2242, "Input",ExpressionUUID->"36efd3cd-b2c6-4d69-8868-2412c8a7b8f3"],
Cell[38901, 929, 1947, 51, 292, "Input",ExpressionUUID->"5aba9bbf-4e2e-40bf-84e8-896e9a9389fe"],
Cell[40851, 982, 2341, 57, 292, "Input",ExpressionUUID->"facbe6de-5352-4d5b-b5c3-c81d66cd4883"],
Cell[43195, 1041, 2645, 54, 417, "Input",ExpressionUUID->"002a69a4-b0ae-4b1c-8a9b-a662b09b3569"],
Cell[45843, 1097, 3404, 79, 492, "Input",ExpressionUUID->"cd650940-2af8-4e48-8baa-61f00e437cdf"],
Cell[49250, 1178, 6511, 142, 817, "Input",ExpressionUUID->"69d44c90-6300-4dbf-892b-2343f0088fa9"],
Cell[55764, 1322, 1077, 25, 267, "Input",ExpressionUUID->"8a0c47c0-ce47-40d6-947f-bddd39c2db7c"],
Cell[56844, 1349, 8601, 205, 1142, "Input",ExpressionUUID->"4ebe46f9-e1b0-4242-8f4d-77b0bfa10946"],
Cell[65448, 1556, 2541, 65, 392, "Input",ExpressionUUID->"8f9e4210-b039-4432-8ce7-d35e72132988"],
Cell[67992, 1623, 7901, 193, 892, "Input",ExpressionUUID->"a8d0ff82-2863-42cf-9ed7-cf144efec20a"],
Cell[75896, 1818, 10575, 251, 1117, "Input",ExpressionUUID->"6601e01d-6081-4493-91cd-900ba08dab75"],
Cell[86474, 2071, 3721, 79, 492, "Input",ExpressionUUID->"8c6a9d9e-e0bb-4207-98f3-486487b51e6e"],
Cell[90198, 2152, 5121, 114, 717, "Input",ExpressionUUID->"1c9fae79-ad2a-4707-aba8-915170a3fe4e"],
Cell[95322, 2268, 6602, 153, 892, "Input",ExpressionUUID->"5e7d80f6-ab1f-4420-9c68-de7ad86ad4bd"],
Cell[101927, 2423, 5009, 125, 617, "Input",ExpressionUUID->"cd6dd171-fc38-4f5a-a023-e37b84f80b25"],
Cell[106939, 2550, 8218, 200, 667, "Input",ExpressionUUID->"e01780d3-fe8e-4471-ab31-7b6f14dd854a"],
Cell[115160, 2752, 2362, 54, 267, "Input",ExpressionUUID->"a8a016b1-862d-471e-a11e-a7f51f52abbe"],
Cell[117525, 2808, 2187, 53, 267, "Input",ExpressionUUID->"3b15fedd-e675-4ad3-b34c-26a79543056e"],
Cell[119715, 2863, 3214, 75, 417, "Input",ExpressionUUID->"1f220d05-8f21-4e39-9cd7-8b8c959fac43"],
Cell[122932, 2940, 3961, 98, 767, "Input",ExpressionUUID->"3b80d4d5-a4b3-4fc2-b264-586664fcd614"],
Cell[126896, 3040, 915, 20, 192, "Input",ExpressionUUID->"090e1dff-5f54-42f4-881a-4c2e946662bc"],
Cell[127814, 3062, 2171, 51, 317, "Input",ExpressionUUID->"cbd08fde-8c85-4842-928a-81b8eda9afd5"],
Cell[129988, 3115, 3315, 82, 617, "Input",ExpressionUUID->"691e540e-bd19-411f-864c-c76cb46396df"],
Cell[133306, 3199, 16829, 404, 1417, "Input",ExpressionUUID->"9352ed5c-a9fb-454d-85bf-4cb6c5242847"],
Cell[150138, 3605, 2804, 60, 492, "Input",ExpressionUUID->"09929b03-9058-4e83-85fd-68fa689b4c0a"],
Cell[152945, 3667, 3715, 82, 667, "Input",ExpressionUUID->"ba600486-1738-483e-b610-6555c15b6caa"],
Cell[156663, 3751, 3053, 65, 417, "Input",ExpressionUUID->"a86d3402-9242-4d44-bb9d-03e61fa348af"],
Cell[159719, 3818, 2889, 62, 417, "Input",ExpressionUUID->"32a3bd61-9e43-474b-9ef2-f28f540b0056"],
Cell[162611, 3882, 2845, 61, 442, "Input",ExpressionUUID->"a67509fd-d1e8-4553-bac7-31843a3962a6"],
Cell[165459, 3945, 2184, 49, 367, "Input",ExpressionUUID->"619cd504-4ca9-467e-babd-2d7f293a79a8"],
Cell[167646, 3996, 3790, 89, 467, "Input",ExpressionUUID->"2dcb4107-ea4e-47be-bdf9-4ce528acb4f4"],
Cell[171439, 4087, 1388, 32, 217, "Input",ExpressionUUID->"ede8aed5-4a84-4375-adb0-54fdcd619d2c"],
Cell[172830, 4121, 4208, 96, 517, "Input",ExpressionUUID->"856a0a47-a2c8-4a40-a13c-d843eaa356df"],
Cell[177041, 4219, 621, 14, 92, "Input",ExpressionUUID->"bab950e1-3430-4e99-bf71-1efd84da4fb8"],
Cell[177665, 4235, 2984, 70, 392, "Input",ExpressionUUID->"3bf373eb-fc3d-4f9b-a00d-aed806dc4f3f"],
Cell[180652, 4307, 8307, 201, 717, "Input",ExpressionUUID->"ac48b6ca-6c8f-4994-8203-31337bcd47e2"],
Cell[188962, 4510, 18105, 417, 2417, "Input",ExpressionUUID->"0e63f571-5ccb-4001-a773-3533ab442636"],
Cell[207070, 4929, 1922, 44, 292, "Input",ExpressionUUID->"9415a0e9-5c11-4497-bf26-f7806ab07e48"],
Cell[208995, 4975, 1714, 39, 317, "Input",ExpressionUUID->"5a3090f7-72e0-4fb3-b970-a425e5a158be"],
Cell[210712, 5016, 3749, 88, 567, "Input",ExpressionUUID->"36cfdfc2-e40a-4e50-b501-132720553cfa"],
Cell[214464, 5106, 3285, 81, 417, "Input",ExpressionUUID->"6e4b8f59-5c00-430d-ab0c-57cd19c0ca99"],
Cell[217752, 5189, 1145, 27, 217, "Input",ExpressionUUID->"ac44e100-4d8c-4ed5-b350-06ecd2ce6e9a"],
Cell[218900, 5218, 7415, 188, 542, "Input",ExpressionUUID->"c625680b-f1a2-4a9b-8e0f-ecff9d241886"],
Cell[226318, 5408, 1975, 46, 317, "Input",ExpressionUUID->"16a6ff06-c818-4e00-9969-a2cdc72af537"],
Cell[228296, 5456, 20930, 459, 1692, "Input",ExpressionUUID->"51ba84d1-2325-4628-a056-1dc8c01034a8"],
Cell[249229, 5917, 382, 8, 92, "Input",ExpressionUUID->"92ab2337-fe43-4d8e-98d4-0f041d115770"],
Cell[249614, 5927, 7778, 190, 767, "Input",ExpressionUUID->"6062a169-9361-4014-9458-4e48dd5952c5"],
Cell[257395, 6119, 3784, 102, 392, "Input",ExpressionUUID->"b75420ed-739d-449c-8953-fd748270132d"],
Cell[261182, 6223, 1158, 25, 242, "Input",ExpressionUUID->"be21ba18-4f5f-4986-b8be-638b62f54c2c"],
Cell[262343, 6250, 2828, 68, 342, "Input",ExpressionUUID->"6947f183-6c97-46ac-a7ca-f3596fe508f7"],
Cell[265174, 6320, 1735, 36, 292, "Input",ExpressionUUID->"868663b3-eec2-4fa6-9f51-911c790a00c0"],
Cell[266912, 6358, 2572, 60, 442, "Input",ExpressionUUID->"cd11e5f0-68eb-4bff-9a20-c9a42ce8f791"],
Cell[269487, 6420, 1711, 40, 242, "Input",ExpressionUUID->"d9389a64-3545-44df-bd4c-0de09d3f5a4e"],
Cell[271201, 6462, 678, 16, 142, "Input",ExpressionUUID->"2fb6e13f-a0d6-412f-accb-ce991d4facc8"],
Cell[271882, 6480, 2911, 70, 417, "Input",ExpressionUUID->"88a02ca0-860f-4604-8f4b-d25f92c859e3"],
Cell[274796, 6552, 2171, 58, 242, "Input",ExpressionUUID->"98133a02-2db7-4d7d-86b0-fa102efe83e0"],
Cell[276970, 6612, 2047, 47, 392, "Input",ExpressionUUID->"c29c4102-9506-4652-ab5a-2ddaf594518b"]
}
]
*)

