(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     52862,       1184]
NotebookOptionsPosition[     50723,       1151]
NotebookOutlinePosition[     51076,       1167]
CellTagsIndexPosition[     51033,       1164]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClampedEdges", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M_mesh", ",", "\[IndentingNewLine]", 
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Caching", "\[Rule]", "Settings"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"SetClampedEdges", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M_mesh", ",", "edges_"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ClearAllCacheDependingOn", "[", 
      RowBox[{"M", ",", "\"\<ClampedEdges\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SetSettings", "[", 
      RowBox[{"M", ",", "\"\<ClampedEdges\>\"", ",", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"ToPack", "[", 
          RowBox[{"Flatten", "[", "edges", "]"}], "]"}], ",", "2"}], "]"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6369468618003807`*^9, 3.6369468710657253`*^9}, {
   3.636971120223866*^9, 3.636971122462307*^9}, {3.636982131174415*^9, 
   3.6369822728409777`*^9}, {3.636982324620262*^9, 3.6369823903670797`*^9}, {
   3.636982535740713*^9, 3.636982539584149*^9}, {3.637518708152678*^9, 
   3.637518715244576*^9}, {3.637748411851397*^9, 3.637748412262898*^9}, {
   3.6377609834580936`*^9, 3.637760983937676*^9}, {3.6377611943751583`*^9, 
   3.6377611946760397`*^9}, {3.63776213738148*^9, 3.6377621377334833`*^9}, 
   3.637763372568038*^9, {3.6377798367048073`*^9, 3.637779836945261*^9}, 
   3.637815921821354*^9, 3.637816047304117*^9, 3.637840098813958*^9, {
   3.6379469666881447`*^9, 3.637946967626683*^9}, {3.637952987064065*^9, 
   3.637953125634623*^9}, {3.637953171052608*^9, 3.63795317159933*^9}, {
   3.6380010225599813`*^9, 3.638001041198392*^9}, {3.6380010712450953`*^9, 
   3.638001191004332*^9}, 3.638001262445115*^9, {3.638001311591056*^9, 
   3.6380013210034523`*^9}, {3.638001398652945*^9, 3.638001487591095*^9}, {
   3.638002862373725*^9, 3.638002905600418*^9}, {3.6430839512657824`*^9, 
   3.643083997823107*^9}, 3.643084055268751*^9, {3.645708053049918*^9, 
   3.6457080772354527`*^9}, {3.6457081209014606`*^9, 
   3.6457081980919952`*^9}, {3.684745400182328*^9, 3.684745409398335*^9}, {
   3.68474564782478*^9, 3.684745753790554*^9}, {3.68474785227803*^9, 
   3.684747903293211*^9}, {3.684748021157803*^9, 3.6847480215816507`*^9}, {
   3.68474821510225*^9, 3.684748229293795*^9}, {3.684749269104005*^9, 
   3.6847492693920517`*^9}, {3.6847684986545362`*^9, 3.684768519896501*^9}, {
   3.684770515549397*^9, 3.68477053468467*^9}, {3.6847707644074087`*^9, 
   3.684770786577806*^9}, {3.7201793475493727`*^9, 3.720179349034688*^9}, {
   3.728930335667446*^9, 3.728930340368875*^9}, {3.7582741286138277`*^9, 
   3.7582741329613*^9}},ExpressionUUID->"5381a42a-a5c2-41a5-9709-\
3596e3393daf"],

Cell[BoxData[
 RowBox[{"ClampedVertices", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_mesh", ",", "\[IndentingNewLine]", 
    RowBox[{"Union", "@@", 
     RowBox[{"ClampedEdges", "[", "M", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "Persistent"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.684768744525167*^9, 3.6847687706257353`*^9}, {
   3.684770524083473*^9, 3.6847705329038267`*^9}, 3.6848380781370497`*^9, {
   3.7289303181717157`*^9, 3.7289303270242558`*^9}, {3.728930662406996*^9, 
   3.728930667554378*^9}, 3.728930761929809*^9, {3.758274138189296*^9, 
   3.75827414097689*^9}},ExpressionUUID->"3225c52a-089d-4970-8dd4-\
4051ef792eae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClampedVertexCoordinates", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M_mesh", ",", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"VertexCoordinates", "[", 
       RowBox[{"M", ",", 
        RowBox[{"ClampedVertices", "[", "M", "]"}]}], "]"}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClampedVertexCoordinates", "'"}], "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M_mesh", ",", "\[IndentingNewLine]", 
     RowBox[{"LetL", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"plist", "=", 
          RowBox[{
           RowBox[{"ClampedVertices", "[", "M", "]"}], "-", "1"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"qlist", "=", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Length", "[", "plist", "]"}], "-", "1"}]}], "]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"d", "=", 
          RowBox[{"EmbeddingDimension", "[", "M", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "plist", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MySparseArray", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Catenate", "[", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"qlist", " ", "d"}], "+", "i"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}], "]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"Catenate", "[", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"plist", " ", "d"}], "+", "i"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}], "]"}]}],
               "\[IndentingNewLine]", "}"}], "]"}], "\[Rule]", "1."}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "plist", "]"}], " ", 
              RowBox[{"EmbeddingDimension", "[", "M", "]"}]}], ",", 
             RowBox[{"DofCount", "[", "M", "]"}]}], "}"}], ",", "Total"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClampedVertexCoordinates", "''"}], "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_mesh", ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"ClampedVertices", "[", "M", "]"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", ">", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"MySparseArray", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"n", " ", 
             RowBox[{"EmbeddingDimension", "[", "M", "]"}]}], ",", 
            RowBox[{"DofCount", "[", "M", "]"}], ",", 
            RowBox[{"DofCount", "[", "M", "]"}]}], "}"}], ",", "Total"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",\

 CellChangeTimes->{{3.684838028276455*^9, 3.684838054606142*^9}, {
  3.68483813474782*^9, 3.6848381857175303`*^9}, {3.720101532525473*^9, 
  3.7201015586449833`*^9}, {3.728930347209371*^9, 3.728930362609123*^9}, {
  3.7582740679935617`*^9, 3.758274075999127*^9}, {3.758274142395879*^9, 
  3.75827415141718*^9}},ExpressionUUID->"28e7db2a-8892-44a0-a04e-\
1a939b8c370d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DesiredClampedVertexCoordinates", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M_mesh", ",", "\[IndentingNewLine]", 
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Caching", "\[Rule]", "Settings"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"SetDesiredClampedVertexCoordinates", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M_mesh", ",", "pts_"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ClearAllCacheDependingOn", "[", 
      RowBox[{"M", ",", "\"\<DesiredClampedVertexCoordinates\>\""}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"SetSettings", "[", 
      RowBox[{"M", ",", "\"\<DesiredClampedVertexCoordinates\>\"", ",", 
       RowBox[{"Flatten", "[", "pts", "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.684839862472252*^9, 3.684839936295012*^9}, {
  3.728930372061447*^9, 3.728930377137032*^9}, {3.758274153418171*^9, 
  3.75827415944773*^9}, {3.758275050723843*^9, 
  3.7582750644951963`*^9}},ExpressionUUID->"f7e5ef10-b786-498d-937c-\
ce892c41cde1"],

Cell[BoxData[
 RowBox[{"CreateCombinatorics", "[", 
  RowBox[{
  "\"\<ClampedTriple\>\"", ",", "mesh", ",", "3", ",", "M", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "neumannelist", ",", "EOP", ",", "plist", ",", "bndcheck", ",", 
       "neumannplist", ",", "\[IndentingNewLine]", "dofcheck", ",", 
       "neumannedeges"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"neumannedeges", "=", 
       RowBox[{"ClampedEdges", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"neumannelist", "=", 
       RowBox[{"EdgeLookup", "[", 
        RowBox[{"M", ",", 
         RowBox[{"ClampedEdges", "[", "M", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"EOP", "=", 
       RowBox[{"EdgesOppVertices", "[", "M", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plist", "=", 
       RowBox[{"ToPack", "[", 
        RowBox[{
        "EOP", "\[LeftDoubleBracket]", "neumannelist", 
         "\[RightDoubleBracket]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"bndcheck", "=", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"Unitize", "[", "plist", "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}], "]"}], "\[LessEqual]", " ", 
        "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"neumannplist", "=", 
       RowBox[{"plist", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dofcheck", "=", 
       RowBox[{"DuplicateFreeQ", "[", "neumannplist", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<bndcheck: \>\"", ",", "bndcheck"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<dofcheck: \>\"", ",", "dofcheck"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"neumannedeges", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"neumannedeges", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
         "\[IndentingNewLine]", "neumannplist"}], "\[IndentingNewLine]", 
        "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6847685108530817`*^9, 3.6847685122854156`*^9}, {
  3.684769655273149*^9, 3.684769659050414*^9}, {3.6847705519734583`*^9, 
  3.684770585348502*^9}, {3.720179250600534*^9, 
  3.72017925206465*^9}},ExpressionUUID->"b49ead72-7982-4b21-af91-\
3bcfaeddf971"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CreategetFunction", "[", 
    RowBox[{
    "\"\<ClampedNormals\>\"", ",", "mesh", ",", "ClampedTriples", ",", 
     "ClampedTripleData", ",", 
     RowBox[{"\"\<getFunction\>\"", "\[Rule]", "\"\<ClampedNormals2D\>\""}]}],
     "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CreategetFunction", "[", 
    RowBox[{
    "\"\<ClampedUnitEdgeVectors\>\"", ",", "mesh", ",", "ClampedTriples", ",",
      "ClampedTripleData", ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<getFunction\>\"", "\[Rule]", "\"\<ClampedUnitEdgeVectors2D\>\""}]}],
     "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CreateJet", "[", 
    RowBox[{
    "\"\<ClampedNormals\>\"", ",", "\[IndentingNewLine]", "mesh", ",", 
     "\[IndentingNewLine]", "ClampedTriples", ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Global\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Derivatives\>\"", "\[Rule]", "2"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<VectorDimension\>\"", "\[Rule]", "3"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateJet", "[", 
   RowBox[{
   "\"\<ClampedUnitEdgeVectors\>\"", ",", "\[IndentingNewLine]", "mesh", ",", 
    "\[IndentingNewLine]", "ClampedTriples", ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Global\>\"", "\[Rule]", "False"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Derivatives\>\"", "\[Rule]", "0"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<VectorDimension\>\"", "\[Rule]", "3"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.684748435159811*^9, 3.684748442180952*^9}, {
  3.684768868278243*^9, 3.684768870014226*^9}, {3.684769278911809*^9, 
  3.684769289511026*^9}, {3.6847693277496643`*^9, 3.6847693754424562`*^9}, {
  3.684769716650383*^9, 3.6847697591622477`*^9}, {3.6848409146109333`*^9, 
  3.6848409173396053`*^9}, {3.684841089418765*^9, 3.6848410933231297`*^9}, {
  3.6884604906238194`*^9, 3.68846053502649*^9}, {3.688460628439712*^9, 
  3.68846066653791*^9}, {3.689415537077746*^9, 3.689415553242454*^9}, {
  3.689416080499982*^9, 
  3.6894160877691803`*^9}},ExpressionUUID->"544a3427-f3be-419a-af09-\
714da989600a"],

Cell[BoxData[
 RowBox[{"ClampedBinormals", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_mesh", ",", "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{"cCross3", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"ClampedUnitEdgeVectors", "[", "M", "]"}], ",", 
         RowBox[{"EmbeddingDimension", "[", "M", "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"ClampedNormals", "[", "M", "]"}], ",", 
         RowBox[{"EmbeddingDimension", "[", "M", "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.684840953090026*^9, 3.684840974497147*^9}, {
   3.6848413935746803`*^9, 3.684841396024458*^9}, 3.6848422396957703`*^9, {
   3.758274171123301*^9, 
   3.758274172855034*^9}},ExpressionUUID->"42bfbb0a-7846-4d30-8004-\
6a8df834f317"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DesiredClampedNormals", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M_mesh", ",", "\[IndentingNewLine]", 
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Caching", "\[Rule]", "Settings"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"SetDesiredClampedNormals", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M_mesh", ",", "\[Nu]_"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ClearAllCacheDependingOn", "[", 
      RowBox[{"M", ",", "\"\<DesiredClampedNormals\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SetSettings", "[", 
      RowBox[{
      "M", ",", "\"\<DesiredClampedNormals\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"ToPack", "[", 
          RowBox[{"N", "[", 
           RowBox[{"Flatten", "[", "\[Nu]", "]"}], "]"}], "]"}], ",", 
         RowBox[{"EmbeddingDimension", "[", "M", "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.684769496153242*^9, 3.684769503722837*^9}, {
  3.684838690995471*^9, 3.6848386930340776`*^9}, {3.6848427732002697`*^9, 
  3.6848428065599957`*^9}, {3.728930395658442*^9, 3.7289303999898157`*^9}, {
  3.758274174170787*^9, 3.758274180751089*^9}, {3.758276875049404*^9, 
  3.75827688382557*^9}},
 CellLabel->
  "In[266]:=",ExpressionUUID->"7275385e-f0a5-4b2e-b125-bc4126f1a617"],

Cell[BoxData[
 RowBox[{"DesiredClampedUnitEdgeVectors", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_mesh", ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"edges", "=", 
        RowBox[{"ClampedEdges", "[", "M", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"cNormalize3", "[", 
       RowBox[{
        RowBox[{"VertexCoordinates", "[", 
         RowBox[{"M", ",", 
          RowBox[{"edges", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}], "-", 
        RowBox[{"VertexCoordinates", "[", 
         RowBox[{"M", ",", 
          RowBox[{"edges", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
       "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "Persistent"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.684838294017557*^9, 3.6848384676229353`*^9}, 
   3.684838599486495*^9, {3.68483864313098*^9, 3.684838643875526*^9}, {
   3.720101533609371*^9, 3.7201015340524406`*^9}, {3.7582741821330347`*^9, 
   3.7582741849186697`*^9}},ExpressionUUID->"11fd0b2e-b156-44d7-a8ea-\
a5054ba891a0"],

Cell[BoxData[
 RowBox[{"DesiredClampedBinormals", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_mesh", ",", "\[IndentingNewLine]", 
    RowBox[{"cCross3", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DesiredClampedUnitEdgeVectors", "[", "M", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"DesiredClampedNormals", "[", "M", "]"}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "Persistent"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.684769496153242*^9, 3.684769503722837*^9}, {
  3.684769585481161*^9, 3.6847695944178047`*^9}, {3.684838451949354*^9, 
  3.684838492805809*^9}, {3.684838615413926*^9, 3.68483861665287*^9}, {
  3.68483864670883*^9, 3.684838661555517*^9}, {3.684838695083127*^9, 
  3.6848386982106752`*^9}, {3.684842759289041*^9, 3.6848427615524817`*^9}, {
  3.7582741882829943`*^9, 
  3.758274189623314*^9}},ExpressionUUID->"7a8a134e-5d2a-4f36-9a3e-\
e6d98ceca3c7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CreategetFunction", "[", 
    RowBox[{
    "\"\<ClampedNormalCoordinates\>\"", ",", "mesh", ",", "ClampedTriples", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "ClampedTripleData", ",", "\[IndentingNewLine]", 
       "DesiredClampedUnitEdgeVectors", ",", "\[IndentingNewLine]", 
       "DesiredClampedNormals"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "\"\<getFunction\>\"", "\[Rule]", 
      "\"\<ClampedNormalCoordinates2D\>\""}]}], "\[IndentingNewLine]", "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CreateJet", "[", 
   RowBox[{
   "\"\<ClampedNormalCoordinates\>\"", ",", "\[IndentingNewLine]", "mesh", 
    ",", "\[IndentingNewLine]", "ClampedTriples", ",", "\[IndentingNewLine]", 
    
    RowBox[{"\"\<Global\>\"", "\[Rule]", "False"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Derivatives\>\"", "\[Rule]", "2"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<VectorDimension\>\"", "\[Rule]", "1"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6848411069066668`*^9, 3.684841110222259*^9}, {
   3.684841233505103*^9, 3.684841246499345*^9}, {3.684841783989107*^9, 
   3.684841784761012*^9}, 3.684841967014613*^9, 3.684842692020422*^9, 
   3.684842746637315*^9, {3.688460560084461*^9, 3.688460575099393*^9}, 
   3.688460674937862*^9, {3.6894157948208647`*^9, 3.689415849322433*^9}, 
   3.6894160953058567`*^9},ExpressionUUID->"e07a5e01-eada-4b2a-a2f2-\
3bad2c3e1947"],

Cell[BoxData[
 RowBox[{"DesiredClampedBinormalProjector", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_mesh", ",", "\[IndentingNewLine]", 
    RowBox[{"SparseDiagonalBlockMatrix", "[", 
     RowBox[{"List", "/@", 
      RowBox[{"DesiredClampedBinormals", "[", "M", "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6848387412678833`*^9, 3.6848387887153387`*^9}, {
  3.684838916013533*^9, 3.684838919670912*^9}, {3.758274193256432*^9, 
  3.75827419498295*^9}},ExpressionUUID->"a49f9062-38d3-456b-88b8-\
fa075a4e364b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClampedCondition", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M_mesh", ",", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ClampedVertexCoordinates", "[", "M", "]"}], "-", 
        RowBox[{"DesiredClampedVertexCoordinates", "[", "M", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ClampedNormalCoordinates", "[", "M", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClampedCondition", "'"}], "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M_mesh", ",", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ClampedVertexCoordinates", "'"}], "[", "M", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClampedNormalCoordinates", "'"}], "[", "M", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClampedCondition", "'"}], "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M_mesh", ",", "Ulist_", ",", "slotlist_"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"TensorVectorContract", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ClampedVertexCoordinates", "'"}], "[", "M", "]"}], ",", 
         RowBox[{"GetBuffer", "[", 
          RowBox[{"M", ",", "Ulist"}], "]"}], ",", "slotlist"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClampedNormalCoordinates", "'"}], "[", 
        RowBox[{"M", ",", "Ulist", ",", "slotlist"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ClampedCondition", "''"}], "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M_mesh", ",", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"ClampedVertexCoordinates", "''"}], "[", "M", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClampedNormalCoordinates", "''"}], "[", "M", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClampedCondition", "''"}], "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M_mesh", ",", "Ulist_", ",", "slotlist_"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TensorVectorContract", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ClampedVertexCoordinates", "''"}], "[", "M", "]"}], ",", 
        RowBox[{"GetBuffer", "[", 
         RowBox[{"M", ",", "Ulist"}], "]"}], ",", "slotlist"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ClampedNormalCoordinates", "''"}], "[", 
       RowBox[{"M", ",", "Ulist", ",", "slotlist"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",\

 CellChangeTimes->{{3.6848396226221123`*^9, 3.684839673823917*^9}, {
   3.684839983352559*^9, 3.684839990096964*^9}, 3.684841118750361*^9, {
   3.684841192491838*^9, 3.684841196188525*^9}, {3.688453197494295*^9, 
   3.688453197924306*^9}, 3.688460355140286*^9, {3.6884613051563168`*^9, 
   3.688461308090266*^9}, {3.688532193575911*^9, 3.688532194130682*^9}, {
   3.689415639552731*^9, 3.689415722229653*^9}, {3.7195031654542217`*^9, 
   3.719503174398703*^9}, {3.728908967696355*^9, 3.728908979534843*^9}, {
   3.728909055880739*^9, 3.728909100970787*^9}, {3.728909135445924*^9, 
   3.7289093457066593`*^9}, {3.72890983035205*^9, 3.7289098722371197`*^9}, 
   3.728909909565954*^9, {3.728928857369565*^9, 3.7289288612143993`*^9}, {
   3.728930423680087*^9, 3.728930424134699*^9}, {3.728930455270578*^9, 
   3.728930507504169*^9}, {3.758274196535891*^9, 3.75827421513409*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"0f4ce551-d0c2-40a1-a01f-f545699aa06c"],

Cell[BoxData[
 RowBox[{"ClampedFrames", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_mesh", ",", "\[IndentingNewLine]", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"ClampedUnitEdgeVectors", "[", "M", "]"}], ",", 
         RowBox[{"EmbeddingDimension", "[", "M", "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"ClampedNormals", "[", "M", "]"}], ",", 
         RowBox[{"EmbeddingDimension", "[", "M", "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"ClampedBinormals", "[", "M", "]"}], ",", 
         RowBox[{"EmbeddingDimension", "[", "M", "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.684748300655107*^9, 3.684748384343013*^9}, 
   3.684748451702423*^9, 3.6847688746316557`*^9, 3.684769323171063*^9, 
   3.6847715604562807`*^9, {3.7582742178177557`*^9, 3.7582742203578672`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"e071a1e1-8aed-4668-bfa8-6caefaa833b3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClampedEdgeMidpoints", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M_mesh", ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p", "=", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"VertexCoordinates", "[", 
            RowBox[{"M", ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{"ClampedEdges", "[", "M", "]"}], "]"}]}], "]"}], ",", 
           "2"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"0.5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "\[LeftDoubleBracket]", " ", 
           RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
          RowBox[{"p", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], ")"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ClampedFramePlot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_mesh", ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Plist", "=", 
        RowBox[{"ClampedEdgeMidpoints", "[", "M", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Arrowheads", "[", "0.0", "]"}], ",", "\[IndentingNewLine]",
           "\[IndentingNewLine]", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Red"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Arrow", "@", 
           RowBox[{"Transpose", "@", 
            RowBox[{"{", 
             RowBox[{"Plist", ",", 
              RowBox[{"Plist", "+", 
               RowBox[{
                RowBox[{"OptionValue", "[", "\"\<VectorScale\>\"", "]"}], 
                "\[IndentingNewLine]", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"ClampedUnitEdgeVectors", "[", "M", "]"}], ",", 
                  RowBox[{"EmbeddingDimension", "[", "M", "]"}]}], 
                 "]"}]}]}]}], "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Green"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Arrow", "@", 
           RowBox[{"Transpose", "@", 
            RowBox[{"{", 
             RowBox[{"Plist", ",", 
              RowBox[{"Plist", "+", 
               RowBox[{
                RowBox[{"OptionValue", "[", "\"\<VectorScale\>\"", "]"}], 
                "\[IndentingNewLine]", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"ClampedNormals", "[", "M", "]"}], ",", 
                  RowBox[{"EmbeddingDimension", "[", "M", "]"}]}], 
                 "]"}]}]}]}], "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Blue"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Arrow", "@", 
           RowBox[{"Transpose", "@", 
            RowBox[{"{", 
             RowBox[{"Plist", ",", 
              RowBox[{"Plist", "+", 
               RowBox[{
                RowBox[{"OptionValue", "[", "\"\<VectorScale\>\"", "]"}], 
                "\[IndentingNewLine]", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"ClampedBinormals", "[", "M", "]"}], ",", 
                  RowBox[{"EmbeddingDimension", "[", "M", "]"}]}], 
                 "]"}]}]}]}], "}"}]}]}]}], "\[IndentingNewLine]", "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"VectorStyle", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"\"\<VectorScale\>\"", "\[Rule]", "0.1"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.638003747561754*^9, 3.638003753098917*^9}, {
   3.6380038862870293`*^9, 3.6380038935455313`*^9}, {3.6847486906345463`*^9, 
   3.684748699814878*^9}, {3.684758191279779*^9, 3.6847581971985397`*^9}, {
   3.6847582843840322`*^9, 3.684758298785832*^9}, {3.684759954295268*^9, 
   3.6847599552164907`*^9}, {3.6847685741669493`*^9, 3.684768575486084*^9}, {
   3.6847693870337687`*^9, 3.6847693922992887`*^9}, {3.684769427808857*^9, 
   3.684769447108122*^9}, {3.6847698706550694`*^9, 3.684769906992684*^9}, {
   3.684771029433692*^9, 3.684771031031787*^9}, {3.6847712796157417`*^9, 
   3.684771283519312*^9}, {3.684771772555161*^9, 3.6847717856815977`*^9}, {
   3.6847731522881727`*^9, 3.6847731531447153`*^9}, 3.68477323325671*^9, {
   3.720101535094503*^9, 3.720101541871265*^9}, {3.758274222664342*^9, 
   3.758274235294581*^9}},ExpressionUUID->"d892b463-4adb-4133-95a9-\
5548081d4492"],

Cell[BoxData[
 RowBox[{"DesiredClampedFramePlot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_mesh", ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Plist", "=", 
        RowBox[{"ClampedEdgeMidpoints", "[", "M", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Arrowheads", "[", "0.0", "]"}], ",", "\[IndentingNewLine]",
           "\[IndentingNewLine]", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Red"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Arrow", "@", 
           RowBox[{"Transpose", "@", 
            RowBox[{"{", 
             RowBox[{"Plist", ",", 
              RowBox[{"Plist", "+", 
               RowBox[{
                RowBox[{"OptionValue", "[", "\"\<VectorScale\>\"", "]"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                "DesiredClampedUnitEdgeVectors", "[", "M", "]"}]}]}]}], 
             "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Green"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Arrow", "@", 
           RowBox[{"Transpose", "@", 
            RowBox[{"{", 
             RowBox[{"Plist", ",", 
              RowBox[{"Plist", "+", 
               RowBox[{
                RowBox[{"OptionValue", "[", "\"\<VectorScale\>\"", "]"}], 
                "\[IndentingNewLine]", 
                RowBox[{"DesiredClampedNormals", "[", "M", "]"}]}]}]}], 
             "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Blue"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Arrow", "@", 
           RowBox[{"Transpose", "@", 
            RowBox[{"{", 
             RowBox[{"Plist", ",", 
              RowBox[{"Plist", "+", 
               RowBox[{
                RowBox[{"OptionValue", "[", "\"\<VectorScale\>\"", "]"}], 
                "\[IndentingNewLine]", 
                RowBox[{"DesiredClampedBinormals", "[", "M", "]"}]}]}]}], 
             "}"}]}]}]}], "\[IndentingNewLine]", "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"VectorStyle", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"\"\<VectorScale\>\"", "\[Rule]", "0.1"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.68484213507176*^9, 3.684842177853158*^9}, {
  3.684848628730958*^9, 3.684848631906878*^9}, {3.758274237791864*^9, 
  3.758274239989736*^9}},ExpressionUUID->"fb82f53b-bfea-4b6a-85b8-\
b6a2812ec9fc"],

Cell[BoxData[
 RowBox[{"ClampedNormalPlot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_mesh", ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Plist", "=", 
        RowBox[{"ClampedEdgeMidpoints", "[", "M", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Arrowheads", "[", "0.0", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Red"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Arrow", "@", 
           RowBox[{"Transpose", "@", 
            RowBox[{"{", 
             RowBox[{"Plist", ",", 
              RowBox[{"Plist", "+", 
               RowBox[{
                RowBox[{"OptionValue", "[", "\"\<VectorScale\>\"", "]"}], 
                "\[IndentingNewLine]", 
                RowBox[{"DesiredClampedNormals", "[", "M", "]"}]}]}]}], 
             "}"}]}]}], ",", "\[IndentingNewLine]", "Black", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Arrow", "@", 
           RowBox[{"Transpose", "@", 
            RowBox[{"{", 
             RowBox[{"Plist", ",", 
              RowBox[{"Plist", "+", 
               RowBox[{
                RowBox[{"OptionValue", "[", "\"\<VectorScale\>\"", "]"}], 
                "\[IndentingNewLine]", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"ClampedNormals", "[", "M", "]"}], ",", 
                  RowBox[{"EmbeddingDimension", "[", "M", "]"}]}], 
                 "]"}]}]}]}], "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Darker", "@", 
           RowBox[{"Darker", "@", "Blue"}]}]}], "\[IndentingNewLine]", "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"VectorStyle", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"\"\<VectorScale\>\"", "\[Rule]", "0.1"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{
  3.684758248967127*^9, {3.684773157280055*^9, 3.684773198046612*^9}, {
   3.684773236101687*^9, 3.684773236351109*^9}, {3.758274242881173*^9, 
   3.758274244219987*^9}, 3.7582768989820433`*^9},
 CellLabel->
  "In[268]:=",ExpressionUUID->"759df766-4c09-4cd6-bf06-32c562c8e7a1"],

Cell[BoxData[
 RowBox[{"BoundaryParameterizations", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_mesh", ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"strata", "=", 
        RowBox[{"OrientedBoundaryEdges", "[", "M", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"tlist", "=", 
            RowBox[{"Accumulate", "[", "\[IndentingNewLine]", 
             RowBox[{"Prepend", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"getEdgeLengths3D", "[", 
                 RowBox[{"Partition", "[", 
                  RowBox[{
                   RowBox[{"VertexCoordinates", "[", 
                    RowBox[{"M", ",", 
                    RowBox[{"Flatten", "[", "edges", "]"}]}], "]"}], ",", 
                   "2"}], "]"}], "]"}], "]"}], ",", "0."}], "]"}], 
             "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tlist", "=", " ", 
            RowBox[{"tlist", "/", 
             RowBox[{"tlist", "\[LeftDoubleBracket]", 
              RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"edges", ",", 
            RowBox[{
            "strata", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"tlist", "=", 
            RowBox[{"Accumulate", "[", "\[IndentingNewLine]", 
             RowBox[{"Prepend", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"getEdgeLengths3D", "[", 
                 RowBox[{"Partition", "[", 
                  RowBox[{
                   RowBox[{"VertexCoordinates", "[", 
                    RowBox[{"M", ",", 
                    RowBox[{"Flatten", "[", "edges", "]"}]}], "]"}], ",", 
                   "2"}], "]"}], "]"}], "]"}], ",", "0."}], "]"}], 
             "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tlist", "=", 
            RowBox[{"2", "Pi", " ", 
             RowBox[{"tlist", "/", 
              RowBox[{"tlist", "\[LeftDoubleBracket]", 
               RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"edges", ",", 
            RowBox[{
            "strata", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.684772528653417*^9, 3.68477255394586*^9}, {
  3.684772681035491*^9, 3.6847726914804*^9}, {3.684772722490637*^9, 
  3.684772859115665*^9}, {3.720101530758412*^9, 3.720101531333984*^9}, {
  3.758274246529261*^9, 3.7582742486534977`*^9}, {3.7582747141403723`*^9, 
  3.758274717411043*^9}, {3.758274751625534*^9, 
  3.7582747575734*^9}},ExpressionUUID->"6aff278f-da7b-4d36-9e26-f629fe091a25"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "RotateBoundaryNormals", "]"}]], "Input",
 CellChangeTimes->{{3.758275407928199*^9, 3.758275409312026*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"00dc80ae-67be-48ca-b0b0-c3a5e37d5e9f"],

Cell[BoxData[
 RowBox[{"RotateBoundaryNormals", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M0_mesh", ",", "funs_"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "M", ",", "propts", ",", "maxangle", ",", "oriedges", ",", "tlists", 
        ",", "bndedges", ",", "angles", ",", "elist", ",", "\[Nu]", ",", "b", 
        ",", "\[Nu]0", ",", "b0", ",", "\[Phi]", ",", "n", ",", "tic", ",", 
        "toc", ",", "f"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "PrintTemporary", "[", "\"\<This is RotateBoundaryNormals.\>\"", "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"M", "\[LeftArrow]", "M0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"oriedges", "=", 
        RowBox[{"OrientedBoundaryEdges", "[", "M", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"maxangle", "=", 
        RowBox[{"N", "[", 
         RowBox[{"OptionValue", "[", "\"\<MaxAngle\>\"", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"propts", "=", 
        RowBox[{"OptionValue", "[", "\"\<ProjectionOptions\>\"", "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"SetClampedEdges", "[", 
        RowBox[{"M", ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"OrientedBoundaryEdges", "[", "M", "]"}], ",", "2"}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"tlists", "=", 
        RowBox[{"BoundaryParameterizations", "[", "M", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bndedges", "=", 
        RowBox[{"BoundaryStrataEdges", "[", "M", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"aa", "=", 
        RowBox[{"angles", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"elist", "=", 
               RowBox[{
               "bndedges", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Table", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"f", "=", 
                  RowBox[{"funs", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"f", "/@", 
                  RowBox[{"MovingAverage", "[", 
                   RowBox[{
                    RowBox[{"tlists", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                    "2"}], "]"}]}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", 
                  RowBox[{"Length", "[", "elist", "]"}]}], "}"}]}], "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], ",", "2"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Nu]", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"ClampedNormals", "[", "M", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SetDesiredClampedVertexCoordinates", "[", 
        RowBox[{"M", ",", 
         RowBox[{"ClampedVertexCoordinates", "[", "M", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"SetDesiredClampedNormals", "[", 
        RowBox[{"M", ",", 
         RowBox[{"ClampedNormals", "[", "M", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Q", "=", "M"}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"Ceiling", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"Abs", "[", "angles", "]"}], "]"}], "/", "maxangle"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Phi]", "=", 
        RowBox[{"N", "[", 
         RowBox[{"angles", "/", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{
        "\"\<Number of Iterations scheduled: \>\"", ",", "n", ",", 
         "\"\<.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<1\>\"", "\[Rule]", "n"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"tic", "=", 
           RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Nu]0", "=", 
           RowBox[{"DesiredClampedNormals", "[", "M", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"b0", "=", 
           RowBox[{"DesiredClampedBinormals", "[", "M", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Nu]", "=", 
           RowBox[{
            RowBox[{"\[Nu]0", " ", 
             RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
            RowBox[{"b0", " ", 
             RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"b", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "\[Nu]0"}], " ", 
             RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
            RowBox[{"b0", " ", 
             RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"SetDesiredClampedVertexCoordinates", "[", 
           RowBox[{"M", ",", 
            RowBox[{"ClampedVertexCoordinates", "[", "M", "]"}]}], "]"}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"SetDesiredClampedNormals", "[", 
           RowBox[{"M", ",", 
            RowBox[{"Flatten", "[", "\[Nu]", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendToConstraintList", "[", 
           RowBox[{"M", ",", "ClampedCondition", ",", 
            RowBox[{"DesiredConstraint", "\[Rule]", "\"\<Zero\>\""}]}], "]"}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"M", "=", 
           RowBox[{"ConstraintProjection", "[", 
            RowBox[{"M", ",", 
             RowBox[{"Sequence", "@@", "propts"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"toc", "=", 
           RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"PrintTemporary", "[", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<Iteration: \>\"", ",", "iter", ",", "\"\<. \>\"", ",", " ", 
            "\[IndentingNewLine]", "\"\<ConstraintViolation: \>\"", ",", 
            RowBox[{"Max", "[", 
             RowBox[{"Abs", "[", 
              RowBox[{"ConstraintViolation", "[", "M", "]"}], "]"}], "]"}], 
            ",", "\"\<. \>\"", ",", "\[IndentingNewLine]", 
            "\"\<Time elapsed: \>\"", ",", 
            RowBox[{"toc", "-", "tic"}], ",", "\"\<. \>\""}], 
           "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"iter", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<2\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"ConstraintProjection", "[", 
         RowBox[{"M", ",", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"(", 
            RowBox[{
            "OptionValue", "[", "\"\<FinalProjectionOptions\>\"", "]"}], 
            ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"PrintTemporary", "[", "\[IndentingNewLine]", 
        RowBox[{"\"\<Iterations finished. ConstraintViolation: \>\"", ",", 
         RowBox[{"Max", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{"ConstraintViolation", "[", "M", "]"}], "]"}], "]"}], ",", 
         "\"\<.\>\""}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "M"}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<MaxAngle\>\"", "\[Rule]", 
        RowBox[{"2", 
         RowBox[{"Pi", "/", "12"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<ProjectionOptions\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Method", "\[Rule]", "\"\<FrozenNewton\>\""}], ",", 
          RowBox[{"MaxIterations", "\[Rule]", "6"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<FinalProjectionOptions\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Method", "\[Rule]", "\"\<FrozenNewton\>\""}], "}"}]}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.68484778324301*^9, 3.6848477957820168`*^9}, {
   3.684847846857997*^9, 3.684847870351801*^9}, {3.6848479900371647`*^9, 
   3.684848014474689*^9}, {3.6849027204352903`*^9, 3.6849027855038967`*^9}, {
   3.728930699663265*^9, 3.728930705508174*^9}, {3.7582742517464314`*^9, 
   3.758274270751522*^9}, {3.75827444586278*^9, 3.758274446772771*^9}, {
   3.7582749543789988`*^9, 3.758274962706654*^9}, {3.758275127679221*^9, 
   3.758275148063171*^9}, {3.758275196022456*^9, 3.758275196335178*^9}, {
   3.7582753494670963`*^9, 3.7582754004367857`*^9}, 3.75827545807631*^9},
 CellLabel->"In[97]:=",ExpressionUUID->"dfe42f97-9142-49a7-a924-3e0eb3085802"]
},
WindowSize->{1440, 851},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2883, 50, 242, "Input",ExpressionUUID->"5381a42a-a5c2-41a5-9709-3596e3393daf"],
Cell[3444, 72, 711, 13, 117, "Input",ExpressionUUID->"3225c52a-089d-4970-8dd4-4051ef792eae"],
Cell[4158, 87, 4273, 103, 767, "Input",ExpressionUUID->"28e7db2a-8892-44a0-a04e-1a939b8c370d"],
Cell[8434, 192, 1199, 25, 242, "Input",ExpressionUUID->"f7e5ef10-b786-498d-937c-ce892c41cde1"],
Cell[9636, 219, 2898, 66, 592, "Input",ExpressionUUID->"b49ead72-7982-4b21-af91-3bcfaeddf971"],
Cell[12537, 287, 2356, 51, 542, "Input",ExpressionUUID->"544a3427-f3be-419a-af09-714da989600a"],
Cell[14896, 340, 970, 22, 167, "Input",ExpressionUUID->"42bfbb0a-7846-4d30-8004-6a8df834f317"],
Cell[15869, 364, 1552, 34, 292, "Input",ExpressionUUID->"7275385e-f0a5-4b2e-b125-bc4126f1a617"],
Cell[17424, 400, 1259, 27, 167, "Input",ExpressionUUID->"11fd0b2e-b156-44d7-a8ea-a5054ba891a0"],
Cell[18686, 429, 996, 19, 192, "Input",ExpressionUUID->"7a8a134e-5d2a-4f36-9a3e-e6d98ceca3c7"],
Cell[19685, 450, 1556, 34, 367, "Input",ExpressionUUID->"e07a5e01-eada-4b2a-a2f2-3bad2c3e1947"],
Cell[21244, 486, 562, 11, 92, "Input",ExpressionUUID->"a49f9062-38d3-456b-88b8-fa075a4e364b"],
Cell[21809, 499, 4291, 97, 867, "Input",ExpressionUUID->"0f4ce551-d0c2-40a1-a01f-f545699aa06c"],
Cell[26103, 598, 1213, 26, 192, "Input",ExpressionUUID->"e071a1e1-8aed-4668-bfa8-6caefaa833b3"],
Cell[27319, 626, 4990, 108, 667, "Input",ExpressionUUID->"d892b463-4adb-4133-95a9-5548081d4492"],
Cell[32312, 736, 2909, 67, 517, "Input",ExpressionUUID->"fb82f53b-bfea-4b6a-85b8-b6a2812ec9fc"],
Cell[35224, 805, 2571, 59, 442, "Input",ExpressionUUID->"759df766-4c09-4cd6-bf06-32c562c8e7a1"],
Cell[37798, 866, 3342, 74, 467, "Input",ExpressionUUID->"6aff278f-da7b-4d36-9e26-f629fe091a25"],
Cell[41143, 942, 226, 3, 41, "Input",ExpressionUUID->"00dc80ae-67be-48ca-b0b0-c3a5e37d5e9f"],
Cell[41372, 947, 9347, 202, 1367, "Input",ExpressionUUID->"dfe42f97-9142-49a7-a924-3e0eb3085802"]
}
]
*)

