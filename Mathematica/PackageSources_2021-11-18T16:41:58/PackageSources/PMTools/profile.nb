(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     81344,       1740]
NotebookOptionsPosition[     78824,       1704]
NotebookOutlinePosition[     79160,       1719]
CellTagsIndexPosition[     79117,       1716]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"profile", "=", 
   RowBox[{"Object", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<Description\>\"", "\[Rule]", 
      "\"\<This is the head used for profile objects.\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<CacheActivated\>\"", "\[Rule]", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<PersistentCacheActivated\>\"", "\[Rule]", "True"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.632690985190308*^9, {3.632827401136145*^9, 3.6328274148330107`*^9}, {
   3.633193833628323*^9, 3.633193837961084*^9}, {3.633194008763186*^9, 
   3.633194011785421*^9}, {3.680248840702671*^9, 3.6802488510931396`*^9}, 
   3.680268682502781*^9, {3.6804088083983393`*^9, 3.680408848238799*^9}, 
   3.680429506426087*^9, 3.68113139331826*^9, 3.6812000195392942`*^9, {
   3.6937540113873796`*^9, 
   3.6937540181474333`*^9}},ExpressionUUID->"db180181-42b7-458d-a1b3-\
223ff56cb5ed"],

Cell[BoxData[
 RowBox[{"VerbatimRegion", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"Init", "::", "usage"}], "=", "\"\<\>\""}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"profile", "/:", 
    RowBox[{"Init", "[", 
     RowBox[{"profile", ",", "result_", ",", "data_Association", ",", 
      RowBox[{"OptionsPattern", "[", 
       RowBox[{"{", "}"}], "]"}]}], "]"}], ":=", 
    RowBox[{"Initialize", "[", 
     RowBox[{"profile", ",", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"\"\<Result\>\"", "\[Rule]", "result"}], ",", 
        RowBox[{"\"\<Data\>\"", "\[Rule]", "data"}]}], 
       "\[RightAssociation]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"CreateFormat", "[", 
    RowBox[{"profile", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\"\<Caption\>\"", "\[Rule]", "\"\<Calls: \>\""}], ",", 
          RowBox[{"\"\<Function\>\"", "\[Rule]", "NumberOfCalls"}]}], 
         "\[RightAssociation]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"\[LeftAssociation]", 
         RowBox[{
          RowBox[{"\"\<Caption\>\"", "\[Rule]", "\"\<TotalTime: \>\""}], ",", 
          
          RowBox[{"\"\<Function\>\"", "\[Rule]", "TotalTime"}]}], 
         "\[RightAssociation]"}]}], "\[IndentingNewLine]", "}"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6811321683851757`*^9, 3.681132310322715*^9}, {
   3.6811324618441877`*^9, 3.681132464993331*^9}, {3.681134785703697*^9, 
   3.6811347965284452`*^9}, {3.681135625437714*^9, 3.6811356269799433`*^9}, {
   3.6811359671310663`*^9, 3.68113598066352*^9}, 3.6811445208607264`*^9, {
   3.681200022082737*^9, 3.6812000231174593`*^9}, {3.6812012634290648`*^9, 
   3.6812012686281567`*^9}, {3.681290286094648*^9, 3.681290326662993*^9}, {
   3.681290851572365*^9, 3.681290898364396*^9}, 3.681290940157605*^9, {
   3.681311219104185*^9, 3.681311296674086*^9}, {3.681311493064481*^9, 
   3.6813114972053223`*^9}, {3.681311594421053*^9, 3.681311658487636*^9}, 
   3.6813119299610653`*^9, {3.681312142198049*^9, 3.6813121462964687`*^9}, {
   3.6813130830308733`*^9, 3.6813131712195463`*^9}, {3.6813132033177567`*^9, 
   3.6813132042832623`*^9}, {3.681313501517391*^9, 3.6813135036858*^9}, {
   3.684142536837372*^9, 3.684142607592991*^9}, {3.693551197201179*^9, 
   3.693551219785631*^9}, {3.6935513083852987`*^9, 3.693551312024106*^9}, {
   3.693551363654882*^9, 3.693551378759986*^9}, {3.693551551036154*^9, 
   3.693551573684247*^9}, {3.693551700624045*^9, 3.693551786140831*^9}, {
   3.693551917067464*^9, 3.69355196062882*^9}, {3.693552051801117*^9, 
   3.693552205390679*^9}, {3.6935522452339497`*^9, 3.693552270419518*^9}, {
   3.6935523751592913`*^9, 3.693552399047945*^9}, {3.69355254254661*^9, 
   3.693552611117516*^9}, {3.693552922800435*^9, 3.693553008684906*^9}, {
   3.693553053499577*^9, 3.6935531069110126`*^9}, {3.6935532458310337`*^9, 
   3.693553297056085*^9}, {3.6935533681696253`*^9, 3.693553390152961*^9}, {
   3.6935534286429358`*^9, 3.6935534468497133`*^9}, 3.693553487051043*^9, {
   3.693553550700004*^9, 3.693553752290262*^9}, {3.6935538032497263`*^9, 
   3.6935538181424427`*^9}, {3.693553858821226*^9, 3.693553862428916*^9}, {
   3.693554005120288*^9, 3.693554132303481*^9}, {3.6935542085133038`*^9, 
   3.693554210128868*^9}, {3.693554250424527*^9, 3.693554265981387*^9}, {
   3.6935543161813993`*^9, 3.693554659403964*^9}, {3.6935547615360126`*^9, 
   3.693554833543947*^9}, {3.693554878475543*^9, 3.693554939932605*^9}, {
   3.693555121436738*^9, 3.693555123052837*^9}, {3.693555613952001*^9, 
   3.6935556146704807`*^9}, {3.693555813281946*^9, 3.693555823422621*^9}, {
   3.693556029188127*^9, 3.693556054370721*^9}, {3.693556602089526*^9, 
   3.693556610376052*^9}, {3.693556640542911*^9, 3.693556641141664*^9}, {
   3.693569658033745*^9, 3.693569659104632*^9}, {3.693583197038045*^9, 
   3.693583212333288*^9}, {3.693583279762395*^9, 3.693583334093317*^9}, {
   3.6935833800297813`*^9, 3.693583435846951*^9}, {3.693583467906164*^9, 
   3.693583520721786*^9}, {3.6935835880362177`*^9, 3.6935836460987167`*^9}, {
   3.693583774309799*^9, 3.6935837835492697`*^9}, 3.693583969700905*^9, {
   3.693584264722337*^9, 3.693584271446187*^9}, {3.693584311254421*^9, 
   3.6935843699770403`*^9}, {3.693642229094617*^9, 3.69364242845007*^9}, {
   3.6936427858884783`*^9, 3.6936429408230953`*^9}, {3.693643816197404*^9, 
   3.69364381872583*^9}, {3.693754038934531*^9, 3.6937540977926188`*^9}, {
   3.693754760271133*^9, 3.693754763604863*^9}, {3.693755102810536*^9, 
   3.6937551346817102`*^9}, {3.693755175391005*^9, 3.6937551809427*^9}, {
   3.694014816776799*^9, 3.694014831557898*^9}, {3.707669935621364*^9, 
   3.707669952908463*^9}, {3.707998229924576*^9, 3.707998260825739*^9}, {
   3.70799838762402*^9, 3.7079983900782003`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"10376da1-8116-47ce-bcae-e323f92485e9"],

Cell[BoxData[
 RowBox[{"NumberOfCalls", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"p_profile", ",", "\[IndentingNewLine]", 
    RowBox[{"Length", "[", 
     RowBox[{
      RowBox[{"p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
      "\[LeftDoubleBracket]", "\"\<Data\>\"", "\[RightDoubleBracket]"}], 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.748687921216275*^9, 
  3.748687923988121*^9}},ExpressionUUID->"4f073a04-bac6-4a4c-a6a3-\
85c1e80a7cf5"],

Cell[BoxData[
 RowBox[{"Data", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"p_profile", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"data", ",", "A", ",", "times", ",", "owntimes"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"data", "=", 
        RowBox[{"p", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "\"\<Data\>\""}], "\[RightDoubleBracket]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"times", "=", 
        RowBox[{"Values", "[", 
         RowBox[{
          RowBox[{"data", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "\"\<Toc\>\""}], "\[RightDoubleBracket]"}], 
          "-", 
          RowBox[{"data", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "\"\<Tic\>\""}], "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"A", "=", 
        RowBox[{"SparseArray", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"List", "@@@", 
              RowBox[{"Normal", "@", 
               RowBox[{"data", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{"2", ";;"}], ",", "\"\<From\>\"", ",", "1"}], 
                "\[RightDoubleBracket]"}]}]}], "+", "1"}], ")"}], "\[Rule]", 
           "1."}], ",", 
          RowBox[{"Length", "[", "times", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"owntimes", "=", 
        RowBox[{"times", "-", 
         RowBox[{"times", ".", "A"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "\"\<Eigentime\>\""}], "\[RightDoubleBracket]"}],
         "=", "owntimes"}], ";", "\[IndentingNewLine]", "data"}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.693757868197254*^9, 3.693757888043393*^9}, {
   3.693808835870229*^9, 3.69380884250441*^9}, {3.69381133322742*^9, 
   3.69381134711026*^9}, {3.748687746235365*^9, 3.74868774775416*^9}, {
   3.797346820194108*^9, 3.797346824993291*^9}, 3.797489407416499*^9, 
   3.7974901519457912`*^9, {3.7974902654696493`*^9, 3.7974902656109056`*^9}},
 CellLabel->
  "In[297]:=",ExpressionUUID->"872bf297-928a-44c7-8d00-519c43a2ed4e"],

Cell[BoxData[
 RowBox[{"TotalTime", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"p_profile", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"p", "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "\"\<Data\>\"", ",", 
       RowBox[{"Key", "[", "0", "]"}], ",", "\"\<Toc\>\""}], 
      "\[RightDoubleBracket]"}], "-", 
     RowBox[{"p", "\[LeftDoubleBracket]", 
      RowBox[{"1", ",", "\"\<Data\>\"", ",", 
       RowBox[{"Key", "[", "0", "]"}], ",", "\"\<Tic\>\""}], 
      "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.697959410599853*^9, 3.6979594298778057`*^9}, {
   3.6979594816721287`*^9, 3.6979594936396437`*^9}, {3.748687758962243*^9, 
   3.748687760865082*^9}, 3.797489722624496*^9},
 CellLabel->
  "In[289]:=",ExpressionUUID->"342d464e-8292-4a20-b4e0-81cbf67a1728"],

Cell[BoxData[
 RowBox[{"Eigentimes", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"p_profile", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Data", "[", "p", "]"}], "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Tag\>\"", ",", "\"\<Eigentime\>\""}], "}"}]}], 
     "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7974901434359007`*^9, 3.797490145913824*^9}, {
  3.7974902599884253`*^9, 3.797490263146105*^9}},
 CellLabel->
  "In[296]:=",ExpressionUUID->"b9abbb32-e49e-47e7-a4a8-563180597e97"],

Cell[BoxData[
 RowBox[{"EigentimeTable", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p_profile", ",", 
      RowBox[{"HoldPattern", "[", 
       RowBox[{"threshold_:", 
        RowBox[{"Quantity", "[", 
         RowBox[{"5.", ",", "\"\<Percent\>\""}], "]"}]}], "]"}]}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tot", ",", "data", ",", "a", ",", "b", ",", "i"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tot", "=", 
        RowBox[{"TotalTime", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"Association", "@", 
         RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"key", ",", "val"}], "}"}], "\[Function]", 
            RowBox[{"key", "\[Rule]", 
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{"\"\<Absolute Eigentime\>\"", "\[Rule]", 
                RowBox[{"Quantity", "[", 
                 RowBox[{
                  RowBox[{"1000", "val"}], ",", "\"\<Milliseconds\>\""}], 
                 "]"}]}], ",", 
               RowBox[{"\"\<Relative Eigentime\>\"", "\[Rule]", 
                RowBox[{"Quantity", "[", 
                 RowBox[{
                  RowBox[{"100", 
                   RowBox[{"val", "/", "tot"}]}], ",", "\"\<Percent\>\""}], 
                 "]"}]}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"ReverseSort", "@", 
            RowBox[{"Merge", "[", 
             RowBox[{
              RowBox[{"Rule", "@@@", 
               RowBox[{"Values", "/@", 
                RowBox[{"Values", "[", 
                 RowBox[{"Eigentimes", "[", "p", "]"}], "]"}]}]}], ",", 
              "Total"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a", "=", 
        RowBox[{"Accumulate", "[", 
         RowBox[{"Reverse", "[", 
          RowBox[{"Values", "[", 
           RowBox[{"data", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "\"\<Relative Eigentime\>\""}], 
            "\[RightDoubleBracket]"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"b", "=", 
        RowBox[{"Accumulate", "[", 
         RowBox[{"Reverse", "[", 
          RowBox[{"Values", "[", 
           RowBox[{"data", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "\"\<Absolute Eigentime\>\""}], 
            "\[RightDoubleBracket]"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"i", "=", 
        RowBox[{
         RowBox[{"FirstPosition", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "\[GreaterEqual]", "threshold"}], ")"}], "&"}], "/@", 
            RowBox[{"Accumulate", "[", 
             RowBox[{"Reverse", "[", 
              RowBox[{"Values", "[", 
               RowBox[{"data", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "\"\<Relative Eigentime\>\""}], 
                "\[RightDoubleBracket]"}], "]"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", "1"}], 
          "\[IndentingNewLine]", "]"}], "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Dataset", "@", 
        RowBox[{"Append", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"data", "\[LeftDoubleBracket]", 
           RowBox[{";;", 
            RowBox[{"-", "i"}]}], "\[RightDoubleBracket]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Others\>\"", "\[Rule]", " ", 
           RowBox[{"Association", "[", 
            RowBox[{
             RowBox[{"\"\<Absolute Eigentime\>\"", "\[Rule]", 
              RowBox[{"b", "\[LeftDoubleBracket]", 
               RowBox[{"i", "-", "1"}], "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{"\"\<Relative Eigentime\>\"", "\[Rule]", 
              RowBox[{"a", "\[LeftDoubleBracket]", 
               RowBox[{"i", "-", "1"}], "\[RightDoubleBracket]"}]}]}], 
            "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.827128782668521*^9, 3.8271287828360853`*^9}, {
  3.8394843122001*^9, 
  3.839484315174464*^9}},ExpressionUUID->"71cccb6c-0b4a-409d-871b-\
a7040f7e9fea"],

Cell[BoxData[
 RowBox[{"EigentimeChart", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p_profile", ",", "timetable_Dataset"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"data", "=", 
        RowBox[{"Normal", "[", "timetable", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PieChart3D", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Map", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"x", "\[Function]", 
             RowBox[{"Tooltip", "[", 
              RowBox[{
               RowBox[{"x", "[", "\"\<Absolute Eigentime\>\"", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Row", "@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{
                    "x", "\[LeftDoubleBracket]", "\"\<Absolute Eigentime\>\"",
                     "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"6", ",", "2", ",", "10"}], "}"}]}], "]"}], ",", 
                  RowBox[{"Spacer", "[", "10", "]"}], ",", "\"\<(\>\"", ",", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{
                    "x", "\[LeftDoubleBracket]", "\"\<Relative Eigentime\>\"",
                     "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"6", ",", "2", ",", "10"}], "}"}]}], "]"}], ",", 
                  "\"\<)\>\""}], "\[IndentingNewLine]", "}"}]}]}], "]"}]}], 
            ",", "\[IndentingNewLine]", "data"}], "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ColorFunction", "\[Rule]", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", "x", "}"}], ",", 
             RowBox[{
              RowBox[{"ColorData", "[", "\"\<DarkRainbow\>\"", "]"}], "[", 
              "x", "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"SectorOrigin", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "1"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ChartLabels", "\[Rule]", 
           RowBox[{"Placed", "[", 
            RowBox[{
             RowBox[{"Keys", "[", "data", "]"}], ",", 
             "\"\<RadialCallout\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
          "ChartElementFunction", "\[Rule]", "\"\<ProfileSector3D\>\""}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.797753353134283*^9, 3.7977533578621798`*^9}, {
  3.797753390123576*^9, 3.7977533912767344`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"2adc5259-3af9-4653-8e16-3e90b40e1838"],

Cell[BoxData[
 RowBox[{"EigentimeChart", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p_profile", ",", 
      RowBox[{"HoldPattern", "[", 
       RowBox[{"threshold_:", 
        RowBox[{"Quantity", "[", 
         RowBox[{"5.", ",", "\"\<Percent\>\""}], "]"}]}], "]"}]}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"data", "=", 
        RowBox[{"Normal", "[", 
         RowBox[{"EigentimeTable", "[", 
          RowBox[{"p", ",", "threshold"}], "]"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PieChart3D", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Map", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"x", "\[Function]", 
             RowBox[{"Tooltip", "[", 
              RowBox[{
               RowBox[{"x", "[", "\"\<Absolute Eigentime\>\"", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Row", "@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{
                    "x", "\[LeftDoubleBracket]", "\"\<Absolute Eigentime\>\"",
                     "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"6", ",", "2", ",", "10"}], "}"}]}], "]"}], ",", 
                  RowBox[{"Spacer", "[", "10", "]"}], ",", "\"\<(\>\"", ",", 
                  RowBox[{"NumberForm", "[", 
                   RowBox[{
                    RowBox[{
                    "x", "\[LeftDoubleBracket]", "\"\<Relative Eigentime\>\"",
                     "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"6", ",", "2", ",", "10"}], "}"}]}], "]"}], ",", 
                  "\"\<)\>\""}], "\[IndentingNewLine]", "}"}]}]}], "]"}]}], 
            ",", "\[IndentingNewLine]", "data"}], "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ColorFunction", "\[Rule]", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", "x", "}"}], ",", 
             RowBox[{
              RowBox[{"ColorData", "[", "\"\<DarkRainbow\>\"", "]"}], "[", 
              "x", "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"SectorOrigin", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "1"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ChartLabels", "\[Rule]", 
           RowBox[{"Placed", "[", 
            RowBox[{
             RowBox[{"Keys", "[", "data", "]"}], ",", 
             "\"\<RadialCallout\>\""}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
          "ChartElementFunction", "\[Rule]", "\"\<ProfileSector3D\>\""}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]", 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.797753374780958*^9, 3.797753377836896*^9}, 
   3.8394843211208572`*^9},ExpressionUUID->"b916e2ad-1998-4c4d-a8a1-\
1639c6b8d0a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"TagTime", "=", 
    RowBox[{"PackageFunction", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p_profile", ",", "tag_"}], "}"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Data", "[", "p", "]"}], "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "\"\<Tag\>\""}], "\[RightDoubleBracket]"}], 
             ",", "tag"}], "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"Data", "[", "p", "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"pos", ",", "\"\<Time\>\""}], "\[RightDoubleBracket]"}], 
         "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"TagTime", "=", 
    RowBox[{"PackageFunction", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p_profile", ",", "taglist_List"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"data", ",", "pos"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"data", "=", 
          RowBox[{"Data", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Reverse", "@", 
          RowBox[{"Sort", "[", 
           RowBox[{"Association", "[", 
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"pos", "=", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Position", "[", 
                  RowBox[{
                   RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "\"\<Tag\>\""}], 
                    "\[RightDoubleBracket]"}], ",", "tag"}], "]"}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"tag", "\[Rule]", 
                RowBox[{"Total", "[", 
                 RowBox[{"data", "\[LeftDoubleBracket]", 
                  RowBox[{"pos", ",", "\"\<Time\>\""}], 
                  "\[RightDoubleBracket]"}], "]"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"tag", ",", "taglist"}], "}"}]}], 
             "\[IndentingNewLine]", "]"}], "]"}], "]"}]}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.748687742439345*^9, 3.7486877525219517`*^9}, {
  3.797489413698255*^9, 
  3.797489417933536*^9}},ExpressionUUID->"e119f363-3c60-4b76-8df1-\
b197291bebb1"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"PackageManagerOverhead", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"p_profile", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"p", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "\"\<Data\>\""}], "\[RightDoubleBracket]"}], "]"}], 
      " ", 
      RowBox[{"OptionValue", "[", "\"\<OverheadPerCall\>\"", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Options", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<OverheadPerCall\>\"", "\[Rule]", "0.00012"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.697952550158524*^9, 3.697952709446879*^9}, {
   3.7079980414759483`*^9, 3.7079980540340643`*^9}, {3.748687755658247*^9, 
   3.748687757217331*^9}, 
   3.797489433069927*^9},ExpressionUUID->"ebae685a-104e-4664-b2b9-\
c4d388d9fe8c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Edges", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"p_profile", ",", "\[IndentingNewLine]", 
     RowBox[{"Reverse", "[", 
      RowBox[{"Rule", "@@@", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Values", "[", 
           RowBox[{"p", "\[LeftDoubleBracket]", 
            RowBox[{
            "1", ",", "\"\<Data\>\"", ",", "All", ",", "\"\<From\>\""}], 
            "\[RightDoubleBracket]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Keys", "[", 
              RowBox[{"p", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "\"\<Data\>\""}], "\[RightDoubleBracket]"}], 
              "]"}], ",", 
             RowBox[{"Values", "[", 
              RowBox[{"p", "\[LeftDoubleBracket]", 
               RowBox[{
               "1", ",", "\"\<Data\>\"", ",", "All", ",", "\"\<Tag\>\""}], 
               "\[RightDoubleBracket]"}], "]"}]}], "}"}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", "]"}]}],
   "*)"}]], "Input",
 CellChangeTimes->{{3.693738951050605*^9, 3.693739084578519*^9}, {
   3.693739140587057*^9, 3.693739141970603*^9}, {3.693755062014414*^9, 
   3.693755068269059*^9}, {3.6937551443545647`*^9, 3.693755162672079*^9}, {
   3.693755225341249*^9, 3.693755264447111*^9}, {3.693755455720649*^9, 
   3.693755460008164*^9}, {3.693755507318321*^9, 3.6937555118055058`*^9}, 
   3.6937560787053633`*^9, 3.693756146789707*^9, {3.6937565080659924`*^9, 
   3.693756511992332*^9}, {3.693756989777019*^9, 3.69375699991143*^9}, {
   3.7486877631461687`*^9, 3.748687764729004*^9}, 
   3.797489445116211*^9},ExpressionUUID->"7d2cc166-5ef4-4580-ba57-\
d708e5dd607a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Graph", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"p_profile", ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "vertexshapefuns", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"vertexshapefuns", "=", 
         RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "y"}], "}"}], "\[Function]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{
               "y", "\[LeftDoubleBracket]", "\"\<Tag\>\"", 
                "\[RightDoubleBracket]"}]}], "}"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "v", ",", "s"}], "}"}], "\[Function]", 
               RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{"Black", ",", "\[IndentingNewLine]", 
                  RowBox[{"Tooltip", "[", 
                   RowBox[{
                    RowBox[{"Text", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Framed", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "y", "\[LeftDoubleBracket]", "\"\<Time\>\"", 
                    "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Background", "\[Rule]", "White"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"FrameMargins", "\[Rule]", "0.5"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"RoundingRadius", "\[Rule]", "2"}]}], 
                    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                    "x"}], "\[IndentingNewLine]", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{
                    "y", "\[LeftDoubleBracket]", "\"\<Tag\>\"", 
                    "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}], 
                 "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", "]"}]}],
               "\[IndentingNewLine]", ")"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Data", "[", "p", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"labels", "=", 
           RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], "\[Function]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"x", ",", 
                  RowBox[{
                  "y", "\[LeftDoubleBracket]", "\"\<Tag\>\"", 
                   "\[RightDoubleBracket]"}]}], "}"}], "\[Rule]", 
                RowBox[{"Placed", "[", 
                 RowBox[{
                  RowBox[{"Tooltip", "[", 
                   RowBox[{
                    RowBox[{
                    "y", "\[LeftDoubleBracket]", "\"\<Time\>\"", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{
                    "y", "\[LeftDoubleBracket]", "\"\<Tag\>\"", 
                    "\[RightDoubleBracket]"}]}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"1", "/", "2"}], ",", 
                    RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}]}], ")"}]}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"Data", "[", "p", "]"}]}], "\[IndentingNewLine]", 
            "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Rectangle", "[", 
           RowBox[{
            RowBox[{"x", "-", 
             RowBox[{"size", "/", "2"}]}], ",", 
            RowBox[{"x", "+", 
             RowBox[{"size", "/", "2"}]}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"edgeshapefun", "[", 
            RowBox[{"el_", ",", "___"}], "]"}], ":=", 
           RowBox[{"{", 
            RowBox[{"Red", ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"el", ",", "0.1"}], "]"}]}], "}"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Graph", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Edges", "[", "p", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"VertexLabels", "\[Rule]", "labels"}], ","}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"GraphLayout", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<LayeredDigraphEmbedding\>\"", ",", 
             RowBox[{"\"\<Orientation\>\"", "\[Rule]", "Left"}]}], "}"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"VertexSize", "\[Rule]", "1.3"}], ","}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"VertexShapeFunction", "\[Rule]", "vertexshapefuns"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"EdgeShapeFunction", "\[Rule]", "edgeshapefun"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "\[IndentingNewLine]",
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.693755269977109*^9, 3.693755290525062*^9}, {
   3.693755462575569*^9, 3.693755502046275*^9}, {3.693755552579002*^9, 
   3.693755666842361*^9}, {3.693756285378537*^9, 3.693756288242334*^9}, {
   3.6937574266864233`*^9, 3.693757439771345*^9}, 3.69375750735562*^9, {
   3.693758030572179*^9, 3.693758032372179*^9}, {3.693758152410696*^9, 
   3.693758154456985*^9}, {3.693758348981324*^9, 3.693758349348044*^9}, {
   3.693804699919279*^9, 3.693804705034149*^9}, {3.693805341581593*^9, 
   3.693805356810871*^9}, {3.6938053912024317`*^9, 3.6938054462707253`*^9}, {
   3.693805516636739*^9, 3.693805520025462*^9}, 3.693805788131185*^9, {
   3.69380582236829*^9, 3.6938059900723*^9}, {3.693806059574485*^9, 
   3.6938060726927233`*^9}, {3.693806185280538*^9, 3.6938062572806396`*^9}, {
   3.693806320950708*^9, 3.693806326103348*^9}, {3.693806457211706*^9, 
   3.693806465776335*^9}, {3.693806496198601*^9, 3.693806574679351*^9}, {
   3.693806645253759*^9, 3.693806680933481*^9}, {3.693806953449731*^9, 
   3.6938070493709383`*^9}, {3.693807080273731*^9, 3.6938070885711327`*^9}, 
   3.693807190447192*^9, {3.693807433355235*^9, 3.693807467529459*^9}, {
   3.693807517552025*^9, 3.693807529240191*^9}, {3.693807577129066*^9, 
   3.69380764129534*^9}, {3.693807701145208*^9, 3.6938077408008003`*^9}, {
   3.6938083684511833`*^9, 3.693808403103611*^9}, {3.693809697330093*^9, 
   3.693809697641231*^9}, {3.693809754071598*^9, 3.69380976347746*^9}, {
   3.743586742658139*^9, 3.7435867504723377`*^9}, {3.748687766938479*^9, 
   3.748687771306325*^9}, 
   3.797489447042204*^9},ExpressionUUID->"be45ac9f-a148-4234-a346-\
9355c03c2652"],

Cell[BoxData[
 RowBox[{"SunburstLeaves", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"p_profile", ",", "\[IndentingNewLine]", 
    RowBox[{"GroupBy", "[", 
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{
        RowBox[{"Data", "[", "p", "]"}], "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "\"\<From\>\"", ",", "1"}], 
        "\[RightDoubleBracket]"}], "]"}], ",", 
      RowBox[{"Last", "\[Rule]", "First"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.695228048661162*^9, 3.6952280790906553`*^9}, {
  3.7486877736015377`*^9, 
  3.7486877752087927`*^9}},ExpressionUUID->"ac557097-008b-440e-a8fa-\
47ae3ee9e9a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SunburstData", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"p_profile", ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "data", ",", "leaves", ",", "layernumber", ",", "factor", ",", 
         "layerlist", ",", "firstinlayer", ",", "restoflayer", ",", 
         "firstannuli", ",", "restannuli", ",", "r1", ",", "r2", ",", 
         "datalist", ",", "t\[Alpha]", ",", "t\[Omega]", ",", "\[Alpha]0", 
         ",", "r0", ",", "i0", ",", "depth", ",", "depth0", ",", "annuli", 
         ",", "radii", ",", "firstcolfun", ",", "restcolfun", ",", 
         "firstedgeform", ",", "restedgeform", ",", "root", ",", "t0", ",", 
         "\[IndentingNewLine]", "firstannulusfun", ",", "restannulusfun", ",",
          "restdatalists", ",", "centerdisk", ",", "\[IndentingNewLine]", 
         "totaltime"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{"Data", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"leaves", "=", 
         RowBox[{"SunburstLeaves", "[", "p", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Alpha]0", "=", 
         RowBox[{"Pi", "/", "2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"r0", "=", "0."}], ";", "\[IndentingNewLine]", 
        RowBox[{"i0", "=", 
         RowBox[{"OptionValue", "[", "\"\<StartWith\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"root", "=", 
         RowBox[{"data", "[", "i0", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"t0", "=", 
         RowBox[{
         "root", "\[LeftDoubleBracket]", "\"\<Tic\>\"", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"depth0", "=", 
         RowBox[{
         "root", "\[LeftDoubleBracket]", "\"\<Depth\>\"", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"totaltime", "=", 
         RowBox[{
          RowBox[{
          "root", "\[LeftDoubleBracket]", "\"\<Toc\>\"", 
           "\[RightDoubleBracket]"}], "-", 
          RowBox[{
          "root", "\[LeftDoubleBracket]", "\"\<Tic\>\"", 
           "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"depth", "=", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"data", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "\"\<Depth\>\""}], "\[RightDoubleBracket]"}],
             "]"}], ",", 
           RowBox[{"OptionValue", "[", "\"\<Depth\>\"", "]"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"radii", "=", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"depth", "+", "r0", "+", "1"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{"depth", "+", "1"}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"restcolfun", "=", 
         RowBox[{"ColorData", "[", "\"\<DarkRainbow\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"restedgeform", "=", 
         RowBox[{"EdgeForm", "[", 
          RowBox[{"{", 
           RowBox[{"Black", ",", "Thin"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"layernumber", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"factor", "=", 
         RowBox[{"2", 
          RowBox[{"Pi", "/", "totaltime"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"layerlist", "=", 
         RowBox[{"{", "i0", "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"centerdisk", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"FaceForm", "[", 
            RowBox[{"restcolfun", "[", 
             RowBox[{"layernumber", "/", "depth"}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", "restedgeform", ",", "\[IndentingNewLine]", 
           
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Disk", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0.", ",", "0."}], "}"}], ",", 
                RowBox[{"1.001", 
                 RowBox[{
                 "radii", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<(\>\"", ",", 
                RowBox[{"ToString", "[", "i0", "]"}], ",", "\"\<) \>\"", ",", 
                
                RowBox[{"ToString", "[", 
                 RowBox[{
                 "root", "\[LeftDoubleBracket]", "\"\<Tag\>\"", 
                  "\[RightDoubleBracket]"}], "]"}], ",", "\"\< Time = \>\"", 
                ",", 
                RowBox[{"ToString", "[", "totaltime", "]"}], ",", 
                "\"\< s  (100.0 %)\>\""}], "]"}]}], "\[IndentingNewLine]", 
             "}"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"restannulusfun", "=", 
         RowBox[{"x", "\[Function]", 
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"x", "\[LeftDoubleBracket]", 
               RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
              RowBox[{"x", "\[LeftDoubleBracket]", 
               RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], ">", 
             RowBox[{"10", "^", 
              RowBox[{"-", "4"}]}]}], "\[IndentingNewLine]", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Annulus", "@@", 
                RowBox[{"x", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ";;", "3"}], "\[RightDoubleBracket]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"StringJoin", "[", 
                RowBox[{"\"\<(\>\"", ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"x", "\[LeftDoubleBracket]", 
                   RowBox[{"-", "3"}], "\[RightDoubleBracket]"}], "]"}], ",", 
                 "\"\<) \>\"", ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"x", "\[LeftDoubleBracket]", 
                   RowBox[{"-", "2"}], "\[RightDoubleBracket]"}], "]"}], ",", 
                 "\"\< Time = \>\"", ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"x", "\[LeftDoubleBracket]", 
                   RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "]"}], ",", 
                 "\"\< s  (\>\"", ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"x", "\[LeftDoubleBracket]", 
                    RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "/", 
                    "totaltime"}], " ", "100."}], "]"}], ",", "\"\< %)\>\""}],
                 "]"}]}], "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]",
              ")"}], ",", "\[IndentingNewLine]", 
            RowBox[{
            "(", "\[IndentingNewLine]", "Nothing", "\[IndentingNewLine]", 
             ")"}]}], "\[IndentingNewLine]", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"layernumber", "++"}], ";", "\[IndentingNewLine]", 
              RowBox[{"firstinlayer", "=", "layerlist"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"restoflayer", "=", 
               RowBox[{"leaves", "/@", "layerlist"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"r1", "=", 
               RowBox[{
               "radii", "\[LeftDoubleBracket]", "layernumber", 
                "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"r2", "=", 
               RowBox[{"radii", "\[LeftDoubleBracket]", 
                RowBox[{"layernumber", "+", "1"}], 
                "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"restdatalists", "=", 
               RowBox[{"Map", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"x", "\[Function]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", "x", "]"}], "===", "Missing"}], ",", 
                    " ", 
                    RowBox[{"Missing", "[", "]"}], ",", 
                    RowBox[{"data", "\[LeftDoubleBracket]", 
                    RowBox[{"Key", "/@", "x"}], "\[RightDoubleBracket]"}]}], 
                   "]"}]}], ",", "\[IndentingNewLine]", "restoflayer"}], 
                "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"layerlist", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{"DeleteMissing", "[", "restoflayer", "]"}], "]"}]}], 
              ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"datalist", "=", 
               RowBox[{"Join", "@@", 
                RowBox[{"DeleteMissing", "[", "restdatalists", "]"}]}]}], 
              ";"}], ";", "\[IndentingNewLine]", 
             RowBox[{"t\[Alpha]", "=", 
              RowBox[{"Values", "[", 
               RowBox[{"datalist", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "\"\<Tic\>\""}], 
                "\[RightDoubleBracket]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"t\[Omega]", "=", 
              RowBox[{"Values", "[", 
               RowBox[{"datalist", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "\"\<Toc\>\""}], 
                "\[RightDoubleBracket]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"annuli", "=", 
              RowBox[{"Transpose", "[", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0.", ",", "0."}], "}"}], ",", 
                   RowBox[{"Length", "[", "datalist", "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"r1", ",", "r2"}], "}"}], ",", 
                   RowBox[{"Length", "[", "datalist", "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Alpha]0", "-", 
                    RowBox[{"factor", " ", 
                    RowBox[{"(", 
                    RowBox[{"t\[Omega]", "-", "t0"}], ")"}]}]}], ",", 
                    RowBox[{"\[Alpha]0", "-", 
                    RowBox[{"factor", " ", 
                    RowBox[{"(", 
                    RowBox[{"t\[Alpha]", "-", "t0"}], ")"}]}]}]}], "}"}], 
                  "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Keys", "[", "datalist", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Values", "[", 
                  RowBox[{"datalist", "\[LeftDoubleBracket]", 
                   RowBox[{"All", ",", "\"\<Tag\>\""}], 
                   "\[RightDoubleBracket]"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"t\[Omega]", "-", "t\[Alpha]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"restannuli", "=", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"FaceForm", "[", 
                 RowBox[{"restcolfun", "[", 
                  RowBox[{"layernumber", "/", "depth"}], "]"}], "]"}], ",", 
                "\[IndentingNewLine]", "restedgeform", ",", 
                "\[IndentingNewLine]", 
                RowBox[{"restannulusfun", "/@", "annuli"}]}], 
               "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"{", "restannuli", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", "depth0", ",", 
              RowBox[{"depth", "-", "1"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "centerdisk", "}"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Options", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Depth\>\"", "\[Rule]", "Infinity"}], ",", 
        RowBox[{"\"\<StartWith\>\"", "\[Rule]", "0"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.693814480651938*^9, 3.69381449438538*^9}, {
   3.693814634205687*^9, 3.6938146493479347`*^9}, {3.69381473902039*^9, 
   3.69381477313183*^9}, {3.6938148284140873`*^9, 3.6938148864896317`*^9}, {
   3.693814939051735*^9, 3.693815025588415*^9}, {3.6938150560525303`*^9, 
   3.693815062820215*^9}, {3.6938151132776327`*^9, 3.6938151222536173`*^9}, {
   3.69381516655525*^9, 3.693815244753841*^9}, {3.693815303246991*^9, 
   3.693815304246449*^9}, {3.693815344454406*^9, 3.69381535241293*^9}, {
   3.693815403390875*^9, 3.693815435381946*^9}, {3.693815493652172*^9, 
   3.6938155530745077`*^9}, {3.693816009628963*^9, 3.693816031765868*^9}, {
   3.693816679812571*^9, 3.6938167190020037`*^9}, 3.693816863292457*^9, {
   3.693816938848765*^9, 3.693817045274665*^9}, {3.693817180425351*^9, 
   3.693817197902831*^9}, {3.693817256913136*^9, 3.693817319896133*^9}, {
   3.693817377240583*^9, 3.693817378497944*^9}, 3.693817418202137*^9, {
   3.693817678446904*^9, 3.6938176797758627`*^9}, {3.6938177118310738`*^9, 
   3.6938177293350353`*^9}, {3.693817861393219*^9, 3.693817887056162*^9}, {
   3.69381800628118*^9, 3.693818006744032*^9}, {3.693818114237208*^9, 
   3.693818116653921*^9}, {3.693818210988698*^9, 3.693818234683032*^9}, 
   3.693818330388039*^9, {3.6938184083487883`*^9, 3.693818414669486*^9}, {
   3.693818558611598*^9, 3.693818570234056*^9}, {3.693818635572852*^9, 
   3.6938186990864697`*^9}, {3.693818838994533*^9, 3.69381885776219*^9}, {
   3.693818890049161*^9, 3.693818890233017*^9}, {3.693818946876129*^9, 
   3.693818954275769*^9}, {3.693818995672793*^9, 3.693818996121065*^9}, {
   3.69381904194189*^9, 3.693819046805128*^9}, {3.693819080292609*^9, 
   3.693819095534333*^9}, {3.693819137129327*^9, 3.693819192479759*^9}, 
   3.6938192377252827`*^9, {3.6938193718205976`*^9, 3.693819372004614*^9}, {
   3.693819429817218*^9, 3.6938194310564203`*^9}, {3.693819461887382*^9, 
   3.693819462847712*^9}, {3.693819702083788*^9, 3.693819753355133*^9}, {
   3.6938198940245533`*^9, 3.693819916034047*^9}, {3.6938201186163893`*^9, 
   3.69382012249254*^9}, {3.693820681611425*^9, 3.6938207052402897`*^9}, {
   3.693820813100671*^9, 3.69382081485991*^9}, {3.693820855125764*^9, 
   3.6938208676065474`*^9}, {3.69382091543382*^9, 3.6938209213001957`*^9}, {
   3.693820952683255*^9, 3.693820967636639*^9}, {3.693821968744503*^9, 
   3.693822028245097*^9}, {3.693822077695133*^9, 3.693822077870201*^9}, {
   3.693822164896366*^9, 3.6938221921674833`*^9}, {3.693822246715543*^9, 
   3.69382224766508*^9}, {3.693822308984432*^9, 3.693822362366252*^9}, 
   3.693822489429204*^9, {3.693822546161146*^9, 3.693822651261848*^9}, {
   3.693822690420835*^9, 3.693822788986555*^9}, {3.693822820307271*^9, 
   3.69382287740009*^9}, {3.693822924941639*^9, 3.6938229573161287`*^9}, 
   3.6938231712183027`*^9, {3.693823931107328*^9, 3.693823933986828*^9}, {
   3.6938239823380003`*^9, 3.6938240134080677`*^9}, {3.693824112955323*^9, 
   3.693824173652852*^9}, {3.6938242555198393`*^9, 3.6938244423246317`*^9}, 
   3.694015279365966*^9, {3.6952242708630323`*^9, 3.6952243236569157`*^9}, {
   3.695224396435842*^9, 3.695224398539092*^9}, {3.69522482554244*^9, 
   3.695224826261241*^9}, {3.695224906022806*^9, 3.695224906741714*^9}, {
   3.6952249489412403`*^9, 3.6952249730601597`*^9}, {3.695225724000203*^9, 
   3.695225736133543*^9}, {3.6952257810997458`*^9, 3.695225794018548*^9}, {
   3.695225829979788*^9, 3.695225840698635*^9}, {3.695225880472335*^9, 
   3.695225882071052*^9}, {3.695227568643949*^9, 3.695227744033127*^9}, {
   3.695227780529684*^9, 3.6952277829368153`*^9}, {3.695227977408992*^9, 
   3.6952279932503567`*^9}, {3.6952280825103493`*^9, 3.695228084019801*^9}, {
   3.6952281174842777`*^9, 3.6952281186121683`*^9}, {3.695228227647843*^9, 
   3.69522830583394*^9}, {3.6952283466366043`*^9, 3.695228349555582*^9}, {
   3.6952284457451*^9, 3.695228445906625*^9}, {3.695228537432448*^9, 
   3.695228667121709*^9}, {3.695229079073292*^9, 3.695229230704831*^9}, {
   3.695240153978657*^9, 3.695240155718918*^9}, 3.695448675289242*^9, {
   3.695561356614294*^9, 3.695561362949451*^9}, {3.695561394821211*^9, 
   3.695561403779175*^9}, {3.6955615662370234`*^9, 3.6955615664509*^9}, {
   3.695561608097567*^9, 3.695561610222245*^9}, {3.6955616534543447`*^9, 
   3.6955616548706636`*^9}, {3.695561728132257*^9, 3.695561733202594*^9}, {
   3.6955617866255693`*^9, 3.695561789569993*^9}, 3.695561828216262*^9, {
   3.695561877562307*^9, 3.695561885955124*^9}, {3.695561925273492*^9, 
   3.695561931712864*^9}, {3.695566274162669*^9, 3.695566274378828*^9}, {
   3.697950793006991*^9, 3.697950793415403*^9}, {3.6979508710328207`*^9, 
   3.697950871583555*^9}, {3.697950929922304*^9, 3.697950964543438*^9}, {
   3.697951021394146*^9, 3.697951192493409*^9}, {3.6979512255003433`*^9, 
   3.697951257040064*^9}, {3.697952162584012*^9, 3.69795225781171*^9}, {
   3.697952314275805*^9, 3.697952336228406*^9}, {3.7486877782050858`*^9, 
   3.748687782339342*^9}, {3.824899217928196*^9, 3.8248992587002907`*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"801e70fe-9ee3-4679-9bd5-d8ab05609d5e"],

Cell[BoxData[
 RowBox[{"Sunburst", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"p_profile", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fun", ",", "depth", ",", "data"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"data", "=", 
        RowBox[{"SunburstData", "[", 
         RowBox[{"p", ",", 
          RowBox[{"\"\<Depth\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<Depth\>\"", "]"}]}], ",", 
          RowBox[{"\"\<StartWith\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<StartWith\>\"", "]"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"depth", "=", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"Length", "[", "data", "]"}], ",", 
          RowBox[{"OptionValue", "[", "\"\<Depth\>\"", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fun", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<Tooltips\>\"", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"x", "\[Function]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", 
               RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"Tooltip", "@@@", 
              RowBox[{"x", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]}]}], 
            "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"x", "\[Function]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", 
               RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "3", ",", "1"}], "\[RightDoubleBracket]"}]}], 
            "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", 
         RowBox[{"fun", "/@", 
          RowBox[{"data", "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", "depth"}], "\[RightDoubleBracket]"}]}], "]"}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Tooltips\>\"", "\[Rule]", "True"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Depth\>\"", "\[Rule]", "Infinity"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<StartWith\>\"", "\[Rule]", "0"}]}], "\[IndentingNewLine]",
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.693824608224101*^9, 3.6938246386708603`*^9}, {
   3.693825083267672*^9, 3.693825084501687*^9}, 3.694015300803141*^9, {
   3.694017807978013*^9, 3.694017854961193*^9}, {3.695216882727881*^9, 
   3.695216896723505*^9}, {3.695224320711031*^9, 3.695224332394781*^9}, {
   3.695224418607428*^9, 3.6952245477461643`*^9}, {3.695224609477418*^9, 
   3.695224615189247*^9}, {3.695224667706818*^9, 3.695224713049162*^9}, {
   3.695224744663456*^9, 3.695224749639326*^9}, {3.695225998515107*^9, 
   3.695226035088317*^9}, {3.695226217051684*^9, 3.695226218250581*^9}, {
   3.695227667682762*^9, 3.695227672521503*^9}, {3.695227793830111*^9, 
   3.695227850984758*^9}, {3.697950806940529*^9, 3.697950848269252*^9}, {
   3.697950971048088*^9, 3.6979509738694468`*^9}, 3.697951107753861*^9, {
   3.697951277659855*^9, 3.6979512840436373`*^9}, {3.69795216550338*^9, 
   3.697952171279241*^9}, {3.748687783458001*^9, 
   3.7486877864481783`*^9}},ExpressionUUID->"bedf7345-9e26-46db-a6e7-\
ae9de26204c8"],

Cell[BoxData[
 RowBox[{"Sunburst", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p_profile", ",", "i_Integer"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Sunburst", "[", 
     RowBox[{"p", ",", 
      RowBox[{"\"\<StartWith\>\"", "\[Rule]", "i"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Tooltips\>\"", "\[Rule]", 
       RowBox[{"OptionValue", "[", "\"\<Tooltips\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Depth\>\"", "\[Rule]", 
       RowBox[{"OptionValue", "[", "\"\<Depth\>\"", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Tooltips\>\"", "\[Rule]", "True"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Depth\>\"", "\[Rule]", "Infinity"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.695228971908244*^9, 3.695228998474613*^9}, {
  3.6952290670874147`*^9, 3.695229067106206*^9}, {3.6979518278276987`*^9, 
  3.69795187911845*^9}, {3.69795217387812*^9, 3.697952176838151*^9}, {
  3.74868778812103*^9, 
  3.7486877895521708`*^9}},ExpressionUUID->"cd7f67f5-7142-4138-9186-\
d5da81f66079"],

Cell[BoxData[
 RowBox[{"VerbatimRegion", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"DebuggingReap", "::", "usage"}], "=", "\"\<\>\""}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DebuggingReap", "::", "abort"}], "=", 
    "\"\<Execution aborted.\>\""}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DebuggingReap", "::", "error"}], "=", 
    "\"\<Error found during execution of a call from `1` to `2` for `3` with \
arguments `4`.\>\""}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"SetAttributes", "[", 
    RowBox[{"DebuggingReap", ",", "HoldAll"}], "]"}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DebuggingReap", "[", "code0_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"data", ",", "oldtag0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"oldtag0", "=", "None"}], ";", "\[IndentingNewLine]", 
       RowBox[{"$TimingStack", "=", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", "TimingReap"}], "}"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"$TimingStackCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"$TimingCallCounter", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"$TimingInitial", "=", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"$TimingData", "=", 
        RowBox[{"Internal`Bag", "[", 
         RowBox[{"{", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"TimingSow", "=", 
        RowBox[{"Function", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"code", ",", "tag", ",", "vars", ",", "type"}], "}"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"result", ",", "from", ",", "cc", ",", "cs"}], "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"from", "=", 
              RowBox[{
              "$TimingStack", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"cs", "=", 
              RowBox[{"++", "$TimingStackCounter"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"cc", "=", 
              RowBox[{"++", "$TimingCallCounter"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"$TimingStack", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"cc", ",", "tag"}], "}"}], ",", "$TimingStack"}], 
               "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"result", "=", 
              RowBox[{"Check", "[", 
               RowBox[{"code", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Message", "[", 
                  RowBox[{
                   RowBox[{"DebuggingReap", "::", "error"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    "from", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}], ",", "Bold"}], "]"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "tag", "]"}], ",", "Bold"}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "type", "]"}], ",", "Bold"}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", "vars", "]"}], ",", "Bold"}], 
                    "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
                 RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"$TimingStack", "=", 
              RowBox[{
              "$TimingStack", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"--", "$TimingStackCounter"}], ";", 
             "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", "HoldAll"}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"\"\<TimingStack: \>\"", ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{
          "$TimingStack", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"CheckAbort", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ReleaseHold", "[", "code0", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Message", "[", 
            RowBox[{"DebuggingReap", "::", "abort"}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"TimingSow", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"Null", ",", "#1", ",", "HoldAll"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "data"}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.720149661630539*^9, 3.7201496646664953`*^9}, {
   3.720156774002185*^9, 3.720156814661335*^9}, {3.720156854604444*^9, 
   3.720156970762855*^9}, {3.720157054340591*^9, 3.720157072077326*^9}, {
   3.720157477028545*^9, 3.720157577995322*^9}, {3.720157615841395*^9, 
   3.720157706016644*^9}, {3.720157743599045*^9, 3.720157882474057*^9}, {
   3.720157951713093*^9, 3.7201579701670094`*^9}, {3.720158044949892*^9, 
   3.720158046231414*^9}, 3.7201581178931723`*^9, {3.720158189692968*^9, 
   3.720158194861215*^9}, {3.720158233978961*^9, 3.72015824889119*^9}, {
   3.720158315554749*^9, 3.7201583291923237`*^9}, {3.720158361579646*^9, 
   3.720158476873376*^9}, {3.720158508487371*^9, 3.720158519455202*^9}, {
   3.7201585747052307`*^9, 3.720158641056404*^9}, {3.720158708684733*^9, 
   3.720158720346468*^9}, {3.720158767231751*^9, 3.720158777422737*^9}, {
   3.720158846292729*^9, 3.720158846907728*^9}, {3.72015915984146*^9, 
   3.720159221800891*^9}, {3.7201593168807*^9, 3.720159319034384*^9}, {
   3.720159379355789*^9, 3.720159447328785*^9}, {3.720159584459936*^9, 
   3.7201598075126743`*^9}, {3.720161063184737*^9, 3.7201610653677073`*^9}, {
   3.720161129259502*^9, 3.720161180903502*^9}, {3.7201640766343193`*^9, 
   3.7201640965683727`*^9}, {3.720164156397121*^9, 3.720164157011607*^9}, {
   3.7486878001699247`*^9, 3.748687848915213*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"647d519e-b8e9-4574-b13e-4b62170f3275"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.727610158918709*^9, 3.727610208808663*^9}, {
   3.7486878539216413`*^9, 3.74868785571139*^9}, {3.797347936145157*^9, 
   3.797347937335772*^9}, {3.7974895929106817`*^9, 3.797489617083643*^9}, 
   3.797489709429488*^9},ExpressionUUID->"55b67a61-dc6a-4c7c-803e-\
dd92f64960c6"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"TagTimes", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"p_profile", ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tags", ",", "owntimes"}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"tags", "=", 
         RowBox[{
          RowBox[{"Data", "[", "p", "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "\"\<Tag\>\""}], "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"AssociateTo", "[", 
         RowBox[{"tags", ",", 
          RowBox[{
           RowBox[{"-", "1"}], "\[Rule]", "\"\<User\>\""}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"owntimes", "=", 
         RowBox[{"OwnTimes", "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"GroupBy", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Lookup", "[", 
              RowBox[{"tags", ",", 
               RowBox[{"Keys", "[", "owntimes", "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Lookup", "[", 
              RowBox[{"owntimes", ",", 
               RowBox[{"Keys", "[", "owntimes", "]"}]}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], "]"}], ",", 
          RowBox[{"First", "\[Rule]", "Last"}], ",", "Total"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", "]"}]}],
   "*)"}]], "Input",
 CellChangeTimes->{{3.727610230289403*^9, 3.727610230631503*^9}, {
   3.727610280256328*^9, 3.72761028052036*^9}, 3.727610326732283*^9, {
   3.748687858519738*^9, 3.748687860838603*^9}, 
   3.797489672760638*^9},ExpressionUUID->"bddc9ce2-11d9-43fe-b20d-\
a150d042bb8e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"TagTimeTable", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"p_profile", ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tagtimes", "=", 
         RowBox[{"Reverse", "@", 
          RowBox[{"Sort", "@", 
           RowBox[{"TagTimes", "[", "p", "]"}]}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Dataset", "@", 
        RowBox[{"Transpose", "@", 
         RowBox[{"\[LeftAssociation]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<Time\>\"", "\[Rule]", "tagtimes"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<%\>\"", "\[Rule]", 
            RowBox[{
             RowBox[{"tagtimes", "/", 
              RowBox[{"Total", "[", "tagtimes", "]"}]}], "100."}]}]}], 
          "\[IndentingNewLine]", "\[RightAssociation]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.727610634518434*^9, 3.727610648914474*^9}, {
   3.74868786220713*^9, 3.748687865838361*^9}, 
   3.7974896885689783`*^9},ExpressionUUID->"c35e3303-d158-4a1f-9ba1-\
a78d4cb4ba7f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"TimesByFunction", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"p_profile", ",", "\[IndentingNewLine]", 
     RowBox[{"PieChart", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sort", "@", 
        RowBox[{"Merge", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Association", "@*", "Rule"}], "@@@", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Values", "[", 
               RowBox[{"p", "\[LeftDoubleBracket]", 
                RowBox[{
                "1", ",", "\"\<Data\>\"", ",", "All", ",", "\"\<Tag\>\""}], 
                "\[RightDoubleBracket]"}], "]"}], ",", "\[IndentingNewLine]", 
              
              RowBox[{"Values", "[", 
               RowBox[{"KeyDrop", "[", 
                RowBox[{
                 RowBox[{"OwnTimes", "[", "p", "]"}], ",", 
                 RowBox[{"-", "1"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
             "}"}], "]"}]}], ",", "\[IndentingNewLine]", "Total"}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ChartLegends", "\[Rule]", "Automatic"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{
  3.7974897018048887`*^9},ExpressionUUID->"e843d9da-1599-4755-99eb-\
28982693a2dd"],

Cell[BoxData[
 RowBox[{"Tally", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"p_profile", ",", "\[IndentingNewLine]", 
    RowBox[{"Dataset", "[", 
     RowBox[{"ReverseSort", "[", 
      RowBox[{"Counts", "[", 
       RowBox[{"p", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "\"\<Data\>\"", ",", "All", ",", "\"\<Tag\>\""}], 
        "\[RightDoubleBracket]"}], "]"}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[109]:=",ExpressionUUID->"07090110-a153-4dfe-84a3-42c55e68cac3"],

Cell[BoxData[
 RowBox[{"ImportProfile", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"filename_String", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"A", ",", "keys", ",", "data"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", "=", 
        RowBox[{"Import", "[", "filename", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"keys", "=", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Tag\>\"", ",", "\"\<From\>\"", ",", "\"\<Tic\>\"", ",", 
          "\"\<Toc\>\"", ",", "\"\<Duration\>\"", ",", "\"\<Depth\>\""}], 
         "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"KeySort", "@", 
         RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Association", "@", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"First", "[", "#", "]"}], "\[Rule]", 
                RowBox[{"AssociationThread", "[", 
                 RowBox[{"keys", ",", 
                  RowBox[{"Rest", "[", "#", "]"}]}], "]"}]}], "&"}], ",", 
              "A"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{"0", "\[Rule]", 
             RowBox[{"\[LeftAssociation]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"\"\<Tag\>\"", "\[Rule]", "TimingReap"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<Type\>\"", "\[Rule]", "None"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<Depth\>\"", "\[Rule]", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<Arguments\>\"", "\[Rule]", 
                RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"\"\<Tic\>\"", "\[Rule]", "0."}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<Toc\>\"", "\[Rule]", 
                RowBox[{"Max", "[", 
                 RowBox[{"A", "\[LeftDoubleBracket]", 
                  RowBox[{"All", ",", "5"}], "\[RightDoubleBracket]"}], 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"\"\<From\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "\"\<User\>\""}], "}"}]}]}], 
              "\[IndentingNewLine]", "\[RightAssociation]"}]}], 
            "\[RightAssociation]"}]}], "\[IndentingNewLine]", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{"#", ",", 
            RowBox[{"\"\<Type\>\"", "\[Rule]", "None"}]}], "]"}], "&"}], "/@",
          "data"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{"#", ",", 
            RowBox[{"\"\<Arguments\>\"", "\[Rule]", 
             RowBox[{"{", "}"}]}]}], "]"}], "&"}], "/@", "data"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"data", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Tag\>\"", ",", "\"\<Type\>\"", ",", "\"\<Depth\>\"", ",", 
            "\"\<Arguments\>\"", ",", "\"\<Tic\>\"", ",", "\"\<Toc\>\"", ",", 
            "\"\<From\>\""}], "}"}]}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"a", "=", 
             RowBox[{
             "data", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
             ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", 
                RowBox[{"a", "[", "\"\<From\>\"", "]"}], "]"}], "=!=", 
               "List"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"a", "[", "\"\<From\>\"", "]"}], "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"a", "[", "\"\<From\>\"", "]"}], ",", 
                  RowBox[{
                   RowBox[{"data", "[", 
                    RowBox[{"a", "[", "\"\<From\>\"", "]"}], "]"}], "[", 
                   "\"\<Tag\>\"", "]"}]}], "}"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                "data", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "=", "a"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"AssociationThread", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Keys", "[", "data", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Map", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"value", "\[Function]", 
             RowBox[{"Module", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a", "=", "value"}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"AssociateTo", "[", 
                RowBox[{"a", ",", "\[IndentingNewLine]", 
                 RowBox[{"\"\<From\>\"", "\[Rule]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Head", "[", 
                    RowBox[{"a", "[", "\"\<From\>\"", "]"}], "]"}], "=!=", 
                    "List"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"a", "[", "\"\<From\>\"", "]"}], ",", 
                    RowBox[{
                    RowBox[{"data", "[", 
                    RowBox[{"a", "[", "\"\<From\>\"", "]"}], "]"}], "[", 
                    "\"\<Tag\>\"", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"a", "[", "\"\<From\>\"", "]"}]}], 
                   "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
                "]"}]}], "\[IndentingNewLine]", "]"}]}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{"Values", "[", "data", "]"}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Init", "[", 
        RowBox[{"profile", ",", "Null", ",", "data"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.8292279818310223`*^9, 
  3.8292279916456537`*^9}},ExpressionUUID->"46f5404e-b63c-482a-ae62-\
fffd2734197c"]
},
WindowSize->{1440, 851},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 986, 21, 142, "Input",ExpressionUUID->"db180181-42b7-458d-a1b3-223ff56cb5ed"],
Cell[1547, 43, 5202, 86, 417, "Input",ExpressionUUID->"10376da1-8116-47ce-bcae-e323f92485e9"],
Cell[6752, 131, 507, 11, 92, "Input",ExpressionUUID->"4f073a04-bac6-4a4c-a6a3-85c1e80a7cf5"],
Cell[7262, 144, 2414, 54, 292, "Input",ExpressionUUID->"872bf297-928a-44c7-8d00-519c43a2ed4e"],
Cell[9679, 200, 916, 19, 117, "Input",ExpressionUUID->"342d464e-8292-4a20-b4e0-81cbf67a1728"],
Cell[10598, 221, 598, 13, 92, "Input",ExpressionUUID->"b9abbb32-e49e-47e7-a4a8-563180597e97"],
Cell[11199, 236, 4565, 104, 567, "Input",ExpressionUUID->"71cccb6c-0b4a-409d-871b-a7040f7e9fea"],
Cell[15767, 342, 3213, 70, 542, "Input",ExpressionUUID->"2adc5259-3af9-4653-8e16-3e90b40e1838"],
Cell[18983, 414, 3390, 76, 542, "Input",ExpressionUUID->"b916e2ad-1998-4c4d-a8a1-1639c6b8d0a2"],
Cell[22376, 492, 2800, 69, 417, "Input",ExpressionUUID->"e119f363-3c60-4b76-8df1-b197291bebb1"],
Cell[25179, 563, 887, 20, 117, "Input",ExpressionUUID->"ebae685a-104e-4664-b2b9-c4d388d9fe8c"],
Cell[26069, 585, 1921, 40, 192, "Input",ExpressionUUID->"7d2cc166-5ef4-4580-ba57-d708e5dd607a"],
Cell[27993, 627, 7322, 153, 942, "Input",ExpressionUUID->"be45ac9f-a148-4234-a346-9355c03c2652"],
Cell[35318, 782, 754, 18, 117, "Input",ExpressionUUID->"ac557097-008b-440e-a8fa-47ae3ee9e9a3"],
Cell[36075, 802, 18093, 345, 2067, "Input",ExpressionUUID->"801e70fe-9ee3-4679-9bd5-d8ab05609d5e"],
Cell[54171, 1149, 3811, 79, 467, "Input",ExpressionUUID->"bedf7345-9e26-46db-a6e7-ae9de26204c8"],
Cell[57985, 1230, 1305, 30, 267, "Input",ExpressionUUID->"cd7f67f5-7142-4138-9186-d5da81f66079"],
Cell[59293, 1262, 7141, 146, 1242, "Input",ExpressionUUID->"647d519e-b8e9-4574-b13e-4b62170f3275"],
Cell[66437, 1410, 324, 5, 41, "Input",ExpressionUUID->"55b67a61-dc6a-4c7c-803e-dd92f64960c6"],
Cell[66764, 1417, 1897, 44, 317, "Input",ExpressionUUID->"bddc9ce2-11d9-43fe-b20d-a150d042bb8e"],
Cell[68664, 1463, 1194, 29, 217, "Input",ExpressionUUID->"c35e3303-d158-4a1f-9ba1-a78d4cb4ba7f"],
Cell[69861, 1494, 1433, 33, 317, "Input",ExpressionUUID->"e843d9da-1599-4755-99eb-28982693a2dd"],
Cell[71297, 1529, 527, 12, 92, "Input",ExpressionUUID->"07090110-a153-4dfe-84a3-42c55e68cac3"],
Cell[71827, 1543, 6993, 159, 1117, "Input",ExpressionUUID->"46f5404e-b63c-482a-ae62-fffd2734197c"]
}
]
*)

