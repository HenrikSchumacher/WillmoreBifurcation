(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     67917,       1480]
NotebookOptionsPosition[     65540,       1445]
NotebookOutlinePosition[     65931,       1461]
CellTagsIndexPosition[     65888,       1458]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"PlotFunction", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_tetmesh", ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"EmbeddingDimension", "[", "M", "]"}], "\[Equal]", "3"}], ",", 
      "Graphics3D", ",", 
      RowBox[{"Unevaluated", "[", 
       RowBox[{"PlotFunction", "[", "M", "]"}], "]"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "Persistent"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.670158360493637*^9, 3.670158397855556*^9}, {
  3.6703988117539062`*^9, 3.670398841781609*^9}, {3.834577585838902*^9, 
  3.8345775871171513`*^9}},ExpressionUUID->"a418a787-0671-4493-8eeb-\
e762b3c1f1e4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GraphicsOptions", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M_tetmesh", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
       RowBox[{"Boxed", "\[Rule]", "False"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Caching", "\[Rule]", "Persistent"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"SetGraphicsOptions", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M_tetmesh", ",", "bla__"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"SetPersistentCache", "[", 
     RowBox[{"M", ",", "\"\<GraphicsOptions\>\"", ",", 
      RowBox[{"Flatten", "[", 
       RowBox[{"List", "[", "bla", "]"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.682869532242548*^9, 3.682869554025393*^9}, {
  3.68287598452288*^9, 3.682876039191122*^9}, {3.8345775830473022`*^9, 
  3.834577592140959*^9}},ExpressionUUID->"ef7047ec-2c13-46ee-b3e4-\
86defe7dd0f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GraphicsDirectives", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M_tetmesh", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EdgeForm", "[", "]"}], ",", "unired", ",", 
       RowBox[{"Specularity", "[", 
        RowBox[{"White", ",", "30"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Caching", "\[Rule]", "Persistent"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"SetGraphicsDirectives", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M_tetmesh", ",", "s__"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"SetPersistentCache", "[", 
     RowBox[{"M", ",", "\"\<GraphicsDirectives\>\"", ",", 
      RowBox[{"Flatten", "[", 
       RowBox[{"List", "[", "s", "]"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6828644071121807`*^9, 3.6828644092870903`*^9}, {
   3.6828644589211884`*^9, 3.68286458664813*^9}, {3.682864899479631*^9, 
   3.682864903406457*^9}, {3.6828653600127897`*^9, 3.682865399830372*^9}, {
   3.682865555930995*^9, 3.6828655570081577`*^9}, {3.6828660376551037`*^9, 
   3.6828660423805933`*^9}, {3.6828760553357143`*^9, 3.68287605647474*^9}, 
   3.7245723824220667`*^9, {3.724573097964336*^9, 3.7245731015878067`*^9}, {
   3.765985640098037*^9, 3.765985641080488*^9}, {3.8345775937914677`*^9, 
   3.8345775993166857`*^9}},ExpressionUUID->"4e661b13-9cf0-49d6-9614-\
25ccb65e9b8f"],

Cell[BoxData[
 RowBox[{"ToGraphicsComplex", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_tetmesh", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"flist", ",", "g", ",", "faces", ",", "f", ",", "r"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"flist", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Sort", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"AdjacencyLists", "[", 
             RowBox[{"M", ",", "Tets", ",", "Triangles"}], "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"OptionValue", "[", "\"\<Tets\>\"", "]"}], 
            "\[RightDoubleBracket]"}], ")"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<IgnoreInterior\>\"", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"g", "=", 
           RowBox[{"CountsBy", "[", 
            RowBox[{"flist", ",", "Identity"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"flist", "=", 
           RowBox[{"Union", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Keys", "[", "g", "]"}], "\[LeftDoubleBracket]", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"Values", "[", "g", "]"}], ",", "1"}], "]"}], "]"}], 
              "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"OptionValue", "[", "\"\<Triangles\>\"", "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"faces", "=", 
           RowBox[{"Triangles", "[", 
            RowBox[{"M", ",", "flist"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"f", "=", 
        RowBox[{"OptionValue", "[", "\"\<ColorMethod\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"f", "===", "Automatic"}], ",", 
         RowBox[{"(*", "Then", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"I", " ", "prefer", " ", "coloring", " ", "by", " ", 
           RowBox[{"texture", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", 
             RowBox[{"VertexTextureCoordinates", "[", "M", "]"}], "]"}], "===", 
            RowBox[{"Missing", "[", "]"}]}], ",", 
           RowBox[{"(*", "Then", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"r", "=", 
            RowBox[{"VertexColors", "\[Rule]", 
             RowBox[{"VertexColors", "[", "M", "]"}]}]}], ",", 
           RowBox[{"(*", "Else", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"r", "=", 
            RowBox[{"VertexTextureCoordinates", "\[Rule]", 
             RowBox[{"VertexTextureCoordinates", "[", "M", "]"}]}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"(*", "Else", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"f", "===", "None"}], ",", 
           RowBox[{"(*", "Then", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"r", "=", 
            RowBox[{"VertexColors", "\[Rule]", 
             RowBox[{"Missing", "[", "]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"r", "=", 
            RowBox[{"f", "\[Rule]", 
             RowBox[{"f", "[", "M", "]"}]}]}]}], "\[IndentingNewLine]", 
          "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"GraphicsComplex", "[", 
        RowBox[{
         RowBox[{"VertexCoordinates", "[", "M", "]"}], ",", 
         RowBox[{"Polygon", "[", "faces", "]"}], ",", "r"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Tets\>\"", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<Triangles\>\"", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<IgnoreInterior\>\"", "\[Rule]", "True"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<ColorMethod\>\"", "\[Rule]", "Automatic"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6828643362512283`*^9, 3.6828643566899157`*^9}, {
  3.682868597394784*^9, 3.682868609134202*^9}, {3.682869349980382*^9, 
  3.682869401744143*^9}, {3.6828755560660467`*^9, 3.6828758018484983`*^9}, {
  3.6828758390541077`*^9, 3.6828758406798964`*^9}, {3.682876137169509*^9, 
  3.6828761395043488`*^9}, {3.682876293820785*^9, 3.682876300795508*^9}, {
  3.6828763570733128`*^9, 3.6828763654858313`*^9}, {3.6828859075974693`*^9, 
  3.68288591590842*^9}, {3.6828859475335093`*^9, 3.682885969846814*^9}, {
  3.72001612722717*^9, 3.720016135154523*^9}, {3.720016384770424*^9, 
  3.720016387079323*^9}, {3.7200164454342957`*^9, 3.7200164473107986`*^9}, {
  3.834577531793027*^9, 3.8345775793351183`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"a182bae0-74e3-467d-ae12-eb674e6c22c1"],

Cell[BoxData[
 RowBox[{"MeshPlot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_tetmesh", ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"plotfun", "=", 
        RowBox[{"PlotFunction", "[", "M", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"plotfun", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "\"\<BoundingBox\>\"", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"OptionValue", "[", "\"\<BoundingBoxStyle\>\"", "]"}], 
               ",", 
               RowBox[{"Cuboid", "@@", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"BoundingBox", "[", "M", "]"}], "]"}]}]}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"GraphicsDirectives", "[", "M", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"List", "[", 
            RowBox[{"OptionValue", "[", "\"\<PlotStyle\>\"", "]"}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Texture", "[", "M", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"ToGraphicsComplex", "[", 
            RowBox[{"M", ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<Tets\>\"", "\[Rule]", 
              RowBox[{"OptionValue", "[", "\"\<Tets\>\"", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<IgnoreInterior\>\"", "\[Rule]", 
              RowBox[{"OptionValue", "[", "\"\<IgnoreInterior\>\"", "]"}]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"\"\<ColorMethod\>\"", "\[Rule]", 
              RowBox[{"OptionValue", "[", "\"\<ColorMethod\>\"", "]"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"GraphicsOptions", "[", "M", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<PlotStyle\>\"", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<BoundingBox\>\"", "\[Rule]", "False"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<BoundingBoxStyle\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Opacity", "[", "0.", "]"}], ",", 
          RowBox[{"EdgeForm", "[", "]"}], ",", 
          RowBox[{"FaceForm", "[", "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Tets\>\"", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<IgnoreInterior\>\"", "\[Rule]", "True"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<ColorMethod\>\"", "\[Rule]", "Automatic"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6679038619622173`*^9, 3.667903880874345*^9}, {
   3.6681899806343203`*^9, 3.668190010712104*^9}, {3.668190116037328*^9, 
   3.66819016036347*^9}, 3.668190293545105*^9, {3.66970471888317*^9, 
   3.669704742912883*^9}, {3.669720303215908*^9, 3.6697203060211277`*^9}, {
   3.671903608709483*^9, 3.6719036132255793`*^9}, {3.671903644846712*^9, 
   3.6719036457261677`*^9}, {3.682834639192573*^9, 3.68283465939502*^9}, {
   3.682834735308072*^9, 3.682834760602169*^9}, {3.682834816147195*^9, 
   3.6828348457657957`*^9}, {3.682865416784436*^9, 3.682865454902862*^9}, {
   3.6828686503894567`*^9, 3.682868661488172*^9}, {3.6828690247626257`*^9, 
   3.6828690337225018`*^9}, {3.6828691806315813`*^9, 3.682869206640316*^9}, {
   3.682869267641638*^9, 3.6828692861158113`*^9}, {3.6828694437312937`*^9, 
   3.682869458109838*^9}, {3.682869548418522*^9, 3.682869565167942*^9}, {
   3.682869607360495*^9, 3.6828696578210907`*^9}, {3.682869836291875*^9, 
   3.682869857014956*^9}, {3.68287587069718*^9, 3.682875881742052*^9}, 
   3.6828759838899*^9, 3.682876056685556*^9, {3.6829213107471733`*^9, 
   3.6829213216586514`*^9}, {3.683711758505969*^9, 3.6837117606509533`*^9}, {
   3.8345776037026367`*^9, 3.834577606813012*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"14472ae7-03c7-478e-b231-ce5ef2b850ab"],

Cell[BoxData[
 RowBox[{"SelectTets", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M_tetmesh", ",", "f_"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Position", "[", 
      RowBox[{
       RowBox[{"Negative", "[", 
        RowBox[{"Map", "[", 
         RowBox[{"f", ",", 
          RowBox[{"TetCentroids", "[", "M", "]"}]}], "]"}], "]"}], ",", 
       "True"}], "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.682840897851638*^9, 3.68284089978195*^9}, {
  3.834577609366282*^9, 3.834577610892467*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"465e66e2-56c9-4d16-a7a8-e3d8a5533ef8"],

Cell[BoxData[
 RowBox[{"SlicedPlot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M_tetmesh", ",", "f_"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"MeshPlot", "[", 
     RowBox[{"M", ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<PlotStyle\>\"", "\[Rule]", 
       RowBox[{"OptionValue", "[", "\"\<PlotStyle\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<Tets\>\"", "\[Rule]", 
       RowBox[{"SelectTets", "[", 
        RowBox[{"M", ",", "f"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<IgnoreInterior\>\"", "\[Rule]", 
       RowBox[{"OptionValue", "[", "\"\<IgnoreInterior\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<ColorMethod\>\"", "\[Rule]", 
       RowBox[{"OptionValue", "[", "\"\<ColorMethod\>\"", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<PlotStyle\>\"", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<IgnoreInterior\>\"", "\[Rule]", "True"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<ColorMethod\>\"", "\[Rule]", "Automatic"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.669741693861785*^9, 3.669741727073824*^9, {3.669742272866089*^9, 
   3.669742273232444*^9}, {3.669742308978571*^9, 3.669742322012143*^9}, {
   3.669742395135068*^9, 3.6697423961403913`*^9}, 3.669742537483059*^9, {
   3.682836370075354*^9, 3.682836401066516*^9}, {3.682840906660569*^9, 
   3.682840917640485*^9}, {3.6828697373204393`*^9, 3.682869766772956*^9}, {
   3.6828699461679087`*^9, 3.682869980006297*^9}, {3.6828700720532513`*^9, 
   3.6828700724902267`*^9}, {3.6828762482293987`*^9, 
   3.6828762583377647`*^9}, {3.68292112183567*^9, 3.682921139767589*^9}, {
   3.834577612774438*^9, 
   3.834577614460436*^9}},ExpressionUUID->"a8811c24-76ad-4450-a679-\
1ae08662aa18"],

Cell[BoxData[
 RowBox[{"FieldPlot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M_tetmesh", ",", "w_"}], "}"}], ",", "\[IndentingNewLine]", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pplist", ",", "\[Lambda]", ",", "Q", ",", "selector", ",", 
        RowBox[{"c", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"selector", "=", 
        RowBox[{"OptionValue", "[", "\"\<Selector\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"selector", "===", "All"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"pplist", "=", "All"}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"VertexCount", "[", "M", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Q", "=", 
           RowBox[{"VertexCoordinates", "[", "M", "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"pplist", "=", 
           RowBox[{"selector", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"Q", "=", 
           RowBox[{"VertexCoordinates", "[", 
            RowBox[{"M", ",", "pplist"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"Length", "[", "Q", "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "w", "]"}], "==", "\[Lambda]"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"TensorRank", "[", "w", "]"}], "\[Equal]", "2"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Arrowheads", "[", "0.01", "]"}], ",", "Black", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"Flatten", "@", 
                RowBox[{"List", "@", 
                 RowBox[{"OptionValue", "[", "PlotStyle", "]"}]}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Arrow", "/@", 
               RowBox[{"Transpose", "[", 
                RowBox[{"{", 
                 RowBox[{"Q", ",", 
                  RowBox[{"Q", "+", 
                   RowBox[{"0.1", " ", "w"}]}]}], "}"}], "]"}]}]}], "}"}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"TensorRank", "[", "w", "]"}], "\[Equal]", "3"}], 
             "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{"Graphics3D", "[", "\[IndentingNewLine]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"c", "++"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Lighter", "@", "unired"}], ",", "unigreen", ",", 
                    
                    RowBox[{"Lighter", "@", "uniblue"}]}], "}"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"Mod", "[", 
                    RowBox[{"c", ",", "3", ",", "1"}], "]"}], "]"}], "]"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"Arrowheads", "[", "0.005", "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"List", "@", 
                    RowBox[{"OptionValue", "[", "PlotStyle", "]"}]}]}]}], ",",
                    "\[IndentingNewLine]", 
                   RowBox[{"Arrow", "/@", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"{", 
                    RowBox[{"Q", ",", 
                    RowBox[{"Q", "+", 
                    RowBox[{"0.1", " ", "ww"}]}]}], "}"}], "]"}]}]}], 
                  "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
                
                RowBox[{"{", 
                 RowBox[{"ww", ",", 
                  RowBox[{"Transpose", "[", 
                   RowBox[{"w", ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
                 "}"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]",
               "]"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Message", "[", 
               RowBox[{"FieldPlot", "::", "dim"}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{"FieldPlot", "::", "dim"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{"FieldPlot", "::", "dim"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Description\>\"", "\[Rule]", "\"\<\>\""}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<Selector\>\"", "\[Rule]", "All"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", "}"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Errors\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<dim\>\"", "\[Rule]", "\"\<Error: Dimensions do not fit.\>\""}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6319697815058117`*^9, 3.6319700332367353`*^9}, {
   3.631970139260428*^9, 3.631970184450596*^9}, {3.631970600099037*^9, 
   3.631970621394752*^9}, {3.6319706942416983`*^9, 3.631970698347245*^9}, {
   3.631970742400725*^9, 3.631970754431018*^9}, {3.632063664234652*^9, 
   3.6320637426211042`*^9}, {3.6320638566513653`*^9, 3.632063883893499*^9}, {
   3.632065330062633*^9, 3.6320653703201313`*^9}, {3.632065498021649*^9, 
   3.63206549826994*^9}, {3.632697389715293*^9, 3.6326974475333014`*^9}, {
   3.6327300456368933`*^9, 3.6327300474848537`*^9}, {3.63689176282899*^9, 
   3.636891763190987*^9}, {3.63689183557865*^9, 3.636891836014502*^9}, {
   3.638003256166811*^9, 3.638003271989574*^9}, 3.643081608605564*^9, {
   3.6443145129893084`*^9, 3.644314514943514*^9}, {3.644314559469881*^9, 
   3.644314582185652*^9}, {3.6545219250631647`*^9, 3.6545219261029577`*^9}, {
   3.6547843590027037`*^9, 3.654784359199563*^9}, {3.6696448214026527`*^9, 
   3.669644821655776*^9}, {3.6703971643291187`*^9, 3.670397173582835*^9}, {
   3.7200161587900753`*^9, 3.720016165408414*^9}, {3.720016209318675*^9, 
   3.7200162113721313`*^9}, {3.765985646842568*^9, 3.765985659761397*^9}, {
   3.834577616527485*^9, 
   3.834577628108794*^9}},ExpressionUUID->"a11b33cf-a909-4a02-95e7-\
60283b9b3ede"],

Cell[BoxData[
 RowBox[{"PointHighlight", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_tetmesh", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"j", "=", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"List", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"VertexCount", "[", "M", "]"}], "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"OptionValue", "[", "\"\<Points\>\"", "]"}], 
            "\[RightDoubleBracket]"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "p", ",", "\[IndentingNewLine]", "pointfun", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"plotfun", "=", 
         RowBox[{"PlotFunction", "[", "M", "]"}]}]}], "\[IndentingNewLine]", 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<Spheres\>\"", "]"}], ",", 
         "\[IndentingNewLine]", " ", 
         RowBox[{"pointfun", "=", 
          RowBox[{"x", "\[Function]", 
           RowBox[{"Sphere", "[", 
            RowBox[{"x", ",", 
             RowBox[{
              RowBox[{"OptionValue", "[", "\"\<Radius\>\"", "]"}], 
              RowBox[{"Radius", "[", "M", "]"}]}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", " ", 
         RowBox[{"pointfun", "=", 
          RowBox[{"x", "\[Function]", 
           RowBox[{"Point", "[", "x", "]"}]}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{"VertexCoordinates", "[", "M", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"plotfun", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"unired", ",", "\[IndentingNewLine]", 
           RowBox[{"PointSize", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "\"\<Radius\>\"", "]"}], 
             RowBox[{"Radius", "[", "M", "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Specularity", "[", 
            RowBox[{"White", ",", "30"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Flatten", "[", 
             RowBox[{"List", "[", 
              RowBox[{"OptionValue", "[", "\"\<PlotStyle\>\"", "]"}], "]"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Tooltip", "[", 
              RowBox[{
               RowBox[{"Evaluate", "[", 
                RowBox[{"pointfun", "[", 
                 RowBox[{
                 "p", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                 "]"}], "]"}], ",", 
               RowBox[{"\"\<Vertex \>\"", "<>", 
                RowBox[{"ToString", "[", "i", "]"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", "indices"}], "}"}]}], "\[IndentingNewLine]", 
            "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Boxed", "\[Rule]", "False"}]}], "\[IndentingNewLine]", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Options\>\"", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<Points\>\"", "\[Rule]", "All"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<PlotStyle\>\"", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<Spheres\>\"", "\[Rule]", "False"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Radius\>\"", "\[Rule]", "0.005"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.652019999213011*^9, 3.6520200194624653`*^9}, {
  3.6520201027204123`*^9, 3.6520202266316233`*^9}, {3.6520202684168177`*^9, 
  3.652020321425555*^9}, {3.6520203639730473`*^9, 3.652020415235772*^9}, {
  3.652020449461035*^9, 3.652020544401902*^9}, {3.652020599832704*^9, 
  3.6520206337525063`*^9}, {3.652020744698861*^9, 3.6520207464649353`*^9}, {
  3.652020813488823*^9, 3.652020814953166*^9}, {3.670158326702735*^9, 
  3.670158358343585*^9}, {3.670158446823448*^9, 3.670158452382649*^9}, {
  3.670158639671048*^9, 3.670158715024699*^9}, {3.670398772953681*^9, 
  3.6703987732003593`*^9}, {3.670398862003704*^9, 3.6703988692644777`*^9}, {
  3.671895033119143*^9, 3.671895041919045*^9}, {3.683186458274768*^9, 
  3.6831864631394873`*^9}, {3.7200161598409224`*^9, 3.720016173605898*^9}, {
  3.765985666592799*^9, 3.765985667592765*^9}, {3.834577629941917*^9, 
  3.834577646844326*^9}},ExpressionUUID->"e6d9cd76-ac5a-40b6-8af0-\
58db170db74d"],

Cell[BoxData[
 RowBox[{"EdgeHighlight", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_tetmesh", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"j", "=", "0"}], ",", "\[IndentingNewLine]", "indices", ",", 
        "\[IndentingNewLine]", "p", ",", "\[IndentingNewLine]", 
        RowBox[{"arrow", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "\"\<Oriented\>\"", "]"}], ",", 
           "Arrow", ",", "Identity"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"line", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "\"\<Tubes\>\"", "]"}], ",", "Tube", 
           ",", "Line"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"indices", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"List", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"EdgeCount", "[", "M", "]"}], "]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"OptionValue", "[", "\"\<Edges\>\"", "]"}], 
           "\[RightDoubleBracket]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"VertexCoordinates", "[", 
           RowBox[{"M", ",", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Edges", "[", 
              RowBox[{"M", ",", "indices"}], "]"}], "]"}]}], "]"}], ",", 
          "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PlotFunction", "[", "M", "]"}], "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"unired", ",", "\[IndentingNewLine]", 
           RowBox[{"Specularity", "[", 
            RowBox[{"White", ",", "30"}], "]"}], ",", "\[IndentingNewLine]", 
           "Thick", ",", "\[IndentingNewLine]", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Flatten", "[", 
             RowBox[{"List", "[", 
              RowBox[{"OptionValue", "[", "\"\<PlotStyle\>\"", "]"}], "]"}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"j", "++"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Tooltip", "[", 
               RowBox[{
                RowBox[{"arrow", "@", 
                 RowBox[{"line", "[", 
                  RowBox[{
                  "p", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}],
                   "]"}]}], ",", 
                RowBox[{"\"\<Edge \>\"", "<>", 
                 RowBox[{"ToString", "[", "i", "]"}]}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", "indices"}], "}"}]}], "\[IndentingNewLine]", 
            "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Boxed", "\[Rule]", "False"}]}], "\[IndentingNewLine]", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Options\>\"", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<PlotStyle\>\"", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<Edges\>\"", "\[Rule]", "All"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Oriented\>\"", "\[Rule]", "False"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Tubes\>\"", "\[Rule]", "False"}]}], "\[IndentingNewLine]",
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.652019022204352*^9, 3.6520190656273203`*^9}, {
   3.652019112605492*^9, 3.6520191829340467`*^9}, 3.652019235782074*^9, {
   3.6520192799571037`*^9, 3.65201929607766*^9}, {3.652019414445654*^9, 
   3.6520194471559877`*^9}, {3.652019508575405*^9, 3.652019526324307*^9}, {
   3.652019556944104*^9, 3.652019557526236*^9}, {3.652019634311846*^9, 
   3.6520197159975653`*^9}, {3.652019768038268*^9, 3.652019779225539*^9}, {
   3.65201983739826*^9, 3.6520198602708607`*^9}, {3.652020045624474*^9, 
   3.652020047439507*^9}, {3.65202092238236*^9, 3.652020965961244*^9}, 
   3.670158458241372*^9, {3.670398770105556*^9, 3.670398770303378*^9}, {
   3.68318646624084*^9, 3.68318647185773*^9}, {3.720016161794195*^9, 
   3.7200161835327597`*^9}, {3.720016217062097*^9, 3.720016217764798*^9}, {
   3.7659856985193644`*^9, 3.7659856993195543`*^9}, {3.8345776512034397`*^9, 
   3.834577674810959*^9}},ExpressionUUID->"99806473-fdb5-418d-bb47-\
57e6d8fb583c"],

Cell[BoxData[
 RowBox[{"TriangleHighlight", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_tetmesh", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"j", "=", "0"}], ",", "p", ",", "arrow", ",", "tube", ",", 
        "\[Nu]", ",", "u", ",", "v", ",", "indices", ",", "tt", ",", "data"}],
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<Oriented\>\"", "]"}], ",", 
         RowBox[{"arrow", "=", 
          RowBox[{"x", "\[Function]", 
           RowBox[{"Arrow", "[", "x", "]"}]}]}], ",", 
         RowBox[{"arrow", "=", "Identity"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<Tubes\>\"", "]"}], ",", 
         RowBox[{"tube", "=", 
          RowBox[{"x", "\[Function]", 
           RowBox[{"Tube", "[", "x", "]"}]}]}], ",", 
         RowBox[{"tube", "=", "Identity"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"indices", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"List", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"TriangleCount", "[", "M", "]"}], "]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"OptionValue", "[", "\"\<Triangles\>\"", "]"}], 
           "\[RightDoubleBracket]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tt", "=", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"VertexCoordinates", "[", "M", "]"}], 
           "\[LeftDoubleBracket]", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Triangles", "[", "M", "]"}], "\[LeftDoubleBracket]", 
             "indices", "\[RightDoubleBracket]"}], "]"}], 
           "\[RightDoubleBracket]"}], ",", "3"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"\[Nu]", "=", 
          RowBox[{
           RowBox[{"TriangleNormals", "[", "M", "]"}], "\[LeftDoubleBracket]",
            "indices", "\[RightDoubleBracket]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"u", "=", 
          RowBox[{
           RowBox[{"1", "/", "3"}], "r", " ", 
           RowBox[{"cNormalize3", "[", 
            RowBox[{
             RowBox[{"tt", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
             RowBox[{"tt", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"v", "=", 
          RowBox[{"cCross3", "[", 
           RowBox[{"\[Nu]", ",", "u"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"data", "=", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"TriangleIncirclecenters", "[", "M", "]"}], 
                "\[LeftDoubleBracket]", "indices", "\[RightDoubleBracket]"}], 
               ",", "12"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1", ",", "3"}], "}"}]}], "]"}], "+", 
           "\[IndentingNewLine]", 
           RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"u", ",", "v"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}], ".", 
              RowBox[{"Transpose", "@", 
               RowBox[{"Most", "@", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"N", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "t", "]"}], ",", " ", 
                    RowBox[{"Sin", "[", "t", "]"}]}], "}"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"t", ",", "0", ",", 
                    RowBox[{"2", "Pi"}], ",", 
                    RowBox[{"2", 
                    RowBox[{"Pi", "/", "12"}]}]}], "}"}]}], "]"}]}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"data", "=", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"mp", "=", 
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"ConstantArray", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"TriangleMidpoints", "[", "M", "]"}], 
                 "\[LeftDoubleBracket]", "indices", "\[RightDoubleBracket]"}],
                 ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "3"}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", "2", ",", "1", ",", "4"}], "}"}]}], "]"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"OptionValue", "[", "\"\<OrientationSize\>\"", "]"}]}], 
             ")"}], " ", "mp"}], "+", 
           RowBox[{
            RowBox[{"OptionValue", "[", "\"\<OrientationSize\>\"", "]"}], 
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"tt", "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "2"}], "}"}]}], 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"tt", "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", 
                  RowBox[{"{", 
                   RowBox[{"2", ",", "3"}], "}"}]}], 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"tt", "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", 
                  RowBox[{"{", 
                   RowBox[{"3", ",", "1"}], "}"}]}], 
                 "\[RightDoubleBracket]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "1", ",", "3", ",", "4"}], "}"}]}], 
             "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<Oriented\>\"", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"PlotFunction", "[", "M", "]"}], "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"unigreen", ",", "\[IndentingNewLine]", 
             RowBox[{"Specularity", "[", 
              RowBox[{"White", ",", "30"}], "]"}], ",", "\[IndentingNewLine]",
              "Thick", ",", "\[IndentingNewLine]", 
             RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Arrowheads", "[", 
              RowBox[{"0.015", 
               RowBox[{"Radius", "[", "M", "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"j", "++"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Tooltip", "[", 
                 RowBox[{
                  RowBox[{"arrow", "@", 
                   RowBox[{"tube", "[", 
                    RowBox[{
                    "data", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "]"}]}], ",", 
                  RowBox[{"\"\<Triangle \>\"", "<>", 
                   RowBox[{"ToString", "[", "i", "]"}]}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"i", ",", "indices"}], "}"}]}], "\[IndentingNewLine]",
               "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Boxed", "\[Rule]", "False"}]}], "\[IndentingNewLine]", 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"PlotFunction", "[", "M", "]"}], "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"unired", ",", "\[IndentingNewLine]", 
             RowBox[{"Specularity", "[", 
              RowBox[{"White", ",", "30"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"EdgeForm", "[", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"Flatten", "[", 
               RowBox[{"List", "[", 
                RowBox[{"OptionValue", "[", "\"\<PlotStyle\>\"", "]"}], "]"}],
                "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"j", "++"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Tooltip", "[", 
                 RowBox[{
                  RowBox[{"Polygon", "[", 
                   RowBox[{
                   "tt", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "]"}], ",", 
                  RowBox[{"\"\<Triangle \>\"", "<>", 
                   RowBox[{"ToString", "[", "i", "]"}]}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"i", ",", "indices"}], "}"}]}], "\[IndentingNewLine]",
               "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Boxed", "\[Rule]", "False"}]}], "\[IndentingNewLine]", 
          "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Options\>\"", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<PlotStyle\>\"", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<Triangles\>\"", "\[Rule]", "All"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Oriented\>\"", "\[Rule]", "False"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Tubes\>\"", "\[Rule]", "True"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<OrientationSize\>\"", "\[Rule]", 
        RowBox[{"2", "/", "3"}]}]}], "\[IndentingNewLine]", "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{
  3.652023169458136*^9, {3.652023319638712*^9, 3.652023330801661*^9}, {
   3.652023385554891*^9, 3.652023431345747*^9}, {3.652023526027631*^9, 
   3.6520235519415903`*^9}, {3.652023602564033*^9, 3.65202362808187*^9}, {
   3.652023672818431*^9, 3.652023676529545*^9}, {3.652028455801543*^9, 
   3.652028513102378*^9}, 3.65202865191969*^9, 3.652028773712084*^9, {
   3.652028813358962*^9, 3.652028911599875*^9}, {3.6520289525772943`*^9, 
   3.652028954975688*^9}, {3.6520289891694107`*^9, 3.652029007359642*^9}, {
   3.6520290486867313`*^9, 3.652029077648199*^9}, {3.652029168075181*^9, 
   3.652029170616219*^9}, {3.652029257041893*^9, 3.652029291113514*^9}, {
   3.652029700616233*^9, 3.652029701227578*^9}, {3.6520297625602827`*^9, 
   3.652029804098543*^9}, {3.652029902980576*^9, 3.652029948890238*^9}, {
   3.6520300273654737`*^9, 3.652030063013019*^9}, {3.652030107603643*^9, 
   3.652030146663822*^9}, {3.670158465468359*^9, 3.670158468996295*^9}, {
   3.670398735002263*^9, 3.670398766209382*^9}, {3.671903550242185*^9, 
   3.671903583745359*^9}, {3.6831864746933804`*^9, 3.683186486688504*^9}, {
   3.683202573798627*^9, 3.683202589518772*^9}, {3.6832026450275307`*^9, 
   3.683202647014296*^9}, {3.683202763132824*^9, 3.683202782266358*^9}, {
   3.720016187496469*^9, 3.720016190215864*^9}, {3.720016416840629*^9, 
   3.720016442039775*^9}, {3.765985704440423*^9, 3.7659857114478483`*^9}, {
   3.832999906681324*^9, 3.832999928485732*^9}, {3.834577655494978*^9, 
   3.8345776685255957`*^9}},ExpressionUUID->"e84abcef-0e7f-413d-9cd6-\
86aae65726b3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VertexColorFunction", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M_tetmesh", ",", "\[IndentingNewLine]", 
     RowBox[{"x", "\[Function]", 
      RowBox[{"Missing", "[", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Caching", "\[Rule]", "Persistent"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetVertexColorFunction", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M_tetmesh", ",", "f_"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ClearAllCacheDependingOn", "[", 
       RowBox[{"M", ",", "\"\<VertexColorFunction\>\""}], "]"}], ";", 
      RowBox[{"SetPersistentCache", "[", 
       RowBox[{"M", ",", "\"\<VertexColorFunction\>\"", ",", "f"}], "]"}]}]}],
     "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VertexColors", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M_tetmesh", ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", "=", 
         RowBox[{"VertexColorFunction", "[", "M", "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"f", "[", "M", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"SetVertexColors", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M_tetmesh", ",", "cols_"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"SetVertexColorFunction", "[", 
     RowBox[{"M", ",", 
      RowBox[{"x", "\[Function]", "cols"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.682316698568636*^9, 3.6823168109527807`*^9}, {
  3.6823177212880907`*^9, 3.682317721783244*^9}, {3.682834956676127*^9, 
  3.682834958760375*^9}, {3.682879669667029*^9, 3.682879766408986*^9}, {
  3.834577683915906*^9, 
  3.834577696897169*^9}},ExpressionUUID->"7a61532d-01ad-453f-bd19-\
21a67e914243"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ColorGradientValues", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M_tetmesh", ",", "\[IndentingNewLine]", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0.5", ",", 
       RowBox[{"VertexCount", "[", "M", "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Caching", "\[Rule]", "Persistent"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetColorGradientValues", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M_tetmesh", ",", "c_"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ClearAllCacheDependingOn", "[", 
       RowBox[{"M", ",", "\"\<ColorGradientValues\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetPersistentCache", "[", 
       RowBox[{"M", ",", "\"\<ColorGradientValues\>\"", ",", "c"}], "]"}]}]}],
     "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ColorGradient", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M_tetmesh", ",", "c_"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SetColorGradientValues", "[", 
      RowBox[{"M", ",", "c"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"SetTextureFunction", "[", 
      RowBox[{"M", ",", "ColorGradientTexture"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SetVertexTextureCoordinates", "[", 
      RowBox[{"M", ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{"x", "\[Function]", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"Min", "[", 
                RowBox[{"x", ",", ".9999"}], "]"}], ",", "0.0001"}], "]"}]}], 
            ",", "c"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{".25", ",", 
            RowBox[{"VertexCount", "[", "M", "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SetVertexColorFunction", "[", 
      RowBox[{"M", ",", "ColorGradientVertexColorFunction"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.682836607518455*^9, 3.682836607704858*^9}, {
  3.682878297039407*^9, 3.68287830618289*^9}, {3.682878354793127*^9, 
  3.682878357192376*^9}, {3.682879032451274*^9, 3.682879123915732*^9}, {
  3.682879337326705*^9, 3.6828793377733307`*^9}, {3.682879920470128*^9, 
  3.6828799287864447`*^9}, {3.720016193518478*^9, 3.7200161999326067`*^9}, {
  3.834577698884197*^9, 
  3.834577709113062*^9}},ExpressionUUID->"5e80a3ac-aa99-4c20-a8b4-\
77a6e87b576d"],

Cell[BoxData[
 RowBox[{"ColorGradientVertexColorFunction", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_tetmesh", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ColorGradientSteps", "[", "M", "]"}], "\[LeftDoubleBracket]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Floor", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"x", "\[Function]", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"x", ",", "1"}], "]"}], ",", "0"}], "]"}]}], ",", 
          RowBox[{"ColorGradientValues", "[", "M", "]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"ColorGradientSteps", "[", "M", "]"}], "]"}], "-", "1"}], 
         ")"}]}], "]"}], "+", "1"}], "\[IndentingNewLine]", 
     "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.682879816953384*^9, 3.682879893260556*^9}, {
  3.682879937247559*^9, 3.682879943422358*^9}, {3.834577711307262*^9, 
  3.834577712872642*^9}},ExpressionUUID->"548458ce-63b7-4bef-a1d0-\
ffc77b49f776"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ColorGradientFunction", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M_tetmesh", ",", "\[IndentingNewLine]", 
     RowBox[{"ColorData", "[", "\"\<DarkRainbow\>\"", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Caching", "\[Rule]", "Persistent"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetColorGradientFunction", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"M_tetmesh", ",", "fun_"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ClearAllCacheDependingOn", "[", 
       RowBox[{"M", ",", "\"\<ColorGradientFunction\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SetPersistentCache", "[", 
       RowBox[{"M", ",", "\"\<ColorGradientFunction\>\"", ",", "fun"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ColorGradientSteps", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M_tetmesh", ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f", "=", 
         RowBox[{"ColorGradientFunction", "[", "M", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"n", "=", 
         RowBox[{"OptionValue", "[", "\"\<ColorSteps\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ToPack", "[", 
         RowBox[{"List", "@@@", 
          RowBox[{"(", 
           RowBox[{"f", "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", "n"}], "]"}], "/", "n"}], ")"}]}], ")"}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Caching", "\[Rule]", "Persistent"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Options", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<ColorSteps\>\"", "\[Rule]", 
        RowBox[{"2", "^", "10"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"ColorGradient", "=", 
    RowBox[{"PackageFunction", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M_", ",", "c_"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"SetVertexColors", "[", 
       RowBox[{"M", ",", 
        RowBox[{
         RowBox[{"ColorGradientSteps", "[", "M", "]"}], 
         "\[LeftDoubleBracket]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{"x", "\[Function]", 
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{"Min", "[", 
                  RowBox[{"x", ",", "1"}], "]"}], ",", "0"}], "]"}]}], ",", 
              "c"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"ColorGradientSteps", "[", "M", "]"}], "]"}], "-", 
              "1"}], ")"}]}], "]"}], "+", "1"}], "\[IndentingNewLine]", 
         "\[RightDoubleBracket]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"InputType", "\[Rule]", "tetmesh"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6823181978853292`*^9, 3.6823182358855*^9}, {
  3.682318273385215*^9, 3.682318348979558*^9}, {3.682318421942778*^9, 
  3.68231854023483*^9}, {3.6823185746307487`*^9, 3.682318610842744*^9}, {
  3.682318994066914*^9, 3.682319009785122*^9}, {3.68232034265593*^9, 
  3.682320358622658*^9}, {3.6823204000420713`*^9, 3.682320419730095*^9}, {
  3.682320493531473*^9, 3.682320496294117*^9}, {3.682419173854548*^9, 
  3.6824191846649923`*^9}, {3.682420690773303*^9, 3.682420693720324*^9}, {
  3.682834565629867*^9, 3.682834572087579*^9}, {3.682878153684814*^9, 
  3.682878159259547*^9}, {3.682878319806402*^9, 3.682878333133541*^9}, {
  3.682879566221874*^9, 3.6828796067494097`*^9}, {3.834577714179534*^9, 
  3.8345777239922533`*^9}},ExpressionUUID->"dc15a5a8-5b23-4777-8fd9-\
bd864c592bec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TextureFunction", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M_tetmesh", ",", "\[IndentingNewLine]", 
     RowBox[{"Missing", "[", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Caching", "\[Rule]", "Persistent"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"SetTextureFunction", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M_tetmesh", ",", "f_"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"SetPersistentCache", "[", 
     RowBox[{"M", ",", "\"\<TextureFunction\>\"", ",", "f"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.682879407237508*^9, 3.682879422303727*^9}, {
   3.682922375569337*^9, 3.682922447540299*^9}, {3.6829226417961597`*^9, 
   3.682922642688324*^9}, 3.682922927499542*^9, {3.8345777260968037`*^9, 
   3.83457773076799*^9}},ExpressionUUID->"ae7ee800-1f79-4e12-8093-\
b5ac46741070"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Texture", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M_tetmesh", ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", "=", 
         RowBox[{"TextureFunction", "[", "M", "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "f", "]"}], "===", "Missing"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"Texture", "[", 
          RowBox[{"f", "[", "M", "]"}], "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"SetTexture", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M_tetmesh", ",", "tex_"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"SetPersistentCache", "[", 
     RowBox[{"M", ",", "\"\<TextureFunction\>\"", ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "tex", "]"}], "===", "Texture"}], ",", 
        RowBox[{"x", "\[Function]", "tex"}], ",", 
        RowBox[{"x", "\[Function]", 
         RowBox[{"Texture", "[", "tex", "]"}]}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.670862004431177*^9, 3.670862148541212*^9}, {
  3.6708623357334414`*^9, 3.670862345467029*^9}, {3.670862484898142*^9, 
  3.670862562445356*^9}, {3.679720097731947*^9, 3.679720101720229*^9}, {
  3.679721085506188*^9, 3.679721086443787*^9}, {3.682837385632142*^9, 
  3.682837410661518*^9}, {3.6828390322738953`*^9, 3.682839050583125*^9}, {
  3.6828789163616047`*^9, 3.682878977268454*^9}, {3.682879228073474*^9, 
  3.682879255562476*^9}, {3.682879441617127*^9, 3.68287948911836*^9}, {
  3.682921269572248*^9, 3.682921284521838*^9}, {3.834577732234557*^9, 
  3.83457773848766*^9}, {3.8345777886948147`*^9, 
  3.834577789838132*^9}},ExpressionUUID->"73155a82-5786-4f22-b448-\
2b9b1eef60db"],

Cell[BoxData[
 RowBox[{"VertexTextureCoordinates", "=", 
  RowBox[{"SettingFunction", "[", 
   RowBox[{"M_tetmesh", ",", "\[IndentingNewLine]", 
    RowBox[{"Missing", "[", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.682837849378653*^9, 3.6828378795090313`*^9}, {
  3.6829224827951593`*^9, 3.682922498316135*^9}, {3.682922913807971*^9, 
  3.6829229162170467`*^9}, {3.834577741559978*^9, 3.83457774764716*^9}, {
  3.834577778302573*^9, 
  3.83457778436561*^9}},ExpressionUUID->"f65003df-67bb-4f19-a5e2-\
fb5db81d188b"],

Cell[BoxData[
 RowBox[{"TextureMesh", "=", 
  RowBox[{"SettingFunction", "[", 
   RowBox[{"M_tetmesh", ",", "\[IndentingNewLine]", 
    RowBox[{"Init", "[", 
     RowBox[{"mesh", ",", 
      RowBox[{"VertexTextureCoordinates", "[", "M", "]"}], ",", 
      RowBox[{"Triangles", "[", "M", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.679721048629176*^9, 3.679721069926066*^9}, {
   3.679721101507098*^9, 3.679721101831889*^9}, 3.6797213387201138`*^9, {
   3.682836859290154*^9, 3.68283686289847*^9}, {3.682837883478353*^9, 
   3.682837939271706*^9}, {3.682877606438384*^9, 3.682877607226315*^9}, {
   3.720016143087791*^9, 3.720016163403696*^9}, 3.72001644384769*^9, {
   3.834577748945788*^9, 
   3.83457777214226*^9}},ExpressionUUID->"5a5a86c2-e7da-487a-be09-\
a04def536f0e"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.682836857205865*^9, 
  3.682836857410001*^9}},ExpressionUUID->"2bc09dab-2cad-4f1b-bbcf-\
8257fb2d964b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ColorGradientTexture", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M_tetmesh", ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{
           RowBox[{"OptionValue", "[", "\"\<Resolution\>\"", "]"}], "-", 
           "1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"colfun", "=", 
          RowBox[{"ColorGradientFunction", "[", "M", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Image", "[", "\[IndentingNewLine]", 
        RowBox[{"ConstantArray", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ToPack", "[", 
           RowBox[{"List", "@@@", 
            RowBox[{"(", 
             RowBox[{"colfun", "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"0", ",", "n"}], "]"}], "/", "n"}], ")"}]}], ")"}]}],
            "]"}], ",", "10"}], "]"}], "\[IndentingNewLine]", "]"}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Options\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Resolution\>\"", "\[Rule]", "1080"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Caching", "\[Rule]", "Persistent"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"TextureColorGradient", "=", 
    RowBox[{"PackageFunction", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M_", ",", "c_"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"R", ",", "pts"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pts", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{"x", "\[Function]", 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"Min", "[", 
                   RowBox[{"x", ",", ".9999"}], "]"}], ",", "0.0001"}], 
                 "]"}]}], ",", "c"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{".25", ",", 
               RowBox[{"VertexCount", "[", "M", "]"}]}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"SetTexture", "[", 
          RowBox[{"M", ",", 
           RowBox[{"ColorGradientTexture", "[", "M", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"SetVertexTextureCoordinates", "[", 
          RowBox[{"M", ",", "pts"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"InputType", "\[Rule]", "tetmesh"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.682313936967124*^9, 3.6823139997967377`*^9}, {
   3.6823140344992*^9, 3.682314044441586*^9}, {3.682314954517367*^9, 
   3.6823149553221273`*^9}, {3.682417059220688*^9, 3.68241730518889*^9}, {
   3.6824173442279167`*^9, 3.682417358246183*^9}, {3.682417502216963*^9, 
   3.682417513689933*^9}, {3.682417643505534*^9, 3.682417679946619*^9}, {
   3.682418066516766*^9, 3.682418106756641*^9}, {3.682418279841298*^9, 
   3.682418300706183*^9}, 3.682418364705268*^9, {3.682418477006794*^9, 
   3.682418483813552*^9}, {3.682418535077065*^9, 3.682418550381946*^9}, {
   3.682418599305601*^9, 3.682418678386057*^9}, {3.682418763802082*^9, 
   3.682418773398395*^9}, {3.682418806140723*^9, 3.682418842109626*^9}, {
   3.682418991648827*^9, 3.682418996493454*^9}, 3.6824191623977213`*^9, {
   3.682420697192457*^9, 3.682420701840847*^9}, {3.682836598795274*^9, 
   3.68283660151812*^9}, {3.682836855459618*^9, 3.682836856395412*^9}, {
   3.6828412450696793`*^9, 3.68284127217198*^9}, {3.682877671425596*^9, 
   3.682877726163952*^9}, {3.682878278533787*^9, 3.682878282037548*^9}, {
   3.682879197962778*^9, 3.682879202304387*^9}, {3.720016202261788*^9, 
   3.72001620561987*^9}, {3.8345777995754642`*^9, 
   3.834577801541885*^9}},ExpressionUUID->"a78f3574-70e1-4e52-8f2b-\
7d5d4ec43192"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.682865498577121*^9, 3.6828655489170227`*^9}, 
   3.682866033627502*^9},ExpressionUUID->"ebfb0384-a867-4d0c-9a95-\
2a633dc77a78"]
},
WindowSize->{1440, 851},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (May 11, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"449d50d3-767f-4d82-baac-69df3f5d3dab"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 746, 17, 117, "Input",ExpressionUUID->"a418a787-0671-4493-8eeb-e762b3c1f1e4"],
Cell[1307, 39, 1136, 25, 242, "Input",ExpressionUUID->"ef7047ec-2c13-46ee-b3e4-86defe7dd0f2"],
Cell[2446, 66, 1535, 31, 217, "Input",ExpressionUUID->"4e661b13-9cf0-49d6-9614-25ccb65e9b8f"],
Cell[3984, 99, 5266, 109, 817, "Input",ExpressionUUID->"a182bae0-74e3-467d-ae12-eb674e6c22c1"],
Cell[9253, 210, 4522, 88, 717, "Input",ExpressionUUID->"14472ae7-03c7-478e-b231-ce5ef2b850ab"],
Cell[13778, 300, 688, 16, 92, "Input",ExpressionUUID->"465e66e2-56c9-4d16-a7a8-e3d8a5533ef8"],
Cell[14469, 318, 2048, 41, 342, "Input",ExpressionUUID->"a8811c24-76ad-4450-a679-1ae08662aa18"],
Cell[16520, 361, 7437, 156, 1267, "Input",ExpressionUUID->"a11b33cf-a909-4a02-95e7-60283b9b3ede"],
Cell[23960, 519, 4924, 103, 842, "Input",ExpressionUUID->"e6d9cd76-ac5a-40b6-8af0-58db170db74d"],
Cell[28887, 624, 4741, 99, 792, "Input",ExpressionUUID->"99806473-fdb5-418d-bb47-57e6d8fb583c"],
Cell[33631, 725, 12531, 271, 1617, "Input",ExpressionUUID->"e84abcef-0e7f-413d-9cd6-86aae65726b3"],
Cell[46165, 998, 2088, 49, 492, "Input",ExpressionUUID->"7a61532d-01ad-453f-bd19-21a67e914243"],
Cell[48256, 1049, 2801, 64, 492, "Input",ExpressionUUID->"5e80a3ac-aa99-4c20-a8b4-77a6e87b576d"],
Cell[51060, 1115, 1154, 27, 142, "Input",ExpressionUUID->"548458ce-63b7-4bef-a1d0-ffc77b49f776"],
Cell[52217, 1144, 4246, 96, 717, "Input",ExpressionUUID->"dc15a5a8-5b23-4777-8fd9-bd864c592bec"],
Cell[56466, 1242, 986, 20, 217, "Input",ExpressionUUID->"ae7ee800-1f79-4e12-8093-b5ac46741070"],
Cell[57455, 1264, 2019, 45, 242, "Input",ExpressionUUID->"73155a82-5786-4f22-b448-2b9b1eef60db"],
Cell[59477, 1311, 548, 11, 92, "Input",ExpressionUUID->"f65003df-67bb-4f19-a5e2-fb5db81d188b"],
Cell[60028, 1324, 816, 16, 92, "Input",ExpressionUUID->"5a5a86c2-e7da-487a-be09-a04def536f0e"],
Cell[60847, 1342, 206, 4, 92, "Input",ExpressionUUID->"2bc09dab-2cad-4f1b-bbcf-8257fb2d964b"],
Cell[61056, 1348, 4300, 90, 642, "Input",ExpressionUUID->"a78f3574-70e1-4e52-8f2b-7d5d4ec43192"],
Cell[65359, 1440, 177, 3, 41, "Input",ExpressionUUID->"ebfb0384-a867-4d0c-9a95-2a633dc77a78"]
}
]
*)

