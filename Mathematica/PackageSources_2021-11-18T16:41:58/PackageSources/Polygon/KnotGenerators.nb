(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     83980,       1994]
NotebookOptionsPosition[     81562,       1959]
NotebookOutlinePosition[     81898,       1974]
CellTagsIndexPosition[     81855,       1971]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"KnotString", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IntegerString", "[", 
      RowBox[{"m", ",", "10", ",", "3"}], "]"}], "<>", "\"\<_\>\"", "<>", 
     RowBox[{"IntegerString", "[", 
      RowBox[{"n", ",", "10", ",", "3"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.846035046829441*^9, 3.846035058062521*^9}, {
  3.8460353266604424`*^9, 3.8460353277785397`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"020eb25c-5e55-4fcf-a297-df360003b1aa"],

Cell[BoxData[
 RowBox[{"FromKnotString", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"s_String", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ImportString", "[", 
      RowBox[{
       RowBox[{"StringReplace", "[", 
        RowBox[{"s", ",", 
         RowBox[{"\"\<_\>\"", "\[Rule]", "\"\<\\t\>\""}]}], "]"}], ",", 
       "\"\<Table\>\""}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.846035078740394*^9, 3.8460350836757174`*^9}, {
  3.8460353026695433`*^9, 3.846035319188797*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"ba050b0e-a235-413e-9af1-12a6bf368e27"],

Cell[BoxData[
 RowBox[{"LoadKnot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"LoadKnot", "[", 
     RowBox[{"KnotString", "[", 
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.846034355376217*^9, 3.846034365917697*^9}, {
   3.846034396931726*^9, 3.8460344100287647`*^9}, {3.846034561000413*^9, 
   3.846034586468169*^9}, 3.846035065654167*^9, {3.84603535144204*^9, 
   3.846035355409453*^9}},ExpressionUUID->"93583373-665b-4389-8f77-\
a3b384fd8c59"],

Cell[BoxData[
 RowBox[{"LoadKnot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"s_String", ",", "\[IndentingNewLine]", 
    RowBox[{"ToPolygon", "[", 
     RowBox[{"Import", "[", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"SourcePath", "[", 
          RowBox[{
           RowBox[{"Packages", "[", "$PM", "]"}], "[", "\"\<Polygon\>\"", 
           "]"}], "]"}], ",", "\"\<KnotData\>\"", ",", 
         RowBox[{"s", "<>", "\"\<.obj\>\""}]}], "}"}], "]"}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.846034205222735*^9, 3.8460342212596693`*^9}, 
   3.8460343508934193`*^9, {3.84603456258414*^9, 
   3.8460345874280443`*^9}},ExpressionUUID->"15f6d87a-7dff-48dc-a407-\
c416d1c94d5a"],

Cell[BoxData[
 RowBox[{"KnotSpline", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"P_", "?", "MatrixQ"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"data", "=", 
        RowBox[{"List", "@@", 
         RowBox[{"BSplineFunction", "[", 
          RowBox[{"P", ",", 
           RowBox[{"SplineClosed", "\[Rule]", "True"}], ",", 
           RowBox[{"SplineDegree", "\[Rule]", "3"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "data", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "*=", 
        
        RowBox[{"2.", "Pi"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "data", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}], "*=", 
        
        RowBox[{"2.", "Pi"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"BSplineFunction", "@@", "data"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.8460348790747433`*^9, 3.8460349152984056`*^9}, 
   3.846034946339069*^9, {3.8460353596346617`*^9, 
   3.8460353625295277`*^9}},ExpressionUUID->"77baf281-18a6-4d8a-b6ac-\
296e1e172536"],

Cell[BoxData[
 RowBox[{"Knot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"s_String", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[Gamma]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]", "=", 
        RowBox[{"KnotSpline", "[", 
         RowBox[{"VertexCoordinates", "[", 
          RowBox[{"LoadKnot", "[", "s", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ParametricPolygon", "[", 
        RowBox[{"\[Gamma]", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"2.", "Pi"}], ",", 
           RowBox[{"OptionValue", "[", "Mesh", "]"}]}], "}"}], ",", 
         RowBox[{"\"\<Closed\>\"", "\[Rule]", "True"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Mesh", "\[Rule]", "100"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.846035911109542*^9, 3.84603591678046*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"98b853d3-1c59-4ab4-a63c-aba127c2374e"],

Cell[BoxData[
 RowBox[{"Knot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"m_Integer", ",", "n_Integer"}], "}"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Knot", "[", 
     RowBox[{"s", ",", 
      RowBox[{"Mesh", "\[Rule]", 
       RowBox[{"OptionValue", "[", "\"\<Mesh\>\"", "]"}]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Mesh", "\[Rule]", "100"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8460346027010307`*^9, 3.846034618381296*^9}, {
   3.846034672646489*^9, 3.846034699715479*^9}, 3.846034931213636*^9, {
   3.846035365682452*^9, 3.846035372249013*^9}, 3.846035950661051*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"d5af138a-4dbb-4f13-812d-47b830b87b36"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Knot", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"knot_String", ",", "nn_"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "\[Gamma]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Gamma]", "=", 
         RowBox[{"KnotDataSpline", "[", "knot", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ParametricPolygon", "[", 
         RowBox[{"\[Gamma]", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"2.", "Pi"}], ",", "nn"}], "}"}], ",", 
          RowBox[{"\"\<Closed\>\"", "\[Rule]", "True"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Options", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Mesh", "\[Rule]", "100"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.827920243690699*^9, 3.827920260828711*^9}, {
   3.827920316855587*^9, 3.827920317371092*^9}, {3.828095596282823*^9, 
   3.828095600696959*^9}, {3.846034549489523*^9, 3.846034550358672*^9}, {
   3.846034807061974*^9, 3.846034837372492*^9}, 
   3.846035712466507*^9},ExpressionUUID->"7deeb374-8327-4919-bd58-\
b8b02a5cd323"],

Cell[BoxData[
 RowBox[{"Unknot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"nn_", ",", "\[IndentingNewLine]", 
    RowBox[{"Init", "[", "\[IndentingNewLine]", 
     RowBox[{"polygon", ",", "\[IndentingNewLine]", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"CirclePoints", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1.", ",", "0."}], "}"}], ",", "nn"}], "]"}], ",", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0.", ",", 
          RowBox[{"{", 
           RowBox[{"nn", ",", 
            RowBox[{
             RowBox[{"OptionValue", "[", "\"\<EmbeddingDimension\>\"", "]"}], 
             "-", "2"}]}], "}"}]}], "]"}], ",", "2"}], "]"}], ",", 
      "\[IndentingNewLine]", "\"\<Closed\>\""}], "\[IndentingNewLine]", "]"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<EmbeddingDimension\>\"", "\[Rule]", "3"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6533866650518627`*^9, 3.6533866722417717`*^9}, {
   3.653386744295718*^9, 3.6533867447957172`*^9}, {3.673096687868834*^9, 
   3.673096708214363*^9}, {3.686747662330802*^9, 3.6867477015336018`*^9}, {
   3.6867477890636463`*^9, 3.686747808276984*^9}, {3.713254839130138*^9, 
   3.713254841449974*^9}, {3.744384974659656*^9, 3.744385000733439*^9}, {
   3.7565621333225603`*^9, 3.7565621391288424`*^9}, 3.756562174092184*^9, {
   3.794063276404586*^9, 3.794063353872814*^9}, 3.7940689752551737`*^9},
 CellLabel->
  "In[120]:=",ExpressionUUID->"e3f15f80-16d0-4296-b1ba-4a457e9192b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TorusKnot", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n_Integer", ",", "m_Integer"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "nn", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nn", "=", 
         RowBox[{"OptionValue", "[", "\"\<Mesh\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nn", "===", "Automatic"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"nn", "=", " ", 
            RowBox[{"m", " ", "n", " ", "15"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"r1", "=", 
             RowBox[{
              RowBox[{"OptionValue", "[", "\"\<Radii\>\"", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"r2", "=", 
             RowBox[{
              RowBox[{"OptionValue", "[", "\"\<Radii\>\"", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Gamma]", "=", 
              RowBox[{"t", "\[Function]", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"N", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"m", " ", "t"}], "]"}]}], 
                    RowBox[{"(", 
                    RowBox[{"r1", "+", 
                    RowBox[{"r2", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"n", " ", "t"}], "]"}]}]}], ")"}]}], ",", 
                   RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"m", " ", "t"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{"r1", "+", 
                    RowBox[{"r2", " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"n", " ", "t"}], "]"}]}]}], ")"}]}], ",", 
                   RowBox[{"r2", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"n", " ", "t"}], "]"}]}]}], "}"}], "]"}], 
                "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"EqualEdgeLengthSampling", "[", 
              RowBox[{"\[Gamma]", ",", 
               RowBox[{"{", 
                RowBox[{"0.", ",", 
                 RowBox[{"2.", "Pi"}], ",", "nn"}], "}"}], ",", 
               RowBox[{"\"\<Closed\>\"", "\[Rule]", "True"}]}], "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Options\>\"", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<Radii\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1.", ",", "0.5"}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<Mesh\>\"", "\[Rule]", "Automatic"}]}], 
       "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.713255214635508*^9, 3.713255223255686*^9}, 
   3.734594573513172*^9, {3.7599034747695312`*^9, 3.759903476751186*^9}, {
   3.76484664620037*^9, 3.764846667517639*^9}, 3.8411337001130733`*^9},
 CellLabel->
  "In[189]:=",ExpressionUUID->"33e7c50b-d9ee-468f-be58-3a6bd138807f"],

Cell[BoxData[
 RowBox[{"FigureEightKnot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"nn_", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[Gamma]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Gamma]", "=", 
        RowBox[{"KnotDataSpline", "[", "\"\<FigureEight\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ParametricPolygon", "[", 
        RowBox[{"\[Gamma]", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"2.", "Pi"}], ",", "nn"}], "}"}], ",", 
         RowBox[{"\"\<Closed\>\"", "\[Rule]", "True"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.649347861422933*^9, 3.6493478683161173`*^9}, {
   3.649682600307556*^9, 3.649682603088263*^9}, {3.653386638800864*^9, 
   3.653386654251232*^9}, {3.6533867294388857`*^9, 3.6533867404846888`*^9}, {
   3.6758627608058434`*^9, 3.6758627738740788`*^9}, {3.675865047880073*^9, 
   3.675865052388476*^9}, {3.697346264861676*^9, 3.697346272587509*^9}, {
   3.713254827229081*^9, 3.71325483669023*^9}, 3.7268324480080442`*^9, {
   3.7295950137121572`*^9, 3.7295950213430634`*^9}, {3.731399696146757*^9, 
   3.731399730020887*^9}, {3.744384024167959*^9, 3.744384098989472*^9}, 
   3.7472966007007017`*^9, {3.756561884222205*^9, 3.7565618898026*^9}, 
   3.827919812812071*^9, {3.846034811007588*^9, 3.846034812565421*^9}, {
   3.846035625328101*^9, 3.846035632469734*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"44e1f80e-e24b-4886-bd4d-3113684e3442"],

Cell[BoxData[
 RowBox[{"BorromeanLink", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"n_", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "A", ",", "pts0", ",", "P", ",", "dividepts", ",", "splinepts", ",", 
        "\[Gamma]list", ",", "tlist", ",", "pts", ",", "edges"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", "=", 
        RowBox[{"RotationTransform", "[", 
         RowBox[{"1.0172219678978514`", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pts0", "=", 
        RowBox[{"A", "/@", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"PolyhedronData", "[", "\"\<Icosahedron\>\"", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"P", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"x", "\[Function]", 
           RowBox[{"Part", "[", 
            RowBox[{"pts0", ",", "x"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "3", ",", "2", ",", "4", ",", "1"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"5", ",", "6", ",", "8", ",", "7", ",", "5"}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"9", ",", "11", ",", "12", ",", "10", ",", "9"}], 
             "}"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dividepts", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"x", "\[Function]", 
           RowBox[{"MovingAverage", "[", 
            RowBox[{"x", ",", "2"}], "]"}]}], ",", "P"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"splinepts", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Riffle", "[", 
           RowBox[{
            RowBox[{"P", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"dividepts", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "P", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"\[Gamma]list", "=", 
          RowBox[{"Map", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pp", "\[Function]", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"(", 
               RowBox[{"t", "\[Function]", 
                RowBox[{
                 RowBox[{"BSplineFunction", "[", 
                  RowBox[{"pp", ",", 
                   RowBox[{"SplineClosed", "\[Rule]", "True"}]}], "]"}], "[", 
                 
                 RowBox[{
                  RowBox[{"t", "/", "2"}], "/", "Pi"}], "]"}]}], ")"}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Most", "/@", "splinepts"}]}], "\[IndentingNewLine]", 
           "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]list", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"data", "=", 
              RowBox[{"List", "@@", 
               RowBox[{"BSplineFunction", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Most", "[", "p", "]"}], ",", "\[IndentingNewLine]", 
                 
                 RowBox[{"SplineClosed", "\[Rule]", "True"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"SplineDegree", "\[Rule]", "3"}]}], 
                "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{
              "data", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "*=", 
              RowBox[{"2.", "Pi"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "data", "\[LeftDoubleBracket]", "6", "\[RightDoubleBracket]"}], 
              "*=", 
              RowBox[{"2.", "Pi"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"BSplineFunction", "@@", "data"}]}]}], 
           "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"p", ",", "splinepts"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tlist", "=", 
        RowBox[{"Most", "[", 
         RowBox[{"Subdivide", "[", 
          RowBox[{"0.", ",", 
           RowBox[{"2.", "Pi"}], ",", "n"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"pts", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"\[Gamma]", "/@", "tlist"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Gamma]", ",", "\[Gamma]list"}], "}"}]}], "]"}], ",", 
          "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"edges", "=", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ee", "=", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", 
                  RowBox[{"i", "+", "1"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Join", "[", "\[IndentingNewLine]", 
           RowBox[{"ee", ",", "\[IndentingNewLine]", 
            RowBox[{"ee", "+", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"n", ",", "n"}], "}"}], ",", "n"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ee", "+", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"2", "n"}], ",", 
                 RowBox[{"2", "n"}]}], "}"}], ",", "n"}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Init", "[", 
        RowBox[{"polygon", ",", "pts", ",", "edges"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.653135581161924*^9, 3.65313565696951*^9}, {
   3.653135719721652*^9, 3.653135745557386*^9}, {3.729769522504994*^9, 
   3.729769558272983*^9}, {3.729769716641004*^9, 3.7297697188243313`*^9}, {
   3.729769809715909*^9, 3.729769809953105*^9}, 3.7474181985823183`*^9},
 CellLabel->"In[64]:=",ExpressionUUID->"25440a98-42fb-4b18-9b75-8dea07abff69"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"RandomPolygon", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n_", ",", "m_"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Init", "[", 
      RowBox[{"polygon", ",", "\[IndentingNewLine]", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"OptionValue", "[", "\"\<EmbeddingDimension\>\"", "]"}]}], 
          "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ToPack", "@", "List"}], "@@@", 
        RowBox[{"EdgeList", "[", 
         RowBox[{"RandomGraph", "[", 
          RowBox[{"{", 
           RowBox[{"n", ",", "m"}], "}"}], "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Options\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<EmbeddingDimension\>\"", "\[Rule]", "3"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6531389281012363`*^9, 3.653138990960157*^9}, 
   3.689447506850127*^9, 
   3.76449821007579*^9},ExpressionUUID->"055af7da-e3b6-432c-bc5b-\
3b3adee9a2ca"],

Cell[BoxData[
 RowBox[{"FreedmanHeWangKnot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"n_", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"data", ",", "p", ",", "q", ",", "P"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"r", "=", 
            RowBox[{"N", "@", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"u", "=", 
            RowBox[{"N", "@", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"d", "=", 
            RowBox[{"N", "@", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "1"}], ",", "0"}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"l", "=", 
            RowBox[{"N", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"z", "=", 
            RowBox[{"N", "@", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"data", "=", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"N", "@", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
            "\[IndentingNewLine]", "r", ",", "r", ",", "r", ",", "r", ",", 
            "r", ",", "r", ",", "r", ",", "r", ",", "\[IndentingNewLine]", 
            "d", ",", "d", ",", "d", ",", "d", ",", "d", ",", 
            "\[IndentingNewLine]", "l", ",", "z", ",", "l", ",", "l", ",", 
            "l", ",", 
            RowBox[{"-", "z"}], ",", "l", ",", "\[IndentingNewLine]", "u", 
            ",", "u", ",", "u", ",", 
            RowBox[{"-", "z"}], ",", "u", ",", "u", ",", "u", ",", "z", ",", 
            "u", ",", "\[IndentingNewLine]", "r", ",", "r", ",", "r", ",", 
            "\[IndentingNewLine]", "d", ",", "z", ",", "d", ",", "d", ",", 
            "d", ",", 
            RowBox[{"-", "z"}], ",", "d", ",", "d", ",", "d", ",", "d", ",", 
            "d", ",", "\[IndentingNewLine]", "l", ",", "l", ",", "l", ",", 
            "l", ",", "l", ",", "\[IndentingNewLine]", "u", ",", "u", ",", 
            "u", ",", "u", ",", "u", ",", "z", ",", "u", ",", "u", ",", "u", 
            ",", 
            RowBox[{"-", "z"}], ",", "\[IndentingNewLine]", "r", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"-", "z"}], ",", "d", ",", "d", ",", "d", ",", "z", ",", 
            "d", ",", "d", ",", "d", ",", "d", ",", "\[IndentingNewLine]", 
            "r", ",", "r", ",", "r", ",", "\[IndentingNewLine]", "u", ",", 
            "u", ",", "u", ",", "u", ",", "z", ",", "u", ",", "u", ",", "u", 
            ",", 
            RowBox[{"-", "z"}], ",", "\[IndentingNewLine]", "l", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"-", "z"}], ",", "d", ",", "d", ",", "d", ",", "z", ",", 
            "d", ",", "d", ",", "\[IndentingNewLine]", "z", ",", "r", ",", 
            "r", ",", "r", ",", 
            RowBox[{"-", "z"}], ",", "\[IndentingNewLine]", "u", ",", "u", 
            ",", "u", ",", "\[IndentingNewLine]", "l", ",", "l", ",", "l", 
            ",", "l", ",", "l", ",", "l", ",", "l"}], "\[IndentingNewLine]", 
           "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{"Accumulate", "[", "data", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"q", "=", 
        RowBox[{"Reverse", "@", "p"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "*=", 
        RowBox[{"-", "1."}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"P", "=", 
        RowBox[{"Subdivide", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Init", "[", 
           RowBox[{"polygon", ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Most", "@", "p"}], ",", 
              RowBox[{"Most", "@", "q"}]}], "]"}], ",", "\"\<Closed\>\""}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Method", "\[Rule]", "\"\<Planar\>\""}], ",", 
          RowBox[{"Subdivisions", "\[Rule]", "n"}]}], "\[IndentingNewLine]", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Init", "[", 
        RowBox[{"polygon", ",", 
         RowBox[{"VertexCoordinates", "[", 
          RowBox[{"P", ",", 
           RowBox[{"Most", "@", 
            RowBox[{
             RowBox[{"Strata", "[", "P", "]"}], "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}]}], "]"}], 
         ",", "\"\<Closed\>\""}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6731630101973352`*^9, 3.673163059143054*^9}, {
   3.673163106156192*^9, 3.673163159454812*^9}, {3.6731632025317507`*^9, 
   3.673163209852887*^9}, {3.673163240974313*^9, 3.673163351083585*^9}, {
   3.673163391997374*^9, 3.673163444878886*^9}, {3.673163478707715*^9, 
   3.6731635194531727`*^9}, {3.673163560959716*^9, 3.6731635853707113`*^9}, {
   3.71325485063673*^9, 3.713254857096386*^9}, 3.719504697704664*^9, {
   3.777582953999687*^9, 3.777583043854645*^9}, {3.7775830793728323`*^9, 
   3.777583089938867*^9}},
 CellLabel->
  "In[480]:=",ExpressionUUID->"58a0cd17-86e2-4013-8bad-ffe77d028b54"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SquareKnot", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{
     RowBox[{"{", "nn_", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "e2", ",", "M", ",", "epos", ",", "ppos", ",", "epos2", ",", 
         "stratum", ",", "i1", ",", "i2", ",", "elist", ",", "edges", ",", 
         "plist", ",", "shift", ",", "pts", ",", "\[Sigma]", ",", "R", ",", 
         "S", ",", "pS", ",", "pR", ",", "pairs", ",", "p", ",", "q", ",", 
         ",", "m", ",", "Q1", ",", "Q2", ",", "Q"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"M", "=", 
         RowBox[{"TorusKnot", "[", 
          RowBox[{"3", ",", "2", ",", 
           RowBox[{"Mesh", "\[Rule]", "nn"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"e2", "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"epos", "=", 
         RowBox[{
          RowBox[{"Ordering", "[", 
           RowBox[{
            RowBox[{"UnitEdgeVectors", "[", "M", "]"}], ".", "e2"}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", 
            RowBox[{"-", "2"}], ",", 
            RowBox[{"-", "1"}]}], "}"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ppos", "=", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Edges", "[", 
            RowBox[{"M", ",", "epos"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
          
          RowBox[{
           RowBox[{"Ordering", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"EdgeData", "[", "M", "]"}], "\[LeftDoubleBracket]", 
                "epos", "\[RightDoubleBracket]"}], ",", "1"}], "]"}], ".", 
             "e2"}], "]"}], "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"-", "2"}], ";;", 
            RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"epos2", "=", 
         RowBox[{"Intersection", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"AdjacencyLists", "[", 
              RowBox[{"M", ",", "Vertices", ",", "Edges"}], "]"}], 
             "\[LeftDoubleBracket]", "ppos", "\[RightDoubleBracket]"}], "]"}],
            ",", "epos"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"stratum", "=", 
         RowBox[{
          RowBox[{"StrataEdges", "[", "M", "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"i1", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"stratum", ",", 
            RowBox[{
            "epos2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
            "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"i2", "=", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"stratum", ",", 
            RowBox[{
            "epos2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
            "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"elist", "=", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "stratum", "]"}], "-", 
             RowBox[{"Max", "[", 
              RowBox[{"i1", ",", "i2"}], "]"}], "+", 
             RowBox[{"Min", "[", 
              RowBox[{"i1", ",", "i2"}], "]"}]}], "<=", 
            RowBox[{"Abs", "[", 
             RowBox[{"i1", "-", "i2"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"stratum", "\[LeftDoubleBracket]", 
            RowBox[{"i1", ";;", "i2"}], "\[RightDoubleBracket]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"stratum", "\[LeftDoubleBracket]", 
              RowBox[{"i2", ";;", 
               RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"stratum", "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", "i1"}], "\[RightDoubleBracket]"}]}], "]"}]}],
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"edges", "=", 
         RowBox[{"Edges", "[", 
          RowBox[{"M", ",", "elist"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"plist", "=", 
         RowBox[{"Union", "@@", "edges"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"shift", "=", 
         RowBox[{"e2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Mean", "[", 
             RowBox[{
              RowBox[{"VertexCoordinates", "[", 
               RowBox[{"M", ",", "ppos"}], "]"}], ".", "e2"}], "]"}], " ", 
            "+", 
            RowBox[{"OptionValue", "[", "\"\<Shift\>\"", "]"}]}], ")"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"pts", "=", 
         RowBox[{
          RowBox[{"VertexCoordinates", "[", 
           RowBox[{"M", ",", "plist"}], "]"}], "-", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"shift", ",", 
            RowBox[{"Length", "[", "plist", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Sigma]", "=", 
         RowBox[{"AssociationThread", "[", 
          RowBox[{"plist", ",", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "plist", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"edges", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"\[Sigma]", ",", "edges", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"R", "=", 
         RowBox[{"Init", "[", 
          RowBox[{"polygon", ",", "pts", ",", "edges"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"S", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{"x", "\[Function]", 
            RowBox[{"-", "x"}]}], ",", "R"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"pS", "=", 
         RowBox[{"VertexCoordinates", "[", 
          RowBox[{"S", ",", 
           RowBox[{
            RowBox[{"Strata", "[", "S", "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pR", "=", 
         RowBox[{"VertexCoordinates", "[", 
          RowBox[{"R", ",", 
           RowBox[{
            RowBox[{"Strata", "[", "S", "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", "=", 
            RowBox[{
             RowBox[{"Ordering", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Norm", "[", 
                   RowBox[{"p", "-", "q"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"p", ",", "pS"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"q", ",", "pR"}], "}"}]}], "]"}], ",", "1"}], 
               "]"}], "]"}], "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"pairs", "=", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", "j"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", 
                   RowBox[{"Length", "[", "pS", "]"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", "1", ",", 
                   RowBox[{"Length", "[", "pR", "]"}]}], "}"}]}], "]"}], ",", 
               "1"}], "]"}], "\[LeftDoubleBracket]", "a", 
             "\[RightDoubleBracket]"}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"p", "=", 
         RowBox[{"Part", "[", 
          RowBox[{"pS", ",", 
           RowBox[{"pairs", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"q", "=", 
         RowBox[{"Part", "[", 
          RowBox[{"pR", ",", 
           RowBox[{"pairs", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"m", "=", 
         RowBox[{"Ceiling", "[", 
          RowBox[{"1", "/", 
           RowBox[{"Mean", "[", 
            RowBox[{"EdgeLengths", "[", "M", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"plist", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"p", 
             RowBox[{"(", 
              RowBox[{"1", "-", "t"}], ")"}]}], "+", 
            RowBox[{"t", " ", "q"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "1", ",", 
             RowBox[{"1", "/", "m"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Q1", "=", 
         RowBox[{"Init", "[", 
          RowBox[{"polygon", ",", 
           RowBox[{"plist", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Q2", "=", 
         RowBox[{"Init", "[", 
          RowBox[{"polygon", ",", 
           RowBox[{"plist", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Q", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"S", ",", "R", ",", "Q1", ",", "Q2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Q", "=", 
         RowBox[{"ToleranceGlue", "[", 
          RowBox[{"Q", ",", "0.001"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "Q"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<Options\>\"", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"\"\<Shift\>\"", "\[Rule]", "1."}], "\[IndentingNewLine]", 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"GrannyKnot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "nn_", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "shift", ",", "M", ",", "e2", ",", "epos", ",", "ppos", ",", "epos2", 
        ",", "stratum", ",", "i1", ",", "i2", ",", "elist", ",", "plist", ",",
         "pts", ",", "pts2", ",", "m"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"shift", "=", 
        RowBox[{"OptionValue", "[", "\"\<Shift\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M", "=", 
        RowBox[{"TorusKnot", "[", 
         RowBox[{"3", ",", "2", ",", 
          RowBox[{"Mesh", "\[Rule]", "nn"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"e2", "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"epos", "=", 
        RowBox[{
         RowBox[{"Ordering", "[", 
          RowBox[{
           RowBox[{"UnitEdgeVectors", "[", "M", "]"}], ".", "e2"}], "]"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", 
           RowBox[{"-", "2"}], ",", 
           RowBox[{"-", "1"}]}], "}"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ppos", "=", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Edges", "[", 
           RowBox[{"M", ",", "epos"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"Ordering", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"EdgeData", "[", "M", "]"}], "\[LeftDoubleBracket]", 
               "epos", "\[RightDoubleBracket]"}], ",", "1"}], "]"}], ".", 
            "e2"}], "]"}], "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"-", "2"}], ";;", 
           RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"epos2", "=", 
        RowBox[{"Intersection", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"AdjacencyLists", "[", 
             RowBox[{"M", ",", "Vertices", ",", "Edges"}], "]"}], 
            "\[LeftDoubleBracket]", "ppos", "\[RightDoubleBracket]"}], "]"}], 
          ",", "epos"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"stratum", "=", 
        RowBox[{
         RowBox[{"StrataEdges", "[", "M", "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"stratum", ",", 
           RowBox[{
           "epos2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"stratum", ",", 
           RowBox[{
           "epos2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"elist", "=", 
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "stratum", "]"}], "-", 
            RowBox[{"Max", "[", 
             RowBox[{"i1", ",", "i2"}], "]"}], "+", 
            RowBox[{"Min", "[", 
             RowBox[{"i1", ",", "i2"}], "]"}]}], "<=", 
           RowBox[{"Abs", "[", 
            RowBox[{"i1", "-", "i2"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"stratum", "\[LeftDoubleBracket]", 
           RowBox[{"i1", ";;", "i2"}], "\[RightDoubleBracket]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"stratum", "\[LeftDoubleBracket]", 
             RowBox[{"i2", ";;", 
              RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"stratum", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", "i1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"plist", "=", 
        RowBox[{"Union", "@@", 
         RowBox[{"Edges", "[", 
          RowBox[{"M", ",", "elist"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"shift", "=", 
        RowBox[{"e2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Mean", "[", 
            RowBox[{
             RowBox[{"VertexCoordinates", "[", 
              RowBox[{"M", ",", "ppos"}], "]"}], ".", "e2"}], "]"}], " ", "+",
            "shift"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pts", "=", 
        RowBox[{
         RowBox[{"VertexCoordinates", "[", 
          RowBox[{"M", ",", "plist"}], "]"}], "-", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"shift", ",", 
           RowBox[{"Length", "[", "plist", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pts2", "=", 
        RowBox[{
         RowBox[{"Reverse", "[", "pts", "]"}], ".", 
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m", "=", 
        RowBox[{"Ceiling", "[", 
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{
            RowBox[{
            "pts2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "-", 
            RowBox[{"pts", "\[LeftDoubleBracket]", 
             RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], "]"}], "/", 
          RowBox[{"Mean", "[", 
           RowBox[{"EdgeLengths", "[", "M", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Init", "[", "\[IndentingNewLine]", 
        RowBox[{"polygon", ",", "\[IndentingNewLine]", 
         RowBox[{"Join", "[", 
          RowBox[{"pts", ",", 
           RowBox[{
            RowBox[{"Subdivide", "[", 
             RowBox[{
              RowBox[{"pts", "\[LeftDoubleBracket]", 
               RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "pts2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", "m"}], "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}], ",", "pts2", 
           ",", 
           RowBox[{
            RowBox[{"Subdivide", "[", 
             RowBox[{
              RowBox[{"pts2", "\[LeftDoubleBracket]", 
               RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "pts", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", "m"}], "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"2", ";;", 
             RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\"\<Closed\>\""}], "\[IndentingNewLine]", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Options\>\"", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"\"\<Shift\>\"", "\[Rule]", "1."}], "\[IndentingNewLine]", 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.6738368277257032`*^9, 3.6738368514322977`*^9}, {
  3.673836913816658*^9, 3.673836959285963*^9}, {3.673836989342328*^9, 
  3.6738370152133617`*^9}, {3.673837075928557*^9, 3.6738371259239397`*^9}, {
  3.673837241245269*^9, 3.673837259575225*^9}, {3.6738374158423*^9, 
  3.673837416061054*^9}, {3.673838360223761*^9, 3.673838360498144*^9}, {
  3.673838788540506*^9, 3.6738389172743893`*^9}, {3.673838952041108*^9, 
  3.673838972169868*^9}, {3.67383901161559*^9, 3.6738390400543756`*^9}, {
  3.713254861870966*^9, 3.713254893570572*^9}, {3.719504653743191*^9, 
  3.719504705682002*^9}, {3.7758200564704237`*^9, 3.7758200593603973`*^9}, {
  3.7758201944808702`*^9, 3.775820209719228*^9}, {3.7775828925243883`*^9, 
  3.7775829306976557`*^9}, {3.795365986754017*^9, 
  3.7953659923248987`*^9}},ExpressionUUID->"49efc788-15e1-425e-bffd-\
7057b2dfdcb8"],

Cell[BoxData[
 RowBox[{"CrazyKnot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "nn_", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "a", ",", "objfile", ",", "g", ",", "s", ",", "shift", ",", "pts", ",",
         "pts0", ",", "\[Gamma]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "=", "\"\<CrazyKnot.obj\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a", "=", 
        RowBox[{
         RowBox[{"Packages", "[", "$PM", "]"}], "[", "\"\<Polygon\>\"", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"objfile", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"SourcePath", "[", "a", "]"}], ",", "\"\<KnotData\>\"", 
           ",", "s"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"g", "=", 
        RowBox[{"Import", "[", 
         RowBox[{"objfile", ",", "\"\<OBJ\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pts0", "=", 
        RowBox[{"Mean", "/@", 
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"MeshCoordinates", "[", "g", "]"}], ",", "8"}], "]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"3", ";;", 
           RowBox[{"-", "1"}]}], "\[RightDoubleBracket]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"shift", "=", 
        RowBox[{"-", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.2915873565703334`"}], ",", "0.08738571889448025`", 
           ",", 
           RowBox[{"-", "0.22950983268663314`"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pts0", "+=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"shift", ",", 
          RowBox[{"Length", "[", "pts0", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pts0", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], "*=", 
        RowBox[{"OptionValue", "[", "\"\<Squeeze\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]", "=", 
        RowBox[{"t", "\[Function]", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"ClosedSpline", "[", 
            RowBox[{"Append", "[", 
             RowBox[{"pts0", ",", 
              RowBox[{"pts0", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "[", "t", 
           "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Init", "[", 
        RowBox[{"polygon", ",", 
         RowBox[{"\[Gamma]", "[", 
          RowBox[{"Most", "[", 
           RowBox[{"Subdivide", "[", 
            RowBox[{"0.", ",", 
             RowBox[{"2.", "Pi"}], ",", "nn"}], "]"}], "]"}], "]"}], ",", 
         "\"\<Closed\>\""}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"\"\<Squeeze\>\"", "\[Rule]", "1."}], "\[IndentingNewLine]", 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.67587034155588*^9, 3.6758703451766148`*^9}, {
   3.713254897281625*^9, 3.713254902853972*^9}, {3.719504781669055*^9, 
   3.719504783507155*^9}, {3.719504874056738*^9, 3.7195048829661503`*^9}, {
   3.7575074506984453`*^9, 3.757507451617736*^9}, 3.795870830303588*^9, {
   3.795871031745427*^9, 3.795871037624202*^9}, {3.7958711110439777`*^9, 
   3.7958711244187613`*^9}},
 CellLabel->
  "In[366]:=",ExpressionUUID->"a80c5794-09e5-4e73-a19c-ebca1c344fdf"],

Cell[BoxData[
 RowBox[{"HopfLink", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"n_", ",", "\[IndentingNewLine]", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ParametricPolygon", "[", 
       RowBox[{
        RowBox[{"t", "\[Function]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "t", "]"}], "-", 
            RowBox[{"OptionValue", "[", "\"\<Shift\>\"", "]"}]}], ",", 
           RowBox[{"Sin", "[", "t", "]"}], ",", "0"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"2", "Pi"}], ",", "n"}], "}"}], ",", 
        RowBox[{"\"\<Closed\>\"", "\[Rule]", "True"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ParametricPolygon", "[", 
       RowBox[{
        RowBox[{"t", "\[Function]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "\"\<Shift\>\"", "]"}], "-", 
            RowBox[{"Cos", "[", "t", "]"}]}], ",", "0", ",", 
           RowBox[{"Sin", "[", "t", "]"}]}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"2", "Pi"}], ",", "n"}], "}"}], ",", 
        RowBox[{"\"\<Closed\>\"", "\[Rule]", "True"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"\"\<Shift\>\"", "\[Rule]", "0.5"}], "\[IndentingNewLine]", 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7443595537463017`*^9, 3.744359560887953*^9}, {
  3.756561907573142*^9, 3.756561909275055*^9}, {3.780164734260387*^9, 
  3.780164765062796*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"d3373420-9620-4500-a358-3deea66997cd"],

Cell[BoxData[
 RowBox[{"HelixKnot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "n0_", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "n", ",", "\[Theta]", ",", "R1", ",", "R2", ",", "R3", ",", 
        "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Gamma]1", ",", "\[Omega]", ",",
         "\[Gamma]0", ",", "u1", ",", "u2", ",", "\[Gamma]31", ",", 
        "\[Gamma]32", ",", "\[Delta]11", ",", "\[Delta]12", ",", "\[Delta]21",
         ",", "\[Delta]22", ",", "\[Gamma]2", ",", "t1list", ",", "t2list", 
        ",", "t3list", ",", "s1list", ",", "s2list", ",", "p1", ",", "p2", 
        "\[IndentingNewLine]", ",", "p31", ",", "p32", ",", "q11", ",", "q12",
         ",", "q21", ",", "q22", ",", "p", ",", "q", ",", "pts"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"1", "+", "n0"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Theta]", "=", "0.4"}], ";", "\[IndentingNewLine]", 
       RowBox[{"R1", "=", ".3"}], ";", "\[IndentingNewLine]", 
       RowBox[{"R2", "=", "1."}], ";", "\[IndentingNewLine]", 
       RowBox[{"R3", "=", "1."}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Alpha]1", "=", 
        RowBox[{"ArcSin", "[", 
         RowBox[{
          RowBox[{"\[Theta]", "/", "2"}], "/", "R1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Alpha]2", "=", 
        RowBox[{"ArcSin", "[", 
         RowBox[{
          RowBox[{"\[Theta]", "/", "2"}], "/", "R2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]1", "=", 
        RowBox[{"t", "\[Function]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "R3"}], ",", 
           RowBox[{
            RowBox[{"-", "R3"}], "-", 
            RowBox[{"R1", " ", 
             RowBox[{"Cos", "[", "t", "]"}]}]}], ",", 
           RowBox[{"R1", " ", 
            RowBox[{"Sin", "[", "t", "]"}]}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"\[Omega]", "=", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<Twists\>\"", "]"}], " ", 
         RowBox[{"4", "/", "3"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]0", "=", 
        RowBox[{"t", "\[Function]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"R3", " ", 
            RowBox[{"Cos", "[", "t", "]"}]}], ",", 
           RowBox[{"R3", " ", 
            RowBox[{"Sin", "[", "t", "]"}]}], ",", "0"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"u1", "=", 
        RowBox[{"t", "\[Function]", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"Cos", "[", "t", "]"}], ",", 
           RowBox[{"Sin", "[", "t", "]"}], ",", "0"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"u2", "=", 
        RowBox[{"t", "\[Function]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]31", "=", 
        RowBox[{"t", "\[Function]", 
         RowBox[{
          RowBox[{"\[Gamma]0", "[", "t", "]"}], "+", 
          RowBox[{
           RowBox[{"\[Theta]", "/", "2"}], 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"(", 
              RowBox[{"t", "+", 
               RowBox[{"Pi", "/", "2"}]}], ")"}]}], "]"}], 
           RowBox[{"u2", "[", "t", "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Theta]", "/", "2"}], 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Omega]", " ", 
             RowBox[{"(", 
              RowBox[{"t", "+", 
               RowBox[{"Pi", "/", "2"}]}], ")"}]}], "]"}], 
           RowBox[{"u1", "[", "t", "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"\[Gamma]32", "=", 
        RowBox[{"t", "\[Function]", 
         RowBox[{
          RowBox[{"\[Gamma]0", "[", "t", "]"}], "+", 
          RowBox[{
           RowBox[{"\[Theta]", "/", "2"}], 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"\[Omega]", " ", 
              RowBox[{"(", 
               RowBox[{"t", "+", 
                RowBox[{"Pi", "/", "2"}]}], ")"}]}], "+", "Pi"}], "]"}], 
           RowBox[{"u2", "[", "t", "]"}]}], "+", 
          RowBox[{
           RowBox[{"\[Theta]", "/", "2"}], 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"\[Omega]", " ", 
              RowBox[{"(", 
               RowBox[{"t", "+", 
                RowBox[{"Pi", "/", "2"}]}], ")"}]}], "+", "Pi"}], "]"}], 
           RowBox[{"u1", "[", "t", "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Delta]11", "=", 
        RowBox[{"t", "\[Function]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "t"}], ")"}], 
           RowBox[{"\[Gamma]1", "[", 
            RowBox[{
             RowBox[{"-", "Pi"}], "+", "\[Alpha]1"}], "]"}]}], "+", 
          RowBox[{"t", " ", 
           RowBox[{"\[Gamma]32", "[", "Pi", "]"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Delta]12", "=", 
        RowBox[{"t", "\[Function]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "t"}], ")"}], 
           RowBox[{"\[Gamma]1", "[", 
            RowBox[{"Pi", "-", "\[Alpha]1"}], "]"}]}], "+", 
          RowBox[{"t", " ", 
           RowBox[{"\[Gamma]31", "[", "Pi", "]"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"\[Delta]21", "=", 
        RowBox[{"t", "\[Function]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "t"}], ")"}], 
           RowBox[{"\[Gamma]2", "[", 
            RowBox[{
             RowBox[{"-", "Pi"}], "+", "\[Alpha]2"}], "]"}]}], "+", 
          RowBox[{"t", " ", 
           RowBox[{"\[Gamma]32", "[", 
            RowBox[{
             RowBox[{"-", "Pi"}], "/", "2"}], "]"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Delta]22", "=", 
        RowBox[{"t", "\[Function]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "t"}], ")"}], 
           RowBox[{"\[Gamma]2", "[", 
            RowBox[{"Pi", "-", "\[Alpha]2"}], "]"}]}], "+", 
          RowBox[{"t", " ", 
           RowBox[{"\[Gamma]31", "[", 
            RowBox[{
             RowBox[{"-", "Pi"}], "/", "2"}], "]"}]}]}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]2", "=", 
        RowBox[{"t", "\[Function]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "R1"}], "-", "R3", "-", "R2", "-", 
            RowBox[{"R2", " ", 
             RowBox[{"Cos", "[", "t", "]"}]}]}], ",", 
           RowBox[{"-", "R3"}], ",", 
           RowBox[{"R2", " ", 
            RowBox[{"Sin", "[", "t", "]"}]}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"t1list", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"N", "[", "t", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", 
            RowBox[{
             RowBox[{"-", "Pi"}], "+", "\[Alpha]1"}], ",", 
            RowBox[{"Pi", "-", "\[Alpha]1"}], ",", 
            RowBox[{"2", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Pi", "-", "\[Alpha]1"}], ")"}], "/", "10"}], " ", 
              "/", "n"}]}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"t2list", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"N", "[", "t", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", 
            RowBox[{
             RowBox[{"-", "Pi"}], "+", "\[Alpha]2"}], ",", 
            RowBox[{"Pi", "-", "\[Alpha]2"}], ",", 
            RowBox[{"2", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Pi", "-", "\[Alpha]2"}], ")"}], "/", "20"}], "/", 
              "n"}]}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"t3list", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"N", "[", "t", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", 
            RowBox[{
             RowBox[{"-", "Pi"}], "/", "2"}], ",", "Pi", ",", 
            RowBox[{
             RowBox[{"3", "/", "2"}], 
             RowBox[{
              RowBox[{"Pi", "/", "40"}], "/", "n"}]}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"s1list", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"N", "[", "t", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "1", ",", 
            RowBox[{
             RowBox[{"1", "/", "3"}], "/", "n"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"s2list", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"N", "[", "t", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "1", ",", 
            RowBox[{
             RowBox[{"1", "/", "6"}], "/", "n"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p1", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"\[Gamma]1", ",", "t1list"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p2", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"\[Gamma]2", ",", "t2list"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p31", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"\[Gamma]31", ",", "t3list"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"p32", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"\[Gamma]32", ",", "t3list"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"q11", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"\[Delta]11", ",", "s1list"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"q12", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"\[Delta]12", ",", "s1list"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"q21", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"\[Delta]21", ",", "s2list"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"q22", "=", 
        RowBox[{"Map", "[", 
         RowBox[{"\[Delta]22", ",", "s2list"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{"Catenate", "@", 
         RowBox[{"(", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"q21", "\[LeftDoubleBracket]", 
             RowBox[{"2", ";;", 
              RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}], ",", 
            "\[IndentingNewLine]", "p32", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Reverse", "@", "q11"}], ")"}], "\[LeftDoubleBracket]", 
             
             RowBox[{"2", ";;", 
              RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}], ",", 
            "\[IndentingNewLine]", "p1", ",", "\[IndentingNewLine]", 
            RowBox[{"q12", "\[LeftDoubleBracket]", 
             RowBox[{"2", ";;", 
              RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Reverse", "@", "p31"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Reverse", "@", "q22"}], ")"}], "\[LeftDoubleBracket]", 
             
             RowBox[{"2", ";;", 
              RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}]}], 
           "\[IndentingNewLine]", "}"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", 
          RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}], "-=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"p", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", 
            RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"Length", "[", "p", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"q", "=", 
        RowBox[{"Reverse", "@", "p"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", 
          RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}], "*=", 
        RowBox[{"-", "1."}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pts", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Most", "@", "p"}], ",", 
          RowBox[{"Most", "@", "q"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Init", "[", 
        RowBox[{"polygon", ",", "pts", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"i", "+", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
                RowBox[{"Length", "[", "pts", "]"}], "-", "1"}]}], "}"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Length", "[", "pts", "]"}], ",", "1"}], "}"}]}], 
          "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Twists\>\"", "\[Rule]", "6"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.673173295189734*^9, 3.673173332268841*^9}, {
   3.673173382017579*^9, 3.673173508400391*^9}, {3.673173545779325*^9, 
   3.673173596574504*^9}, {3.673174293558156*^9, 3.6731743061338663`*^9}, {
   3.673174357682803*^9, 3.673174358051005*^9}, {3.6731747728921127`*^9, 
   3.673174789177956*^9}, {3.6731748368302507`*^9, 3.673174848494687*^9}, {
   3.673174944794919*^9, 3.6731749699241734`*^9}, 3.6731750298972607`*^9, {
   3.673175086515596*^9, 3.673175168410612*^9}, {3.673175220081086*^9, 
   3.673175235125909*^9}, {3.673175305291356*^9, 3.673175384656698*^9}, {
   3.673175445085355*^9, 3.673175570971583*^9}, {3.6731756090230303`*^9, 
   3.673175777210772*^9}, {3.821341151878338*^9, 3.821341152238967*^9}, {
   3.8213411952471027`*^9, 
   3.82134121634144*^9}},ExpressionUUID->"8f1f8043-dd49-4d96-9a4e-\
48a492791525"],

Cell[BoxData[
 RowBox[{"LewinGanBrucksteinUnknot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "n_", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "a", ",", "objfile", ",", "s", ",", "pts", ",", "\[Gamma]", ",", "h"}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "=", "\"\<LewinGanBrucksteinUnknot.obj\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a", "=", 
        RowBox[{
         RowBox[{"Packages", "[", "$PM", "]"}], "[", "\"\<Polygon\>\"", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"objfile", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"SourcePath", "[", "a", "]"}], ",", "\"\<KnotData\>\"", 
           ",", "s"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"h", "=", 
        RowBox[{"OptionValue", "[", "\"\<ScaleZAxis\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pts", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Mean", "/@", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"MeshCoordinates", "[", 
              RowBox[{"Import", "[", 
               RowBox[{"objfile", ",", "\"\<OBJ\>\""}], "]"}], "]"}], ",", 
             "2"}], "]"}]}], ")"}], ".", 
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"{", 
           RowBox[{"1.", ",", "1.", ",", "h"}], "}"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]", "=", 
        RowBox[{"Interpolation", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Subdivide", "[", 
              RowBox[{"0.", ",", 
               RowBox[{"2.", "Pi"}], ",", 
               RowBox[{"Length", "[", "pts", "]"}]}], "]"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{"pts", ",", 
               RowBox[{
               "pts", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], "]"}]}], "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PeriodicInterpolation", "\[Rule]", "True"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"InterpolationOrder", "\[Rule]", "3"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"Method", "\[Rule]", "\"\<Spline\>\""}]}], "*)"}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Centralize", "@", 
        RowBox[{"ParametricPolygon", "[", 
         RowBox[{"\[Gamma]", ",", 
          RowBox[{"{", 
           RowBox[{"0.", ",", 
            RowBox[{"2.", "Pi"}], ",", "n"}], "}"}], ",", 
          RowBox[{"\"\<Closed\>\"", "\[Rule]", "True"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"\"\<ScaleZAxis\>\"", "\[Rule]", "4."}], "\[IndentingNewLine]", 
      "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
    "Description", "\[Rule]", 
     "\"\<This is KnotPlot example LewGanBru1.k; derived from Figure 11 in \
Lewin, Gan, Bruckstein - Trivial or Knot:\nA Software Tool and Algorithms for \
Knot Simplification.\>\""}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.67587034155588*^9, 3.6758703451766148`*^9}, {
   3.713254897281625*^9, 3.713254902853972*^9}, {3.719504781669055*^9, 
   3.719504783507155*^9}, {3.719504874056738*^9, 3.7195048829661503`*^9}, {
   3.7575074506984453`*^9, 3.757507451617736*^9}, {3.7871357670456457`*^9, 
   3.787135786911805*^9}, {3.787136199819255*^9, 3.787136258057118*^9}, {
   3.787136336497158*^9, 3.787136339638876*^9}, {3.787136421650638*^9, 
   3.787136497887393*^9}, 3.787136630058179*^9, {3.787138435962946*^9, 
   3.787138438320548*^9}, 
   3.7958708423908377`*^9},ExpressionUUID->"b6cb0bc3-8a32-482b-864e-\
1feef78b3a3e"],

Cell[BoxData[
 RowBox[{"LewinGanBrucksteinTorusknot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "n_", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "a", ",", "objfile", ",", "s", ",", "pts", ",", "\[Gamma]", ",", "h"}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "=", "\"\<LewinGanBrucksteinTorusKnot.obj\>\""}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a", "=", 
        RowBox[{
         RowBox[{"Packages", "[", "$PM", "]"}], "[", "\"\<Polygon\>\"", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"objfile", "=", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"SourcePath", "[", "a", "]"}], ",", "\"\<KnotData\>\"", 
           ",", "s"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"h", "=", 
        RowBox[{"OptionValue", "[", "\"\<ScaleZAxis\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pts", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Mean", "/@", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"MeshCoordinates", "[", 
              RowBox[{"Import", "[", 
               RowBox[{"objfile", ",", "\"\<OBJ\>\""}], "]"}], "]"}], ",", 
             "2"}], "]"}]}], ")"}], ".", 
         RowBox[{"DiagonalMatrix", "[", 
          RowBox[{"{", 
           RowBox[{"1.", ",", "1.", ",", "h"}], "}"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]", "=", 
        RowBox[{"Interpolation", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Subdivide", "[", 
              RowBox[{"0.", ",", 
               RowBox[{"2.", "Pi"}], ",", 
               RowBox[{"Length", "[", "pts", "]"}]}], "]"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{"pts", ",", 
               RowBox[{
               "pts", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], "]"}]}], "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PeriodicInterpolation", "\[Rule]", "True"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"InterpolationOrder", "\[Rule]", "3"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"Method", "\[Rule]", "\"\<Spline\>\""}]}], "*)"}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Centralize", "@", 
        RowBox[{"ParametricPolygon", "[", 
         RowBox[{"\[Gamma]", ",", 
          RowBox[{"{", 
           RowBox[{"0.", ",", 
            RowBox[{"2.", "Pi"}], ",", "n"}], "}"}], ",", 
          RowBox[{"\"\<Closed\>\"", "\[Rule]", "True"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"\"\<ScaleZAxis\>\"", "\[Rule]", "2."}], "\[IndentingNewLine]", 
      "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
    "Description", "\[Rule]", 
     "\"\<This is KnotPlot example LewGanBru1.k; derived from Figure 12 in \
Lewin, Gan, Bruckstein - Trivial or Knot:\nA Software Tool and Algorithms for \
Knot Simplification.\>\""}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.787136505750134*^9, 3.787136514023224*^9}, {
   3.7871365874886436`*^9, 3.787136627821207*^9}, 3.787138440799769*^9, 
   3.7958708502858152`*^9},
 CellLabel->
  "In[374]:=",ExpressionUUID->"b21bbc62-c8c6-4f62-be97-825daad0e661"],

Cell[BoxData[
 RowBox[{"OtherFigureEightKnot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "n_", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pts0", ",", "\[Gamma]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pts0", "=", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"SourcePath", "[", 
              RowBox[{
               RowBox[{"Packages", "[", "$PM", "]"}], "[", "\"\<Polygon\>\"", 
               "]"}], "]"}], ",", "\"\<KnotData\>\"", ",", 
             "\"\<OtherFigureEight.csv\>\""}], "}"}], "]"}], ",", 
          "\"\<Data\>\""}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]", "=", 
        RowBox[{"t", "\[Function]", 
         RowBox[{"Evaluate", "[", 
          RowBox[{
           RowBox[{"ClosedSpline", "[", 
            RowBox[{"ToPack", "@", 
             RowBox[{"Append", "[", 
              RowBox[{"pts0", ",", 
               RowBox[{"pts0", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], "[", "t", 
           "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Init", "[", 
        RowBox[{"polygon", ",", 
         RowBox[{"\[Gamma]", "[", 
          RowBox[{"Most", "[", 
           RowBox[{"Subdivide", "[", 
            RowBox[{"0.", ",", 
             RowBox[{"2.", "Pi"}], ",", "n"}], "]"}], "]"}], "]"}], ",", 
         "\"\<Closed\>\""}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.795871344586946*^9, 3.795871355219524*^9}},
 CellLabel->
  "In[386]:=",ExpressionUUID->"c0030d26-5820-40af-b9fa-301677566980"],

Cell[BoxData[
 RowBox[{"KauffmanUnknot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n_", ":", "0"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Centralize", "[", "\[IndentingNewLine]", 
     RowBox[{"Subdivide", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Init", "[", "\[IndentingNewLine]", 
        RowBox[{"polygon", ",", "\[IndentingNewLine]", 
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"SourcePath", "[", 
               RowBox[{
                RowBox[{"Packages", "[", "$PM", "]"}], "[", "\"\<Polygon\>\"",
                 "]"}], "]"}], ",", "\"\<KnotData\>\"", ",", 
              "\"\<Kauffman.txt\>\""}], "}"}], "]"}], ",", "\"\<Table\>\""}], 
          "]"}], ",", "\"\<Closed\>\""}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Subdivisions", "\[Rule]", "n"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Method", "\[Rule]", "\"\<Planar\>\""}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
    "Description", "\[Rule]", 
     "\"\<This is a so-called `hard unknot' sent to me by Louis \
Kauffman.\>\""}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.818591120178862*^9, 3.8185911471760273`*^9}},
 CellLabel->
  "In[2867]:=",ExpressionUUID->"cafc51f5-e4d6-4c3c-a3b8-8123a5c465c4"],

Cell[BoxData[
 RowBox[{"KauffmanUnknot2", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n_", ":", "0"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Centralize", "[", "\[IndentingNewLine]", 
     RowBox[{"Subdivide", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Init", "[", "\[IndentingNewLine]", 
        RowBox[{"polygon", ",", "\[IndentingNewLine]", 
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"SourcePath", "[", 
               RowBox[{
                RowBox[{"Packages", "[", "$PM", "]"}], "[", "\"\<Polygon\>\"",
                 "]"}], "]"}], ",", "\"\<KnotData\>\"", ",", 
              "\"\<Kauffman2.txt\>\""}], "}"}], "]"}], ",", "\"\<Table\>\""}],
           "]"}], ",", "\"\<Closed\>\""}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Subdivisions", "\[Rule]", "n"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Method", "\[Rule]", "\"\<Planar\>\""}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
    "Description", "\[Rule]", 
     "\"\<Another so-called `hard unknot' sent to me by Louis \
Kauffman.\>\""}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.816189203315624*^9, 3.8161892233041277`*^9}, {
  3.8185911530106573`*^9, 3.818591163256455*^9}},
 CellLabel->
  "In[2866]:=",ExpressionUUID->"7f83b008-e544-4a4a-8f17-c7c36c401b65"]
},
WindowSize->{1440, 855},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 678, 16, 92, "Input",ExpressionUUID->"020eb25c-5e55-4fcf-a297-df360003b1aa"],
Cell[1239, 38, 656, 15, 92, "Input",ExpressionUUID->"ba050b0e-a235-413e-9af1-12a6bf368e27"],
Cell[1898, 55, 699, 17, 92, "Input",ExpressionUUID->"93583373-665b-4389-8f77-a3b384fd8c59"],
Cell[2600, 74, 776, 18, 92, "Input",ExpressionUUID->"15f6d87a-7dff-48dc-a407-c416d1c94d5a"],
Cell[3379, 94, 1275, 31, 217, "Input",ExpressionUUID->"77baf281-18a6-4d8a-b6ac-296e1e172536"],
Cell[4657, 127, 1127, 26, 192, "Input",ExpressionUUID->"98b853d3-1c59-4ab4-a63c-aba127c2374e"],
Cell[5787, 155, 845, 20, 117, "Input",ExpressionUUID->"d5af138a-4dbb-4f13-812d-47b830b87b36"],
Cell[6635, 177, 1301, 31, 192, "Input",ExpressionUUID->"7deeb374-8327-4919-bd58-b8b02a5cd323"],
Cell[7939, 210, 1595, 33, 217, "Input",ExpressionUUID->"e3f15f80-16d0-4296-b1ba-4a457e9192b0"],
Cell[9537, 245, 3750, 88, 467, "Input",ExpressionUUID->"33e7c50b-d9ee-468f-be58-3a6bd138807f"],
Cell[13290, 335, 1595, 30, 167, "Input",ExpressionUUID->"44e1f80e-e24b-4886-bd4d-3113684e3442"],
Cell[14888, 367, 7105, 173, 892, "Input",ExpressionUUID->"25440a98-42fb-4b18-9b75-8dea07abff69"],
Cell[21996, 542, 1273, 32, 192, "Input",ExpressionUUID->"055af7da-e3b6-432c-bc5b-3b3adee9a2ca"],
Cell[23272, 576, 5803, 121, 1017, "Input",ExpressionUUID->"58a0cd17-86e2-4013-8bad-ffe77d028b54"],
Cell[29078, 699, 19718, 463, 1992, "Input",ExpressionUUID->"49efc788-15e1-425e-bffd-7057b2dfdcb8"],
Cell[48799, 1164, 3655, 87, 467, "Input",ExpressionUUID->"a80c5794-09e5-4e73-a19c-ebca1c344fdf"],
Cell[52457, 1253, 1783, 42, 242, "Input",ExpressionUUID->"d3373420-9620-4500-a358-3deea66997cd"],
Cell[54243, 1297, 14523, 358, 1592, "Input",ExpressionUUID->"8f1f8043-dd49-4d96-9a4e-48a492791525"],
Cell[68769, 1657, 4044, 91, 592, "Input",ExpressionUUID->"b6cb0bc3-8a32-482b-864e-1feef78b3a3e"],
Cell[72816, 1750, 3679, 86, 592, "Input",ExpressionUUID->"b21bbc62-c8c6-4f62-be97-825daad0e661"],
Cell[76498, 1838, 1805, 44, 217, "Input",ExpressionUUID->"c0030d26-5820-40af-b9fa-301677566980"],
Cell[78306, 1884, 1599, 35, 392, "Input",ExpressionUUID->"cafc51f5-e4d6-4c3c-a3b8-8123a5c465c4"],
Cell[79908, 1921, 1650, 36, 392, "Input",ExpressionUUID->"7f83b008-e544-4a4a-8f17-c7c36c401b65"]
}
]
*)

