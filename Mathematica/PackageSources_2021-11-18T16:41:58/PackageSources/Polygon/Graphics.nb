(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     61317,       1366]
NotebookOptionsPosition[     59491,       1337]
NotebookOutlinePosition[     59827,       1352]
CellTagsIndexPosition[     59784,       1349]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"MeshPointSize", "=", 
  RowBox[{"SettingFunction", "[", 
   RowBox[{"M_polygon", ",", "\[IndentingNewLine]", 
    RowBox[{"0.25", 
     RowBox[{"Min", "[", 
      RowBox[{"EdgeLengths", "[", "M", "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7443663437526217`*^9, 
  3.7443663734554377`*^9}},ExpressionUUID->"2f33fd3f-edca-435e-a61e-\
c397a3bf46fe"],

Cell[BoxData[
 RowBox[{"MeshThickness", "=", 
  RowBox[{"SettingFunction", "[", 
   RowBox[{"M_polygon", ",", "\[IndentingNewLine]", 
    RowBox[{"0.5", " ", 
     RowBox[{"MeshPointSize", "[", "M", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.744366335720997*^9, 3.7443663387828703`*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"8b69382d-2c01-41c1-a4a0-87eccf21cb27"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlotOptions", "=", 
   RowBox[{"SettingFunction", "[", 
    RowBox[{"M_polygon", ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
       RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
       RowBox[{"SphericalRegion", "\[Rule]", "True"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.682869532242548*^9, 3.682869554025393*^9}, {
  3.68287598452288*^9, 3.682876039191122*^9}, {3.6829518654724407`*^9, 
  3.682951867248292*^9}, {3.683096256033292*^9, 3.683096257166314*^9}, {
  3.6831015901697493`*^9, 3.683101599958022*^9}, {3.683101656098407*^9, 
  3.683101659782262*^9}, {3.683633490740553*^9, 3.683633503307014*^9}, {
  3.683706612500209*^9, 3.683706624603251*^9}, {3.730195805990432*^9, 
  3.730195814452074*^9}, {3.778169515696712*^9, 3.77816951814108*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"3d765fc4-40c3-476d-a852-ab093c7a4d44"],

Cell[BoxData[
 RowBox[{"GraphicsDirectives", "=", 
  RowBox[{"SettingFunction", "[", 
   RowBox[{"M_polygon", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Thick", ",", "Black", ",", 
      RowBox[{"Opacity", "[", "1", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6828644071121807`*^9, 3.6828644092870903`*^9}, {
  3.6828644589211884`*^9, 3.68286458664813*^9}, {3.682864899479631*^9, 
  3.682864903406457*^9}, {3.6828653600127897`*^9, 3.682865399830372*^9}, {
  3.682865555930995*^9, 3.6828655570081577`*^9}, {3.6828660376551037`*^9, 
  3.6828660423805933`*^9}, {3.6828760553357143`*^9, 3.68287605647474*^9}, {
  3.682951869424679*^9, 3.682951872216365*^9}, {3.682952008313675*^9, 
  3.682952057338941*^9}, {3.683633494124919*^9, 3.683633520509138*^9}, {
  3.6837045333775597`*^9, 3.683704560858971*^9}, {3.683704802093021*^9, 
  3.683704850018008*^9}, {3.683706560521821*^9, 3.6837065795964813`*^9}, {
  3.730195540909759*^9, 3.730195548883543*^9}, {3.7781695210637712`*^9, 
  3.7781695228048553`*^9}, {3.7781696450386457`*^9, 3.778169646412403*^9}, {
  3.778177618815742*^9, 3.778177619285585*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"f135c4ad-720a-4486-9fce-af5521fe39bc"],

Cell[BoxData[
 RowBox[{"TubeGraphicsDirectives", "=", 
  RowBox[{"SettingFunction", "[", 
   RowBox[{"M_polygon", ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"EdgeForm", "[", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"FaceForm", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Darker", "@", "Orange"}], ",", 
         RowBox[{"Specularity", "[", 
          RowBox[{"White", ",", "30"}], "]"}], ",", 
         RowBox[{"Opacity", "[", "1", "]"}]}], "}"}], "]"}]}], 
     "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.77816964010918*^9, 3.7781696639737186`*^9}, {
  3.7781776120630913`*^9, 3.778177612294569*^9}},
 CellLabel->
  "In[688]:=",ExpressionUUID->"f542e05f-18aa-4897-b465-a436bd7e213e"],

Cell[BoxData[
 RowBox[{"MeshPointSize", "=", 
  RowBox[{"SettingFunction", "[", 
   RowBox[{"M_polygon", ",", "\[IndentingNewLine]", 
    RowBox[{"0.125", 
     RowBox[{"Min", "[", 
      RowBox[{"EdgeLengths", "[", "M", "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7234040958342943`*^9, 3.723404125746337*^9}, 
   3.723404171329364*^9, {3.7301955529796877`*^9, 3.730195563003171*^9}, {
   3.778169525390746*^9, 3.778169527076846*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"0c38c8ac-88fe-4e22-bb0c-0dd2c282c775"],

Cell[BoxData[
 RowBox[{"VerbatimRegion", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"polygon", "/:", 
    RowBox[{"Graphics", "[", 
     RowBox[{"P_polygon", ",", "args___"}], "]"}], ":=", 
    RowBox[{"Graphics", "[", 
     RowBox[{"{", 
      RowBox[{"Thick", ",", "args", ",", " ", 
       RowBox[{"Line", "/@", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"VertexCoordinates", "[", 
           RowBox[{"P", ",", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Edges", "[", "P", "]"}], "]"}]}], "]"}], ",", "2"}], 
         "]"}]}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"polygon", "/:", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"P_polygon", ",", "args___"}], "]"}], ":=", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Thick", ",", "args", ",", "\[IndentingNewLine]", " ", 
        RowBox[{"Line", "/@", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"VertexCoordinates", "[", 
            RowBox[{"P", ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Edges", "[", "P", "]"}], "]"}]}], "]"}], ",", "2"}], 
          "]"}]}]}], "}"}], ",", 
      RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6312613867578297`*^9, 3.631261418327594*^9}, {
   3.631278907277402*^9, 3.631278914363853*^9}, 3.6639257811523523`*^9, {
   3.7201016005447607`*^9, 3.72010160129382*^9}, {3.720101650188821*^9, 
   3.7201016506405687`*^9}, 3.723403844494379*^9, 
   3.723403950517048*^9},ExpressionUUID->"bafe3360-5d5b-4605-99cd-\
550945825652"],

Cell[BoxData[
 RowBox[{"MeshPlot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_polygon", ",", "\[IndentingNewLine]", 
    RowBox[{"PolygonPlot", "[", 
     RowBox[{"M", ",", "\[IndentingNewLine]", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"OptionValue", "[", "PlotStyle", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<BoundingBox\>\"", "\[Rule]", 
       RowBox[{"OptionValue", "[", "\"\<BoundingBox\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<BoundingBoxStyle\>\"", "\[Rule]", 
       RowBox[{"OptionValue", "[", "\"\<BoundingBoxStyle\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<LineFunction\>\"", "\[Rule]", 
       RowBox[{"OptionValue", "[", "\"\<LineFunction\>\"", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<BoundingBox\>\"", "\[Rule]", "False"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<BoundingBoxStyle\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Opacity", "[", "0.", "]"}], ",", 
          RowBox[{"EdgeForm", "[", "]"}], ",", 
          RowBox[{"FaceForm", "[", "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<LineFunction\>\"", "\[Rule]", "Line"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.673437784402269*^9, 3.673437870252437*^9}, {
  3.678610393406722*^9, 3.678610394043483*^9}, {3.683711720340906*^9, 
  3.683711723181514*^9}, {3.7130046932561617`*^9, 3.713004706071352*^9}, {
  3.778169531054564*^9, 
  3.778169547708724*^9}},ExpressionUUID->"980279d9-7809-4cac-a345-\
d5938ef0a1f7"],

Cell[BoxData[
 RowBox[{"PolygonPlot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_polygon", ",", "\[IndentingNewLine]", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "vertexcolors", ",", "allopts", ",", "opts", ",", "gfun", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"defaultdirectives", "=", 
         RowBox[{"GraphicsDirectives", "[", "M", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"defaultoptions", "=", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"linefun", "=", 
         RowBox[{"OptionValue", "[", "\"\<LineFunction\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gfun", "=", 
        RowBox[{"PlotFunction", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vertexcolors", "=", 
        RowBox[{"VertexColors", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"opts", "=", 
        RowBox[{"OptionValue", "[", "\"\<PlotStyle\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"opts", "===", "Automatic"}], ",", "\[IndentingNewLine]", 
         RowBox[{"opts", "=", 
          RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"allopts", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"defaultdirectives", ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{"List", "[", "opts", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{"gfun", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "\"\<BoundingBox\>\"", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Sequence", "@@", 
                 RowBox[{
                 "OptionValue", "[", "\"\<BoundingBoxStyle\>\"", "]"}]}], ",", 
                RowBox[{"BoundingBox", "[", "M", "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Sequence", "@@", "allopts"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Head", "[", "vertexcolors", "]"}], "===", "Missing"}],
               ",", "\[IndentingNewLine]", " ", 
              RowBox[{"(*", 
               RowBox[{"Line", "/@", 
                RowBox[{"EdgeData", "[", "M", "]"}]}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"GraphicsComplex", "[", 
               RowBox[{
                RowBox[{"VertexCoordinates", "[", "M", "]"}], ",", 
                RowBox[{"linefun", "[", 
                 RowBox[{"Edges", "[", "M", "]"}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"GraphicsComplex", "[", 
               RowBox[{
                RowBox[{"VertexCoordinates", "[", "M", "]"}], ",", 
                RowBox[{"linefun", "[", 
                 RowBox[{"Edges", "[", "M", "]"}], "]"}], ",", 
                RowBox[{"VertexColors", "\[Rule]", 
                 RowBox[{"RGBColor", "@@@", "vertexcolors"}]}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"PlotOptions", "[", "M", "]"}]}]}], "\[IndentingNewLine]", 
         "]"}], "\[IndentingNewLine]", "]"}]}]}], "\n", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<PlotStyle\>\"", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<BoundingBox\>\"", "\[Rule]", "False"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<BoundingBoxStyle\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Opacity", "[", "0.", "]"}], ",", 
          RowBox[{"EdgeForm", "[", "]"}], ",", 
          RowBox[{"FaceForm", "[", "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<LineFunction\>\"", "\[Rule]", "Line"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6309608922863607`*^9, 3.630960920122044*^9}, {
   3.630960965925653*^9, 3.630960975949239*^9}, {3.630961021490006*^9, 
   3.630961022847558*^9}, {3.630961268501604*^9, 3.630961302761654*^9}, {
   3.630961357890355*^9, 3.630961363964212*^9}, {3.630961427740155*^9, 
   3.630961427887195*^9}, {3.630961826205162*^9, 3.630961840897914*^9}, {
   3.6309619032435093`*^9, 3.630961904897784*^9}, {3.632697110279187*^9, 
   3.632697112032179*^9}, {3.632697502963456*^9, 3.6326976410329037`*^9}, 
   3.632697712298818*^9, {3.632697822886794*^9, 3.632697827858448*^9}, {
   3.632698275051859*^9, 3.632698311114711*^9}, {3.6326983659029007`*^9, 
   3.632698370596225*^9}, 3.6326984202745028`*^9, 3.6327300173901*^9, {
   3.632730076814827*^9, 3.632730077406355*^9}, {3.632730292098805*^9, 
   3.632730324288857*^9}, {3.6327303883395653`*^9, 3.632730392882351*^9}, {
   3.632730714775627*^9, 3.6327307246296043`*^9}, {3.633190685840453*^9, 
   3.633190688372005*^9}, {3.633869926382674*^9, 3.633870009638648*^9}, {
   3.63387004041391*^9, 3.633870048723569*^9}, 3.6338783544353867`*^9, {
   3.633878475242323*^9, 3.633878482888392*^9}, 3.633878618835219*^9, {
   3.633880588972939*^9, 3.63388059274028*^9}, {3.636106918381794*^9, 
   3.6361069377408447`*^9}, {3.643026169292427*^9, 3.643026192970212*^9}, {
   3.6430280988604527`*^9, 3.64302814221229*^9}, {3.643028580101643*^9, 
   3.643028585251053*^9}, 3.6430816086270533`*^9, {3.664266407786335*^9, 
   3.6642664156743526`*^9}, {3.664266456844933*^9, 3.664266494132237*^9}, {
   3.664266535943084*^9, 3.664266680550276*^9}, {3.666686655729517*^9, 
   3.666686711792944*^9}, {3.666686763642815*^9, 3.666686805505288*^9}, {
   3.666686881138164*^9, 3.66668689635602*^9}, {3.666686943443263*^9, 
   3.6666869469843283`*^9}, {3.666686990373355*^9, 3.666686998097535*^9}, {
   3.666687090373839*^9, 3.666687090929632*^9}, {3.666688542206218*^9, 
   3.6666885426931887`*^9}, {3.66672491386185*^9, 3.6667250573612833`*^9}, {
   3.666725121828397*^9, 3.666725125123437*^9}, {3.6667251565363197`*^9, 
   3.666725165029562*^9}, 3.666725204574863*^9, {3.671702102780548*^9, 
   3.671702103307933*^9}, {3.6786103791593924`*^9, 3.678610379811719*^9}, {
   3.683633545929081*^9, 3.683633550140921*^9}, {3.6836348131032553`*^9, 
   3.683634813651793*^9}, {3.6837117299182463`*^9, 3.683711731942062*^9}, {
   3.6983136375538588`*^9, 3.698313639776032*^9}, {3.6983136851365643`*^9, 
   3.6983136882895412`*^9}, {3.698313740995509*^9, 3.698313747514391*^9}, {
   3.698313860603788*^9, 3.698313977150341*^9}, {3.698314020571784*^9, 
   3.698314054376876*^9}, {3.698314168796426*^9, 3.698314206494059*^9}, {
   3.698338286052546*^9, 3.698338293427309*^9}, {3.7130046465636787`*^9, 
   3.7130046856572104`*^9}, {3.720101602976242*^9, 3.72010160340808*^9}, {
   3.720101651704298*^9, 3.7201016522150593`*^9}, {3.730195961412136*^9, 
   3.7301959738770227`*^9}, {3.778169481848933*^9, 3.778169490551546*^9}, 
   3.778169539789624*^9, {3.778169677085828*^9, 3.77816968770916*^9}, {
   3.7781697876316223`*^9, 3.778169800685875*^9}, {3.793800300408628*^9, 
   3.793800302493185*^9}, {3.842675290410512*^9, 3.842675314384692*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"e04964cf-7a4a-41cd-af6a-5535271780f2"],

Cell[BoxData[
 RowBox[{"Present", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_polygon", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"box", ",", "r"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "=", 
        RowBox[{"OptionValue", "[", "\"\<Radius\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"r", "===", "Automatic"}], ",", 
         RowBox[{"r", "=", 
          RowBox[{"0.025", " ", 
           RowBox[{"BoundingBoxLength", "[", "M", "]"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"box", "=", 
        RowBox[{
         RowBox[{"BoundingBox", "[", "M", "]"}], "+", 
         RowBox[{"1.01", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "r"}], ",", "r"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "r"}], ",", "r"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "r"}], ",", "r"}], "}"}]}], "}"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics3D", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "\"\<BoundingBox\>\"", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Sequence", "@@", 
                 RowBox[{
                 "OptionValue", "[", "\"\<BoundingBoxStyle\>\"", "]"}]}], ",", 
                RowBox[{"Cuboid", "@@", 
                 RowBox[{"Transpose", "[", "box", "]"}]}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"TubeGraphicsDirectives", "[", "M", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Flatten", "[", 
             RowBox[{"List", "[", 
              RowBox[{"OptionValue", "[", "\"\<PlotStyle\>\"", "]"}], "]"}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"MyTube", "[", 
             RowBox[{"M", ",", 
              RowBox[{"\"\<Radius\>\"", "\[Rule]", "r"}], ",", 
              RowBox[{"Mesh", "\[Rule]", 
               RowBox[{"OptionValue", "[", "Mesh", "]"}]}]}], "]"}]}], 
           "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"PlotOptions", "[", "M", "]"}]}]}], "\[IndentingNewLine]", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<PlotStyle\>\"", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<BoundingBox\>\"", "\[Rule]", "False"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<BoundingBoxStyle\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Opacity", "[", "0.", "]"}], ",", 
          RowBox[{"EdgeForm", "[", "]"}], ",", 
          RowBox[{"FaceForm", "[", "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Radius\>\"", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Mesh", "\[Rule]", "32"}]}], "\[IndentingNewLine]", "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.666780521136982*^9, 3.666780576752722*^9}, {
   3.666780734974386*^9, 3.6667807799505033`*^9}, {3.666782106756588*^9, 
   3.666782225820772*^9}, {3.6731260022358093`*^9, 3.673126009468836*^9}, {
   3.673350082810014*^9, 3.673350096248966*^9}, {3.6786104330953197`*^9, 
   3.678610433756406*^9}, {3.6836335561477127`*^9, 3.6836335602086687`*^9}, 
   3.6836348264253798`*^9, {3.683704658528119*^9, 3.683704662021634*^9}, {
   3.683704755397868*^9, 3.683704785823628*^9}, {3.683711740703253*^9, 
   3.683711742573628*^9}, {3.6928763353636293`*^9, 3.692876406824648*^9}, {
   3.778169495055385*^9, 3.778169496719482*^9}, {3.7781698251622334`*^9, 
   3.77816982564697*^9}},ExpressionUUID->"4ea6e180-efb4-4445-9f28-\
04aabc091fbe"],

Cell[BoxData[
 RowBox[{"SortQuads2D", "=", 
  RowBox[{"CPackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"x", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Evaluate", "[", 
     RowBox[{"ReleaseHold", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Hold", "[", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"x", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], " ", 
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "+", 
            RowBox[{
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "+", 
            RowBox[{
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
            RowBox[{
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
            RowBox[{
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}]}], "+", 
            RowBox[{
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ">", 
           "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"cases", " ", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "4", ",", "2", ",", "3"}], "}"}]}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"x", "\[LeftDoubleBracket]", 
                 RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], " ", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
              RowBox[{
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
              RowBox[{
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ">", 
             "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"cases", " ", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "4", ",", "2", ",", "3"}], "}"}]}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"x", "\[LeftDoubleBracket]", 
                   RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], " ", 
                 
                 RowBox[{"x", "\[LeftDoubleBracket]", 
                  RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "+", 
                RowBox[{
                 RowBox[{"x", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
                 RowBox[{"x", "\[LeftDoubleBracket]", 
                  RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "+", 
                RowBox[{
                 RowBox[{"x", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
                 RowBox[{"x", "\[LeftDoubleBracket]", 
                  RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
                RowBox[{
                 RowBox[{"x", "\[LeftDoubleBracket]", 
                  RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
                 RowBox[{"x", "\[LeftDoubleBracket]", 
                  RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
                RowBox[{
                 RowBox[{"x", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
                 RowBox[{"x", "\[LeftDoubleBracket]", 
                  RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}]}], "+", 
                RowBox[{
                 RowBox[{"x", "\[LeftDoubleBracket]", 
                  RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
                 RowBox[{"x", "\[LeftDoubleBracket]", 
                  RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ">",
                "0"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "x", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}],
                "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "x", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}],
                "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{" ", 
              RowBox[{"cases", " ", 
               RowBox[{"{", 
                RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "}"}]}], "}"}], 
             " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
             "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"(*", "Else", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"cases", " ", 
             RowBox[{"{", 
              RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "4", ",", "3", ",", "2"}], "}"}]}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"x", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], " ", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
              RowBox[{
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
              RowBox[{
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ">", 
             "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"cases", " ", 
              RowBox[{"{", 
               RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "}"}]}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"cases", " ", 
               RowBox[{"{", 
                RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "4", ",", "3", ",", "2"}], "}"}]}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"x", "\[LeftDoubleBracket]", 
                   RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], " ", 
                 
                 RowBox[{"x", "\[LeftDoubleBracket]", 
                  RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], "+", 
                RowBox[{
                 RowBox[{"x", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
                 RowBox[{"x", "\[LeftDoubleBracket]", 
                  RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}]}], "+", 
                RowBox[{
                 RowBox[{"x", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
                 RowBox[{"x", "\[LeftDoubleBracket]", 
                  RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
                RowBox[{
                 RowBox[{"x", "\[LeftDoubleBracket]", 
                  RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
                 RowBox[{"x", "\[LeftDoubleBracket]", 
                  RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}]}], "-", 
                RowBox[{
                 RowBox[{"x", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
                 RowBox[{"x", "\[LeftDoubleBracket]", 
                  RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}]}], "+", 
                RowBox[{
                 RowBox[{"x", "\[LeftDoubleBracket]", 
                  RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], " ", 
                 RowBox[{"x", "\[LeftDoubleBracket]", 
                  RowBox[{"4", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ">",
                "0"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "x", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
                "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                ",", 
                RowBox[{
                "x", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
                "}"}]}], "\[IndentingNewLine]", "]"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
        "\[IndentingNewLine]", "]"}], "/.", 
       RowBox[{"Part", "\[Rule]", "Compile`GetElement"}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"RuntimeAttributes", "\[Rule]", 
     RowBox[{"{", "Listable", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"RuntimeOptions", "\[Rule]", "\"\<Speed\>\""}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.70559271524531*^9, 3.705592719483027*^9}, {
   3.7055927925578814`*^9, 3.705592811829339*^9}, {3.7055929039263144`*^9, 
   3.705592930386389*^9}, 3.705592968492196*^9, 3.7055930107770567`*^9, {
   3.705593058164681*^9, 3.705593077763006*^9}, {3.705593108468955*^9, 
   3.7055931415542383`*^9}, {3.7201016718070507`*^9, 3.720101672070511*^9}, {
   3.730195673974703*^9, 3.730195719373659*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"e46f2cef-40fd-4aff-bd44-294a3dccc8aa"],

Cell[BoxData[
 RowBox[{"PlanarPlot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M_polygon", ",", 
      RowBox[{"n_:", 
       RowBox[{"{", 
        RowBox[{"0.", ",", "0.", ",", "1."}], "}"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "A", ",", "\[Epsilon]", ",", "\[Delta]", ",", "zdata", ",", 
        "ezbuffer1", ",", "ezbuffer2", ",", "edata", ",", "tdata", ",", "e1", 
        ",", "e2", ",", "pn", ",", "en", ",", "polys1", ",", "polys2", ",", 
        "ordering", ",", "plotdata", ",", "\[Theta]1", ",", "\[Theta]2"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", "=", 
        RowBox[{
         RowBox[{"getframe", "[", "n", "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;", "3"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Epsilon]", "=", "0.001"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Delta]", "=", "0.000"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Theta]2", "=", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<Thickness\>\"", "]"}], 
         RowBox[{"BoundingBoxLength", "[", "M", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Theta]1", "=", 
        RowBox[{"\[Theta]2", " ", 
         RowBox[{"OptionValue", "[", "\"\<WhiteSpace\>\"", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"zdata", "=", 
        RowBox[{
         RowBox[{"EdgeData", "[", "M", "]"}], ".", "n"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ezbuffer1", "=", 
        RowBox[{
         RowBox[{"Min", "@@@", "zdata"}], "-", "\[Delta]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ezbuffer2", "=", 
        RowBox[{
         RowBox[{"Max", "@@@", "zdata"}], "+", "\[Delta]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"edata", "=", 
        RowBox[{
         RowBox[{"EdgeData", "[", "M", "]"}], ".", 
         RowBox[{"A", "\[Transpose]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tdata", "=", 
        RowBox[{
         RowBox[{"CurvatureTripleData", "[", "M", "]"}], ".", 
         RowBox[{"A", "\[Transpose]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"e1", "=", 
        RowBox[{
         RowBox[{"cNormalize3", "[", 
          RowBox[{
           RowBox[{"tdata", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
           RowBox[{"tdata", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], 
         ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.", ",", 
             RowBox[{"-", "1."}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1.", ",", "0."}], "}"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"e2", "=", 
        RowBox[{
         RowBox[{"cNormalize3", "[", 
          RowBox[{
           RowBox[{"tdata", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], "-", 
           RowBox[{"tdata", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}], 
         ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.", ",", 
             RowBox[{"-", "1."}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1.", ",", "0."}], "}"}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pn", "=", 
        RowBox[{"cNormalize3", "[", 
         RowBox[{"e1", "+", "e2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"en", "=", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"pn", "\[LeftDoubleBracket]", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Edges", "[", "M", "]"}], "]"}], 
           "\[RightDoubleBracket]"}], ",", "2"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"polys1", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"x", "\[Function]", 
           RowBox[{"{", 
            RowBox[{"White", ",", 
             RowBox[{"EdgeForm", "[", 
              RowBox[{"{", 
               RowBox[{"White", ",", 
                RowBox[{"Thickness", "[", "\[Epsilon]", "]"}]}], "}"}], "]"}],
              ",", 
             RowBox[{"Polygon", "[", "x", "]"}]}], "}"}]}], ",", 
          RowBox[{"SortQuads2D", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"edata", "+", 
              RowBox[{"\[Theta]1", " ", "en"}]}], ",", 
             RowBox[{"Reverse", "/@", 
              RowBox[{"(", 
               RowBox[{"edata", "-", 
                RowBox[{"\[Theta]1", " ", "en"}]}], ")"}]}], ",", "2"}], 
            "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"polys2", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"x", "\[Function]", 
           RowBox[{"{", 
            RowBox[{"Black", ",", 
             RowBox[{"EdgeForm", "[", 
              RowBox[{"{", 
               RowBox[{"Black", ",", 
                RowBox[{"Thickness", "[", "\[Epsilon]", "]"}]}], "}"}], "]"}],
              ",", 
             RowBox[{"Polygon", "[", "x", "]"}]}], "}"}]}], ",", 
          RowBox[{"SortQuads2D", "[", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"edata", "+", 
              RowBox[{"\[Theta]2", " ", "en"}]}], ",", 
             RowBox[{"Reverse", "/@", 
              RowBox[{"(", 
               RowBox[{"edata", "-", 
                RowBox[{"\[Theta]2", " ", "en"}]}], ")"}]}], ",", "2"}], 
            "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ordering", "=", 
        RowBox[{"Ordering", "[", 
         RowBox[{"Join", "[", 
          RowBox[{"ezbuffer1", ",", "ezbuffer2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"plotdata", "=", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{"polys1", ",", "polys2"}], "]"}], "\[LeftDoubleBracket]", 
         "ordering", "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"Graphics", "[", "plotdata", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<WhiteSpace\>\"", "\[Rule]", "3."}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Thickness\>\"", "\[Rule]", "0.005"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.7055946106867933`*^9, {3.705594676034671*^9, 3.7055946960557337`*^9}, {
   3.7055948792957277`*^9, 3.705594888005652*^9}, 3.720101648967979*^9, {
   3.778169501712578*^9, 
   3.778169504575562*^9}},ExpressionUUID->"f370765f-8012-4ef9-97e5-\
a848a383dabb"],

Cell[BoxData[
 RowBox[{"TubePlot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_polygon", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "r", ",", "coords", ",", "box", ",", "minmax", ",", "\[Rho]", ",", 
        "\[Lambda]", ",", "opts"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Lambda]", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumericQ", "[", 
           RowBox[{"OptionValue", "[", "\"\<Scale\>\"", "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"OptionValue", "[", "\"\<Scale\>\"", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"BoundingBoxLength", "[", "M", "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"getAbsoluteSize", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<Thickness\>\"", "]"}], ",", 
          "\[Lambda]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"r", "===", "Automatic"}], ",", 
         RowBox[{"r", "=", 
          RowBox[{"MeshThickness", "[", "M", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"coords", "=", 
        RowBox[{"StrataVertexCoordinates", "[", "M", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"minmax", "=", 
        RowBox[{"MinMax", "/@", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Join", "@@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"coords", ",", "1"}], "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Rho]", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Differences", "[", 
          RowBox[{"Transpose", "[", "minmax", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"box", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"minmax", "+", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.01"}], ",", "0.01"}], "}"}], "\[Rho]"}], ",", 
            "3"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"\[Delta]", "=", 
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "r", "]"}], "===", "Scaled"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "r", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "1.5", 
             RowBox[{"Norm", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "box", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                 "-", 
                RowBox[{
                "box", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], ",", "2"}], "]"}]}], ",", 
            "\[IndentingNewLine]", "r"}], "\[IndentingNewLine]", "]"}]}], 
         ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"opts", "=", 
        RowBox[{"OptionValue", "[", "\"\<PlotStyle\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"opts", "===", "Automatic"}], ",", "\[IndentingNewLine]", 
         RowBox[{"opts", "=", 
          RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics3D", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"TubeGraphicsDirectives", "[", "M", "]"}], ",", 
            "\[IndentingNewLine]", "opts", ",", "\[IndentingNewLine]", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Tube", "[", 
                RowBox[{"#", ",", "r"}], "]"}], "&"}], ",", "coords", ",", 
              RowBox[{"{", "2", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
           "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "box", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "-", 
              RowBox[{"1.01", "r"}]}], ",", 
             RowBox[{
              RowBox[{
              "box", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "+", 
              RowBox[{"1.01", "r"}]}]}], "}"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"PlotOptions", "[", "M", "]"}]}]}], "\[IndentingNewLine]", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<PlotStyle\>\"", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<Thickness\>\"", "\[Rule]", 
        RowBox[{"Scaled", "[", "0.0075", "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"\"\<Scale\>\"", "\[Rule]", "Automatic"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.720101608622246*^9, {3.734615068740677*^9, 3.734615089617219*^9}, 
   3.737462357280456*^9, {3.737462438663312*^9, 3.7374624452680264`*^9}, {
   3.743839668525399*^9, 3.743839681946971*^9}, {3.7438403923556232`*^9, 
   3.74384039775739*^9}, {3.743840479188422*^9, 3.743840499465971*^9}, {
   3.7438422738765383`*^9, 3.743842275108861*^9}, {3.743842786580838*^9, 
   3.743842788776655*^9}, {3.743843265474889*^9, 3.743843269021413*^9}, {
   3.747641462289123*^9, 3.747641482357526*^9}, {3.778169508975667*^9, 
   3.778169511470624*^9}, {3.778169843360139*^9, 3.778169843807432*^9}, {
   3.7907677591468*^9, 3.790767781761099*^9}, {3.793771703644202*^9, 
   3.793771775952819*^9}, {3.7937718474695463`*^9, 3.793771894246353*^9}, {
   3.793805237327435*^9, 3.793805239014041*^9}, {3.795370106294142*^9, 
   3.795370108949177*^9}, {3.842674811187183*^9, 3.842674879224647*^9}, {
   3.842675353539019*^9, 3.842675362711974*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"60f46d02-4c2f-4b20-be8d-4d10ce55e8a4"],

Cell[BoxData[
 RowBox[{"TubePlot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M_meshlist", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"MeshType", "[", "M", "]"}], "===", "polygon"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"MeshPlot", "[", 
       RowBox[{"M", ",", 
        RowBox[{"Method", "\[Rule]", "TubePlot"}], ",", "opts"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"MeshPlot", "[", 
       RowBox[{"M", ",", "opts"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUUID->"79e4cac2-4373-\
4465-85b5-ec24906d0d7a"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.797170167769372*^9, 
  3.797170168363488*^9}},ExpressionUUID->"933438f5-1a08-48f1-bd33-\
3047daa66546"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"NormalizedPolygon", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M0_polygon", ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pts", ",", "box", ",", "frame", ",", "center", ",", "M"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"M", "\[LeftArrow]", "M0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"pts", "=", 
         RowBox[{"VertexCoordinates", "[", "M", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"box", "=", 
         RowBox[{"BoundingRegion", "[", 
          RowBox[{"pts", ",", "\"\<MinOrientedCuboid\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"frame", "=", 
         RowBox[{"Normalize", "/@", 
          RowBox[{"ReverseSortBy", "[", 
           RowBox[{
            RowBox[{
            "box", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            ",", "Norm"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"frame", "\[LeftDoubleBracket]", 
          RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "*=", 
         RowBox[{"Sign", "[", 
          RowBox[{"Det", "[", "frame", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"center", "=", 
         RowBox[{
          RowBox[{
          "box", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
          
          RowBox[{
           RowBox[{"1", "/", "2"}], 
           RowBox[{"Total", "[", 
            RowBox[{
            "box", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"SetVertexCoordinates", "[", 
         RowBox[{"M", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"pts", "-", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"center", ",", 
               RowBox[{"Length", "[", "pts", "]"}]}], "]"}]}], ")"}], ".", 
           RowBox[{"Transpose", "[", "frame", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "M"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.797169494117365*^9, 3.797169562395133*^9}, {
   3.797169614316029*^9, 3.7971696230884247`*^9}, {3.797169808141705*^9, 
   3.797169827815741*^9}, {3.797169933350816*^9, 3.79716994927785*^9}, {
   3.797170028129589*^9, 3.797170083239933*^9}, 3.797170630092506*^9, {
   3.79717250923841*^9, 3.797172520788001*^9}, 
   3.7995005903777647`*^9},ExpressionUUID->"cadbe800-adeb-41d5-8f27-\
1b6b149e9641"],

Cell[BoxData[
 RowBox[{"NormalizedPolygon", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M0_polygon", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "M", ",", "pts", ",", "cpts", ",", "\[Lambda]", ",", "U", ",", 
        "newpts", ",", "L"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"M", "\[LeftArrow]", "M0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"L", "=", 
        RowBox[{"OptionValue", "[", "\"\<CurveLength\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"NumberQ", "[", "L", "]"}]}], ",", 
         RowBox[{"L", "=", 
          RowBox[{"CurveLength", "[", "M", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"SetVertexCoordinates", "[", 
          RowBox[{"M", ",", 
           RowBox[{
            RowBox[{"VertexCoordinates", "[", "M", "]"}], "/", 
            RowBox[{"CurveLength", "[", "M", "]"}]}]}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"pts", "=", 
        RowBox[{"VertexCoordinates", "[", "M", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cpts", "=", 
        RowBox[{
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{"pts", "-", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"DualEdgeLengths", "[", "M", "]"}], ".", "pts"}], 
               ")"}], "/", 
              RowBox[{"CurveLength", "[", "M", "]"}]}], ",", 
             RowBox[{"VertexCount", "[", "M", "]"}]}], "]"}]}], 
          "\[IndentingNewLine]", ")"}], 
         RowBox[{"(", 
          RowBox[{"L", "/", 
           RowBox[{"CurveLength", "[", "M", "]"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Lambda]", ",", "U"}], "}"}], "=", 
        RowBox[{"Eigensystem", "[", 
         RowBox[{
          RowBox[{"DualEdgeLengths", "[", "M", "]"}], ".", 
          RowBox[{"KroneckerSquareThread", "[", "cpts", "]"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"U", "\[LeftDoubleBracket]", 
         RowBox[{"-", "1"}], "\[RightDoubleBracket]"}], "*=", 
        RowBox[{"Sign", "[", 
         RowBox[{"Det", "[", "U", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"newpts", "=", 
        RowBox[{"cpts", ".", 
         RowBox[{"Transpose", "[", "U", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"newpts", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{
             RowBox[{"Ordering", "[", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"newpts", "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], "]"}], 
               ",", 
               RowBox[{"-", "1"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], ",", "3"}], "\[RightDoubleBracket]"}],
           "<", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"newpts", "=", 
          RowBox[{"newpts", ".", 
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"Pi", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"newpts", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{
             RowBox[{"Ordering", "[", 
              RowBox[{
               RowBox[{"cNorm", "[", 
                RowBox[{"newpts", "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", 
                  RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}], 
                "]"}], ",", 
               RowBox[{"-", "1"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], ",", "1"}], "\[RightDoubleBracket]"}],
           "<", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"newpts", "=", 
          RowBox[{"newpts", ".", 
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"Pi", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"SetVertexCoordinates", "[", 
        RowBox[{"M", ",", "newpts"}], "]"}], ";", "\[IndentingNewLine]", 
       "M"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Options\>\"", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"\"\<CurveLength\>\"", "\[Rule]", "Automatic"}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.799500602608397*^9, {3.7995006416611767`*^9, 3.7995006614200983`*^9}, {
   3.799500697290243*^9, 3.7995007068421383`*^9}, 3.799507943475011*^9, {
   3.799994873241735*^9, 3.799994989438931*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"f0600949-c5a6-424a-83d3-d4ef6278d816"]
},
WindowSize->{1440, 855},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 413, 10, 92, "Input",ExpressionUUID->"2f33fd3f-edca-435e-a61e-c397a3bf46fe"],
Cell[974, 32, 402, 8, 92, "Input",ExpressionUUID->"8b69382d-2c01-41c1-a4a0-87eccf21cb27"],
Cell[1379, 42, 1012, 18, 117, "Input",ExpressionUUID->"3d765fc4-40c3-476d-a852-ab093c7a4d44"],
Cell[2394, 62, 1235, 20, 92, "Input",ExpressionUUID->"f135c4ad-720a-4486-9fce-af5521fe39bc"],
Cell[3632, 84, 821, 19, 167, "Input",ExpressionUUID->"f542e05f-18aa-4897-b465-a436bd7e213e"],
Cell[4456, 105, 555, 11, 92, "Input",ExpressionUUID->"0c38c8ac-88fe-4e22-bb0c-0dd2c282c775"],
Cell[5014, 118, 1742, 41, 242, "Input",ExpressionUUID->"bafe3360-5d5b-4605-99cd-550945825652"],
Cell[6759, 161, 1883, 40, 367, "Input",ExpressionUUID->"980279d9-7809-4cac-a345-d5938ef0a1f7"],
Cell[8645, 203, 7821, 145, 992, "Input",ExpressionUUID->"e04964cf-7a4a-41cd-af6a-5535271780f2"],
Cell[16469, 350, 4376, 97, 667, "Input",ExpressionUUID->"4ea6e180-efb4-4445-9f28-04aabc091fbe"],
Cell[20848, 449, 16364, 344, 842, "Input",ExpressionUUID->"e46f2cef-40fd-4aff-bd44-294a3dccc8aa"],
Cell[37215, 795, 6993, 173, 817, "Input",ExpressionUUID->"f370765f-8012-4ef9-97e5-a848a383dabb"],
Cell[44211, 970, 6379, 146, 917, "Input",ExpressionUUID->"60f46d02-4c2f-4b20-be8d-4d10ce55e8a4"],
Cell[50593, 1118, 787, 21, 167, "Input",ExpressionUUID->"79e4cac2-4373-4465-85b5-ec24906d0d7a"],
Cell[51383, 1141, 232, 5, 117, "Input",ExpressionUUID->"933438f5-1a08-48f1-bd33-3047daa66546"],
Cell[51618, 1148, 2609, 60, 317, "Input",ExpressionUUID->"cadbe800-adeb-41d5-8f27-1b6b149e9641"],
Cell[54230, 1210, 5257, 125, 667, "Input",ExpressionUUID->"f0600949-c5a6-424a-83d3-d4ef6278d816"]
}
]
*)

