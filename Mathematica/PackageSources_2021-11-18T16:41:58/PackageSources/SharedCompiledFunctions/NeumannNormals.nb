Notebook[
 {Cell[BoxData[RowBox[{"Quiet", "[", RowBox[{"Module", "[", 
        RowBox[{RowBox[{"{", RowBox[{"PP", ",", "P", ",", "XX", ",", "X", 
              ",", "h", ",", "heightvector", ",", "t", ",", "e", ",", 
              RowBox[{"d", "=", "3"}]}], "}"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", RowBox[{RowBox[{"PP", "=", RowBox[{"Table", 
                "[", RowBox[{RowBox[{"P", "\[LeftDoubleBracket]", RowBox[
                     {"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"{", RowBox[{"i", ",", "1", ",", "3"}], "}"}], ",", 
                  RowBox[{"{", RowBox[{"j", ",", "1", ",", "d"}], "}"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"XX", "=", RowBox[{"Table", "[", RowBox[
                 {RowBox[{"X", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", RowBox[{"{", RowBox[
                     {"i", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", RowBox[{"h", "=", RowBox[{"(", 
                RowBox[{RowBox[{"PP", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "-", " ", RowBox[
                   {RowBox[{"(", RowBox[{"1", "-", "t"}], ")"}], RowBox[
                     {"PP", "\[LeftDoubleBracket]", "1", 
                      "\[RightDoubleBracket]"}]}], "-", RowBox[{"t", " ", 
                    RowBox[{"PP", "\[LeftDoubleBracket]", "2", 
                      "\[RightDoubleBracket]"}]}]}], ")"}]}], ";", 
            "\[IndentingNewLine]", RowBox[{"e", "=", RowBox[{RowBox[
                 {"PP", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "-", RowBox[{"PP", 
                  "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
            ";", "\[IndentingNewLine]", RowBox[{"heightvector", "=", 
              RowBox[{"Together", "[", RowBox[{"h", "/.", RowBox[
                   {RowBox[{"Solve", "[", RowBox[{RowBox[{RowBox[{"h", ".", 
                          "e"}], "\[Equal]", "0"}], ",", "t"}], "]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{"code", "=", 
                    RowBox[{RowBox[{"-", "heightvector"}], "/", RowBox[
                       {"Sqrt", "[", RowBox[{"heightvector", ".", 
                          "heightvector"}], "]"}]}]}], "}"}], ",", 
                "\[IndentingNewLine]", RowBox[{"CompileJet", "[", 
                  RowBox[{"\"NeumannNormals2D3D\"", ",", RowBox[{"{", 
                      RowBox[{"{", RowBox[{"P", ",", "_Real", ",", "2"}], 
                        "}"}], "}"}], ",", "code", ",", "PP", ",", 
                    RowBox[{"\"Derivatives\"", "\[Rule]", "2"}]}], "]"}]}], 
              "\[IndentingNewLine]", "]"}]}]}], "]"}], "\[IndentingNewLine]", 
      "]"}]], "Input", CellChangeTimes -> 
    {{3.6847470580988607*^9, 3.6847470607718687*^9}, 
     {3.684747092410317*^9, 3.6847471313728857*^9}, 
     {3.68474724938196*^9, 3.6847473210509157*^9}, 3.684748317856072*^9, 
     {3.684748420415378*^9, 3.684748420879355*^9}, 3.684748730192322*^9, 
     {3.686303101607626*^9, 3.6863031034285183*^9}, 3.688977074678898*^9, 
     {3.689074607409156*^9, 3.689074608353443*^9}, {3.689421329149662*^9, 
      3.689421331229865*^9}}], Cell[BoxData[""], "Input", 
   CellChangeTimes -> {{3.689421325458231*^9, 3.68942133367688*^9}}], 
  Cell[BoxData[RowBox[{"Quiet", "[", RowBox[{"Module", "[", 
        RowBox[{RowBox[{"{", RowBox[{"PP", ",", "P", ",", "h", ",", 
              "heightvector", ",", "t1", ",", "t2", ",", "e1", ",", "e2", 
              ",", RowBox[{"d", "=", "3"}]}], "}"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{RowBox[{"PP", "=", RowBox[{"Table", "[", RowBox[
                 {RowBox[{"P", "\[LeftDoubleBracket]", RowBox[{"i", ",", 
                      "j"}], "\[RightDoubleBracket]"}], ",", RowBox[
                   {"{", RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
                  RowBox[{"{", RowBox[{"j", ",", "1", ",", "d"}], "}"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"e1", "=", RowBox[{RowBox[{"PP", "\[LeftDoubleBracket]", 
                  "2", "\[RightDoubleBracket]"}], "-", RowBox[{"PP", 
                  "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
            ";", "\[IndentingNewLine]", RowBox[{"e2", "=", 
              RowBox[{RowBox[{"PP", "\[LeftDoubleBracket]", "3", 
                  "\[RightDoubleBracket]"}], "-", RowBox[{"PP", 
                  "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
            ";", "\[IndentingNewLine]", RowBox[{"h", "=", 
              RowBox[{RowBox[{"PP", "\[LeftDoubleBracket]", "4", 
                  "\[RightDoubleBracket]"}], "-", RowBox[{"PP", 
                  "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "+", RowBox[{"t1", " ", "e1"}], "+", RowBox[{"t2", " ", 
                  "e2"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"heightvector", "=", RowBox[{"Together", "[", 
                RowBox[{"h", "/.", RowBox[{RowBox[{"Solve", "[", RowBox[
                       {RowBox[{"{", RowBox[{RowBox[{RowBox[{"h", ".", 
                          "e1"}], "\[Equal]", "0"}], ",", RowBox[{RowBox[
                          {"h", ".", "e2"}], "\[Equal]", "0"}]}], "}"}], ",", 
                        RowBox[{"{", RowBox[{"t1", ",", "t2"}], "}"}]}], 
                      "]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"With", "[", RowBox[{RowBox[{"{", RowBox[{"code", "=", 
                    RowBox[{RowBox[{"-", "heightvector"}], "/", RowBox[
                       {"Sqrt", "[", RowBox[{"heightvector", ".", 
                          "heightvector"}], "]"}]}]}], "}"}], ",", 
                "\[IndentingNewLine]", RowBox[{"CompileJet", "[", 
                  RowBox[{"\"NeumannNormals3D3D\"", ",", RowBox[{"{", 
                      RowBox[{"{", RowBox[{"P", ",", "_Real", ",", "2"}], 
                        "}"}], "}"}], ",", "code", ",", "PP", ",", 
                    "\[IndentingNewLine]", RowBox[{"\"Derivatives\"", 
                      "\[Rule]", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
              "]"}]}]}], "]"}], "\[IndentingNewLine]", "]"}]], "Input", 
   CellChangeTimes -> {{3.6847470580988607*^9, 3.6847470607718687*^9}, 
     {3.684747092410317*^9, 3.6847471313728857*^9}, 
     {3.68474724938196*^9, 3.6847473210509157*^9}, 3.684748317856072*^9, 
     {3.684748420415378*^9, 3.684748420879355*^9}, 3.684748730192322*^9, 
     {3.686303101607626*^9, 3.6863031034285183*^9}, 3.686303159420422*^9, 
     {3.686303236042953*^9, 3.686303240315811*^9}, {3.686303403959105*^9, 
      3.686303428954348*^9}, 3.686303497789311*^9, {3.68907526530781*^9, 
      3.689075266530686*^9}}]}, WindowSize -> {1117, 851}, 
 WindowMargins -> {{Automatic, 2}, {Automatic, 4}}, 
 FrontEndVersion -> 
  "11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 28, 2016)", 
 StyleDefinitions -> "Default.nb"]
