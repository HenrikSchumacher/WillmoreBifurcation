(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     58429,       1212]
NotebookOptionsPosition[     57561,       1193]
NotebookOutlinePosition[     57897,       1208]
CellTagsIndexPosition[     57854,       1205]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ImplicitGradientResidual", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Q_", ",", "\[Lambda]_", ",", "M_", ",", "\[Tau]_"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{"Max", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Energy", "'"}], "[", "Q", "]"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "\[Tau]"}], ")"}], 
             RowBox[{"\[Lambda]", ".", 
              RowBox[{
               RowBox[{"Constraint", "'"}], "[", "Q", "]"}]}]}]}], "]"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"b", "=", 
         RowBox[{"Max", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{"ConstraintViolation", "[", "Q", "]"}], "]"}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"$S", "[", "\"\<Bla\>\"", "]"}], "=", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Max", "[", 
       RowBox[{"a", ",", "b"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{
  3.775662186826009*^9, {3.775899004012912*^9, 3.775899046042948*^9}, 
   3.775899200627797*^9, 3.775899522148182*^9, {3.784135676929452*^9, 
   3.784135678720777*^9}, {3.784136205366165*^9, 3.784136238454485*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"7b9667a1-6437-412e-84f9-0e7b958bad69"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ImplicitGradientStepRHS", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Q_", ",", "\[Lambda]_", ",", "M_", ",", "\[Tau]_"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Metric", "[", 
         RowBox[{"M", ",", 
          RowBox[{
           RowBox[{"VertexCoordinates", "[", "Q", "]"}], "-", 
           RowBox[{"VertexCoordinates", "[", "M", "]"}]}]}], "]"}], "+", 
        RowBox[{"\[Tau]", " ", 
         RowBox[{
          RowBox[{"Energy", "'"}], "[", "Q", "]"}]}], "+", 
        RowBox[{"\[Lambda]", ".", 
         RowBox[{
          RowBox[{"Constraint", "'"}], "[", "Q", "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ConstraintViolation", "[", "Q", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.775656391722351*^9, 3.775656428016424*^9}, {
   3.775656458754651*^9, 3.775656513928547*^9}, {3.7756565440026407`*^9, 
   3.7756566042898617`*^9}, {3.775656918356152*^9, 3.775656929272892*^9}, {
   3.775657940883304*^9, 3.775657953850958*^9}, {3.775658626496591*^9, 
   3.775658628191321*^9}, {3.775658917710125*^9, 3.775658931187992*^9}, {
   3.7756589643070717`*^9, 3.775658979847904*^9}, {3.7756619494123774`*^9, 
   3.775661971389228*^9}, 3.775662187011014*^9, {3.7758558373294353`*^9, 
   3.775855844795505*^9}, 3.7758560309595346`*^9, {3.775863412784465*^9, 
   3.7758634226295557`*^9}, {3.775899309121539*^9, 3.775899309586336*^9}, {
   3.784135646106254*^9, 3.784135650033387*^9}, 3.784136240350337*^9, {
   3.785225917428338*^9, 3.785225922883027*^9}, 3.797401036269115*^9},
 CellLabel->
  "In[104]:=",ExpressionUUID->"eb5ba536-2dbe-4a74-8194-8bcddca0092f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ImplicitGradientSystemMatrix", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Q_", ",", "\[Lambda]_", ",", "M_", ",", "\[Tau]_"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"TrueQ", "[", 
        RowBox[{"OptionValue", "[", "\"\<SparseQ\>\"", "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"B", "=", 
           RowBox[{"Sparsify", "[", 
            RowBox[{
             RowBox[{"Constraint", "'"}], "[", "Q", "]"}], "]"}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"ArrayFlatten", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Sparsify", "[", 
                RowBox[{"VectorMetric", "[", "M", "]"}], "]"}], "+", " ", 
               RowBox[{"\[Tau]", " ", 
                RowBox[{"Sparsify", "[", 
                 RowBox[{
                  RowBox[{"Energy", "''"}], "[", "Q", "]"}], "]"}]}], "+", 
               RowBox[{"Sparsify", "[", 
                RowBox[{
                 RowBox[{"Constraint", "''"}], "[", 
                 RowBox[{"Q", ",", 
                  RowBox[{"{", "\[Lambda]", "}"}], ",", 
                  RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ",", " ", 
              RowBox[{"B", "\[Transpose]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"B", ",", "0."}], "}"}]}], "\[IndentingNewLine]", "}"}], 
          "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"B", "=", 
           RowBox[{"Normal", "[", 
            RowBox[{
             RowBox[{"Constraint", "'"}], "[", "Q", "]"}], "]"}]}], "}"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"ArrayFlatten", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Normal", "[", 
                RowBox[{"VectorMetric", "[", "M", "]"}], "]"}], "+", " ", 
               RowBox[{"\[Tau]", " ", 
                RowBox[{"Normal", "[", 
                 RowBox[{
                  RowBox[{"Energy", "''"}], "[", "Q", "]"}], "]"}]}], "+", 
               RowBox[{"Normal", "[", 
                RowBox[{
                 RowBox[{"Constraint", "''"}], "[", 
                 RowBox[{"Q", ",", 
                  RowBox[{"{", "\[Lambda]", "}"}], ",", 
                  RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ",", " ", 
              RowBox[{"B", "\[Transpose]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"B", ",", "0."}], "}"}]}], "\[IndentingNewLine]", "}"}], 
          "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Options", "\[Rule]", " ", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"\"\<SparseQ\>\"", "\[Rule]", "True"}], "\[IndentingNewLine]", 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.775821786142325*^9, 3.775821827444903*^9}, {
   3.77585584810417*^9, 3.7758558675355473`*^9}, {3.775856017001685*^9, 
   3.7758560277282352`*^9}, {3.775857016279339*^9, 3.7758570378361683`*^9}, {
   3.77586281704208*^9, 3.775862819124599*^9}, {3.7758634334467688`*^9, 
   3.7758634378458147`*^9}, {3.775864392362846*^9, 3.775864393490177*^9}, {
   3.775898483187233*^9, 3.775898483505981*^9}, {3.775898908480651*^9, 
   3.7758989206442757`*^9}, {3.784135624843062*^9, 3.7841356288420362`*^9}, 
   3.784136245660078*^9, {3.784136972931449*^9, 3.784136994632235*^9}, {
   3.784137249024906*^9, 3.784137250279685*^9}, 3.785221426702488*^9},
 CellLabel->
  "In[105]:=",ExpressionUUID->"9f6800d4-420d-42cd-8257-2c9b46cd7fb6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ImplicitGradientSystemMatrixSolverFunction", "=", 
   RowBox[{"SettingFunction", "[", 
    RowBox[{"M_", ",", "\[IndentingNewLine]", 
     RowBox[{"Q", "\[Function]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"S", "=", 
          RowBox[{"LinearSolve", "[", "Q", "]"}]}], "}"}], ",", 
        RowBox[{"u", "\[Function]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"$S", "[", "\"\<LinearSolves\>\"", "]"}], "=", 
            RowBox[{
             RowBox[{"$S", "[", "\"\<LinearSolves\>\"", "]"}], "+", "1"}]}], 
           ";", 
           RowBox[{"S", "[", "u", "]"}]}], ")"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.775823095651917*^9, 3.775823110946949*^9}, 
   3.784136248548976*^9, {3.785227823694725*^9, 3.785227889537801*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"66b09302-136a-4ef4-b291-571bfa0b9c10"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"ImplicitGradientSystemMatrix", "=", 
    RowBox[{"PackageFunction", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Q_genericmesh", ",", "\[Lambda]_", ",", "M_", ",", "\[Tau]_"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"ArrayFlatten", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1.", "/", "\[Tau]"}], ")"}], 
             RowBox[{"Normal", "[", 
              RowBox[{"VectorMetric", "[", "M", "]"}], "]"}]}], "+", 
            RowBox[{"Normal", "[", 
             RowBox[{
              RowBox[{"Energy", "''"}], "[", "Q", "]"}], "]"}], "+", 
            RowBox[{
             RowBox[{"Constraint", "''"}], "[", 
             RowBox[{"Q", ",", 
              RowBox[{"{", "\[Lambda]", "}"}], ",", 
              RowBox[{"{", "1", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Normal", "@", "Constraint"}], "'"}], "[", "Q", "]"}], 
            "\[Transpose]"}]}], "\[IndentingNewLine]", "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Normal", "@", "Constraint"}], "'"}], "[", "Q", "]"}], 
           ",", "0."}], "}"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.775656620105329*^9, 3.775656654911677*^9}, 
   3.775662187201199*^9, 3.775821839243349*^9},
 CellLabel->
  "In[111]:=",ExpressionUUID->"047482a0-f4dd-4f77-9239-9944d929c628"],

Cell[BoxData[
 RowBox[{"ImplicitGradientFlow", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", "M0_", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "me", ",", "M", ",", "FM", ",", "\[Mu]", ",", "d", ",", "n", ",", "Q", 
        ",", "Q\[Sigma]", ",", "\[Delta]Q", ",", "\[Lambda]", ",", 
        "\[Lambda]\[Sigma]", ",", "\[Delta]\[Lambda]", ",", "\[Tau]", ",", 
        "\[Sigma]", ",", "MList", ",", "b", ",", "S", ",", "sol", ",", "res", 
        ",", "resold", ",", "res0", ",", "\[IndentingNewLine]", "maxbiter", 
        ",", "maxouterbiter", ",", "maxiter", ",", "meshlistQ", ",", 
        "HessFun", ",", "maxniter", ",", "NewtonQ", ",", "LinSolve", ",", 
        "ContractionFactor", ",", "ExpansionFactor", ",", "nfactor", ",", 
        "tic", ",", "toc", ",", "cputic", ",", "cputoc", ",", "info", ",", 
        "maxwallclocktime", ",", "sparseQ", ",", "dotM", ",", "dot\[Mu]", ",",
         "StepTrunc", ",", "infokeys", ",", "StoppedQ", ",", "StopFun", ",", 
        "Profiler", ",", "profile"}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"me", "=", "ImplicitGradientFlow"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Profiler", "=", 
        RowBox[{"OptionValue", "[", "\"\<Profiler\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M", "\[LeftArrow]", "M0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"EmbeddingDimension", "[", "M", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"DofCount", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"infokeys", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"$InfoKeys", ",", 
          RowBox[{"{", "\"\<Log\>\"", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NewtonQ", "=", 
        RowBox[{"Switch", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<NonlinearSolver\>\"", "]"}], ",", 
          "\[IndentingNewLine]", "\"\<FrozenNewton\>\"", ",", "False", ",", 
          "\[IndentingNewLine]", "_", ",", "True"}], "\[IndentingNewLine]", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sparseQ", "=", 
        RowBox[{"TrueQ", "[", 
         RowBox[{"OptionValue", "[", "\"\<SparseQ\>\"", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Mu]", "=", 
        RowBox[{"OptionValue", "[", "\"\<LagrangeMultiplier\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"VectorQ", "[", "\[Mu]", "]"}], "]"}], ",", 
         RowBox[{"\[Mu]", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0.", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"Constraint", "[", "M", "]"}], "]"}]}], "]"}]}]}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"meshlistQ", "=", 
        RowBox[{"TrueQ", "[", 
         RowBox[{"OptionValue", "[", "\"\<CreateMeshList\>\"", "]"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"meshlistQ", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"$MeshList", "=", 
           RowBox[{"Init", "[", 
            RowBox[{"meshlist", ",", "M"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"$LagrangeMultiplierList", "=", 
           RowBox[{"Association", "[", 
            RowBox[{"0", "\[Rule]", "\[Mu]"}], "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"$MeshList", "=", "None"}], ";", "\[IndentingNewLine]", 
          RowBox[{"$LagrangeMultiplierList", "=", "None"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"maxwallclocktime", "=", 
        RowBox[{"OptionValue", "[", "\"\<MaxWallClockTime\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NumberQ", "[", "maxwallclocktime", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"maxiter", "=", "\[Infinity]"}], "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"maxwallclocktime", "=", "\[Infinity]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"maxiter", "=", 
           RowBox[{"OptionValue", "[", "\"\<MaxIterations\>\"", "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"maxniter", "=", 
        RowBox[{"OptionValue", "[", "\"\<MaxNewtonIterations\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"maxouterbiter", "=", 
        RowBox[{"OptionValue", "[", "\"\<MaxBacktracking\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"maxbiter", "=", 
        RowBox[{"OptionValue", "[", "\"\<MaxNewtonBacktracking\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"nfactor", " ", "=", 
        RowBox[{
        "OptionValue", "[", "\"\<NewtonSufficientDecreaseFactor\>\"", "]"}]}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"StepTrunc", "=", 
        RowBox[{"OptionValue", "[", "\"\<StepSizeTruncator\>\"", "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"StopFun", "=", 
        RowBox[{"OptionValue", "[", "\"\<StopFunction\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ContractionFactor", "=", 
        RowBox[{"OptionValue", "[", "\"\<ContractionFactor\>\"", "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"ExpansionFactor", "=", 
        RowBox[{"OptionValue", "[", "\"\<ExpansionFactor\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"LinSolve", "=", 
        RowBox[{
        "ImplicitGradientSystemMatrixSolverFunction", "[", "M0", "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Q", "\[LeftArrow]", "M"}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", "=", "\[Mu]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"dotM", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0.", ",", 
          RowBox[{"DofCount", "[", "M", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dot\[Mu]", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0.", ",", 
          RowBox[{"Length", "[", "\[Mu]", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tic", "=", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cputic", "=", 
        RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"profile", "=", 
        RowBox[{"Profiler", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"FM", "=", 
           RowBox[{"Energy", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"res", "=", 
           RowBox[{"ImplicitGradientResidual", "[", 
            RowBox[{"Q", ",", "\[Lambda]", ",", "M", ",", "\[Tau]"}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"StoppedQ", "=", 
           RowBox[{"StopFun", "[", "M", "]"}]}], ";"}], "\[IndentingNewLine]",
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cputoc", "=", 
        RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"toc", "=", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"PrintTemporary", "[", 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Stop\>\"", ",", 
          RowBox[{
           RowBox[{"$S", "[", "\"\<Continue\>\"", "]"}], "=", "False"}]}], 
         "]"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"$S", "=", 
        RowBox[{"Association", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<BigRedButton\>\"", "\[Rule]", 
           RowBox[{"Button", "[", 
            RowBox[{"\"\<Stop\>\"", ",", 
             RowBox[{
              RowBox[{"$S", "[", "\"\<Continue\>\"", "]"}], "=", "False"}]}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<Iteration\>\"", "\[Rule]", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<MaxIteration\>\"", "\[Rule]", "maxiter"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<WallClockTime\>\"", "\[Rule]", 
           RowBox[{"toc", "-", "tic"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<MaxWallClockTime\>\"", "\[Rule]", "maxwallclocktime"}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<Objective\>\"", "\[Rule]", "FM"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Residual\>\"", "\[Rule]", "res"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Time\>\"", "\[Rule]", 
           RowBox[{"toc", "-", "tic"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<OuterBacktracking\>\"", "\[Rule]", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<NewtonIteration\>\"", "\[Rule]", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<InnerBacktracking\>\"", "\[Rule]", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Factorizations\>\"", "\[Rule]", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<LinearSolves\>\"", "\[Rule]", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<StepResidual\>\"", "\[Rule]", "\[Infinity]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<StepTolerance\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<StepTolerance\>\"", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<StepSize\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<InitialStepSize\>\"", "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<Energy\>\"", "\[Rule]", 
           RowBox[{"EnergyList", "[", "M", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Constraints\>\"", "\[Rule]", 
           RowBox[{"ConstraintList", "[", "M", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Log\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<Method\>\"", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"me", ",", "\[IndentingNewLine]", 
             RowBox[{"Association", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"\"\<Metric\>\"", "\[Rule]", 
                RowBox[{"MetricList", "[", "M", "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<NonlinearSolver\>\"", "\[Rule]", 
                RowBox[{
                "OptionValue", "[", "\"\<NonlinearSolver\>\"", "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<ResidualFunction\>\"", "\[Rule]", "Automatic"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"\"\<Tolerance\>\"", "\[Rule]", 
                RowBox[{"OptionValue", "[", "\"\<Tolerance\>\"", "]"}]}], ",",
                "\[IndentingNewLine]", 
               RowBox[{"\"\<StepTolerance\>\"", "\[Rule]", 
                RowBox[{"OptionValue", "[", "\"\<StepTolerance\>\"", "]"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"\"\<InitialStepSize\>\"", "\[Rule]", 
                RowBox[{
                "OptionValue", "[", "\"\<InitialStepSize\>\"", "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"\"\<StepSizeTruncator\>\"", "\[Rule]", 
                RowBox[{
                "OptionValue", "[", "\"\<StepSizeTruncator\>\"", "]"}]}]}], 
              "\[IndentingNewLine]", "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Continue\>\"", "\[Rule]", "True"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<StuckQ\>\"", "\[Rule]", "False"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<StoppedByStopFunction\>\"", "\[Rule]", "StoppedQ"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"$InfoList", "=", 
        RowBox[{"Association", "[", 
         RowBox[{"0", "\[Rule]", 
          RowBox[{
          "$S", "\[LeftDoubleBracket]", "infokeys", 
           "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Gradient", "  ", "loop"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"While", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"And", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"$S", "[", "\"\<StoppedByStopFunction\>\"", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"$S", "[", "\"\<Residual\>\"", "]"}], ">", 
            RowBox[{"$S", "\[LeftDoubleBracket]", 
             RowBox[{"\"\<Method\>\"", ",", "2", ",", "\"\<Tolerance\>\""}], 
             "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"$S", "[", "\"\<Iteration\>\"", "]"}], "<", "maxiter"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"$S", "[", "\"\<WallClockTime\>\"", "]"}], "<", 
            "maxwallclocktime"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Not", "[", 
            RowBox[{
            "$S", "\[LeftDoubleBracket]", "\"\<StuckQ\>\"", 
             "\[RightDoubleBracket]"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"TrueQ", "[", 
            RowBox[{"$S", "[", "\"\<Continue\>\"", "]"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"++", 
           RowBox[{"$S", "[", "\"\<Iteration\>\"", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"$S", "[", "\"\<Log\>\"", "]"}], "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tic", "=", 
           RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"cputic", "=", 
           RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"profile", "=", 
           RowBox[{
           "Profiler", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Outer", " ", "backtracking", "  ", "loop"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"$S", "[", "\"\<OuterBacktracking\>\"", "]"}], "=", 
              "0"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"$S", "[", "\"\<Factorizations\>\"", "]"}], "=", "0"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"$S", "[", "\"\<LinearSolves\>\"", "]"}], "=", "0"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"Label", "[", "\"\<OuterBacktrackingLoop\>\"", "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"\[Tau]", "=", 
              RowBox[{"$S", "[", "\"\<StepSize\>\"", "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Use", " ", "velocities", " ", "from", " ", "last", " ", 
               "iteration", " ", "to", " ", "estimate", " ", "an", " ", 
               "initial", " ", "guess", " ", "for", " ", 
               RowBox[{"Newton", "'"}], "s", " ", "method"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"$S", "[", "\"\<Iteration\>\"", "]"}], ">", "2"}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Q", "=", 
                 RowBox[{"Displace", "[", 
                  RowBox[{"M", ",", 
                   RowBox[{"\[Tau]", " ", "dotM"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"\[Lambda]", "=", 
                 RowBox[{"\[Mu]", "+", 
                  RowBox[{"\[Tau]", " ", "dot\[Mu]"}]}]}], ";"}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{
                 "The", " ", "estimator", " ", "for", " ", "dot\[Mu]", " ", 
                  "is", " ", "only", " ", "meaningful", " ", "after", " ", 
                  "the", " ", "second", " ", "iteration", " ", "because", " ",
                   "the", " ", "estimate", " ", "of", " ", "\[Mu]", " ", "in",
                   " ", "the", " ", "0"}], "-", 
                 RowBox[{
                 "th", " ", "iteration", " ", "is", " ", "probably", " ", 
                  RowBox[{"wrong", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Q", "\[LeftArrow]", "M"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"\[Lambda]", "=", "\[Mu]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"resold", "=", "\[Infinity]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"b", "=", 
                RowBox[{"ImplicitGradientStepRHS", "[", 
                 RowBox[{"Q", ",", "\[Lambda]", ",", "M", ",", "\[Tau]"}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"res", "=", 
                RowBox[{
                 RowBox[{"$S", "[", "\"\<StepResidual\>\"", "]"}], "=", 
                 RowBox[{"Sqrt", "[", 
                  RowBox[{"b", ".", "b"}], "]"}]}]}], ";"}], "*)"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Refactor", " ", "system", " ", "matrix", " ", "after", " ", 
               "each", " ", "backtracking"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Not", "[", "NewtonQ", "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"S", "=", 
                 RowBox[{"Quiet", "@", 
                  RowBox[{"LinSolve", "[", 
                   RowBox[{"ImplicitGradientSystemMatrix", "[", 
                    RowBox[{
                    "Q", ",", "\[Lambda]", ",", "M", ",", "\[Tau]", ",", 
                    RowBox[{"\"\<SparseQ\>\"", "\[Rule]", "sparseQ"}]}], 
                    "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"$S", "[", "\"\<Factorizations\>\"", "]"}], "=", 
                 RowBox[{
                  RowBox[{"$S", "[", "\"\<Factorizations\>\"", "]"}], "+", 
                  "1"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"resold", "=", 
              RowBox[{"res", "=", "\[Infinity]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Newton", "  ", "loop"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"$S", "[", "\"\<NewtonIteration\>\"", "]"}], "=", "0"}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"While", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"And", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"res", ">", 
                  RowBox[{"$S", "\[LeftDoubleBracket]", 
                   RowBox[{
                   "\"\<Method\>\"", ",", "2", ",", "\"\<StepTolerance\>\""}],
                    "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"$S", "[", "\"\<NewtonIteration\>\"", "]"}], "<", 
                  "maxniter"}]}], "\[IndentingNewLine]", "]"}], 
               "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"++", 
                 RowBox[{"$S", "[", "\"\<NewtonIteration\>\"", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"NewtonQ", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"S", "=", 
                    RowBox[{"Quiet", "@", 
                    RowBox[{"LinSolve", "[", 
                    RowBox[{"ImplicitGradientSystemMatrix", "[", 
                    RowBox[{
                    "Q", ",", "\[Lambda]", ",", "M", ",", "\[Tau]", ",", 
                    RowBox[{"\"\<SparseQ\>\"", "\[Rule]", "sparseQ"}]}], 
                    "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"$S", "[", "\"\<Factorizations\>\"", "]"}], "=", 
                    RowBox[{
                    RowBox[{"$S", "[", "\"\<Factorizations\>\"", "]"}], "+", 
                    "1"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"b", "=", 
                 RowBox[{"ImplicitGradientStepRHS", "[", 
                  RowBox[{"Q", ",", "\[Lambda]", ",", "M", ",", "\[Tau]"}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"res0", "=", 
                 RowBox[{"res", "=", 
                  RowBox[{
                   RowBox[{"$S", "[", "\"\<StepResidual\>\"", "]"}], "=", 
                   RowBox[{"Max", "@", 
                    RowBox[{"Abs", "[", "b", "]"}]}]}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"sol", "=", 
                 RowBox[{"Quiet", "@", 
                  RowBox[{"S", "[", 
                   RowBox[{"-", "b"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
                
                RowBox[{"\[Delta]Q", "=", 
                 RowBox[{"Partition", "[", 
                  RowBox[{
                   RowBox[{"sol", "\[LeftDoubleBracket]", 
                    RowBox[{";;", "n"}], "\[RightDoubleBracket]"}], ",", 
                   "d"}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"\[Delta]\[Lambda]", "=", 
                 RowBox[{"sol", "\[LeftDoubleBracket]", 
                  RowBox[{
                   RowBox[{"n", "+", "1"}], ";;"}], 
                  "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"\[Sigma]", "=", "1."}], ";", "\[IndentingNewLine]", 
                RowBox[{"Q\[Sigma]", "=", 
                 RowBox[{"Displace", "[", 
                  RowBox[{"Q", ",", 
                   RowBox[{"\[Sigma]", " ", "\[Delta]Q"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"\[Lambda]\[Sigma]", "=", 
                 RowBox[{"\[Lambda]", "+", 
                  RowBox[{"\[Sigma]", " ", "\[Delta]\[Lambda]"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"b", "=", 
                 RowBox[{"ImplicitGradientStepRHS", "[", 
                  RowBox[{
                  "Q\[Sigma]", ",", "\[Lambda]\[Sigma]", ",", "M", ",", 
                   "\[Tau]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"res", "=", 
                 RowBox[{"Max", "@", 
                  RowBox[{"Abs", "[", "b", "]"}]}]}], ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"Inner", " ", "backtracking", "  ", "loop"}], "*)"}],
                 "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"$S", "[", "\"\<InnerBacktracking\>\"", "]"}], "=", 
                 "0"}], ";", "\[IndentingNewLine]", 
                RowBox[{"While", "[", 
                 RowBox[{
                  RowBox[{"And", "[", 
                   RowBox[{
                    RowBox[{"res", ">", "res0"}], ",", 
                    RowBox[{
                    RowBox[{"$S", "[", "\"\<InnerBacktracking\>\"", "]"}], 
                    "<", "maxbiter"}]}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"++", 
                    RowBox[{"$S", "[", "\"\<InnerBacktracking\>\"", "]"}]}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"\[Sigma]", "*=", "0.1"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Q\[Sigma]", "=", 
                    RowBox[{"Displace", "[", 
                    RowBox[{"Q", ",", 
                    RowBox[{"\[Sigma]", " ", "\[Delta]Q"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"\[Lambda]\[Sigma]", "=", 
                    RowBox[{"\[Lambda]", "+", 
                    RowBox[{"\[Sigma]", " ", "\[Delta]\[Lambda]"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"b", "=", 
                    RowBox[{"ImplicitGradientStepRHS", "[", 
                    RowBox[{
                    "Q\[Sigma]", ",", "\[Lambda]\[Sigma]", ",", "M", ",", 
                    "\[Tau]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"res", "=", 
                    RowBox[{
                    RowBox[{"$S", "[", "\"\<StepResidual\>\"", "]"}], "=", 
                    RowBox[{"Max", "@", 
                    RowBox[{"Abs", "[", "b", "]"}]}]}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "Check", " ", "whether", " ", "Newton", " ", "step", " ", 
                  "should", " ", "be", " ", 
                  RowBox[{"accepted", "."}]}], "*)"}], "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "Line", " ", "search", " ", "did", " ", "not", " ", "find", 
                  " ", "a", " ", "valid", " ", "inner", " ", "step", " ", 
                  "size", " ", 
                  RowBox[{"\[Sigma]", "."}]}], "*)"}], "\[IndentingNewLine]", 
                
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"And", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"$S", "[", "\"\<InnerBacktracking\>\"", "]"}], 
                    "\[GreaterEqual]", "maxbiter"}], ",", 
                    RowBox[{"res", ">", "res0"}], ",", 
                    RowBox[{
                    RowBox[{"$S", "[", "\"\<OuterBacktracking\>\"", "]"}], 
                    "<", "maxouterbiter"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"AppendTo", "[", 
                    RowBox[{
                    RowBox[{"$S", "[", "\"\<Log\>\"", "]"}], ",", 
                    RowBox[{
                    "\"\<Inner backtracking failed after \>\"", "<>", 
                    RowBox[{"IntegerString", "[", "maxbiter", "]"}], "<>", 
                    "\"\< iterations.\>\""}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"$S", "[", "\"\<StepSize\>\"", "]"}], "*=", 
                    "ContractionFactor"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"++", 
                    RowBox[{"$S", "[", "\"\<OuterBacktracking\>\"", "]"}]}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{
                   "Goto", "[", "\"\<OuterBacktrackingLoop\>\"", "]"}], 
                   ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                  "Inner", " ", "step", " ", "size", " ", "\[Sigma]", " ", 
                   "found"}], ",", " ", 
                  RowBox[{
                  "but", " ", "it", " ", "does", " ", "not", " ", "improve", 
                   " ", "the", " ", 
                   RowBox[{"residual", "."}]}]}], "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"res", "\[GreaterEqual]", 
                    RowBox[{"nfactor", " ", "resold"}]}], "&&", 
                   RowBox[{
                    RowBox[{"$S", "[", "\"\<OuterBacktracking\>\"", "]"}], 
                    "<", "maxouterbiter"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"AppendTo", "[", 
                    RowBox[{
                    RowBox[{"$S", "[", "\"\<Log\>\"", "]"}], ",", 
                    "\"\<Newton iteration aborted early because of \
nonsufficient decrease of residual.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"$S", "[", "\"\<StepSize\>\"", "]"}], "*=", 
                    "ContractionFactor"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"++", 
                    RowBox[{"$S", "[", "\"\<OuterBacktracking\>\"", "]"}]}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{
                   "Goto", "[", "\"\<OuterBacktrackingLoop\>\"", "]"}], 
                   ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"Newton", " ", "step", " ", 
                  RowBox[{"accepted", "."}]}], "*)"}], "\[IndentingNewLine]", 
                
                RowBox[{"AppendTo", "[", 
                 RowBox[{
                  RowBox[{"$S", "[", "\"\<Log\>\"", "]"}], ",", 
                  "\"\<Newton step accepted.\>\""}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"resold", "=", "res"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Q", "=", "Q\[Sigma]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"\[Lambda]", "=", "\[Lambda]\[Sigma]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Check", " ", "whether", " ", "gradient", " ", "step", " ", 
               "should", " ", "be", " ", 
               RowBox[{"accepted", "."}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"And", "[", 
                RowBox[{
                 RowBox[{"Or", "[", 
                  RowBox[{
                   RowBox[{"res", ">", 
                    RowBox[{"$S", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "\"\<Method\>\"", ",", "2", ",", 
                    "\"\<StepTolerance\>\""}], "\[RightDoubleBracket]"}]}], 
                   ",", 
                   RowBox[{
                    RowBox[{"Energy", "[", "Q", "]"}], "\[GreaterEqual]", 
                    RowBox[{"Energy", "[", "M", "]"}]}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"$S", "[", "\"\<OuterBacktracking\>\"", "]"}], "<", 
                  "maxouterbiter"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{
                  RowBox[{"$S", "[", "\"\<Log\>\"", "]"}], ",", 
                  "\"\<Gradient step rejected due to nonsufficient descent.\>\
\""}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"$S", "[", "\"\<StepSize\>\"", "]"}], "*=", 
                 "ContractionFactor"}], ";", "\[IndentingNewLine]", 
                RowBox[{"++", 
                 RowBox[{"$S", "[", "\"\<OuterBacktracking\>\"", "]"}]}], ";",
                 "\[IndentingNewLine]", 
                RowBox[{"Goto", "[", "\"\<OuterBacktrackingLoop\>\"", "]"}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{
               RowBox[{"$S", "[", "\"\<Log\>\"", "]"}], ",", 
               "\"\<Gradient step accepted.\>\""}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "Estimate", " ", "the", " ", "velocity", " ", "vectors", " ", 
               "for", " ", "the", " ", "next", " ", "gradient", " ", 
               RowBox[{"iteration", "'"}], "s", " ", "initial", " ", "guess", 
               " ", "for", " ", 
               RowBox[{"Newton", "'"}], "s", " ", 
               RowBox[{"method", "."}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"dotM", "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"Subtract", "[", 
                 RowBox[{
                  RowBox[{"VertexCoordinates", "[", "Q", "]"}], ",", 
                  RowBox[{"VertexCoordinates", "[", "M", "]"}]}], "]"}], "/", 
                "\[Tau]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"dot\[Mu]", "=", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"Subtract", "[", 
                 RowBox[{"\[Lambda]", ",", "\[Mu]"}], "]"}], "/", "\[Tau]"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"M", "=", "Q"}], ";", "\[IndentingNewLine]", 
             RowBox[{"\[Mu]", "=", "\[Lambda]"}], ";", "\[IndentingNewLine]", 
             
             RowBox[{
              RowBox[{"$S", "[", "\"\<Objective\>\"", "]"}], "=", 
              RowBox[{"Energy", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"$S", "[", "\"\<Residual\>\"", "]"}], "=", 
              RowBox[{"ImplicitGradientResidual", "[", 
               RowBox[{"Q", ",", "\[Lambda]", ",", "M", ",", "\[Tau]"}], 
               "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"cputoc", "=", 
           RowBox[{"TimeUsed", "[", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"toc", "=", 
           RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"$S", "[", "\"\<StepResidual\>\"", "]"}], "=", "res"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"meshlistQ", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendToMeshList", "[", 
              RowBox[{"$MeshList", ",", "M"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"$LagrangeMultiplierList", ",", 
               RowBox[{
                RowBox[{"$S", "[", "\"\<Iteration\>\"", "]"}], "\[Rule]", 
                "\[Mu]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"$S", "[", "\"\<Time\>\"", "]"}], "=", 
           RowBox[{"toc", "-", "tic"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"$S", "[", "\"\<CPUTime\>\"", "]"}], "=", 
           RowBox[{"cputoc", "-", "cputic"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"$S", "[", "\"\<WallClockTime\>\"", "]"}], "+=", 
           RowBox[{"toc", "-", "tic"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"$S", "[", "\"\<TotalCPUTime\>\"", "]"}], "+=", 
           RowBox[{"cputoc", "-", "cputic"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"$S", "[", "\"\<Profile\>\"", "]"}], "=", "profile"}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"$InfoList", ",", 
            RowBox[{
             RowBox[{"$S", "[", "\"\<Iteration\>\"", "]"}], "\[Rule]", 
             RowBox[{
             "$S", "\[LeftDoubleBracket]", "infokeys", 
              "\[RightDoubleBracket]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "If", " ", "gradient", " ", "step", " ", "is", " ", "accepted"}], 
            ",", " ", 
            RowBox[{
            "decide", " ", "whether", " ", "the", " ", "gradient", " ", 
             "step", " ", "size", " ", "\[Tau]", " ", "should", " ", "be", 
             " ", 
             RowBox[{"increased", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"$S", "[", "\"\<OuterBacktracking\>\"", "]"}], 
               "\[LessEqual]", "0"}], ",", 
              RowBox[{
               RowBox[{"$S", "[", "\"\<NewtonIteration\>\"", "]"}], 
               "\[LessEqual]", 
               RowBox[{"0.5", "maxniter"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", "\"\<Step size expanded.\>\"", "]"}], 
              ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"$S", "[", "\"\<StepSize\>\"", "]"}], "*=", 
              "ExpansionFactor"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"OptimizationReturnHandler", "[", 
        RowBox[{"me", ",", "M", ",", "\[IndentingNewLine]", 
         RowBox[{"Association", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<LagrangeMultiplier\>\"", "\[Rule]", "\[Mu]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<LagrangeMultiplierList\>\"", "\[Rule]", 
            RowBox[{"If", "[", 
             RowBox[{"meshlistQ", ",", "$LagrangeMultiplierList", ",", 
              RowBox[{"Missing", "[", "]"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Errors\>\"", "\[Rule]", "$OptimizationErrors"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Warnings\>\"", "\[Rule]", "$OptimizationWarnings"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<LagrangeMultiplier\>\"", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<InitialStepSize\>\"", "\[Rule]", "1."}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<StepTolerance\>\"", "\[Rule]", 
          RowBox[{"10", "^", 
           RowBox[{"-", "6"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<ResidualFunction\>\"", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"\"\<ExpansionFactor\>\"", "\[Rule]", "1.1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<ContractionFactor\>\"", "\[Rule]", "0.5"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"\"\<MaxBacktracking\>\"", "\[Rule]", "12"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<MaxNewtonBacktracking\>\"", "\[Rule]", "5"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<MaxNewtonIterations\>\"", "\[Rule]", "10"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<NewtonSufficientDecreaseFactor\>\"", "\[Rule]", "1.0"}],
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"\"\<NonlinearSolver\>\"", "\[Rule]", "\"\<Newton\>\""}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<SparseQ\>\"", "\[Rule]", "True"}]}], 
        "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       "$OptimizationOptions"}], "\[IndentingNewLine]", "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Description", "\[Rule]", 
     "\"\<Performs implicit Euler integration of gradient flow. Employs \
Metric[M] as \\\"mass matrix\\\". Probably, the norms in which the residuals \
are computed are not very meaningful.\>\""}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.785216402708399*^9, 3.7852164043900423`*^9}, 
   3.7852174478942003`*^9, {3.7852178182457333`*^9, 3.785217821770293*^9}, {
   3.785217925238772*^9, 3.785218091874969*^9}, {3.785218130017839*^9, 
   3.785218130167906*^9}, {3.785218251628045*^9, 3.785218315152911*^9}, {
   3.785218429597543*^9, 3.785218566256288*^9}, {3.785219130265711*^9, 
   3.785219210686549*^9}, {3.785219376337541*^9, 3.7852194027081957`*^9}, {
   3.785220179729095*^9, 3.785220195055575*^9}, {3.785220694992845*^9, 
   3.785220791978496*^9}, {3.785221472001245*^9, 3.785221559480184*^9}, {
   3.785224316296802*^9, 3.7852243635089407`*^9}, {3.785224527543776*^9, 
   3.7852245672159758`*^9}, {3.7852246334117737`*^9, 3.785224657283124*^9}, {
   3.7852248314524403`*^9, 3.785224857827731*^9}, {3.785224923716235*^9, 
   3.785224974440235*^9}, {3.7852250546502733`*^9, 3.785225102481284*^9}, {
   3.785225140331522*^9, 3.785225214941502*^9}, {3.785225397075338*^9, 
   3.785225397297098*^9}, {3.785225506131325*^9, 3.785225517787981*^9}, {
   3.7852255760665007`*^9, 3.785225579153788*^9}, {3.785225746890792*^9, 
   3.785225749961261*^9}, {3.785226319798543*^9, 3.7852263250079403`*^9}, {
   3.785226443610128*^9, 3.785226446009778*^9}, {3.785226707130938*^9, 
   3.785226763941965*^9}, {3.785226896167107*^9, 3.78522701655595*^9}, {
   3.785227591936985*^9, 3.785227614918964*^9}, {3.7852277291147842`*^9, 
   3.785227742025682*^9}, {3.785396813528399*^9, 3.785396837081647*^9}, {
   3.785398709953782*^9, 3.7853987289604816`*^9}, {3.785400386818883*^9, 
   3.78540039408206*^9}, {3.7884141105002947`*^9, 3.788414192537592*^9}, {
   3.788428780990052*^9, 3.788428798791417*^9}, {3.796462665824641*^9, 
   3.796462674380052*^9}, {3.7964627063956213`*^9, 3.796462715860022*^9}, 
   3.7964627548846493`*^9, 3.796462801755889*^9, {3.79646286435075*^9, 
   3.7964629393167353`*^9}, {3.796462983841807*^9, 3.796463005986105*^9}, {
   3.796463049953294*^9, 3.796463064311644*^9}, {3.796463111430348*^9, 
   3.796463217786059*^9}, {3.796463299751243*^9, 3.7964633167559547`*^9}, {
   3.7964634239679337`*^9, 3.796463460057732*^9}, {3.796463508279496*^9, 
   3.796463576453211*^9}, {3.796463647204686*^9, 3.796463649099575*^9}, {
   3.796463721065914*^9, 3.796463741597279*^9}, {3.796463799262813*^9, 
   3.796463841499835*^9}, {3.796464128932745*^9, 3.796464135998254*^9}, {
   3.796464243387088*^9, 3.79646427560207*^9}, 3.796644004439905*^9, {
   3.797008619941557*^9, 3.7970086810736732`*^9}, {3.797008827484147*^9, 
   3.797008884921357*^9}, {3.79700892206717*^9, 3.797008963359269*^9}, {
   3.797009047140753*^9, 3.797009109293952*^9}, {3.797009146199361*^9, 
   3.797009161880219*^9}, {3.797009205004531*^9, 3.7970092102368517`*^9}, {
   3.7970691126137133`*^9, 3.797069148169299*^9}, {3.79706956563801*^9, 
   3.797069566156569*^9}, 3.797070175083143*^9, {3.797072549909848*^9, 
   3.7970725676515093`*^9}, {3.79713857390786*^9, 3.7971385767798233`*^9}, {
   3.797138688144331*^9, 3.797138740295699*^9}, {3.797138828395522*^9, 
   3.797138937416092*^9}, {3.7971389679341297`*^9, 3.79713896804205*^9}, {
   3.797139022708869*^9, 3.79713903773717*^9}, {3.797139098313817*^9, 
   3.797139105616373*^9}, {3.797141071497212*^9, 3.797141072708243*^9}, {
   3.7974012178278313`*^9, 3.797401223034149*^9}, {3.7975699699280376`*^9, 
   3.797569973096414*^9}, {3.799545581236833*^9, 3.799545709677534*^9}, {
   3.7995457417870703`*^9, 
   3.799545859146986*^9}},ExpressionUUID->"916042cc-ee2d-4aa9-ab33-\
0864ab4363a0"],

Cell[BoxData[
 RowBox[{"FindImplicitGradientFlowStepSize", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M0_", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "a", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", "=", 
        RowBox[{"ImplicitGradientFlow", "[", 
         RowBox[{"M0", ",", "\[IndentingNewLine]", 
          RowBox[{"MaxIterations", "\[Rule]", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<CreateMeshList\>\"", "\[Rule]", "False"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<NonlinearSolver\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<NonlinearSolver\>\"", "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<InitialStepSize\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<InitialStepSize\>\"", "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<ContractionFactor\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<ContractionFactor\>\"", "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<SparseQ\>\"", "\[Rule]", 
           RowBox[{"OptionValue", "[", "\"\<SparseQ\>\"", "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"a", "\[LeftDoubleBracket]", 
        RowBox[{"\"\<IterationData\>\"", ",", 
         RowBox[{"-", "1"}], ",", "\"\<StepSize\>\""}], 
        "\[RightDoubleBracket]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<InitialStepSize\>\"", "\[Rule]", "1."}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<NonlinearSolver\>\"", "\[Rule]", "\"\<Newton\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<ContractionFactor\>\"", "\[Rule]", "0.125"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<ExpansionFactor\>\"", "\[Rule]", "8."}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<SparseQ\>\"", "\[Rule]", "True"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7964654260784607`*^9, 3.7964655995038643`*^9}, {
  3.796465780763198*^9, 3.796465793001855*^9}, {3.796465844537956*^9, 
  3.79646584915213*^9}, {3.796476417934064*^9, 3.796476418117496*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"54e680bb-1a5b-4aab-98f6-8dffaa740861"]
},
WindowSize->{1440, 855},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1723, 44, 242, "Input",ExpressionUUID->"7b9667a1-6437-412e-84f9-0e7b958bad69"],
Cell[2284, 66, 1838, 38, 167, "Input",ExpressionUUID->"eb5ba536-2dbe-4a74-8194-8bcddca0092f"],
Cell[4125, 106, 4047, 90, 492, "Input",ExpressionUUID->"9f6800d4-420d-42cd-8257-2c9b46cd7fb6"],
Cell[8175, 198, 984, 24, 92, "Input",ExpressionUUID->"66b09302-136a-4ef4-b291-571bfa0b9c10"],
Cell[9162, 224, 1789, 46, 242, "Input",ExpressionUUID->"047482a0-f4dd-4f77-9239-9944d929c628"],
Cell[10954, 272, 44116, 868, 7142, "Input",ExpressionUUID->"916042cc-ee2d-4aa9-ab33-0864ab4363a0"],
Cell[55073, 1142, 2484, 49, 517, "Input",ExpressionUUID->"54e680bb-1a5b-4aab-98f6-8dffaa740861"]
}
]
*)

