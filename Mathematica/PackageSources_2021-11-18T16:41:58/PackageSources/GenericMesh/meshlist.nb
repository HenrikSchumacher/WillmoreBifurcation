(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     43002,        968]
NotebookOptionsPosition[     40421,        931]
NotebookOutlinePosition[     40757,        946]
CellTagsIndexPosition[     40714,        943]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"meshlist", "=", 
   RowBox[{"Object", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "\"\<Description\>\"", "\[Rule]", 
      "\"\<This is the head used for list of meshes with fixed combinatorics.\
\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<CacheActivated\>\"", "\[Rule]", "True"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<PersistentCacheActivated\>\"", "\[Rule]", "True"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.632690985190308*^9, {3.632827401136145*^9, 3.6328274148330107`*^9}, {
   3.633193833628323*^9, 3.633193837961084*^9}, {3.633194008763186*^9, 
   3.633194011785421*^9}, {3.675533899367717*^9, 3.675533904174404*^9}, {
   3.757494280740122*^9, 3.757494301384508*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"c6a32812-e4f4-4029-998e-79065f626a54"],

Cell[BoxData[
 RowBox[{"VerbatimRegion", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"CreateFormat", "[", 
    RowBox[{"meshlist", ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"\"\<Caption\>\"", "\[Rule]", "\"\<Vertices: \>\""}], ",", 
           
           RowBox[{"\"\<Function\>\"", "\[Rule]", "VertexCount"}]}], 
          "\[RightAssociation]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"\"\<Caption\>\"", "\[Rule]", "\"\<Edges: \>\""}], ",", 
           RowBox[{"\"\<Function\>\"", "\[Rule]", "EdgeCount"}]}], 
          "\[RightAssociation]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"\"\<Caption\>\"", "\[Rule]", "\"\<Triangles: \>\""}], ",", 
           RowBox[{"\"\<Function\>\"", "\[Rule]", "TriangleCount"}]}], 
          "\[RightAssociation]"}]}], "\[IndentingNewLine]", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{
           "\"\<Caption\>\"", "\[Rule]", "\"\<EmbeddingDimension: \>\""}], 
           ",", 
           RowBox[{"\"\<Function\>\"", "\[Rule]", "EmbeddingDimension"}]}], 
          "\[RightAssociation]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"\"\<Caption\>\"", "\[Rule]", "\"\<MeshType: \>\""}], ",", 
           
           RowBox[{"\"\<Function\>\"", "\[Rule]", "MeshType"}]}], 
          "\[RightAssociation]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"\"\<Caption\>\"", "\[Rule]", "\"\<MeshCount: \>\""}], ",", 
           RowBox[{"\"\<Function\>\"", "\[Rule]", "MeshCount"}]}], 
          "\[RightAssociation]"}]}], "\[IndentingNewLine]", "}"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{"\"\<Caption\>\"", "\[Rule]", "\"\<DOFs: \>\""}], ",", 
           RowBox[{"\"\<Function\>\"", "\[Rule]", "DofCount"}]}], 
          "\[RightAssociation]"}], ",", "SpanFromLeft"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[LeftAssociation]", 
          RowBox[{
           RowBox[{
           "\"\<Caption\>\"", "\[Rule]", "\"\<BoundaryVertices: \>\""}], ",", 
           
           RowBox[{"\"\<Function\>\"", "\[Rule]", "BoundaryVertexCount"}]}], 
          "\[RightAssociation]"}], ",", "SpanFromLeft"}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6326922934474373`*^9, 3.6326923016626*^9}, {
   3.632692538415489*^9, 3.632692553616931*^9}, 3.632696883690831*^9, 
   3.632763247466894*^9, 3.632765966601877*^9, {3.63276690113347*^9, 
   3.6327669043296843`*^9}, {3.6328054049604607`*^9, 3.632805407607581*^9}, {
   3.633197293489044*^9, 3.633197297169114*^9}, {3.633199707041094*^9, 
   3.6331997099988413`*^9}, {3.665420048840823*^9, 3.6654201560749493`*^9}, {
   3.6654202715807333`*^9, 3.6654202913438187`*^9}, {3.665420330115261*^9, 
   3.66542033521354*^9}, {3.667041529684552*^9, 3.667041542694199*^9}, 
   3.667041769816461*^9, {3.667041995591386*^9, 3.667042024575844*^9}, 
   3.667042608766571*^9, {3.667042675129987*^9, 3.6670427038828993`*^9}, 
   3.667042745186802*^9, 3.6670428333486834`*^9, 3.66704291693025*^9, 
   3.6670429918739862`*^9, {3.675533907684833*^9, 3.6755339117249603`*^9}, {
   3.675534716604175*^9, 3.675534797292595*^9}, {3.675584550329063*^9, 
   3.6755845635042553`*^9}, {3.675584595172965*^9, 3.6755846003559637`*^9}, {
   3.720115201294235*^9, 3.7201152433714523`*^9}, {3.75749488162262*^9, 
   3.757494916987265*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"75a40794-b6bb-4dc5-8479-9d5b07906694"],

Cell[BoxData[
 RowBox[{"VerbatimRegion", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"Init", "::", "usage"}], "=", 
    "\"\<Initializes objects with heads 'meshlist'.\>\""}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"meshlist", "/:", 
    RowBox[{"Init", "[", 
     RowBox[{"meshlist", ",", "mothermesh0_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Initialize", "[", 
       RowBox[{"meshlist", ",", "\[IndentingNewLine]", 
        RowBox[{"Association", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<MotherMesh\>\"", "\[Rule]", "mothermesh0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<VertexCoordinateList\>\"", "\[Rule]", 
           RowBox[{"\[LeftAssociation]", 
            RowBox[{"0", "\[Rule]", 
             RowBox[{"VertexCoordinates", "[", "mothermesh0", "]"}]}], 
            "\[RightAssociation]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6326922934474373`*^9, 3.6326923016626*^9}, {
   3.632692538415489*^9, 3.632692553616931*^9}, 3.632696883690831*^9, 
   3.632763247466894*^9, 3.632765966601877*^9, {3.63276690113347*^9, 
   3.6327669043296843`*^9}, {3.6328054049604607`*^9, 3.632805407607581*^9}, {
   3.633197293489044*^9, 3.633197297169114*^9}, {3.633199707041094*^9, 
   3.6331997099988413`*^9}, {3.665420048840823*^9, 3.6654201560749493`*^9}, {
   3.6654202715807333`*^9, 3.6654202913438187`*^9}, {3.665420330115261*^9, 
   3.66542033521354*^9}, {3.6670415140126457`*^9, 3.6670415181581078`*^9}, 
   3.720115248331677*^9, 3.7574944924679623`*^9, {3.757494530786104*^9, 
   3.7574945309596243`*^9}, 3.757494936874475*^9, {3.757496232596163*^9, 
   3.757496233634363*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"1c5872cc-64e7-4434-8a0d-e1d31091e1d2"],

Cell[BoxData[
 RowBox[{"VertexCoordinateList", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_meshlist", ",", "\[IndentingNewLine]", 
    RowBox[{"M", "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "\"\<VertexCoordinateList\>\""}], 
     "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7574945033922787`*^9, 3.757494524223234*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"83f283f4-48cd-4b14-8b4f-c5863dab7f48"],

Cell[BoxData[
 RowBox[{"MotherMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_meshlist", ",", "\[IndentingNewLine]", 
    RowBox[{"M", "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "\"\<MotherMesh\>\""}], "\[RightDoubleBracket]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7574945518965073`*^9, 3.757494558388959*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"32d76742-3733-4746-920e-e464e2ed9c78"],

Cell[BoxData[
 RowBox[{"MeshType", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_meshlist", ",", "\[IndentingNewLine]", 
    RowBox[{"Head", "[", 
     RowBox[{"MotherMesh", "[", "M", "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellLabel->
  "In[140]:=",ExpressionUUID->"5181af41-9a64-421d-a11d-f3544ee74d36"],

Cell[BoxData[
 RowBox[{"MeshCount", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_meshlist", ",", "\[IndentingNewLine]", 
    RowBox[{"Length", "[", 
     RowBox[{"VertexCoordinateList", "[", "M", "]"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.75749458605517*^9, 3.757494594084956*^9}, 
   3.757495050463304*^9, 3.757495556269108*^9},
 CellLabel->"In[30]:=",ExpressionUUID->"6177fb1e-2ed5-490e-8451-672b87151ffe"],

Cell[BoxData[
 RowBox[{"VertexCount", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_meshlist", ",", "\[IndentingNewLine]", 
    RowBox[{"VertexCount", "[", 
     RowBox[{"MotherMesh", "[", "M", "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.632690954869464*^9, 3.6326909567682962`*^9}, {
   3.6326909886621647`*^9, 3.632691041448658*^9}, {3.632691171172625*^9, 
   3.63269120183147*^9}, {3.632691344798423*^9, 3.632691352565106*^9}, 
   3.63269145185609*^9, 3.632691994075542*^9, {3.632692546809062*^9, 
   3.6326925667926598`*^9}, {3.632693302518222*^9, 3.632693305076129*^9}, 
   3.632693392302751*^9, {3.6326982061835327`*^9, 3.6326982068404922`*^9}, {
   3.632729828421232*^9, 3.632729835971035*^9}, {3.632827424392749*^9, 
   3.6328274244007797`*^9}, {3.633198793548931*^9, 3.633198794443117*^9}, 
   3.646405082084194*^9, {3.675534240669835*^9, 3.67553426582655*^9}, {
   3.675535240458522*^9, 3.675535263479884*^9}, {3.720115179831058*^9, 
   3.7201151853842373`*^9}, {3.75749431693086*^9, 3.7574943617263823`*^9}, {
   3.757494567176351*^9, 3.7574946161163397`*^9}, 3.7574950581793528`*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"e42701a6-5f5e-4c0e-ad05-3b9797eddeb6"],

Cell[BoxData[
 RowBox[{"EdgeCount", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_meshlist", ",", "\[IndentingNewLine]", 
    RowBox[{"EdgeCount", "[", 
     RowBox[{"MotherMesh", "[", "M", "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.632691309633848*^9, 3.632691313209839*^9}, 
   3.632691360973172*^9, {3.632691462197538*^9, 3.63269159370868*^9}, 
   3.632691991250208*^9, {3.632692570185964*^9, 3.632692573584776*^9}, 
   3.632693391283354*^9, {3.6327298382451563`*^9, 3.632729864342648*^9}, {
   3.632827424407628*^9, 3.632827424414105*^9}, {3.633198795728999*^9, 
   3.633198796493149*^9}, 3.634077680302387*^9, {3.64308050429458*^9, 
   3.643080511317576*^9}, {3.643080552459216*^9, 3.643080559398364*^9}, {
   3.672153656806343*^9, 3.672153666219721*^9}, {3.6721537458675547`*^9, 
   3.672153759549479*^9}, {3.672154232934699*^9, 3.672154233732606*^9}, {
   3.67553427252291*^9, 3.675534306429202*^9}, {3.720115173143021*^9, 
   3.720115187544318*^9}, {3.757494605742464*^9, 3.757494611923712*^9}, 
   3.757495059819314*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"6fd66094-f8fd-4db2-a195-3efde2dba5e1"],

Cell[BoxData[
 RowBox[{"TriangleCount", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_meshlist", ",", "\[IndentingNewLine]", 
    RowBox[{"TriangleCount", "[", 
     RowBox[{"MotherMesh", "[", "M", "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.632691309633848*^9, 3.632691313209839*^9}, 
   3.632691360973172*^9, {3.632691462197538*^9, 3.632691492770651*^9}, 
   3.632691984213561*^9, {3.632692576761372*^9, 3.63269257977735*^9}, 
   3.632693391543399*^9, {3.632729867116909*^9, 3.632729871934845*^9}, {
   3.63282742442172*^9, 3.632827447042501*^9}, {3.633198797193454*^9, 
   3.6331987978959637`*^9}, {3.634077656074613*^9, 3.634077692133709*^9}, {
   3.6755342932647448`*^9, 3.675534311916861*^9}, {3.7201151506640167`*^9, 
   3.7201151898722677`*^9}, {3.757494624421864*^9, 3.7574946272190447`*^9}},
 CellLabel->
  "In[126]:=",ExpressionUUID->"1d9d6824-283d-4799-9e65-c2b6c9c3349d"],

Cell[BoxData[
 RowBox[{"EmbeddingDimension", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_meshlist", ",", "\[IndentingNewLine]", 
    RowBox[{"EmbeddingDimension", "[", 
     RowBox[{"MotherMesh", "[", "M", "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.649591310967163*^9, {3.6755343178316813`*^9, 3.675534325725252*^9}, {
   3.720115142342656*^9, 3.720115144303062*^9}, {3.757494632181072*^9, 
   3.757494635314666*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"6df5e699-7b88-49fe-ba26-0fa4a315f0aa"],

Cell[BoxData[
 RowBox[{"DofCount", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_meshlist", ",", "\[IndentingNewLine]", 
    RowBox[{"DofCount", "[", 
     RowBox[{"MotherMesh", "[", "M", "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6541036016679697`*^9, 3.654103663245129*^9}, {
  3.6755343322555017`*^9, 3.675534344469735*^9}, {3.720115127321187*^9, 
  3.7201151406072283`*^9}, {3.7574946391640577`*^9, 3.7574946507816067`*^9}},
 CellLabel->
  "In[129]:=",ExpressionUUID->"a18913e3-5321-4263-950f-ef1bab4bb3f0"],

Cell[BoxData[
 RowBox[{"DofCount", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_meshlist", ",", "\[IndentingNewLine]", 
    RowBox[{"DofCount", "[", 
     RowBox[{"MotherMesh", "[", "M", "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",ExpressionUUID->"91c5a8e8-f610-4aeb-833f-4844f9aa1d5d"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.757495155737823*^9, 3.757495166155458*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"b5e4853c-82da-4c02-ba05-c113ca8a12ef"],

Cell[BoxData[
 RowBox[{"GetMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M_meshlist", ",", "i_Integer"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"f", "=", 
        RowBox[{"VertexCoordinateList", "[", "M", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"0", "\[LessEqual]", "i", "\[LessEqual]", 
         RowBox[{
          RowBox[{"MeshCount", "[", "M", "]"}], "-", "1"}]}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SetVertexCoordinates", "[", 
          RowBox[{
           RowBox[{"MotherMesh", "[", "M", "]"}], ",", 
           RowBox[{"f", "[", "i", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"MotherMesh", "[", "M", "]"}]}], "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"MeshCount", "[", "M", "]"}]}], "\[LessEqual]", "i", "<", 
           "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"SetVertexCoordinates", "[", 
            RowBox[{
             RowBox[{"MotherMesh", "[", "M", "]"}], ",", 
             RowBox[{"f", "[", 
              RowBox[{
               RowBox[{"MeshCount", "[", "M", "]"}], "+", "i"}], "]"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"MotherMesh", "[", "M", "]"}]}], "\[IndentingNewLine]", 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<GetMesh error: \>\"", ",", "i", ",", 
             "\"\< is not a valid index. Returning last mesh.\>\""}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"SetVertexCoordinates", "[", 
            RowBox[{
             RowBox[{"MotherMesh", "[", "M", "]"}], ",", 
             RowBox[{"f", "[", 
              RowBox[{
               RowBox[{"MeshCount", "[", "M", "]"}], "-", "1"}], "]"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"MotherMesh", "[", "M", "]"}]}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.675534968447721*^9, 3.675534999881647*^9}, {
   3.6755351039713497`*^9, 3.675535123016182*^9}, 3.675536599826539*^9, {
   3.675579106420233*^9, 3.675579113427834*^9}, {3.675579320193449*^9, 
   3.67557932788813*^9}, {3.6755793614988747`*^9, 3.6755793920747557`*^9}, {
   3.675579478755271*^9, 3.675579479455764*^9}, {3.675579525329673*^9, 
   3.675579546211073*^9}, {3.675579801109386*^9, 3.6755798012962713`*^9}, 
   3.720115231186483*^9, {3.720115278717712*^9, 3.720115301052732*^9}, 
   3.720115336085088*^9, {3.7574946749219313`*^9, 3.757494812228343*^9}, {
   3.75749518356181*^9, 3.757495191103683*^9}, {3.757496255754591*^9, 
   3.757496264950942*^9}, 3.758359952638411*^9, {3.764403859250169*^9, 
   3.764403878567112*^9}, {3.799568137132639*^9, 3.799568243920437*^9}},
 CellLabel->
  "In[269]:=",ExpressionUUID->"bc999dbc-23cd-4151-8b3c-d1e2d8d6b779"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TimeList", "=", 
    RowBox[{"SettingFunction", "[", 
     RowBox[{"M_meshlist", ",", "Automatic"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimeNearestFunction", "=", 
   RowBox[{"PackageFunction", "[", 
    RowBox[{"M_meshlist", ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"TimeList", "[", "M", "]"}], "=!=", "Automatic"}], "&&", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"TimeList", "[", "M", "]"}], "]"}], "\[Equal]", 
         RowBox[{"MeshCount", "[", "M", "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Nearest", "[", 
        RowBox[{
         RowBox[{"TimeList", "[", "M", "]"}], "\[Rule]", "\"\<Index\>\""}], 
        "]"}], ",", "\[IndentingNewLine]", "Automatic"}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TimeInterpolationOrder", "=", 
   RowBox[{"SettingFunction", "[", 
    RowBox[{"M_meshlist", ",", "1"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7833490943613367`*^9, 3.783349094584559*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"9ddf87c2-7c0a-4e27-8ce6-ef2748a91e7d"],

Cell[BoxData[
 RowBox[{"GetTimeMesh", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M_meshlist", ",", "tt_"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tlist", ",", "idx", ",", "t0", ",", "t1", ",", "\[Lambda]", ",", 
        "pts", ",", "t"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tlist", "=", 
        RowBox[{"TimeList", "[", "M", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"tt", "<", 
           RowBox[{
           "tlist", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "||", 
          RowBox[{"tt", ">", 
           RowBox[{"tlist", "\[LeftDoubleBracket]", 
            RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"t", "=", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{
             "tlist", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{"Min", "[", 
              RowBox[{"tt", ",", 
               RowBox[{"tlist", "\[LeftDoubleBracket]", 
                RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
          "Print", "[", 
           "\"\<Extrapolation (time was capped to time interval).\>\"", "]"}],
           ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"t", "=", "tt"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"pts", "=", 
        RowBox[{"Switch", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TimeInterpolationOrder", "[", "M", "]"}], ",", 
          "\[IndentingNewLine]", "1", ",", "\[IndentingNewLine]", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"idx", "=", 
             RowBox[{"Sort", "[", 
              RowBox[{
               RowBox[{"TimeNearestFunction", "[", "M", "]"}], "[", 
               RowBox[{"t", ",", "2"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"t0", ",", "t1"}], "}"}], "=", 
             RowBox[{
             "tlist", "\[LeftDoubleBracket]", "idx", 
              "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"\[Lambda]", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"t", "-", "t0"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"t1", "-", "t0"}], ")"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1.", "-", "\[Lambda]"}], ",", "\[Lambda]"}], "}"}], 
             ".", 
             RowBox[{"Values", "[", 
              RowBox[{
               RowBox[{"VertexCoordinateList", "[", "M", "]"}], 
               "\[LeftDoubleBracket]", "idx", "\[RightDoubleBracket]"}], 
              "]"}]}]}], "\[IndentingNewLine]", ")"}], "\[IndentingNewLine]", 
          ",", "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"VertexCoordinateList", "[", "M", "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{
              RowBox[{"TimeNearestFunction", "[", "M", "]"}], "[", 
              RowBox[{"t", ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], 
           "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"SetVertexCoordinates", "[", 
        RowBox[{
         RowBox[{"MotherMesh", "[", "M", "]"}], ",", "pts"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"MotherMesh", "[", "M", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Warnings\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<extrapol\>\"", "\[Rule]", 
       "\"\<Warning: Time parameter outside bounds; extrapolation is \
used.\>\""}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7870463082680807`*^9, 3.787046367802854*^9}, {
  3.815832888261956*^9, 
  3.81583288844461*^9}},ExpressionUUID->"aefeb38b-f812-49c7-9fda-\
70801cbe11e7"],

Cell[BoxData[
 RowBox[{"VerbatimRegion", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{"meshlist", "/:", 
    RowBox[{"M_meshlist", "[", "i_Integer", "]"}], ":=", 
    RowBox[{"GetMesh", "[", 
     RowBox[{"M", ",", "i"}], "]"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AppendToMeshList", "::", "usage"}], "=", "\"\<\>\""}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"meshlist", "/:", 
    RowBox[{"AppendToMeshList", "[", 
     RowBox[{
      RowBox[{"M", ":", 
       RowBox[{"meshlist", "[", "$meshlist_", "]"}]}], ",", "Mnew_"}], "]"}], 
    ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
       "$meshlist", "\[LeftDoubleBracket]", "\"\<Cache\>\"", 
        "\[RightDoubleBracket]"}], "=", 
       RowBox[{"\[LeftAssociation]", "\[RightAssociation]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{
        RowBox[{
        "$meshlist", "\[LeftDoubleBracket]", "\"\<VertexCoordinateList\>\"", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
         RowBox[{"MeshCount", "[", "M", "]"}], "\[Rule]", 
         RowBox[{"VertexCoordinates", "[", "Mnew", "]"}]}]}], "]"}], ";"}], 
     "\[IndentingNewLine]", ")"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"meshlist", "/:", 
    RowBox[{"AppendToMeshList", "[", 
     RowBox[{
      RowBox[{"M", ":", 
       RowBox[{"meshlist", "[", "$meshlist_", "]"}]}], ",", 
      RowBox[{"P_", "?", "MatrixQ"}]}], "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
       "$meshlist", "\[LeftDoubleBracket]", "\"\<Cache\>\"", 
        "\[RightDoubleBracket]"}], "=", 
       RowBox[{"\[LeftAssociation]", "\[RightAssociation]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{
        RowBox[{
        "$meshlist", "\[LeftDoubleBracket]", "\"\<VertexCoordinateList\>\"", 
         "\[RightDoubleBracket]"}], ",", 
        RowBox[{
         RowBox[{"MeshCount", "[", "M", "]"}], "\[Rule]", "P"}]}], "]"}], 
      ";"}], "\[IndentingNewLine]", ")"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"meshlist", "/:", 
    RowBox[{"ExportObject", "[", 
     RowBox[{"file_", ",", "X_meshlist"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "Y", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Y", "\[LeftArrow]", "X"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ClearAllCache", "[", "Y", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"ClearAllCache", "[", 
        RowBox[{"MotherMesh", "[", "Y", "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"FileExistsQ", "[", 
           RowBox[{"DirectoryName", "[", "file", "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Creating directory \>\"", ",", 
            RowBox[{"CreateDirectory", "[", 
             RowBox[{"DirectoryName", "[", "file", "]"}], "]"}]}], "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"file", ",", 
         RowBox[{"Serialize", "[", "Y", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "file"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.757495321146558*^9, 3.757495405342914*^9}, {
   3.757495475440048*^9, 3.757495516290655*^9}, 3.757495730013055*^9, 
   3.757496335861768*^9, {3.776460728127351*^9, 3.7764607494084663`*^9}, {
   3.8255649392921467`*^9, 3.825564940442946*^9}, {3.825565071215597*^9, 
   3.825565152882779*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"e05296cb-148f-4f20-848a-3237bc631d07"],

Cell[BoxData[
 RowBox[{"BoundingBox", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_meshlist", ",", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"data", ",", "a"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"data", "=", 
        RowBox[{"MinMax", "/@", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Join", "@@", 
           RowBox[{"Values", "[", 
            RowBox[{"VertexCoordinateList", "[", "M", "]"}], "]"}]}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"a", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"x", "\[Function]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"x", "<", 
              RowBox[{"10", "^", 
               RowBox[{"(", 
                RowBox[{"-", "12"}], ")"}]}]}], ",", "0.1", ",", "x"}], 
            "]"}]}], ",", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"Differences", "/@", "data"}], "]"}], 
           RowBox[{"BoundingBoxTolerance", "[", 
            RowBox[{"M", "[", "0", "]"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"data", "+", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "a"}], ",", "a"}], "}"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.764044677630986*^9, 3.764044677798974*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"5df7083a-4564-4ec9-a360-fdd6daeea8ac"],

Cell[BoxData[
 RowBox[{"BoundingBoxLength", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_meshlist", ",", "\[IndentingNewLine]", 
    RowBox[{"Max", "[", 
     RowBox[{"Differences", "/@", 
      RowBox[{"BoundingBox", "[", "M", "]"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.764044741276479*^9},ExpressionUUID->"001bd9c9-858f-4ddb-bf2d-\
998a055f6e28"],

Cell[BoxData[
 RowBox[{"BoundingBoxCenter", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_meshlist", ",", "\[IndentingNewLine]", 
    RowBox[{"Mean", "/@", 
     RowBox[{"BoundingBox", "[", "M", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Caching", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{3.764044717546772*^9},
 CellLabel->
  "In[185]:=",ExpressionUUID->"55caf47e-cdad-493e-8df0-4f6213dadc46"],

Cell[BoxData[
 RowBox[{"MeshPlot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{"M_meshlist", ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f", "=", 
         RowBox[{"First", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{"OptionValue", "[", "Method", "]"}], "}"}], "]"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"opts", "=", 
         RowBox[{"Rest", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{"OptionValue", "[", "Method", "]"}], "}"}], "]"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"tlist", "=", 
         RowBox[{"TimeList", "[", "M", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"background", "=", 
         RowBox[{"OptionValue", "[", "\"\<Background\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"tlist", "===", "Automatic"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"VectorQ", "[", "tlist", "]"}], "]"}], "||", 
           RowBox[{
            RowBox[{"Length", "[", "tlist", "]"}], "\[NotEqual]", " ", 
            RowBox[{"MeshCount", "[", "M", "]"}]}]}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Show", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{
              RowBox[{"GetMesh", "[", 
               RowBox[{"M", ",", "i"}], "]"}], ",", 
              RowBox[{"Sequence", "@@", "opts"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "background", ",", "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", "\"\<Index\>\""}], "}"}], ",", "0", 
            ",", 
            RowBox[{
             RowBox[{"MeshCount", "[", "M", "]"}], "-", "1"}], ",", "1"}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TrackedSymbols", "\[RuleDelayed]", "i"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Show", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{
              RowBox[{"GetTimeMesh", "[", 
               RowBox[{"M", ",", "t"}], "]"}], ",", 
              RowBox[{"Sequence", "@@", "opts"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "background", ",", "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"Min", "[", "tlist", "]"}], ",", "\"\<Time\>\""}], 
             "}"}], ",", 
            RowBox[{"Min", "[", "tlist", "]"}], ",", 
            RowBox[{"Max", "[", "tlist", "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TrackedSymbols", "\[RuleDelayed]", "t"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Method", "\[Rule]", "MeshPlot"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"\"\<Background\>\"", "\[Rule]", 
        RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.757497447035809*^9, 3.757497455632077*^9}, {
   3.763982365792289*^9, 3.763982366757698*^9}, {3.763982475610517*^9, 
   3.76398249954078*^9}, {3.7639829369167957`*^9, 3.763982937251252*^9}, {
   3.7639830251360617`*^9, 3.763983047228778*^9}, {3.763983101859618*^9, 
   3.763983104513781*^9}, {3.763983174730629*^9, 3.7639831759671707`*^9}, {
   3.764069353745748*^9, 3.764069360109316*^9}, {3.7833487228153973`*^9, 
   3.7833488278118153`*^9}, {3.783348920298704*^9, 3.783348981703286*^9}, 
   3.78334931432448*^9, {3.7845607275389757`*^9, 3.7845607700335283`*^9}, {
   3.784560804858596*^9, 3.784560904406345*^9}, {3.784953151997793*^9, 
   3.784953152156193*^9}, {3.7883456992470503`*^9, 3.788345706157638*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"3de68e5e-8667-4fb1-b192-85845fd4f228"],

Cell[BoxData[
 RowBox[{"MeshPlot", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M_meshlist", ",", "i_Integer"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f", "=", 
         RowBox[{"First", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{"OptionValue", "[", "Method", "]"}], "}"}], "]"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"opts", "=", 
         RowBox[{"Rest", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{"OptionValue", "[", "Method", "]"}], "}"}], "]"}], 
          "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"f", "[", 
       RowBox[{
        RowBox[{"M", "[", "i", "]"}], ",", 
        RowBox[{"Sequence", "@@", "opts"}]}], "]"}]}], "\[IndentingNewLine]", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Options", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"Method", "\[Rule]", "MeshPlot"}], "\[IndentingNewLine]", 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.758359831932952*^9, 3.758359840933832*^9}, {
  3.7639824099776917`*^9, 3.763982467631054*^9}, {3.7639830088427553`*^9, 
  3.7639830111985493`*^9}, {3.763983042902399*^9, 3.763983092151827*^9}, {
  3.7639831313072357`*^9, 3.763983137058907*^9}, {3.7639832003870792`*^9, 
  3.763983202392082*^9}, {3.783349031489481*^9, 
  3.783349033408826*^9}},ExpressionUUID->"792468b1-132e-4347-8d87-\
02e34fcbeafb"],

Cell[BoxData[
 RowBox[{"VerbatimRegion", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"MeshListMap", "::", "usage"}], "=", "\"\<\>\""}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"meshlist", "/:", 
    RowBox[{"MeshListMap", "[", 
     RowBox[{"F_", ",", "M_meshlist"}], "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"F", "[", 
       RowBox[{"M", "[", "i", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{
         RowBox[{"MeshCount", "[", "M", "]"}], "-", "1"}]}], "}"}]}], "]"}]}],
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[60]:=",ExpressionUUID->"bd3a48dd-c980-429c-89bc-6091ec90c192"],

Cell[BoxData[
 RowBox[{"Join", "=", 
  RowBox[{"PackageFunction", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M_meshlist", ",", "Mseq__meshlist"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"list", ",", "plist"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"list", "=", 
        RowBox[{"{", 
         RowBox[{"M", ",", "Mseq"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"And", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Equal", "@@", 
            RowBox[{"(", 
             RowBox[{"MeshType", "/@", "list"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Equal", "@@", 
            RowBox[{"(", 
             RowBox[{"VertexCount", "/@", "list"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Equal", "@@", 
            RowBox[{"(", 
             RowBox[{"EmbeddingDimension", "/@", "list"}], ")"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"plist", "=", 
           RowBox[{"Join", "@@", 
            RowBox[{"Values", "[", 
             RowBox[{
              RowBox[{"list", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "\"\<VertexCoordinateList\>\""}], 
              "\[RightDoubleBracket]"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Initialize", "[", 
           RowBox[{"meshlist", ",", "\[IndentingNewLine]", 
            RowBox[{"Association", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\"\<MotherMesh\>\"", "\[Rule]", 
               RowBox[{
                RowBox[{"list", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
                "\[LeftDoubleBracket]", "\"\<MotherMesh\>\"", 
                "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<VertexCoordinateList\>\"", "\[Rule]", 
               RowBox[{"AssociationThread", "[", 
                RowBox[{
                 RowBox[{"Range", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{
                    RowBox[{"Length", "[", "plist", "]"}], "-", "1"}]}], 
                  "]"}], ",", "plist"}], "]"}]}]}], "\[IndentingNewLine]", 
             "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
         ",", "\[IndentingNewLine]", "$Failed"}], "\[IndentingNewLine]", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7764638799482517`*^9, 3.7764640947888737`*^9}, {
   3.776464129043632*^9, 3.776464138274109*^9}, 3.7764641684315243`*^9, {
   3.776464254436914*^9, 3.77646426573075*^9}, {3.776464492699979*^9, 
   3.776464504145719*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"3b13833b-7470-4537-9ec8-503a60f07d73"]
},
WindowSize->{1440, 851},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 878, 19, 142, "Input",ExpressionUUID->"c6a32812-e4f4-4029-998e-79065f626a54"],
Cell[1439, 41, 4277, 86, 567, "Input",ExpressionUUID->"75a40794-b6bb-4dc5-8479-9d5b07906694"],
Cell[5719, 129, 2012, 38, 342, "Input",ExpressionUUID->"1c5872cc-64e7-4434-8a0d-e1d31091e1d2"],
Cell[7734, 169, 468, 9, 92, "Input",ExpressionUUID->"83f283f4-48cd-4b14-8b4f-c5863dab7f48"],
Cell[8205, 180, 446, 9, 92, "Input",ExpressionUUID->"32d76742-3733-4746-920e-e464e2ed9c78"],
Cell[8654, 191, 337, 8, 92, "Input",ExpressionUUID->"5181af41-9a64-421d-a11d-f3544ee74d36"],
Cell[8994, 201, 459, 9, 92, "Input",ExpressionUUID->"6177fb1e-2ed5-490e-8451-672b87151ffe"],
Cell[9456, 212, 1223, 19, 92, "Input",ExpressionUUID->"e42701a6-5f5e-4c0e-ad05-3b9797eddeb6"],
Cell[10682, 233, 1158, 19, 92, "Input",ExpressionUUID->"6fd66094-f8fd-4db2-a195-3efde2dba5e1"],
Cell[11843, 254, 933, 16, 92, "Input",ExpressionUUID->"1d9d6824-283d-4799-9e65-c2b6c9c3349d"],
Cell[12779, 272, 554, 12, 92, "Input",ExpressionUUID->"6df5e699-7b88-49fe-ba26-0fa4a315f0aa"],
Cell[13336, 286, 561, 11, 92, "Input",ExpressionUUID->"a18913e3-5321-4263-950f-ef1bab4bb3f0"],
Cell[13900, 299, 313, 6, 92, "Input",ExpressionUUID->"91c5a8e8-f610-4aeb-833f-4844f9aa1d5d"],
Cell[14216, 307, 171, 2, 41, "Input",ExpressionUUID->"b5e4853c-82da-4c02-ba05-c113ca8a12ef"],
Cell[14390, 311, 3261, 71, 467, "Input",ExpressionUUID->"bc999dbc-23cd-4151-8b3c-d1e2d8d6b779"],
Cell[17654, 384, 1381, 32, 292, "Input",ExpressionUUID->"9ddf87c2-7c0a-4e27-8ce6-ef2748a91e7d"],
Cell[19038, 418, 4569, 108, 767, "Input",ExpressionUUID->"aefeb38b-f812-49c7-9fda-70801cbe11e7"],
Cell[23610, 528, 3937, 94, 692, "Input",ExpressionUUID->"e05296cb-148f-4f20-848a-3237bc631d07"],
Cell[27550, 624, 1663, 43, 217, "Input",ExpressionUUID->"5df7083a-4564-4ec9-a360-fdd6daeea8ac"],
Cell[29216, 669, 481, 12, 117, "Input",ExpressionUUID->"001bd9c9-858f-4ddb-bf2d-998a055f6e28"],
Cell[29700, 683, 458, 10, 117, "Input",ExpressionUUID->"55caf47e-cdad-493e-8df0-4f6213dadc46"],
Cell[30161, 695, 4751, 102, 867, "Input",ExpressionUUID->"3de68e5e-8667-4fb1-b192-85845fd4f228"],
Cell[34915, 799, 1642, 38, 292, "Input",ExpressionUUID->"792468b1-132e-4347-8d87-02e34fcbeafb"],
Cell[36560, 839, 752, 19, 167, "Input",ExpressionUUID->"bd3a48dd-c980-429c-89bc-6091ec90c192"],
Cell[37315, 860, 3102, 69, 542, "Input",ExpressionUUID->"3b13833b-7470-4537-9ec8-503a60f07d73"]
}
]
*)

