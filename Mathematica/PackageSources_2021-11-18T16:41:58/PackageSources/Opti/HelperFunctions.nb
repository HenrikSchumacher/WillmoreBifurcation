Notebook[
 {Cell[BoxData[RowBox[{RowBox[{RowBox[{"AllNonNegativeQ", "=", 
          RowBox[{"CPackageFunction", "[", RowBox[{RowBox[{"{", 
                RowBox[{"{", RowBox[{"w", ",", "_Real", ",", "1"}], "}"}], 
                "}"}], ",", "\[IndentingNewLine]", RowBox[{"Block", "[", 
                RowBox[{RowBox[{"{", RowBox[{"bool", "=", "True"}], "}"}], 
                  ",", "\[IndentingNewLine]", RowBox[{RowBox[{"Do", "[", 
                      "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[{"bool", 
                          "=", RowBox[{"(", RowBox[{"s", "\[GreaterEqual]", 
                          "0"}], ")"}]}], ";", "\[IndentingNewLine]", 
                          RowBox[{"If", "[", RowBox[{RowBox[{"Not", "[", 
                          "bool", "]"}], ",", RowBox[{"Break", "[", "]"}]}], 
                          "]"}]}], ",", RowBox[{"{", RowBox[{"s", ",", "w"}], 
                          "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    "bool"}]}], "\[IndentingNewLine]", "]"}], ",", 
              "\[IndentingNewLine]", RowBox[{"CompilationTarget", "\[Rule]", 
                "\"C\""}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
      "\[IndentingNewLine]"}]], "Input", CellChangeTimes -> 
    {{3.645869849513579*^9, 3.6458698576368217*^9}}], 
  Cell[BoxData[RowBox[{RowBox[{"AllPositiveQ", "=", 
        RowBox[{"CPackageFunction", "[", RowBox[
           {RowBox[{"{", RowBox[{"{", RowBox[{"w", ",", "_Real", ",", "1"}], 
                "}"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Block", "[", RowBox[{RowBox[{"{", RowBox[{"bool", "=", 
                    "True"}], "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{RowBox[{"Do", "[", "\[IndentingNewLine]", RowBox[
                     {RowBox[{RowBox[{"bool", "=", RowBox[{"(", RowBox[
                          {"s", ">", "0"}], ")"}]}], ";", 
                        "\[IndentingNewLine]", RowBox[{"If", "[", RowBox[
                          {RowBox[{"Not", "[", "bool", "]"}], ",", RowBox[
                          {"Break", "[", "]"}]}], "]"}]}], ",", RowBox[
                       {"{", RowBox[{"s", ",", "w"}], "}"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", "bool"}]}], "\[IndentingNewLine]", 
              "]"}], ",", "\[IndentingNewLine]", RowBox[{"CompilationTarget", 
              "\[Rule]", "\"C\""}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], 
   "Input", CellChangeTimes -> {{3.64589958079692*^9, 
      3.645899598629942*^9}}], 
  Cell[BoxData[RowBox[{RowBox[{"PositivePositions", "=", 
        RowBox[{"CPackageFunction", "[", RowBox[
           {RowBox[{"{", RowBox[{"{", RowBox[{"w", ",", "_Real", ",", "1"}], 
                "}"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Block", "[", RowBox[{RowBox[{"{", "bag", "}"}], ",", 
                "\[IndentingNewLine]", RowBox[{RowBox[{"bag", "=", 
                    RowBox[{"Internal`Bag", "[", RowBox[{"Most", "[", 
                        RowBox[{"{", "0", "}"}], "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", RowBox[{"Do", "[", 
                    "\[IndentingNewLine]", RowBox[{RowBox[{"If", "[", 
                        RowBox[{RowBox[{RowBox[{"w", "\[LeftDoubleBracket]", 
                          "i", "\[RightDoubleBracket]"}], ">", "0."}], ",", 
                          RowBox[{"Internal`StuffBag", "[", RowBox[{"bag", 
                          ",", "i"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
                      ",", RowBox[{"{", RowBox[{"i", ",", "1", ",", RowBox[
                          {"Length", "[", "w", "]"}]}], "}"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", RowBox[{"Internal`BagPart", "[", 
                    RowBox[{"bag", ",", "All"}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"CompilationTarget", "\[Rule]", "\"C\""}]}], 
          "\[IndentingNewLine]", "]"}]}], ";"}]], "Input", 
   CellChangeTimes -> {3.645869860108378*^9}], 
  Cell[BoxData[RowBox[{"cMaxNonnegative", "=", 
      RowBox[{"CPackageFunction", "[", 
        RowBox[{RowBox[{"{", RowBox[{"{", RowBox[{"Y", ",", "_Real", ",", 
                "1"}], "}"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Max", "[", RowBox[{"Table", "[", RowBox[{RowBox[
                 {"Max", "[", RowBox[{"y", ",", "0."}], "]"}], ",", 
                RowBox[{"{", RowBox[{"y", ",", "Y"}], "}"}]}], "]"}], 
            "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input", 
   CellChangeTimes -> {{3.649255782663023*^9, 3.6492558344793777*^9}, 
     3.649255890745181*^9, 3.649255931512308*^9, {3.64925599597756*^9, 
      3.649255998264517*^9}}], 
  Cell[BoxData[RowBox[{"cMax0", "=", RowBox[{"CPackageFunction", "[", 
        RowBox[{RowBox[{"{", RowBox[{"{", RowBox[{"Y", ",", "_Real", ",", 
                "1"}], "}"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", RowBox[{RowBox[{"Max", "[", RowBox[
                 {"y", ",", "0."}], "]"}], ",", RowBox[{"{", RowBox[
                 {"y", ",", "Y"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
        "]"}]}]], "Input"]}, WindowSize -> {808, 968}, 
 WindowMargins -> {{Automatic, 287}, {Automatic, 0}}, 
 FrontEndVersion -> 
  "10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 4, 2014)", 
 StyleDefinitions -> "Default.nb"]
