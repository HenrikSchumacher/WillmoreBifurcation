Notebook[{Cell[BoxData["Exit"], "Input", CellChangeTimes -> 
    {{3.633928791825832*^9, 3.63392879606758*^9}}], 
  Cell[BoxData[{RowBox[{"Needs", "[", "\"PackageManager`\"", "]"}], 
     "\[IndentingNewLine]", RowBox[{RowBox[{"LoadPackage", "[", "\"Opti`\"", 
         "]"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]"}], "Input", 
   CellChangeTimes -> {{3.6405051711411953*^9, 3.640505171801705*^9}, 
     {3.641129898055862*^9, 3.6411298988339252*^9}, 3.6411300901705637*^9, 
     {3.6411307789227247*^9, 3.641130785599749*^9}}], 
  Cell[BoxData[{RowBox[{RowBox[{"P0", "\[LeftArrow]", 
         RowBox[{"Init", "[", RowBox[{"point", ",", " ", 
             RowBox[{"{", RowBox[{RowBox[{"-", "1.1"}], ",", "1.1"}], 
               "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
     RowBox[{RowBox[{"P", "\[LeftArrow]", "P0"}], ";"}], 
     "\[IndentingNewLine]"}], "Input", CellChangeTimes -> 
    {{3.640505557807745*^9, 3.640505570781804*^9}, {3.6405056160325823*^9, 
      3.640505641793063*^9}, 3.640505726521521*^9, {3.6405061074397287*^9, 
      3.640506107855146*^9}, 3.640506186962525*^9, {3.641130792364852*^9, 
      3.641130794514509*^9}, {3.64113356638857*^9, 3.641133594925788*^9}, 
     {3.641134182379087*^9, 3.6411341990135202*^9}, 
     {3.6411349872700768*^9, 3.6411349875428343*^9}}], 
  Cell[BoxData[
    {RowBox[{RowBox[{RowBox[{"R", "\[LeftArrow]", RowBox[{"ModelAlgorithm", 
             "[", RowBox[{"P", ",", "Rosenbrock", ",", "\[IndentingNewLine]", 
               RowBox[{"\"UpdateMethod\"", "\[Rule]", "Displace"}], ",", 
               "\[IndentingNewLine]", RowBox[{"\"MaxIterations\"", "\[Rule]", 
                 "1000"}], ",", "\[IndentingNewLine]", RowBox[
                {"\"PrecisionGoal\"", "\[Rule]", RowBox[{"10", "^", 
                   RowBox[{"(", RowBox[{"-", "8"}], ")"}]}]}], ",", 
               "\[IndentingNewLine]", RowBox[{"\"StepWidth\"", "\[Rule]", 
                 RowBox[{"{", RowBox[{"StrongWolfePowell", ",", RowBox[
                      {"\"Interpolation\"", "\[Rule]", "\"Cubic\""}]}], 
                   "}"}]}], ",", "\[IndentingNewLine]", RowBox[
                {"\"SearchDirection\"", "\[Rule]", RowBox[{"{", 
                   "\[IndentingNewLine]", RowBox[{"\"L\bBFGS\"", ",", 
                     "\[IndentingNewLine]", RowBox[{"\"MaxHistoryLength\"", 
                       "\[Rule]", "20"}]}], "\[IndentingNewLine]", "}"}]}]}], 
             "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], 
     "\[IndentingNewLine]", RowBox[{"Dataset", "@", 
       RowBox[{"R", "\[LeftDoubleBracket]", RowBox[{"1", ",", "\"Cache\"", 
           ",", "\"ModelAlgorithmData\""}], "\[RightDoubleBracket]"}]}]}], 
   "Input", CellChangeTimes -> {{3.641130251473721*^9, 3.641130302423243*^9}, 
     {3.641130624680811*^9, 3.641130664544849*^9}, 3.6411309619132013*^9, 
     {3.6411326130809517*^9, 3.641132640975771*^9}, 
     {3.641132791656012*^9, 3.641132805502993*^9}, {3.641442848557499*^9, 
      3.641442849041025*^9}, {3.641447219776857*^9, 3.641447227038435*^9}, 
     {3.641447617635264*^9, 3.641447622132389*^9}}], 
  Cell[BoxData[{RowBox[{"R", "\[LeftArrow]", RowBox[{"ModelAlgorithm", "[", 
         RowBox[{"P0", ",", "Rosenbrock", ",", "\[IndentingNewLine]", 
           RowBox[{"\"UpdateMethod\"", "\[Rule]", "Displace"}], ",", 
           "\[IndentingNewLine]", RowBox[{"\"MaxIterations\"", "\[Rule]", 
             "1000"}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"PrecisionGoal\"", "\[Rule]", RowBox[{"10", "^", RowBox[
                {"(", RowBox[{"-", "8"}], ")"}]}]}], ",", 
           "\[IndentingNewLine]", RowBox[{"\"SearchDirection\"", "\[Rule]", 
             "\"FletcherReeves\""}]}], "]"}]}], "\[IndentingNewLine]", 
     RowBox[{"Dataset", "@", RowBox[{"R", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "\"Cache\"", ",", "\"ModelAlgorithmData\""}], 
         "\[RightDoubleBracket]"}]}]}], "Input", 
   CellChangeTimes -> {{3.641134854404463*^9, 3.64113489892934*^9}, 
     {3.6411349320198936*^9, 3.6411349535537853*^9}}], 
  Cell[BoxData[{RowBox[{"R", "\[LeftArrow]", RowBox[{"ModelAlgorithm", "[", 
         RowBox[{"P0", ",", "Rosenbrock", ",", "\[IndentingNewLine]", 
           RowBox[{"\"UpdateMethod\"", "\[Rule]", "Displace"}], ",", 
           "\[IndentingNewLine]", RowBox[{"\"MaxIterations\"", "\[Rule]", 
             "1000"}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"PrecisionGoal\"", "\[Rule]", RowBox[{"10", "^", RowBox[
                {"(", RowBox[{"-", "8"}], ")"}]}]}], ",", 
           "\[IndentingNewLine]", RowBox[{"\"SearchDirection\"", "\[Rule]", 
             "\"HeestenesStiefel\""}]}], "]"}]}], "\[IndentingNewLine]", 
     RowBox[{"Dataset", "@", RowBox[{"R", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "\"Cache\"", ",", "\"ModelAlgorithmData\""}], 
         "\[RightDoubleBracket]"}]}]}], "Input", 
   CellChangeTimes -> {3.641135402934722*^9}], Cell[BoxData[""], "Input", 
   CellChangeTimes -> {{3.641181161432416*^9, 3.641181220248588*^9}}], 
  Cell[BoxData[{RowBox[{RowBox[{"n", "=", "100"}], ";"}], 
     "\[IndentingNewLine]", 
     RowBox[{RowBox[{"A", "=", RowBox[{"RandomReal", "[", 
           RowBox[{RowBox[{"{", RowBox[{RowBox[{"-", "2"}], ",", "2"}], 
               "}"}], ",", RowBox[{"{", RowBox[{"n", ",", "n"}], "}"}]}], 
           "]"}]}], ";"}], "\[IndentingNewLine]", 
     RowBox[{RowBox[{"A", "=", RowBox[{RowBox[{RowBox[{"A", "\[Transpose]"}], 
             ".", "A"}], "+", RowBox[{"IdentityMatrix", "[", "n", "]"}]}]}], 
       ";"}], "\[IndentingNewLine]", 
     RowBox[{RowBox[{"b", "=", RowBox[{"RandomReal", "[", 
           RowBox[{RowBox[{"{", RowBox[{RowBox[{"-", "2"}], ",", "2"}], 
               "}"}], ",", RowBox[{"{", "n", "}"}]}], "]"}]}], ";"}], 
     "\[IndentingNewLine]", 
     RowBox[{RowBox[{"x", "=", RowBox[{"RandomReal", "[", 
           RowBox[{RowBox[{"{", RowBox[{RowBox[{"-", "2"}], ",", "2"}], 
               "}"}], ",", RowBox[{"{", "n", "}"}]}], "]"}]}], ";"}], 
     "\[IndentingNewLine]", 
     RowBox[{RowBox[{RowBox[{"v", "=", RowBox[{"RandomReal", "[", 
             RowBox[{RowBox[{"{", RowBox[{RowBox[{"-", "2"}], ",", "2"}], 
                 "}"}], ",", RowBox[{"{", "n", "}"}]}], "]"}]}], ";"}], 
       "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
     RowBox[{RowBox[{"P0", "\[LeftArrow]", RowBox[{"Init", "[", 
           RowBox[{"point", ",", "x"}], "]"}]}], ";"}], 
     "\[IndentingNewLine]", 
     RowBox[{RowBox[{RowBox[{"P", "\[LeftArrow]", "P0"}], ";"}], 
       "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
     RowBox[{RowBox[{"F", "=", RowBox[{"PackageFunction", "[", 
           RowBox[{"P_", ",", RowBox[{RowBox[{"(", RowBox[
                  {RowBox[{RowBox[{"1", "/", "2"}], " ", RowBox[{"A", ".", 
                       RowBox[{"getc", "[", "P", "]"}]}]}], "-", "b"}], 
                 ")"}], ".", RowBox[{"getc", "[", "P", "]"}]}], ",", 
             "\[IndentingNewLine]", RowBox[{"\"InputType\"", "\[Rule]", 
               "point"}], ",", "\[IndentingNewLine]", 
             RowBox[{"\"Caching\"", "\[Rule]", "True"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}], 
     "\[IndentingNewLine]", RowBox[{"DF", "=", 
       RowBox[{"PackageFunction", "[", RowBox[{"P_", ",", 
           RowBox[{RowBox[{"A", ".", RowBox[{"getc", "[", "P", "]"}]}], "-", 
             "b"}], ",", "\[IndentingNewLine]", RowBox[{"\"InputType\"", 
             "\[Rule]", "point"}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"Caching\"", "\[Rule]", "True"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
     RowBox[{RowBox[{RowBox[{RowBox[{"Derivative", "[", "1", "]"}], "[", "F", 
           "]"}], ":=", "DF"}], ";"}], "\[IndentingNewLine]"}], "Input", 
   CellChangeTimes -> {{3.641181215790506*^9, 3.64118122160673*^9}, 
     {3.641181317249161*^9, 3.641181318345024*^9}, {3.641181677689473*^9, 
      3.641181686923593*^9}, {3.641181743844303*^9, 3.6411817467246113*^9}}], 
  Cell[BoxData[""], "Input", CellChangeTimes -> 
    {{3.641181227267702*^9, 3.641181300232531*^9}, {3.6411814203721*^9, 
      3.6411814595258636*^9}, 3.641181685495161*^9}], 
  Cell[BoxData[{RowBox[{RowBox[{RowBox[{"ClearAllCache", "[", "P", "]"}], 
         ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
     RowBox[{RowBox[{"t", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
     RowBox[{RowBox[{"Q", "\[LeftArrow]", RowBox[{"Displace", "[", 
           RowBox[{"P", ",", RowBox[{"t", " ", "v"}]}], "]"}]}], ";"}], 
     "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[{"F", "[", "Q", "]"}], 
         "-", RowBox[{"F", "[", "P", "]"}], "-", 
         RowBox[{"t", " ", RowBox[{RowBox[{"DF", "[", "P", "]"}], ".", 
             "v"}]}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
     RowBox[{RowBox[{"t", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
     RowBox[{RowBox[{"Q", "\[LeftArrow]", RowBox[{"Displace", "[", 
           RowBox[{"P", ",", RowBox[{"t", " ", "v"}]}], "]"}]}], ";"}], 
     "\[IndentingNewLine]", RowBox[{RowBox[{RowBox[{"F", "[", "Q", "]"}], 
         "-", RowBox[{"F", "[", "P", "]"}], "-", 
         RowBox[{"t", " ", RowBox[{RowBox[{"DF", "[", "P", "]"}], ".", 
             "v"}]}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
     RowBox[{RowBox[{"t", "=", "0.0001"}], ";"}], "\[IndentingNewLine]", 
     RowBox[{RowBox[{"Q", "\[LeftArrow]", RowBox[{"Displace", "[", 
           RowBox[{"P", ",", RowBox[{"t", " ", "v"}]}], "]"}]}], ";"}], 
     "\[IndentingNewLine]", RowBox[{RowBox[{"F", "[", "Q", "]"}], "-", 
       RowBox[{"F", "[", "P", "]"}], "-", 
       RowBox[{"t", " ", RowBox[{RowBox[{"DF", "[", "P", "]"}], ".", 
           "v"}]}]}]}], "Input", CellChangeTimes -> 
    {{3.641181303059428*^9, 3.641181396883213*^9}, {3.641181430739977*^9, 
      3.6411814351163473*^9}, {3.641181697943654*^9, 3.641181717971051*^9}}], 
  Cell[BoxData[{RowBox[{"R", "\[LeftArrow]", RowBox[{"ModelAlgorithm", "[", 
         RowBox[{"P", ",", "F", ",", "\[IndentingNewLine]", 
           RowBox[{"\"UpdateMethod\"", "\[Rule]", "Displace"}], ",", 
           "\[IndentingNewLine]", RowBox[{"\"MaxIterations\"", "\[Rule]", 
             "1000"}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"PrecisionGoal\"", "\[Rule]", RowBox[{"10", "^", RowBox[
                {"(", RowBox[{"-", "4"}], ")"}]}]}], ",", 
           "\[IndentingNewLine]", RowBox[{"\"SearchDirection\"", "\[Rule]", 
             "\"HeestenesStiefel\""}]}], "]"}]}], "\[IndentingNewLine]", 
     RowBox[{"Dataset", "@", RowBox[{"R", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "\"Cache\"", ",", "\"ModelAlgorithmData\""}], 
         "\[RightDoubleBracket]"}]}]}], "Input", 
   CellChangeTimes -> {{3.641181447091751*^9, 3.641181517774641*^9}}], 
  Cell[BoxData[{RowBox[{"R", "\[LeftArrow]", RowBox[{"ModelAlgorithm", "[", 
         RowBox[{"P", ",", "F", ",", "\[IndentingNewLine]", 
           RowBox[{"\"UpdateMethod\"", "\[Rule]", "Displace"}], ",", 
           "\[IndentingNewLine]", RowBox[{"\"MaxIterations\"", "\[Rule]", 
             "1000"}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"PrecisionGoal\"", "\[Rule]", RowBox[{"10", "^", RowBox[
                {"(", RowBox[{"-", "4"}], ")"}]}]}], ",", 
           "\[IndentingNewLine]", RowBox[{"\"SearchDirection\"", "\[Rule]", 
             "\"FletcherReeves\""}]}], "]"}]}], "\[IndentingNewLine]", 
     RowBox[{"Dataset", "@", RowBox[{"R", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "\"Cache\"", ",", "\"ModelAlgorithmData\""}], 
         "\[RightDoubleBracket]"}]}]}], "Input", 
   CellChangeTimes -> {{3.6411816396184*^9, 3.6411816431367893*^9}}], 
  Cell[BoxData[RowBox[{"Eigenvalues", "@", "A"}]], "Input", 
   CellChangeTimes -> {{3.641181660100285*^9, 3.641181665746915*^9}}], 
  Cell[BoxData["0"], "Input", CellChangeTimes -> {3.6411816712655582*^9}]}, 
 WindowSize -> {1115, 852}, WindowMargins -> 
  {{Automatic, 10}, {Automatic, 0}}, FrontEndVersion -> 
  "10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 4, 2014)", 
 StyleDefinitions -> "Default.nb"]
