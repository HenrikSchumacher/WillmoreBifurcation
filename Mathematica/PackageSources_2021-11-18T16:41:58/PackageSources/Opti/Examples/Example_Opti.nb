Notebook[{Cell[BoxData["Exit"], "Input", CellChangeTimes -> 
    {{3.6393879815645227*^9, 3.639387982078039*^9}}], 
  Cell[BoxData[RowBox[{"Needs", "[", "\"PackageManager`\"", "]"}]], "Input", 
   CellChangeTimes -> {{3.639458677719285*^9, 3.639458686053751*^9}}], 
  Cell[BoxData[RowBox[{"LoadPackage", "[", "\"Mesh`\035\"", "]"}]], "Input", 
   CellChangeTimes -> {{3.6394587440505657*^9, 3.639458747543745*^9}}], 
  Cell[BoxData[RowBox[{"LoadPackage", "[", "\"Opti`\035\"", "]"}]], "Input", 
   CellChangeTimes -> {{3.639458692215108*^9, 3.6394587405434313*^9}, 
     {3.6394588507773523*^9, 3.639458852777508*^9}}], 
  Cell[BoxData[RowBox[{RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
        RowBox[{RowBox[{"a", "=", "1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"b", "=", "2"}], ";", "\[IndentingNewLine]", 
          RowBox[{"XX", "=", RowBox[{"Table", "[", RowBox[{RowBox[
                 {"X", "[", RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"{", RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{RowBox[{"f", "[", "X_", "]"}], ":=", 
            RowBox[{RowBox[{RowBox[{"(", RowBox[{"a", "-", RowBox[{"X", "[", 
                      RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "^", "2"}], 
              "+", RowBox[{"b", "*", RowBox[{RowBox[{"(", RowBox[
                     {RowBox[{"X", "[", RowBox[{"[", "2", "]"}], "]"}], "-", 
                      RowBox[{RowBox[{"X", "[", RowBox[{"[", "1", "]"}], 
                          "]"}], "^", "2"}]}], ")"}], "^", "2"}]}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{RowBox[{"f", "[", RowBox[{"X_", ",", "\"D\""}], "]"}], 
            ":=", RowBox[{"Evaluate", "[", RowBox[{"D", "[", RowBox[
                 {RowBox[{"f", "[", "XX", "]"}], ",", RowBox[{"{", 
                    RowBox[{"XX", ",", "1"}], "}"}]}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", RowBox[{RowBox[{"f", "[", RowBox[{"X_", ",", 
                "\"DD\""}], "]"}], ":=", RowBox[{"Evaluate", "[", 
              RowBox[{"D", "[", RowBox[{RowBox[{"f", "[", "XX", "]"}], ",", 
                  RowBox[{"{", RowBox[{"XX", ",", "2"}], "}"}]}], "]"}], 
              "]"}]}], ";"}], "\[IndentingNewLine]", "]"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input", 
   CellChangeTimes -> {{3.639387590936421*^9, 3.6393875909377203*^9}, 
     3.639387882799378*^9, {3.6393879412653427*^9, 3.6393880403034782*^9}, 
     {3.639388859755686*^9, 3.6393888661672707*^9}, 
     {3.6393889858774652*^9, 3.63938899979134*^9}, 3.639390389877846*^9, 
     3.639391753891432*^9, 3.639391860515253*^9}], 
  Cell[BoxData[RowBox[{RowBox[{"mesh", "=", RowBox[{"Object", "[", 
          "\[IndentingNewLine]", RowBox[{RowBox[{"\"Description\"", 
              "\[Rule]", "\"This is the head used for mesh objects.\""}], 
            ",", "\[IndentingNewLine]", RowBox[{"\"CacheActivated\"", 
              "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
            RowBox[{"\"PersistentCacheActivated\"", "\[Rule]", "True"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";"}]], "Input"], 
  Cell[BoxData[{RowBox[{"f", "[", RowBox[{"{", RowBox[{"0", ",", "0"}], 
         "}"}], "]"}], "\[IndentingNewLine]", 
     RowBox[{"f", "[", RowBox[{RowBox[{"{", RowBox[{"0", ",", "0"}], "}"}], 
         ",", "\"D\""}], "]"}]}], "Input", CellChangeTimes -> 
    {{3.6393880225783854*^9, 3.6393880421411343*^9}, 
     {3.639388697193591*^9, 3.639388702365868*^9}}], 
  Cell[BoxData[RowBox[{"f", "[", 
      RowBox[{RowBox[{"{", RowBox[{"u", ",", "v"}], "}"}], ",", "\"DD\""}], 
      "]"}]], "Input", CellChangeTimes -> 
    {{3.639391719454485*^9, 3.639391743212636*^9}, 3.639391815652032*^9}], 
  Cell[BoxData[""], "Input", CellChangeTimes -> 
    {{3.639387923632606*^9, 3.639387924542345*^9}, {3.639388083404324*^9, 
      3.639388091850623*^9}, {3.639388402791258*^9, 3.639388403151162*^9}, 
     {3.6393884527514772*^9, 3.639388454800968*^9}, 
     {3.639388643107874*^9, 3.6393886538303413*^9}, 
     {3.639388712542018*^9, 3.639388748152588*^9}, {3.639388790681284*^9, 
      3.639388813591008*^9}, {3.63938903899117*^9, 3.639389040001635*^9}, 
     {3.6393890712164917*^9, 3.639389071651*^9}, {3.6393893850592318*^9, 
      3.6393894133185673*^9}, {3.639389508307523*^9, 3.6393895085571957*^9}, 
     3.639400440442233*^9}], Cell[BoxData[""], "Input", 
   CellChangeTimes -> {{3.639387906030798*^9, 3.639387933703692*^9}, 
     {3.639388058904776*^9, 3.639388105052774*^9}, {3.6393881662545757*^9, 
      3.6393882630897007*^9}, {3.639388308054244*^9, 3.639388379888904*^9}, 
     3.639388852881494*^9, {3.639388918977913*^9, 3.639388993627584*^9}, 
     {3.6393895218307657*^9, 3.63938955650604*^9}, {3.639400442082101*^9, 
      3.639400442738028*^9}, {3.63940084042519*^9, 3.6394008597574244*^9}, 
     {3.639401109747498*^9, 3.6394011448710833*^9}, 
     {3.6394013165753183*^9, 3.639401322431777*^9}, 
     {3.639401381072278*^9, 3.639401381270632*^9}, {3.639401411833603*^9, 
      3.639401443157118*^9}, 3.639401646934493*^9}], 
  Cell[BoxData[
    {RowBox[{RowBox[{RowBox[{"Armijo", "[", RowBox[{"x_", ",", "p_", ",", 
             "f_"}], "]"}], ":=", RowBox[{"Module", "[", 
           RowBox[{RowBox[{"{", "\[IndentingNewLine]", RowBox[
                {RowBox[{"\[Sigma]", "=", "0.4"}], ",", 
                 "\[IndentingNewLine]", RowBox[{"\[Tau]", "=", "1"}], ",", 
                 "\[IndentingNewLine]", RowBox[{"j", "=", "0"}], ",", 
                 "\[IndentingNewLine]", RowBox[{"fx", "=", RowBox[{"f", "[", 
                     "x", "]"}]}], ",", "\[IndentingNewLine]", RowBox[
                  {"pgrad", "=", " ", RowBox[{"p", ".", RowBox[{"f", "[", 
                       RowBox[{"x", ",", "\"D\""}], "]"}]}]}], ",", 
                 "\[IndentingNewLine]", "fx\[Tau]p", ",", 
                 "\[IndentingNewLine]", "\[Tau]1"}], "\[IndentingNewLine]", 
               "}"}], ",", "\[IndentingNewLine]", RowBox[{RowBox[
                {"If", "[", RowBox[{RowBox[{"pgrad", ">", "0"}], ",", 
                   "\[IndentingNewLine]", RowBox[{RowBox[{"\[Tau]", "=", 
                       ".00001"}], ";", "\[IndentingNewLine]", RowBox[
                      {"Print", "[", "\"reverted direction\"", "]"}], ";"}], 
                   "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
                   RowBox[{RowBox[{"fx\[Tau]p", "=", RowBox[{"f", "[", 
                         RowBox[{"x", "+", RowBox[{"\[Tau]", " ", RowBox[
                          {"Partition", "[", RowBox[{"p", ",", "2"}], 
                          "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                     RowBox[{"While", "[", "\[IndentingNewLine]", RowBox[
                        {RowBox[{"fx\[Tau]p", ">", RowBox[{"fx", "+", RowBox[
                          {"\[Sigma]", " ", "\[Tau]", " ", "pgrad"}]}]}], 
                         ",", "\[IndentingNewLine]", RowBox[{RowBox[
                          {"\[Tau]1", "=", RowBox[{RowBox[{"-", " ", 
                          "\[Sigma]"}], " ", RowBox[{"\[Tau]", "^", "2"}], 
                          RowBox[{"pgrad", "/", RowBox[{"(", RowBox[
                          {"fx\[Tau]p", "-", "fx", "-", RowBox[{"\[Tau]", 
                          " ", "pgrad"}]}], ")"}]}]}]}], ";", 
                          "\[IndentingNewLine]", RowBox[{"\[Tau]", "=", 
                          RowBox[{"Max", "[", RowBox[{RowBox[{"0.1", " ", 
                          "\[Tau]"}], ",", " ", "\[Tau]1"}], "]"}]}], ";", 
                          "\[IndentingNewLine]", RowBox[{"fx\[Tau]p", "=", 
                          RowBox[{"f", "[", RowBox[{"x", "+", RowBox[
                          {"\[Tau]", " ", RowBox[{"Partition", "[", RowBox[
                          {"p", ",", "2"}], "]"}]}]}], "]"}]}], ";", 
                          "\[IndentingNewLine]", RowBox[{"j", "++"}], 
                          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";", 
               "\[IndentingNewLine]", "\[Tau]"}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]"}], 
     "\[IndentingNewLine]", 
     RowBox[{RowBox[{RowBox[{"ModelAlgorithm", "[", 
           RowBox[{"x0_", ",", "f_"}], "]"}], ":=", 
         RowBox[{"Module", "[", RowBox[{RowBox[{"{", RowBox[{"p", ",", "t", 
                 ",", RowBox[{"residuum", "=", "1"}], ",", "u", ",", 
                 RowBox[{"k", "=", "0"}], ",", "x", ",", "iter", ",", 
                 "\[Alpha]"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{RowBox[{"x", "=", "x0"}], ";", "\[IndentingNewLine]", 
               RowBox[{"While", "[", RowBox[{RowBox[{"residuum", ">", 
                     RowBox[{"10", "^", RowBox[{"(", RowBox[{"-", "8"}], 
                         ")"}]}]}], ",", "\[IndentingNewLine]", RowBox[
                    {RowBox[{"k", "++"}], ";", "\[IndentingNewLine]", 
                     RowBox[{"iter", "=", "k"}], ";", "\[IndentingNewLine]", 
                     RowBox[{"\[Alpha]", "=", "residuum"}], ";", 
                     "\[IndentingNewLine]", RowBox[{"\[Tau]", "=", "t"}], 
                     ";", "\[IndentingNewLine]", RowBox[{"p", "=", RowBox[
                        {"-", RowBox[{"f", "[", RowBox[{"x", ",", "\"D\""}], 
                          "]"}]}]}], ";", "\[IndentingNewLine]", RowBox[
                      {"t", "=", RowBox[{"Armijo", "[", RowBox[{"x", ",", 
                          "p", ",", "f"}], "]"}]}], ";", 
                     "\[IndentingNewLine]", RowBox[{"x", "=", RowBox[
                        {"x", "+", RowBox[{"t", " ", "p"}]}]}], ";", 
                     "\[IndentingNewLine]", RowBox[{"u", "=", RowBox[
                        {"f", "[", RowBox[{"x", ",", "\"D\""}], "]"}]}], ";", 
                     "\[IndentingNewLine]", RowBox[{"residuum", "=", 
                       RowBox[{"Sqrt", "[", RowBox[{"u", ".", "u"}], "]"}]}], 
                     ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
               "\[IndentingNewLine]", RowBox[{"\[Alpha]", "=", "residuum"}], 
               ";", "\[IndentingNewLine]", "x"}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
     RowBox[{RowBox[{"ClearAll", "[", "BFGSMultiply", "]"}], ";"}], 
     "\[IndentingNewLine]", 
     RowBox[{RowBox[{RowBox[{RowBox[{"BFGSMultiply", "[", 
             RowBox[{"H0_", ",", "s\[Rho]list_", ",", "y\[Rho]list_", ",", 
               "\[Rho]list_", ",", "d_"}], "]"}], ":=", 
           RowBox[{"Block", "[", RowBox[{RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{RowBox[{"r", "=", "d"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"m", "=", RowBox[{"Length", "[", "s\[Rho]list", 
                       "]"}]}], ",", "\[IndentingNewLine]", "\[Alpha]list", 
                   ",", "\[Beta]", ",", "\[Alpha]", ",", "\[Rho]y", ",", 
                   "\[Rho]s", ",", "\[Rho]"}], "\[IndentingNewLine]", "}"}], 
               ",", "\[IndentingNewLine]", RowBox[{RowBox[{"If", "[", 
                   RowBox[{RowBox[{"m", ">", "0"}], ",", 
                     "\[IndentingNewLine]", RowBox[{RowBox[{"\[Alpha]list", 
                         "=", RowBox[{"Table", "[", "\[IndentingNewLine]", 
                          RowBox[{RowBox[{RowBox[{"\[Rho]s", "=", RowBox[
                          {"s\[Rho]list", "\[LeftDoubleBracket]", RowBox[
                          {"-", "i"}], "\[RightDoubleBracket]"}]}], ";", 
                          "\[IndentingNewLine]", RowBox[{"\[Rho]y", "=", 
                          RowBox[{"y\[Rho]list", "\[LeftDoubleBracket]", 
                          RowBox[{"-", "i"}], "\[RightDoubleBracket]"}]}], 
                          ";", "\[IndentingNewLine]", RowBox[{"\[Rho]", "=", 
                          RowBox[{"\[Rho]list", "\[LeftDoubleBracket]", 
                          RowBox[{"-", "i"}], "\[RightDoubleBracket]"}]}], 
                          ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                          RowBox[{"\[Alpha]", "=", RowBox[{"\[Rho]s", ".", 
                          "r"}]}], ";", "\[IndentingNewLine]", RowBox[{"r", 
                          "=", RowBox[{"r", "-", RowBox[{"\[Alpha]", " ", 
                          RowBox[{"\[Rho]y", "/", "\[Rho]"}]}]}]}], ";", 
                          "\[IndentingNewLine]", "\[Alpha]"}], ",", 
                          "\[IndentingNewLine]", RowBox[{"{", RowBox[{"i", 
                          ",", "1", ",", "m"}], "}"}]}], "]"}]}], ";"}]}], 
                   "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"r", "=", RowBox[{"LinearSolve", "[", RowBox[
                      {"H0", ",", "r"}], "]"}]}], ";", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", RowBox[{"If", "[", RowBox[
                    {RowBox[{"m", ">", "0"}], ",", "\[IndentingNewLine]", 
                     RowBox[{RowBox[{"Do", "[", "\[IndentingNewLine]", 
                         RowBox[{RowBox[{RowBox[{"\[Rho]s", "=", RowBox[
                          {"s\[Rho]list", "\[LeftDoubleBracket]", "i", 
                          "\[RightDoubleBracket]"}]}], ";", 
                          "\[IndentingNewLine]", RowBox[{"\[Rho]y", "=", 
                          RowBox[{"y\[Rho]list", "\[LeftDoubleBracket]", "i", 
                          "\[RightDoubleBracket]"}]}], ";", 
                          "\[IndentingNewLine]", RowBox[{"\[Rho]", "=", 
                          RowBox[{"\[Rho]list", "\[LeftDoubleBracket]", "i", 
                          "\[RightDoubleBracket]"}]}], ";", 
                          "\[IndentingNewLine]", RowBox[{"\[Beta]", "=", 
                          RowBox[{"\[Rho]y", ".", "r"}]}], ";", 
                          "\[IndentingNewLine]", RowBox[{"r", "=", RowBox[
                          {"r", "+", RowBox[{RowBox[{"(", RowBox[{RowBox[
                          {"\[Alpha]list", "\[LeftDoubleBracket]", RowBox[
                          {"-", "i"}], "\[RightDoubleBracket]"}], "-", 
                          "\[Beta]"}], ")"}], " ", RowBox[{"\[Rho]s", " ", 
                          "/", "\[Rho]"}]}]}]}], ";"}], 
                          "\[IndentingNewLine]", ",", RowBox[{"{", RowBox[
                          {"i", ",", "1", ",", "m"}], "}"}]}], "]"}], 
                       ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", "r"}]}], 
             "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], 
     "\[IndentingNewLine]", 
     RowBox[{RowBox[{"LBFGSAlgorithm", "[", RowBox[{"x0_", ",", "f_", ",", 
           "H0_"}], "]"}], ":=", RowBox[{"Module", "[", 
         RowBox[{RowBox[{"{", "\[IndentingNewLine]", RowBox[{"p", ",", "t", 
               ",", RowBox[{"residuum", "=", "1"}], ",", "u", ",", RowBox[
                {"k", "=", "0"}], ",", "x", ",", "\[IndentingNewLine]", 
               "s\[Rho]list", ",", "y\[Rho]list", ",", "\[Rho]list", ",", 
               "xlist", ",", "m", ",", "dim", ",", "nn", ",", "iter", ",", 
               "\[Tau]", ",", "g", ",", "s", ",", "y", ",", "\[Rho]"}], 
             "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{RowBox[{"x", "=", "x0"}], ";", "\[IndentingNewLine]", 
             RowBox[{"s\[Rho]list", "=", RowBox[{"{", "}"}]}], ";", 
             "\[IndentingNewLine]", RowBox[{"y\[Rho]list", "=", RowBox[
                {"{", "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"\[Rho]list", "=", RowBox[{"{", "}"}]}], ";", 
             "\[IndentingNewLine]", RowBox[{"xlist", "=", RowBox[
                {"{", "x", "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"m", "=", "100"}], ";", "\[IndentingNewLine]", 
             RowBox[{"dim", "=", RowBox[{"Length", "[", RowBox[{"x", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", RowBox[{"Print", "[", RowBox[
                {"Length", "[", RowBox[{"Flatten", "[", "x", "]"}], "]"}], 
               "]"}], ";", "\[IndentingNewLine]", RowBox[{"nn", "=", RowBox[
                {"Length", "[", RowBox[{"Flatten", "[", "x", "]"}], "]"}]}], 
             ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", RowBox[{RowBox[{"H0", "=", RowBox[
                    {RowBox[{"SparseArray", "@", RowBox[{"IdentityMatrix", 
                         "[", "nn", "]"}]}], "/", "nn"}]}], ";"}], "*)"}], 
             "\[IndentingNewLine]", RowBox[{"(*", RowBox[
                {RowBox[{"H0", "=", RowBox[{"L", "/", "nn"}]}], ";"}], 
               "*)"}], "\[IndentingNewLine]", RowBox[{"u", "=", RowBox[
                {"f", "[", RowBox[{"x", ",", "\"D\""}], "]"}]}], ";", 
             "\[IndentingNewLine]", RowBox[{"While", "[", RowBox[
                {RowBox[{RowBox[{RowBox[{"residuum", "/", "nn"}], ">", 
                     RowBox[{"10", "^", RowBox[{"(", RowBox[{"-", "8"}], 
                         ")"}]}]}], "&&", RowBox[{"k", "<", "100"}]}], ",", 
                 "\[IndentingNewLine]", RowBox[{RowBox[{"k", "++"}], ";", 
                   "\[IndentingNewLine]", RowBox[{"iter", "=", "k"}], ";", 
                   "\[IndentingNewLine]", RowBox[{"\[Alpha]", "=", 
                     "residuum"}], ";", "\[IndentingNewLine]", RowBox[
                    {"l", "=", "k"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"val", "=", RowBox[{"f", "[", "x", "]"}]}], ";", 
                   "\[IndentingNewLine]", RowBox[{"\[Tau]", "=", "t"}], ";", 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", RowBox[
                    {"p", "=", RowBox[{"-", RowBox[{"BFGSMultiply", "[", 
                         RowBox[{"H0", ",", "s\[Rho]list", ",", 
                          "y\[Rho]list", ",", "\[Rho]list", ",", "u"}], 
                         "]"}]}]}], ";", "\[IndentingNewLine]", 
                   "\[IndentingNewLine]", RowBox[{"t", "=", RowBox[{"Armijo", 
                       "[", RowBox[{"x", ",", "p", ",", "f"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", RowBox[{"g", "=", "u"}], ";", 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", RowBox[
                    {"x", "=", RowBox[{"x", "+", RowBox[{"t", " ", RowBox[
                          {"Partition", "[", RowBox[{"p", ",", "2"}], 
                          "]"}]}]}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"AppendTo", "[", RowBox[{"xlist", ",", "x"}], 
                     "]"}], ";", "\[IndentingNewLine]", RowBox[{"s", "=", 
                     " ", RowBox[{"t", " ", "p"}]}], ";", 
                   "\[IndentingNewLine]", RowBox[{"u", "=", RowBox[{"f", "[", 
                       RowBox[{"x", ",", "\"D\""}], "]"}]}], ";", 
                   "\[IndentingNewLine]", RowBox[{"y", "=", RowBox[{"u", "-", 
                       "g"}]}], ";", "\[IndentingNewLine]", RowBox[{"\[Rho]", 
                     "=", RowBox[{"1", "/", RowBox[{"y", ".", "s"}]}]}], ";", 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", RowBox[
                    {"If", "[", RowBox[{RowBox[{RowBox[{"Length", "[", 
                          "s\[Rho]list", "]"}], "\[Equal]", "m"}], ",", 
                       "\[IndentingNewLine]", RowBox[{RowBox[{"s\[Rho]list", 
                          "=", RowBox[{"Join", "[", RowBox[{RowBox[{"Rest", 
                          "@", "s\[Rho]list"}], ",", RowBox[{"{", RowBox[
                          {"s", " ", "\[Rho]"}], "}"}]}], "]"}]}], ";", 
                         "\[IndentingNewLine]", RowBox[{"y\[Rho]list", "=", 
                          RowBox[{"Join", "[", RowBox[{RowBox[{"Rest", "@", 
                          "y\[Rho]list"}], ",", RowBox[{"{", RowBox[{"y", 
                          " ", "\[Rho]"}], "}"}]}], "]"}]}], ";", 
                         "\[IndentingNewLine]", RowBox[{"\[Rho]list", "=", 
                          RowBox[{"Join", "[", RowBox[{RowBox[{"Rest", "@", 
                          "\[Rho]list"}], ",", RowBox[{"{", "\[Rho]", 
                          "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
                       ",", "\[IndentingNewLine]", RowBox[{RowBox[
                          {"s\[Rho]list", "=", RowBox[{"Join", "[", RowBox[
                          {"s\[Rho]list", ",", RowBox[{"{", RowBox[{"s", " ", 
                          "\[Rho]"}], "}"}]}], "]"}]}], ";", 
                         "\[IndentingNewLine]", RowBox[{"y\[Rho]list", "=", 
                          RowBox[{"Join", "[", RowBox[{"y\[Rho]list", ",", 
                          RowBox[{"{", RowBox[{"y", " ", "\[Rho]"}], "}"}]}], 
                          "]"}]}], ";", "\[IndentingNewLine]", RowBox[
                          {"\[Rho]list", "=", RowBox[{"Join", "[", RowBox[
                          {"\[Rho]list", ",", RowBox[{"{", "\[Rho]", "}"}]}], 
                          "]"}]}], ";"}]}], "\[IndentingNewLine]", 
                     "\[IndentingNewLine]", "]"}], ";", 
                   "\[IndentingNewLine]", RowBox[{"u", "=", RowBox[{"f", "[", 
                       RowBox[{"x", ",", "\"D\""}], "]"}]}], ";", 
                   "\[IndentingNewLine]", RowBox[{"residuum", "=", RowBox[
                      {"Sqrt", "[", RowBox[{"Total", "[", RowBox[{"u", "^", 
                          "2"}], "]"}], "]"}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"\[Alpha]", "=", "residuum"}], ";", 
             "\[IndentingNewLine]", RowBox[{"l", "=", "k"}], ";", 
             "\[IndentingNewLine]", "xlist"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "Input", CellChangeTimes -> 
    {{3.639396557219903*^9, 3.6393966354663467*^9}, 
     {3.639396676617237*^9, 3.6393968282538147*^9}, 
     {3.6393968720990953*^9, 3.639397003841228*^9}, 
     {3.6394004781783524*^9, 3.639400514275968*^9}, 
     {3.639400718325522*^9, 3.639400766411902*^9}, {3.639400867026136*^9, 
      3.639400872391531*^9}, {3.639400907876514*^9, 3.639400911785678*^9}, 
     {3.639400972948309*^9, 3.639400975322818*^9}, {3.639401053687622*^9, 
      3.639401057840189*^9}, {3.6394011483474817*^9, 3.639401158584303*^9}, 
     {3.6394011891997013*^9, 3.6394012083582773*^9}, 
     {3.639401267222088*^9, 3.6394012788586197*^9}, 
     {3.639401357496024*^9, 3.639401360857623*^9}, {3.639401495155777*^9, 
      3.639401510655836*^9}, {3.639401648462545*^9, 3.639401649004592*^9}, 
     {3.6394017764811087*^9, 3.639401793094769*^9}, 
     {3.639401984468341*^9, 3.639401986541909*^9}, {3.639402017211178*^9, 
      3.6394020189156437*^9}, {3.639402062491699*^9, 3.639402065089452*^9}, 
     {3.639402152966835*^9, 3.6394021674651814*^9}, 3.6394024879643593*^9, 
     {3.6394025520768957*^9, 3.6394025611106873*^9}, 
     {3.6394026558873796*^9, 3.6394026564227448*^9}, 
     {3.639402779026597*^9, 3.639402786240158*^9}, {3.6394028288479977*^9, 
      3.639402856858911*^9}, {3.6394030136754427*^9, 3.639403081757687*^9}, 
     {3.6394031315094213*^9, 3.63940313396887*^9}, {3.639403294071233*^9, 
      3.639403304918186*^9}, {3.639403769941476*^9, 3.639403806552006*^9}, 
     {3.639403854854272*^9, 3.639403919690042*^9}, 3.63940394989217*^9, 
     {3.639404114638946*^9, 3.639404115863475*^9}, 3.639406009138434*^9, 
     {3.639420935545374*^9, 3.639420936196678*^9}}], 
  Cell[BoxData[RowBox[{"P", "//", "Dimensions"}]], "Input", 
   CellChangeTimes -> {{3.639402038237686*^9, 3.63940204431487*^9}}], 
  Cell[BoxData[RowBox[{"H0", "//", "Dimensions"}]], "Input", 
   CellChangeTimes -> {{3.639402021812086*^9, 3.6394020515303173*^9}}], 
  Cell[BoxData[RowBox[{"H0", ".", "s"}]], "Input", 
   CellChangeTimes -> {{3.639401020291953*^9, 3.6394010238063517*^9}}], 
  Cell[BoxData[RowBox[{RowBox[{"Flatten", "[", "P0", "]"}], "-", "s"}]], 
   "Input", CellChangeTimes -> {{3.63940102993476*^9, 
      3.6394010351688633*^9}}], Cell[BoxData["s"], "Input", 
   CellChangeTimes -> {{3.6394010104315567*^9, 3.639401014231885*^9}}], 
  Cell[BoxData[RowBox[{RowBox[{"LBFGSAlgorithm", "[", 
        RowBox[{"x", ",", "f"}], "]"}], "//", "AbsoluteTiming"}]], "Input", 
   CellChangeTimes -> {{3.639396926489794*^9, 3.6393969273398*^9}, 
     {3.63939704066236*^9, 3.639397041937367*^9}, {3.639398528468989*^9, 
      3.639398529847747*^9}}], 
  Cell[BoxData[{"\[Alpha]", "\[IndentingNewLine]", "l"}], "Input", 
   CellChangeTimes -> {{3.639396968206029*^9, 3.639396998100346*^9}}], 
  Cell[BoxData["x"], "Input", CellChangeTimes -> {3.639396952376998*^9}], 
  Cell[BoxData[RowBox[{"x", "=", 
      RowBox[{"{", RowBox[{RowBox[{"-", "0.1"}], ",", "0.1"}], "}"}]}]], 
   "Input", CellChangeTimes -> {{3.6393969538409863*^9, 
      3.639396956786973*^9}, {3.6393970243878307*^9, 3.639397027062039*^9}}], 
  Cell[BoxData["x0"], "Input", CellChangeTimes -> 
    {{3.639396922833249*^9, 3.639396923024858*^9}}], 
  Cell[BoxData[{RowBox[{"Dynamic", "[", "iter", "]"}], "\[IndentingNewLine]", 
     RowBox[{"Dynamic", "[", "\[Alpha]", "]"}], "\[IndentingNewLine]", 
     RowBox[{RowBox[{"Dynamic", "[", "\[Tau]", "]"}], 
       "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
     RowBox[{RowBox[{RowBox[{"x", "=", RowBox[
            {"{", RowBox[{RowBox[{"-", "0.1"}], ",", "0.1"}], "}"}]}], ";"}], 
       "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
     RowBox[{"x", "=", RowBox[{"ModelAlgorithm", "[", 
         RowBox[{"x", ",", "f"}], "]"}]}]}], "Input", 
   CellChangeTimes -> {{3.639388264389594*^9, 3.639388268110478*^9}, 
     {3.639388313802411*^9, 3.639388315789603*^9}, {3.639388381863324*^9, 
      3.639388383410735*^9}, {3.639388954065611*^9, 3.6393889570437727*^9}, 
     {3.639390420235909*^9, 3.639390422372779*^9}}], 
  Cell[BoxData[RowBox[
     {RowBox[{"x", "=", RowBox[{"{", RowBox[{RowBox[{"-", "0.1"}], ",", 
            "0.1"}], "}"}]}], ";"}]], "Input"], 
  Cell[BoxData[{RowBox[{RowBox[{"k", "=", "0"}], ";"}], 
     "\[IndentingNewLine]", RowBox[{RowBox[{"k", "++"}], ";"}], 
     "\[IndentingNewLine]", RowBox[{RowBox[{"iter", "=", "k"}], ";"}], 
     "\[IndentingNewLine]", RowBox[{RowBox[{"\[Alpha]", "=", "residuum"}], 
       ";"}], "\[IndentingNewLine]", RowBox[{RowBox[{"\[Tau]", "=", "t"}], 
       ";"}], "\[IndentingNewLine]", 
     RowBox[{RowBox[{"p", "=", RowBox[{"-", RowBox[{"f", "[", 
             RowBox[{"x", ",", "\"D\""}], "]"}]}]}], ";"}], 
     "\[IndentingNewLine]", 
     RowBox[{RowBox[{"t", "=", RowBox[{"Armijo", "[", 
           RowBox[{"x", ",", "p", ",", "f"}], "]"}]}], ";"}]}], "Input", 
   CellChangeTimes -> {{3.6393916354650383*^9, 3.6393916365013103*^9}}], 
  Cell[BoxData["t"], "Input", CellChangeTimes -> {3.639391639577161*^9}], 
  Cell[BoxData["p"], "Input", CellChangeTimes -> {3.639391650590125*^9}], 
  Cell[BoxData[{RowBox[{RowBox[{"r", "=", "2"}], ";"}], 
     "\[IndentingNewLine]", RowBox[{"ContourPlot", "[", 
       RowBox[{RowBox[{"Log", "@", RowBox[{"f", "[", RowBox[{"{", RowBox[
                {"x", ",", "y"}], "}"}], "]"}]}], ",", 
         RowBox[{"{", RowBox[{"x", ",", RowBox[{"-", "r"}], ",", "r"}], 
           "}"}], ",", RowBox[{"{", RowBox[{"y", ",", RowBox[{"-", "r"}], 
             ",", "r"}], "}"}], ",", RowBox[{"Contours", "\[Rule]", "50"}]}], 
       "]"}]}], "Input", CellChangeTimes -> 
    {{3.6393876142643013*^9, 3.639387640018815*^9}, 
     {3.6393877155456247*^9, 3.639387738742716*^9}, 
     {3.639387799845744*^9, 3.639387800417777*^9}}], 
  Cell[BoxData[RowBox[{"mod", "=", 
      RowBox[{RowBox[{"{", RowBox[{"a", ",", "m"}], "}"}], "\[Function]", 
        RowBox[{"a", "-", RowBox[{"m", " ", RowBox[{"Floor", "[", 
              RowBox[{"a", "/", "m"}], "]"}]}]}]}]}]], "Input", 
   CellChangeTimes -> {{3.639399104204288*^9, 3.6393991493173933*^9}, 
     {3.639399215233651*^9, 3.639399248070319*^9}}], 
  Cell[BoxData[RowBox[{"mod", "[", RowBox[{"4", ",", "3"}], "]"}]], "Input", 
   CellChangeTimes -> {{3.6393991512049847*^9, 3.639399153092596*^9}, 
     {3.639399220495953*^9, 3.6393992438829823*^9}}], 
  Cell[BoxData[RowBox[{"a", "-", RowBox[{"m", " ", 
        RowBox[{"a", "/", "m"}]}]}]], "Input", 
   CellChangeTimes -> {{3.639399177508254*^9, 3.6393992114207497*^9}}], 
  Cell[BoxData[{RowBox[{RowBox[{"a", "=", "4"}], ";"}], 
     "\[IndentingNewLine]", RowBox[{RowBox[{"m", "=", "2"}], ";"}]}], 
   "Input", CellChangeTimes -> {{3.639399185029624*^9, 
      3.639399190095909*^9}}]}, WindowSize -> {1440, 852}, 
 WindowMargins -> {{0, Automatic}, {Automatic, 0}}, 
 FrontEndVersion -> 
  "10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 4, 2014)", 
 StyleDefinitions -> "Default.nb"]
